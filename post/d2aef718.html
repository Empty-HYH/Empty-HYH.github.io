<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Java é¢è¯•é¢˜è§£æ | Eurkon</title><meta name="keywords" content="â˜•Java"><meta name="author" content="Eurkon,eurkon@foxmail.com"><meta name="copyright" content="Eurkon"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="æ–‡ç« æ¥æºï¼š   ä½œè€…: éª†æ˜Š   é“¾æ¥: https:&#x2F;&#x2F;blog.csdn.net&#x2F;jackfrued&#x2F;article&#x2F;details&#x2F;44921941   æ¥æº: CSDN   è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚   Java åŸºç¡€ï¼ˆ1~51ï¼‰ 1ã€é¢å‘å¯¹è±¡çš„ç‰¹å¾æœ‰å“ªäº›æ–¹é¢ï¼Ÿ  ç­”ï¼šé¢å‘å¯¹è±¡çš„ç‰¹å¾ä¸»è¦æœ‰ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š  æŠ½è±¡ï¼šæŠ½è±¡æ˜¯å°†ä¸€ç±»å¯¹è±¡çš„å…±åŒç‰¹å¾æ€»ç»“å‡ºæ¥">
<meta property="og:type" content="article">
<meta property="og:title" content="Java é¢è¯•é¢˜è§£æ">
<meta property="og:url" content="https://blog.eurkon.com/post/d2aef718.html">
<meta property="og:site_name" content="Eurkon">
<meta property="og:description" content="æ–‡ç« æ¥æºï¼š   ä½œè€…: éª†æ˜Š   é“¾æ¥: https:&#x2F;&#x2F;blog.csdn.net&#x2F;jackfrued&#x2F;article&#x2F;details&#x2F;44921941   æ¥æº: CSDN   è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚   Java åŸºç¡€ï¼ˆ1~51ï¼‰ 1ã€é¢å‘å¯¹è±¡çš„ç‰¹å¾æœ‰å“ªäº›æ–¹é¢ï¼Ÿ  ç­”ï¼šé¢å‘å¯¹è±¡çš„ç‰¹å¾ä¸»è¦æœ‰ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š  æŠ½è±¡ï¼šæŠ½è±¡æ˜¯å°†ä¸€ç±»å¯¹è±¡çš„å…±åŒç‰¹å¾æ€»ç»“å‡ºæ¥">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://blog.eurkon.com/images/cover/java_interview.jpg">
<meta property="article:published_time" content="2021-03-20T01:38:32.000Z">
<meta property="article:modified_time" content="2021-03-23T11:26:55.757Z">
<meta property="article:author" content="Eurkon">
<meta property="article:tag" content="â˜•Java">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://blog.eurkon.com/images/cover/java_interview.jpg"><link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/Eurkon/CDN/hexo/images/user/favicon.png"><link rel="canonical" href="https://blog.eurkon.com/post/d2aef718"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="rClKrjtCYPsDaynvUNmfe2YGPxb7ehnuwEF9aMdG7no"/><meta name="msvalidate.01" content="F299EA4E7AD0E2B28FDF4E0EA94879BA"/><meta name="baidu-site-verification" content="code-GmAI2TORJk"/><meta name="360-site-verification" content="ac410c1012e6f0acc65b5c0805c91f01"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?ca4902422e728abe0603d52ce2e7757a";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}"}},
  translate: {"defaultEncoding":1,"translateDelay":0,"msgToTraditionalChinese":"ç¹","msgToSimplifiedChinese":"ç®€"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":250},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'å¤©',
  date_suffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: {"limitCount":50,"languages":{"author":"ä½œè€…: Eurkon","link":"é“¾æ¥: ","source":"æ¥æº: Eurkon","info":"è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"ä½ å·²åˆ‡æ¢ä¸ºç¹ä½“","cht_to_chs":"ä½ å·²åˆ‡æ¢ä¸ºç®€ä½“","day_to_night":"ä½ å·²åˆ‡æ¢ä¸ºæ·±è‰²æ¨¡å¼","night_to_day":"ä½ å·²åˆ‡æ¢ä¸ºæµ…è‰²æ¨¡å¼","bgLight":"#49b1f5","bgDark":"#121212","position":"bottom-left"},
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-03-23 19:26:55'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const fontSizeVal = saveToLocal.get('global-font-size')
    if (fontSizeVal !== undefined) {
      document.documentElement.style.setProperty('--global-font-size', fontSizeVal + 'px')
    }
    })(window)</script><link rel="stylesheet" href="/css/custom.css"><link rel="stylesheet" href="https://cdn.bootcss.com/highlight.js/9.15.10/styles/dracula.min.css"><script data-pjax src="https://cdn.jsdelivr.net/npm/echarts@4.7.0/dist/echarts.min.js"></script><script data-pjax src="https://cdn.jsdelivr.net/npm/echarts@4.7.0/map/js/china.js"></script><meta name="generator" content="Hexo 5.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" data-lazy-src="https://cdn.jsdelivr.net/gh/Eurkon/CDN/hexo/images/user/avatar.jpg" onerror="onerror=null;src='https://cdn.jsdelivr.net/gh/Eurkon/CDN/hexo/images/user/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">21</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">13</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">3</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-copy"></i><span> æ–‡ç« </span><i class="fas fa-chevron-down expand hide"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> å½’æ¡£</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-link"></i><span> é“¾æ¥</span><i class="fas fa-chevron-down expand hide"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-address-card"></i><span> å‹é“¾</span></a></li><li><a class="site-page child" href="/stars/"><i class="fa-fw fas fa-star"></i><span> æ”¶è—</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> å¨±ä¹</span><i class="fas fa-chevron-down expand hide"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/books/"><i class="fa-fw fas fa-book"></i><span> ä¹¦ç±</span></a></li><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> éŸ³ä¹</span></a></li><li><a class="site-page child" href="/images/"><i class="fa-fw fas fa-images"></i><span> å›¾åº“</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> ç”µå½±</span></a></li><li><a class="site-page child" href="/games/"><i class="fa-fw fas fa-gamepad"></i><span> æ¸¸æˆ</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-bug"></i><span> å®éªŒå®¤</span><i class="fas fa-chevron-down expand hide"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/fcircle/"><i class="fa-fw fas fa-heartbeat"></i><span> æœ‹å‹åœˆ</span></a></li><li><a class="site-page child" href="/census/"><i class="fa-fw fas fa-chart-line"></i><span> åšå®¢ç»Ÿè®¡</span></a></li><li><a class="site-page child" href="/charts/"><i class="fa-fw fas fa-chart-bar"></i><span> æ–‡ç« ç»Ÿè®¡</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/random/"><i class="fa-fw fas fa-random"></i><span> éšä¾¿çœ‹çœ‹</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-info-circle"></i><span> å…³äº</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/images/cover/java_interview.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Eurkon</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> æœç´¢</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-copy"></i><span> æ–‡ç« </span><i class="fas fa-chevron-down expand hide"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> å½’æ¡£</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-link"></i><span> é“¾æ¥</span><i class="fas fa-chevron-down expand hide"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-address-card"></i><span> å‹é“¾</span></a></li><li><a class="site-page child" href="/stars/"><i class="fa-fw fas fa-star"></i><span> æ”¶è—</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> å¨±ä¹</span><i class="fas fa-chevron-down expand hide"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/books/"><i class="fa-fw fas fa-book"></i><span> ä¹¦ç±</span></a></li><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> éŸ³ä¹</span></a></li><li><a class="site-page child" href="/images/"><i class="fa-fw fas fa-images"></i><span> å›¾åº“</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> ç”µå½±</span></a></li><li><a class="site-page child" href="/games/"><i class="fa-fw fas fa-gamepad"></i><span> æ¸¸æˆ</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-bug"></i><span> å®éªŒå®¤</span><i class="fas fa-chevron-down expand hide"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/fcircle/"><i class="fa-fw fas fa-heartbeat"></i><span> æœ‹å‹åœˆ</span></a></li><li><a class="site-page child" href="/census/"><i class="fa-fw fas fa-chart-line"></i><span> åšå®¢ç»Ÿè®¡</span></a></li><li><a class="site-page child" href="/charts/"><i class="fa-fw fas fa-chart-bar"></i><span> æ–‡ç« ç»Ÿè®¡</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/random/"><i class="fa-fw fas fa-random"></i><span> éšä¾¿çœ‹çœ‹</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-info-circle"></i><span> å…³äº</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Java é¢è¯•é¢˜è§£æ</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2021-03-20T01:38:32.000Z" title="å‘è¡¨äº 2021-03-20 09:38:32">2021-03-20</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2021-03-23T11:26:55.757Z" title="æ›´æ–°äº 2021-03-23 19:26:55">2021-03-23</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%F0%9F%93%96%E6%95%99%E7%A8%8B%E7%AC%94%E8%AE%B0/">ğŸ“–æ•™ç¨‹ç¬”è®°</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">å­—æ•°æ€»è®¡:</span><span class="word-count">64,297</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»æ—¶é•¿:</span><span>259åˆ†é’Ÿ</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Java é¢è¯•é¢˜è§£æ"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">è¯„è®ºæ•°:</span><a href="/post/d2aef718.html#post-comment"><span id="twikoo-count"></span></a></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p><div class="note info simple"><p>æ–‡ç« æ¥æºï¼š<br>
  ä½œè€…: <a target="_blank" rel="noopener" href="https://blog.csdn.net/jackfrued">éª†æ˜Š</a><br>
  é“¾æ¥: <a target="_blank" rel="noopener" href="https://blog.csdn.net/jackfrued/article/details/44921941">https://blog.csdn.net/jackfrued/article/details/44921941</a><br>
  æ¥æº: <a target="_blank" rel="noopener" href="https://www.csdn.net/">CSDN</a><br>
  è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p>
</div>
</p>
<h1 id="Java-åŸºç¡€ï¼ˆ1-51ï¼‰"><a href="#Java-åŸºç¡€ï¼ˆ1-51ï¼‰" class="headerlink" title="Java åŸºç¡€ï¼ˆ1~51ï¼‰"></a>Java åŸºç¡€ï¼ˆ1~51ï¼‰</h1><blockquote>
<p>1ã€é¢å‘å¯¹è±¡çš„ç‰¹å¾æœ‰å“ªäº›æ–¹é¢ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šé¢å‘å¯¹è±¡çš„ç‰¹å¾ä¸»è¦æœ‰ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š</p>
<ul>
<li><p>æŠ½è±¡ï¼šæŠ½è±¡æ˜¯å°†ä¸€ç±»å¯¹è±¡çš„å…±åŒç‰¹å¾æ€»ç»“å‡ºæ¥æ„é€ ç±»çš„è¿‡ç¨‹ï¼ŒåŒ…æ‹¬<strong>æ•°æ®æŠ½è±¡</strong>å’Œ<strong>è¡Œä¸ºæŠ½è±¡</strong>ä¸¤æ–¹é¢ã€‚æŠ½è±¡åªå…³æ³¨å¯¹è±¡æœ‰å“ªäº›å±æ€§å’Œè¡Œä¸ºï¼Œå¹¶ä¸å…³æ³¨è¿™äº›è¡Œä¸ºçš„ç»†èŠ‚æ˜¯ä»€ä¹ˆã€‚</p>
</li>
<li><p>ç»§æ‰¿ï¼šç»§æ‰¿æ˜¯ä»å·²æœ‰ç±»å¾—åˆ°ç»§æ‰¿ä¿¡æ¯åˆ›å»ºæ–°ç±»çš„è¿‡ç¨‹ã€‚æä¾›ç»§æ‰¿ä¿¡æ¯çš„ç±»è¢«ç§°ä¸ºçˆ¶ç±»ï¼ˆè¶…ç±»ã€åŸºç±»ï¼‰ï¼›å¾—åˆ°ç»§æ‰¿ä¿¡æ¯çš„ç±»è¢«ç§°ä¸ºå­ç±»ï¼ˆæ´¾ç”Ÿç±»ï¼‰ã€‚ç»§æ‰¿è®©å˜åŒ–ä¸­çš„è½¯ä»¶ç³»ç»Ÿæœ‰äº†ä¸€å®šçš„å»¶ç»­æ€§ï¼ŒåŒæ—¶ç»§æ‰¿ä¹Ÿæ˜¯å°è£…ç¨‹åºä¸­å¯å˜å› ç´ çš„é‡è¦æ‰‹æ®µã€‚</p>
</li>
<li><p>å°è£…ï¼šé€šå¸¸è®¤ä¸ºå°è£…æ˜¯æŠŠæ•°æ®å’Œæ“ä½œæ•°æ®çš„æ–¹æ³•ç»‘å®šèµ·æ¥ï¼Œå¯¹æ•°æ®çš„è®¿é—®åªèƒ½é€šè¿‡å·²å®šä¹‰çš„æ¥å£ã€‚é¢å‘å¯¹è±¡çš„æœ¬è´¨å°±æ˜¯å°†ç°å®ä¸–ç•Œæç»˜æˆä¸€ç³»åˆ—å®Œå…¨è‡ªæ²»ã€å°é—­çš„å¯¹è±¡ã€‚æˆ‘ä»¬åœ¨ç±»ä¸­ç¼–å†™çš„æ–¹æ³•å°±æ˜¯å¯¹å®ç°ç»†èŠ‚çš„ä¸€ç§å°è£…ï¼›æˆ‘ä»¬ç¼–å†™ä¸€ä¸ªç±»å°±æ˜¯å¯¹æ•°æ®å’Œæ•°æ®æ“ä½œçš„å°è£…ã€‚å¯ä»¥è¯´ï¼Œå°è£…å°±æ˜¯éšè—ä¸€åˆ‡å¯éšè—çš„ä¸œè¥¿ï¼Œåªå‘å¤–ç•Œæä¾›æœ€ç®€å•çš„ç¼–ç¨‹æ¥å£ï¼ˆå¯ä»¥æƒ³æƒ³æ™®é€šæ´—è¡£æœºå’Œå…¨è‡ªåŠ¨æ´—è¡£æœºçš„å·®åˆ«ï¼Œæ˜æ˜¾å…¨è‡ªåŠ¨æ´—è¡£æœºå°è£…æ›´å¥½å› æ­¤æ“ä½œèµ·æ¥æ›´ç®€å•ï¼›æˆ‘ä»¬ç°åœ¨ä½¿ç”¨çš„æ™ºèƒ½æ‰‹æœºä¹Ÿæ˜¯å°è£…å¾—è¶³å¤Ÿå¥½çš„ï¼Œå› ä¸ºå‡ ä¸ªæŒ‰é”®å°±æå®šäº†æ‰€æœ‰çš„äº‹æƒ…ï¼‰ã€‚</p>
</li>
<li><p>å¤šæ€æ€§ï¼šå¤šæ€æ€§æ˜¯æŒ‡å…è®¸ä¸åŒå­ç±»å‹çš„å¯¹è±¡å¯¹åŒä¸€æ¶ˆæ¯ä½œå‡ºä¸åŒçš„å“åº”ã€‚ç®€å•çš„è¯´å°±æ˜¯ç”¨åŒæ ·çš„å¯¹è±¡å¼•ç”¨è°ƒç”¨åŒæ ·çš„æ–¹æ³•ä½†æ˜¯åšäº†ä¸åŒçš„äº‹æƒ…ã€‚å¤šæ€æ€§åˆ†ä¸º<strong>ç¼–è¯‘æ—¶çš„å¤šæ€æ€§</strong>å’Œ<strong>è¿è¡Œæ—¶çš„å¤šæ€æ€§</strong>ã€‚å¦‚æœå°†å¯¹è±¡çš„æ–¹æ³•è§†ä¸ºå¯¹è±¡å‘å¤–ç•Œæä¾›çš„æœåŠ¡ï¼Œé‚£ä¹ˆè¿è¡Œæ—¶çš„å¤šæ€æ€§å¯ä»¥è§£é‡Šä¸ºï¼šå½“ A ç³»ç»Ÿè®¿é—® B ç³»ç»Ÿæä¾›çš„æœåŠ¡æ—¶ï¼ŒB ç³»ç»Ÿæœ‰å¤šç§æä¾›æœåŠ¡çš„æ–¹å¼ï¼Œä½†ä¸€åˆ‡å¯¹ A ç³»ç»Ÿæ¥è¯´éƒ½æ˜¯é€æ˜çš„ï¼ˆå°±åƒç”µåŠ¨å‰ƒé¡»åˆ€æ˜¯ A ç³»ç»Ÿï¼Œå®ƒçš„ä¾›ç”µç³»ç»Ÿæ˜¯ B ç³»ç»Ÿï¼ŒB ç³»ç»Ÿå¯ä»¥ä½¿ç”¨ç”µæ± ä¾›ç”µæˆ–è€…ç”¨äº¤æµç”µï¼Œç”šè‡³è¿˜æœ‰å¯èƒ½æ˜¯å¤ªé˜³èƒ½ï¼ŒA ç³»ç»Ÿåªä¼šé€šè¿‡ B ç±»å¯¹è±¡è°ƒç”¨ä¾›ç”µçš„æ–¹æ³•ï¼Œä½†å¹¶ä¸çŸ¥é“ä¾›ç”µç³»ç»Ÿçš„åº•å±‚å®ç°æ˜¯ä»€ä¹ˆï¼Œç©¶ç«Ÿé€šè¿‡ä½•ç§æ–¹å¼è·å¾—äº†åŠ¨åŠ›ï¼‰ã€‚</p>
<ul>
<li><strong>æ–¹æ³•é‡è½½</strong>ï¼ˆ<code>overload</code>ï¼‰å®ç°çš„æ˜¯ç¼–è¯‘æ—¶çš„å¤šæ€æ€§ï¼ˆä¹Ÿç§°ä¸ºå‰ç»‘å®šï¼‰ï¼Œè€Œ<strong>æ–¹æ³•é‡å†™</strong>ï¼ˆ<code>override</code>ï¼‰å®ç°çš„æ˜¯è¿è¡Œæ—¶çš„å¤šæ€æ€§ï¼ˆä¹Ÿç§°ä¸ºåç»‘å®šï¼‰ã€‚</li>
<li>è¿è¡Œæ—¶çš„å¤šæ€æ˜¯é¢å‘å¯¹è±¡æœ€ç²¾é«“çš„ä¸œè¥¿ï¼Œè¦å®ç°å¤šæ€éœ€è¦åšä¸¤ä»¶äº‹ï¼š<ol>
<li>æ–¹æ³•é‡å†™ï¼ˆå­ç±»ç»§æ‰¿çˆ¶ç±»å¹¶é‡å†™çˆ¶ç±»ä¸­å·²æœ‰çš„æˆ–æŠ½è±¡çš„æ–¹æ³•ï¼‰ï¼›</li>
<li>å¯¹è±¡é€ å‹ï¼ˆç”¨çˆ¶ç±»å‹å¼•ç”¨å¼•ç”¨å­ç±»å‹å¯¹è±¡ï¼Œè¿™æ ·åŒæ ·çš„å¼•ç”¨è°ƒç”¨åŒæ ·çš„æ–¹æ³•å°±ä¼šæ ¹æ®å­ç±»å¯¹è±¡çš„ä¸åŒè€Œè¡¨ç°å‡ºä¸åŒçš„è¡Œä¸ºï¼‰ã€‚</li>
</ol>
</li>
</ul>
</li>
</ul>
<blockquote>
<p>2ã€è®¿é—®ä¿®é¥°ç¬¦ <code>public</code>ã€<code>private</code>ã€<code>protected</code>ã€ä»¥åŠä¸å†™ï¼ˆé»˜è®¤ï¼‰æ—¶çš„åŒºåˆ«ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼š</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>ä¿®é¥°ç¬¦</th>
<th>å½“å‰ç±»</th>
<th>åŒåŒ…</th>
<th>å­ç±»</th>
<th>å…¶ä»–åŒ…</th>
</tr>
</thead>
<tbody>
<tr>
<td>public</td>
<td>âˆš</td>
<td>âˆš</td>
<td>âˆš</td>
<td>âˆš</td>
</tr>
<tr>
<td>protected</td>
<td>âˆš</td>
<td>âˆš</td>
<td>âˆš</td>
<td>Ã—</td>
</tr>
<tr>
<td>default</td>
<td>âˆš</td>
<td>âˆš</td>
<td>Ã—</td>
<td>Ã—</td>
</tr>
<tr>
<td>private</td>
<td>âˆš</td>
<td>Ã—</td>
<td>Ã—</td>
<td>Ã—</td>
</tr>
</tbody>
</table>
</div>
<p>ç±»çš„æˆå‘˜ä¸å†™è®¿é—®ä¿®é¥°æ—¶é»˜è®¤ä¸º <code>default</code>ã€‚é»˜è®¤å¯¹äºåŒä¸€ä¸ªåŒ…ä¸­çš„å…¶ä»–ç±»ç›¸å½“äºå…¬å¼€ï¼ˆ<code>public</code>ï¼‰ï¼Œå¯¹äºä¸æ˜¯åŒä¸€ä¸ªåŒ…ä¸­çš„å…¶ä»–ç±»ç›¸å½“äºç§æœ‰ï¼ˆ<code>private</code>ï¼‰ã€‚å—ä¿æŠ¤ï¼ˆ<code>protected</code>ï¼‰å¯¹å­ç±»ç›¸å½“äºå…¬å¼€ï¼Œå¯¹ä¸æ˜¯åŒä¸€åŒ…ä¸­çš„æ²¡æœ‰çˆ¶å­å…³ç³»çš„ç±»ç›¸å½“äºç§æœ‰ã€‚Java ä¸­ï¼Œå¤–éƒ¨ç±»çš„ä¿®é¥°ç¬¦åªèƒ½æ˜¯ <code>public</code> æˆ–é»˜è®¤ï¼Œç±»çš„æˆå‘˜ï¼ˆåŒ…æ‹¬å†…éƒ¨ç±»ï¼‰çš„ä¿®é¥°ç¬¦å¯ä»¥æ˜¯ä»¥ä¸Šå››ç§ã€‚</p>
<blockquote>
<p>3ã€<code>String</code> æ˜¯æœ€åŸºæœ¬çš„æ•°æ®ç±»å‹å—ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šä¸æ˜¯ã€‚Java ä¸­çš„åŸºæœ¬æ•°æ®ç±»å‹åªæœ‰ 8 ä¸ªï¼š<code>byte</code>ã€<code>short</code>ã€<code>int</code>ã€<code>long</code>ã€<code>float</code>ã€<code>double</code>ã€<code>char</code>ã€<code>boolean</code>ï¼›é™¤äº†åŸºæœ¬ç±»å‹ï¼ˆprimitive typeï¼‰ï¼Œå‰©ä¸‹çš„éƒ½æ˜¯å¼•ç”¨ç±»å‹ï¼ˆreference typeï¼‰ï¼ŒJava 5 ä»¥åå¼•å…¥çš„æšä¸¾ç±»å‹ï¼ˆenumï¼‰ä¹Ÿç®—æ˜¯ä¸€ç§æ¯”è¾ƒç‰¹æ®Šçš„å¼•ç”¨ç±»å‹ã€‚</p>
<blockquote>
<p>4ã€<code>float f = 3.4;</code> æ˜¯å¦æ­£ç¡®ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šä¸æ­£ç¡®ã€‚3.4 æ˜¯åŒç²¾åº¦æ•°ï¼Œå°†åŒç²¾åº¦å‹ï¼ˆ<code>double</code>ï¼‰èµ‹å€¼ç»™æµ®ç‚¹å‹ï¼ˆ<code>float</code>ï¼‰å±äº<strong>ä¸‹è½¬å‹</strong>ï¼ˆdown-castingï¼Œä¹Ÿç§°ä¸ºçª„åŒ–ï¼‰ä¼šé€ æˆ<strong>ç²¾åº¦æŸå¤±</strong>ï¼Œå› æ­¤éœ€è¦<strong>å¼ºåˆ¶ç±»å‹è½¬æ¢</strong> <code>float f = (float)3.4;</code> æˆ–è€…å†™æˆ <code>float f = 3.4F</code>;ã€‚</p>
<blockquote>
<p>5ã€<code>short s1 = 1; s1 = s1 + 1;</code> æœ‰é”™å—ï¼Ÿ<code>short s1 = 1; s1 += 1;</code> æœ‰é”™å—ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šå¯¹äº <code>short s1 = 1; s1 = s1 + 1;</code> ç”±äº 1 æ˜¯ <code>int</code> ç±»å‹ï¼Œå› æ­¤ <code>s1 + 1</code> è¿ç®—ç»“æœä¹Ÿæ˜¯ <code>int</code> å‹ï¼Œéœ€è¦å¼ºåˆ¶è½¬æ¢ç±»å‹æ‰èƒ½èµ‹å€¼ç»™ <code>short</code> å‹ã€‚è€Œ <code>short s1 = 1; s1 += 1;</code> å¯ä»¥æ­£ç¡®ç¼–è¯‘ï¼Œå› ä¸º <code>s1 += 1;</code> ç›¸å½“äº <code>s1 = (short)(s1 + 1);</code> å…¶ä¸­æœ‰éšå«çš„å¼ºåˆ¶ç±»å‹è½¬æ¢ã€‚</p>
<blockquote>
<p>6ã€Java æœ‰æ²¡æœ‰ <code>goto</code>ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼š<code>goto</code> æ˜¯ Java ä¸­çš„<strong>ä¿ç•™å­—</strong>ï¼Œåœ¨ç›®å‰ç‰ˆæœ¬çš„ Java ä¸­æ²¡æœ‰ä½¿ç”¨ã€‚ï¼ˆæ ¹æ®James Goslingï¼ˆJavaä¹‹çˆ¶ï¼‰ç¼–å†™çš„ã€ŠThe Java Programming Languageã€‹ä¸€ä¹¦çš„é™„å½•ä¸­ç»™å‡ºäº†ä¸€ä¸ª Java å…³é”®å­—åˆ—è¡¨ï¼Œå…¶ä¸­æœ‰ <code>goto</code> å’Œ <code>const</code>ï¼Œä½†æ˜¯è¿™ä¸¤ä¸ªæ˜¯ç›®å‰æ— æ³•ä½¿ç”¨çš„å…³é”®å­—ï¼Œå› æ­¤æœ‰äº›åœ°æ–¹å°†å…¶ç§°ä¹‹ä¸ºä¿ç•™å­—ï¼Œå…¶å®ä¿ç•™å­—è¿™ä¸ªè¯åº”è¯¥æœ‰æ›´å¹¿æ³›çš„æ„ä¹‰ï¼Œå› ä¸ºç†Ÿæ‚‰ C è¯­è¨€çš„ç¨‹åºå‘˜éƒ½çŸ¥é“ï¼Œåœ¨ç³»ç»Ÿç±»åº“ä¸­ä½¿ç”¨è¿‡çš„æœ‰ç‰¹æ®Šæ„ä¹‰çš„å•è¯æˆ–å•è¯çš„ç»„åˆéƒ½è¢«è§†ä¸ºä¿ç•™å­—ï¼‰ã€‚</p>
<blockquote>
<p>7ã€<code>int</code> å’Œ <code>Integer</code> æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šJava æ˜¯ä¸€ä¸ªè¿‘ä¹çº¯æ´çš„é¢å‘å¯¹è±¡ç¼–ç¨‹è¯­è¨€ï¼Œä½†æ˜¯ä¸ºäº†ç¼–ç¨‹çš„æ–¹ä¾¿è¿˜æ˜¯å¼•å…¥äº†åŸºæœ¬æ•°æ®ç±»å‹ï¼Œä½†æ˜¯ä¸ºäº†èƒ½å¤Ÿå°†è¿™äº›åŸºæœ¬æ•°æ®ç±»å‹å½“æˆå¯¹è±¡æ“ä½œï¼ŒJava ä¸ºæ¯ä¸€ä¸ªåŸºæœ¬æ•°æ®ç±»å‹éƒ½å¼•å…¥äº†å¯¹åº”çš„åŒ…è£…ç±»å‹ï¼ˆwrapper classï¼‰ï¼Œ<code>int</code> çš„åŒ…è£…ç±»å°±æ˜¯ <code>Integer</code>ï¼Œä» Java 5 å¼€å§‹å¼•å…¥äº†<strong>è‡ªåŠ¨è£…ç®± / æ‹†ç®±</strong>æœºåˆ¶ï¼Œä½¿å¾—äºŒè€…å¯ä»¥ç›¸äº’è½¬æ¢ã€‚</p>
<p>Java ä¸ºæ¯ä¸ªåŸå§‹ç±»å‹æä¾›äº†åŒ…è£…ç±»å‹ï¼š</p>
<ul>
<li>åŸå§‹ç±»å‹ï¼š<code>boolean</code>ï¼Œ<code>char</code>ï¼Œ<code>byte</code>ï¼Œ<code>short</code>ï¼Œ<code>int</code>ï¼Œ<code>long</code>ï¼Œ<code>float</code>ï¼Œ<code>double</code>ã€‚</li>
<li>åŒ…è£…ç±»å‹ï¼š<code>Boolean</code>ï¼Œ<code>Character</code>ï¼Œ<code>Byte</code>ï¼Œ<code>Short</code>ï¼Œ<code>Integer</code>ï¼Œ<code>Long</code>ï¼Œ<code>Float</code>ï¼Œ<code>Double</code>ã€‚</li>
</ul>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AutoUnboxingTest</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        Integer a = <span class="hljs-keyword">new</span> Integer(<span class="hljs-number">3</span>);<br>        Integer b = <span class="hljs-number">3</span>;                  <span class="hljs-comment">// å°† 3 è‡ªåŠ¨è£…ç®±æˆIntegerç±»å‹</span><br>        <span class="hljs-keyword">int</span> c = <span class="hljs-number">3</span>;<br>        System.out.println(a == b);     <span class="hljs-comment">// false ä¸¤ä¸ªå¼•ç”¨æ²¡æœ‰å¼•ç”¨åŒä¸€å¯¹è±¡</span><br>        System.out.println(a == c);     <span class="hljs-comment">// true a è‡ªåŠ¨æ‹†ç®±æˆ int ç±»å‹å†å’Œ c æ¯”è¾ƒ</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<p>æœ€è¿‘è¿˜é‡åˆ°ä¸€ä¸ªé¢è¯•é¢˜ï¼Œä¹Ÿæ˜¯å’Œè‡ªåŠ¨è£…ç®±å’Œæ‹†ç®±æœ‰ç‚¹å…³ç³»çš„ï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        <span class="hljs-comment">// æ•´å‹å­—é¢é‡çš„å€¼åœ¨ -128 åˆ° 127 ä¹‹é—´ç›´æ¥å¼•ç”¨å¸¸é‡æ± ä¸­çš„ Integer å¯¹è±¡ï¼Œå¦åˆ™ new æ–°çš„ Integer å¯¹è±¡</span><br>        Integer f1 = <span class="hljs-number">100</span>, f2 = <span class="hljs-number">100</span>, f3 = <span class="hljs-number">150</span>, f4 = <span class="hljs-number">150</span>;<br>        System.out.println(f1 == f2);     <span class="hljs-comment">// true ç›´æ¥å¼•ç”¨å¸¸é‡æ± ä¸­çš„ Integer å¯¹è±¡</span><br>        System.out.println(f3 == f4);     <span class="hljs-comment">// false ä¸¤ä¸ªå¼•ç”¨æ²¡æœ‰å¼•ç”¨åŒä¸€å¯¹è±¡</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<p>å¦‚æœä¸æ˜å°±é‡Œå¾ˆå®¹æ˜“è®¤ä¸ºä¸¤ä¸ªè¾“å‡ºè¦ä¹ˆéƒ½æ˜¯ <code>true</code> è¦ä¹ˆéƒ½æ˜¯ <code>false</code>ã€‚é¦–å…ˆéœ€è¦æ³¨æ„çš„æ˜¯ <code>f1</code>ã€<code>f2</code>ã€<code>f3</code>ã€<code>f4</code> å››ä¸ªå˜é‡éƒ½æ˜¯ <code>Integer</code> å¯¹è±¡å¼•ç”¨ï¼Œæ‰€ä»¥ä¸‹é¢çš„ <code>==</code> è¿ç®—æ¯”è¾ƒçš„ä¸æ˜¯å€¼è€Œæ˜¯å¼•ç”¨ã€‚è£…ç®±çš„æœ¬è´¨æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿå½“æˆ‘ä»¬ç»™ä¸€ä¸ª <code>Integer</code> å¯¹è±¡èµ‹ä¸€ä¸ª <code>int</code> å€¼çš„æ—¶å€™ï¼Œä¼šè°ƒç”¨ <code>Integer</code> ç±»çš„é™æ€æ–¹æ³• <code>valueOf</code>ï¼Œå¦‚æœçœ‹çœ‹ <code>valueOf</code> çš„æºä»£ç å°±çŸ¥é“å‘ç”Ÿäº†ä»€ä¹ˆã€‚</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Integer <span class="hljs-title">valueOf</span><span class="hljs-params">(<span class="hljs-keyword">int</span> i)</span> </span>&#123;<br>    <span class="hljs-keyword">if</span> (i &gt;= IntegerCache.low &amp;&amp; i &lt;= IntegerCache.high)<br>        <span class="hljs-keyword">return</span> IntegerCache.cache[i + (-IntegerCache.low)];<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Integer(i);<br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<p><code>IntegerCache</code> æ˜¯ <code>Integer</code> çš„å†…éƒ¨ç±»ï¼Œå…¶ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment">  * Cache to support the object identity semantics of autoboxing for values between</span><br><span class="hljs-comment">  * -128 and 127 (inclusive) as required by JLS.</span><br><span class="hljs-comment">  *</span><br><span class="hljs-comment">  * The cache is initialized on first usage.  The size of the cache</span><br><span class="hljs-comment">  * may be controlled by the &#123;<span class="hljs-doctag">@code</span> -XX:AutoBoxCacheMax=&lt;size&gt;&#125; option.</span><br><span class="hljs-comment">  * During VM initialization, java.lang.Integer.IntegerCache.high property</span><br><span class="hljs-comment">  * may be set and saved in the private system properties in the</span><br><span class="hljs-comment">  * sun.misc.VM class.</span><br><span class="hljs-comment">  */</span><br><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">IntegerCache</span> </span>&#123;<br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> low = -<span class="hljs-number">128</span>;<br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> high;<br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Integer cache[];<br><br>    <span class="hljs-keyword">static</span> &#123;<br>        <span class="hljs-comment">// high value may be configured by property</span><br>        <span class="hljs-keyword">int</span> h = <span class="hljs-number">127</span>;<br>        String integerCacheHighPropValue =<br>            sun.misc.VM.getSavedProperty(<span class="hljs-string">&quot;java.lang.Integer.IntegerCache.high&quot;</span>);<br>        <span class="hljs-keyword">if</span> (integerCacheHighPropValue != <span class="hljs-keyword">null</span>) &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                <span class="hljs-keyword">int</span> i = parseInt(integerCacheHighPropValue);<br>                i = Math.max(i, <span class="hljs-number">127</span>);<br>                <span class="hljs-comment">// Maximum array size is Integer.MAX_VALUE</span><br>                h = Math.min(i, Integer.MAX_VALUE - (-low) -<span class="hljs-number">1</span>);<br>            &#125; <span class="hljs-keyword">catch</span>( NumberFormatException nfe) &#123;<br>                <span class="hljs-comment">// If the property cannot be parsed into an int, ignore it.</span><br>            &#125;<br>        &#125;<br>        high = h;<br><br>        cache = <span class="hljs-keyword">new</span> Integer[(high - low) + <span class="hljs-number">1</span>];<br>        <span class="hljs-keyword">int</span> j = low;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> k = <span class="hljs-number">0</span>; k &lt; cache.length; k++)<br>            cache[k] = <span class="hljs-keyword">new</span> Integer(j++);<br><br>        <span class="hljs-comment">// range [-128, 127] must be interned (JLS7 5.1.7)</span><br>        <span class="hljs-keyword">assert</span> IntegerCache.high &gt;= <span class="hljs-number">127</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-title">IntegerCache</span><span class="hljs-params">()</span> </span>&#123;&#125;<br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<p>ç®€å•çš„è¯´ï¼Œå¦‚æœæ•´å‹å­—é¢é‡çš„å€¼åœ¨ <code>-128</code> åˆ° <code>127</code> ä¹‹é—´ï¼Œé‚£ä¹ˆä¸ä¼š <code>new</code> æ–°çš„ <code>Integer</code> å¯¹è±¡ï¼Œè€Œæ˜¯ç›´æ¥å¼•ç”¨å¸¸é‡æ± ä¸­çš„ <code>Integer</code> å¯¹è±¡ï¼Œæ‰€ä»¥ä¸Šé¢çš„é¢è¯•é¢˜ä¸­ <code>f1 == f2</code> çš„ç»“æœæ˜¯ <code>true</code>ï¼Œè€Œ <code>f3==f4</code> çš„ç»“æœæ˜¯ <code>false</code>ã€‚</p>
<p><strong>æ³¨æ„ï¼š</strong>è¶Šæ˜¯è²Œä¼¼ç®€å•çš„é¢è¯•é¢˜å…¶ä¸­çš„ç„æœºå°±è¶Šå¤šï¼Œéœ€è¦é¢è¯•è€…æœ‰ç›¸å½“æ·±åšçš„åŠŸåŠ›ã€‚</p>
<blockquote>
<p>8ã€<code>&amp;</code> å’Œ <code>&amp;&amp;</code> çš„åŒºåˆ«ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼š<code>&amp;</code> è¿ç®—ç¬¦æœ‰ä¸¤ç§ç”¨æ³•ï¼š(1)<strong>æŒ‰ä½ä¸</strong>ï¼›(2)<strong>é€»è¾‘ä¸</strong>ã€‚<code>&amp;&amp;</code> è¿ç®—ç¬¦æ˜¯<strong>çŸ­è·¯ä¸</strong>è¿ç®—ã€‚é€»è¾‘ä¸è·ŸçŸ­è·¯ä¸çš„å·®åˆ«æ˜¯éå¸¸å·¨å¤§çš„ï¼Œè™½ç„¶äºŒè€…éƒ½è¦æ±‚è¿ç®—ç¬¦å·¦å³ä¸¤ç«¯çš„å¸ƒå°”å€¼éƒ½æ˜¯ <code>true</code> æ•´ä¸ªè¡¨è¾¾å¼çš„å€¼æ‰æ˜¯ <code>true</code>ã€‚<code>&amp;&amp;</code> ä¹‹æ‰€ä»¥ç§°ä¸ºçŸ­è·¯è¿ç®—æ˜¯å› ä¸ºï¼Œå¦‚æœ <code>&amp;&amp;</code> å·¦è¾¹çš„è¡¨è¾¾å¼çš„å€¼æ˜¯ <code>false</code>ï¼Œå³è¾¹çš„è¡¨è¾¾å¼ä¼šè¢«ç›´æ¥çŸ­è·¯æ‰ï¼Œä¸ä¼šè¿›è¡Œè¿ç®—ã€‚å¾ˆå¤šæ—¶å€™æˆ‘ä»¬å¯èƒ½éƒ½éœ€è¦ç”¨ <code>&amp;&amp;</code> è€Œä¸æ˜¯ <code>&amp;</code>ï¼Œä¾‹å¦‚åœ¨éªŒè¯ç”¨æˆ·ç™»å½•æ—¶åˆ¤å®šç”¨æˆ·åä¸æ˜¯ <code>null</code> è€Œä¸”ä¸æ˜¯ç©ºå­—ç¬¦ä¸²ï¼Œåº”å½“å†™ä¸ºï¼š<code>username != null &amp;&amp;!username.equals(&quot;&quot;)</code>ï¼ŒäºŒè€…çš„é¡ºåºä¸èƒ½äº¤æ¢ï¼Œæ›´ä¸èƒ½ç”¨ <code>&amp;</code> è¿ç®—ç¬¦ï¼Œå› ä¸ºç¬¬ä¸€ä¸ªæ¡ä»¶å¦‚æœä¸æˆç«‹ï¼Œæ ¹æœ¬ä¸èƒ½è¿›è¡Œå­—ç¬¦ä¸²çš„ <code>equals</code> æ¯”è¾ƒï¼Œå¦åˆ™ä¼šäº§ç”Ÿ <code>NullPointerException</code> å¼‚å¸¸ã€‚<strong>æ³¨æ„ï¼š</strong>é€»è¾‘æˆ–è¿ç®—ç¬¦ï¼ˆ<code>|</code>ï¼‰å’ŒçŸ­è·¯æˆ–è¿ç®—ç¬¦ï¼ˆ<code>||</code>ï¼‰çš„å·®åˆ«ä¹Ÿæ˜¯å¦‚æ­¤ã€‚</p>
<p><strong>è¡¥å……ï¼š</strong>å¦‚æœä½ ç†Ÿæ‚‰ JavaScriptï¼Œé‚£ä½ å¯èƒ½æ›´èƒ½æ„Ÿå—åˆ°çŸ­è·¯è¿ç®—çš„å¼ºå¤§ï¼Œæƒ³æˆä¸º JavaScript çš„é«˜æ‰‹å°±å…ˆä»ç©è½¬çŸ­è·¯è¿ç®—å¼€å§‹å§ã€‚</p>
<blockquote>
<p>9ã€è§£é‡Šå†…å­˜ä¸­çš„æ ˆï¼ˆstackï¼‰ã€å †ï¼ˆheapï¼‰å’Œæ–¹æ³•åŒºï¼ˆmethod areaï¼‰çš„ç”¨æ³•ã€‚</p>
</blockquote>
<p>ç­”ï¼šé€šå¸¸æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªåŸºæœ¬æ•°æ®ç±»å‹çš„å˜é‡ï¼Œä¸€ä¸ªå¯¹è±¡çš„å¼•ç”¨ï¼Œè¿˜æœ‰å°±æ˜¯å‡½æ•°è°ƒç”¨çš„ç°åœºä¿å­˜éƒ½ä½¿ç”¨ JVM ä¸­çš„æ ˆç©ºé—´ï¼›è€Œé€šè¿‡ <code>new</code> å…³é”®å­—å’Œæ„é€ å™¨åˆ›å»ºçš„å¯¹è±¡åˆ™æ”¾åœ¨å †ç©ºé—´ï¼Œå †æ˜¯åƒåœ¾æ”¶é›†å™¨ç®¡ç†çš„ä¸»è¦åŒºåŸŸï¼Œç”±äºç°åœ¨çš„åƒåœ¾æ”¶é›†å™¨éƒ½é‡‡ç”¨åˆ†ä»£æ”¶é›†ç®—æ³•ï¼Œæ‰€ä»¥å †ç©ºé—´è¿˜å¯ä»¥ç»†åˆ†ä¸ºæ–°ç”Ÿä»£å’Œè€ç”Ÿä»£ï¼Œå†å…·ä½“ä¸€ç‚¹å¯ä»¥åˆ†ä¸º Edenã€Survivorï¼ˆåˆå¯åˆ†ä¸º From Survivor å’Œ To Survivorï¼‰ã€Tenuredï¼›æ–¹æ³•åŒºå’Œå †éƒ½æ˜¯å„ä¸ªçº¿ç¨‹å…±äº«çš„å†…å­˜åŒºåŸŸï¼Œç”¨äºå­˜å‚¨å·²ç»è¢« JVM åŠ è½½çš„ç±»ä¿¡æ¯ã€å¸¸é‡ã€é™æ€å˜é‡ã€JIT ç¼–è¯‘å™¨ç¼–è¯‘åçš„ä»£ç ç­‰æ•°æ®ï¼›ç¨‹åºä¸­çš„å­—é¢é‡ï¼ˆliteralï¼‰å¦‚ç›´æ¥ä¹¦å†™çš„ <code>100</code>ã€<code>&quot;hello&quot;</code> å’Œå¸¸é‡éƒ½æ˜¯æ”¾åœ¨å¸¸é‡æ± ä¸­ï¼Œå¸¸é‡æ± æ˜¯æ–¹æ³•åŒºçš„ä¸€éƒ¨åˆ†ã€‚æ ˆç©ºé—´æ“ä½œèµ·æ¥æœ€å¿«ä½†æ˜¯æ ˆå¾ˆå°ï¼Œé€šå¸¸å¤§é‡çš„å¯¹è±¡éƒ½æ˜¯æ”¾åœ¨å †ç©ºé—´ï¼Œæ ˆå’Œå †çš„å¤§å°éƒ½å¯ä»¥é€šè¿‡ JVM çš„å¯åŠ¨å‚æ•°æ¥è¿›è¡Œè°ƒæ•´ï¼Œæ ˆç©ºé—´ç”¨å…‰äº†ä¼šå¼•å‘ <code>StackOverflowError</code>ï¼Œè€Œå †å’Œå¸¸é‡æ± ç©ºé—´ä¸è¶³åˆ™ä¼šå¼•å‘ <code>OutOfMemoryError</code>ã€‚</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">String str = <span class="hljs-keyword">new</span> String(<span class="hljs-string">&quot;hello&quot;</span>);<br></code></pre></td></tr></table></figure>
</p>
<p>ä¸Šé¢çš„è¯­å¥ä¸­å˜é‡ <code>str</code> æ”¾åœ¨æ ˆä¸Šï¼Œç”¨ <code>new</code> åˆ›å»ºå‡ºæ¥çš„å­—ç¬¦ä¸²å¯¹è±¡æ”¾åœ¨å †ä¸Šï¼Œè€Œ <code>&quot;hello&quot;</code> è¿™ä¸ªå­—é¢é‡æ˜¯æ”¾åœ¨æ–¹æ³•åŒºçš„ã€‚</p>
<p><strong>è¡¥å……1ï¼š</strong>è¾ƒæ–°ç‰ˆæœ¬çš„ Javaï¼ˆä» Java 6 çš„æŸä¸ªæ›´æ–°å¼€å§‹ï¼‰ä¸­ï¼Œç”±äº JIT ç¼–è¯‘å™¨çš„å‘å±•å’Œâ€œé€ƒé€¸åˆ†æâ€æŠ€æœ¯çš„é€æ¸æˆç†Ÿï¼Œæ ˆä¸Šåˆ†é…ã€æ ‡é‡æ›¿æ¢ç­‰ä¼˜åŒ–æŠ€æœ¯ä½¿å¾—å¯¹è±¡ä¸€å®šåˆ†é…åœ¨å †ä¸Šè¿™ä»¶äº‹æƒ…å·²ç»å˜å¾—ä¸é‚£ä¹ˆç»å¯¹äº†ã€‚</p>
<p><strong>è¡¥å……2ï¼š</strong>è¿è¡Œæ—¶å¸¸é‡æ± ç›¸å½“äº Class æ–‡ä»¶å¸¸é‡æ± å…·æœ‰åŠ¨æ€æ€§ï¼ŒJava è¯­è¨€å¹¶ä¸è¦æ±‚å¸¸é‡ä¸€å®šåªæœ‰ç¼–è¯‘æœŸé—´æ‰èƒ½äº§ç”Ÿï¼Œè¿è¡ŒæœŸé—´ä¹Ÿå¯ä»¥å°†æ–°çš„å¸¸é‡æ”¾å…¥æ± ä¸­ï¼Œ<code>String</code> ç±»çš„ <code>intern()</code> æ–¹æ³•å°±æ˜¯è¿™æ ·çš„ã€‚</p>
<p>çœ‹çœ‹ä¸‹é¢ä»£ç çš„æ‰§è¡Œç»“æœæ˜¯ä»€ä¹ˆå¹¶ä¸”æ¯”è¾ƒä¸€ä¸‹ Java 7 ä»¥å‰å’Œä»¥åçš„è¿è¡Œç»“æœæ˜¯å¦ä¸€è‡´ã€‚</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java">String s1 = <span class="hljs-keyword">new</span> StringBuilder(<span class="hljs-string">&quot;go&quot;</span>).append(<span class="hljs-string">&quot;od&quot;</span>).toString();<br>System.out.println(s1.intern() == s1);<br><br>String s2 = <span class="hljs-keyword">new</span> StringBuilder(<span class="hljs-string">&quot;ja&quot;</span>).append(<span class="hljs-string">&quot;va&quot;</span>).toString();<br>System.out.println(s2.intern() == s2);<br></code></pre></td></tr></table></figure>
</p>
<blockquote>
<p>10ã€<code>Math.round(11.5)</code> ç­‰äºå¤šå°‘ï¼Ÿ<code>Math.round(-11.5)</code> ç­‰äºå¤šå°‘ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼š<code>Math.round(11.5)</code> çš„è¿”å›å€¼æ˜¯ <code>12</code>ï¼Œ<code>Math.round(-11.5)</code> çš„è¿”å›å€¼æ˜¯ <code>-11</code>ã€‚å››èˆäº”å…¥çš„åŸç†æ˜¯åœ¨å‚æ•°ä¸ŠåŠ  <code>0.5</code> ç„¶åè¿›è¡Œä¸‹å–æ•´ã€‚</p>
<blockquote>
<p>11ã€<code>switch</code> æ˜¯å¦èƒ½ä½œç”¨åœ¨ <code>byte</code> ä¸Šï¼Œæ˜¯å¦èƒ½ä½œç”¨åœ¨ <code>long</code> ä¸Šï¼Œæ˜¯å¦èƒ½ä½œç”¨åœ¨ <code>String</code> ä¸Šï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šåœ¨ Java 5 ä»¥å‰ï¼Œ<code>switch(expr)</code> ä¸­ï¼Œ<code>expr</code> åªèƒ½æ˜¯ <code>byte</code>ã€<code>short</code>ã€<code>char</code>ã€<code>int</code>ã€‚ä» Java 5 å¼€ å§‹ï¼ŒJava ä¸­å¼•å…¥äº†æšä¸¾ç±»å‹ï¼Œ<code>expr</code> ä¹Ÿå¯ä»¥æ˜¯ <code>enum</code> ç±»å‹ï¼Œä» Java 7 å¼€å§‹ï¼Œ<code>expr</code> è¿˜å¯ä»¥æ˜¯å­—ç¬¦ä¸²ï¼ˆ<code>String</code>ï¼‰ï¼Œä½†æ˜¯é•¿æ•´å‹ï¼ˆ<code>long</code>ï¼‰åœ¨ç›®å‰æ‰€æœ‰çš„ç‰ˆæœ¬ä¸­éƒ½æ˜¯ä¸å¯ä»¥çš„ã€‚</p>
<blockquote>
<p>12ã€ç”¨æœ€æœ‰æ•ˆç‡çš„æ–¹æ³•è®¡ç®— 2 ä¹˜ä»¥ 8ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼š<code>2 &lt;&lt; 3</code>ï¼ˆå·¦ç§» 3 ä½ç›¸å½“äºä¹˜ä»¥ 2 çš„ 3 æ¬¡æ–¹ï¼Œå³ç§»3ä½ç›¸å½“äºé™¤ä»¥ 2 çš„ 3 æ¬¡æ–¹ï¼‰ã€‚</p>
<p><strong>è¡¥å……ï¼š</strong>æˆ‘ä»¬ä¸ºç¼–å†™çš„ç±»é‡å†™ <code>hashCode</code> æ–¹æ³•æ—¶ï¼Œå¯èƒ½ä¼šçœ‹åˆ°å¦‚ä¸‹æ‰€ç¤ºçš„ä»£ç ï¼Œå…¶å®æˆ‘ä»¬ä¸å¤ªç†è§£ä¸ºä»€ä¹ˆè¦ä½¿ç”¨è¿™æ ·çš„ä¹˜æ³•è¿ç®—æ¥äº§ç”Ÿå“ˆå¸Œç ï¼ˆæ•£åˆ—ç ï¼‰ï¼Œè€Œä¸”ä¸ºä»€ä¹ˆè¿™ä¸ªæ•°æ˜¯ä¸ªç´ æ•°ï¼Œä¸ºä»€ä¹ˆé€šå¸¸é€‰æ‹© 31 è¿™ä¸ªæ•°ï¼Ÿå‰ä¸¤ä¸ªé—®é¢˜çš„ç­”æ¡ˆä½ å¯ä»¥è‡ªå·±ç™¾åº¦ä¸€ä¸‹ï¼Œé€‰æ‹© 31 æ˜¯å› ä¸ºå¯ä»¥ç”¨ç§»ä½å’Œå‡æ³•è¿ç®—æ¥ä»£æ›¿ä¹˜æ³•ï¼Œä»è€Œå¾—åˆ°æ›´å¥½çš„æ€§èƒ½ã€‚è¯´åˆ°è¿™é‡Œä½ å¯èƒ½å·²ç»æƒ³åˆ°äº†ï¼š<code>31 * num</code> ç­‰ä»·äº <code>(num &lt;&lt; 5) - num</code>ï¼Œå·¦ç§» 5 ä½ç›¸å½“äºä¹˜ä»¥ 2 çš„ 5 æ¬¡æ–¹å†å‡å»è‡ªèº«å°±ç›¸å½“äºä¹˜ä»¥ 31ï¼Œç°åœ¨çš„ JVM éƒ½èƒ½è‡ªåŠ¨å®Œæˆè¿™ä¸ªä¼˜åŒ–ã€‚</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PhoneNumber</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> areaCode;<br>    <span class="hljs-keyword">private</span> String prefix;<br>    <span class="hljs-keyword">private</span> String lineNumber;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">hashCode</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> prime = <span class="hljs-number">31</span>;<br>        <span class="hljs-keyword">int</span> result = <span class="hljs-number">1</span>;<br>        result = prime * result + areaCode;<br>        result = prime * result<br>                + ((lineNumber == <span class="hljs-keyword">null</span>) ? <span class="hljs-number">0</span> : lineNumber.hashCode());<br>        result = prime * result + ((prefix == <span class="hljs-keyword">null</span>) ? <span class="hljs-number">0</span> : prefix.hashCode());<br>        <span class="hljs-keyword">return</span> result;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">equals</span><span class="hljs-params">(Object obj)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span> == obj)<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<br>        <span class="hljs-keyword">if</span> (obj == <span class="hljs-keyword">null</span>)<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<br>        <span class="hljs-keyword">if</span> (getClass() != obj.getClass())<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<br>        PhoneNumber other = (PhoneNumber) obj;<br>        <span class="hljs-keyword">if</span> (areaCode != other.areaCode)<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<br>        <span class="hljs-keyword">if</span> (lineNumber == <span class="hljs-keyword">null</span>) &#123;<br>            <span class="hljs-keyword">if</span> (other.lineNumber != <span class="hljs-keyword">null</span>)<br>                <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!lineNumber.equals(other.lineNumber))<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<br>        <span class="hljs-keyword">if</span> (prefix == <span class="hljs-keyword">null</span>) &#123;<br>            <span class="hljs-keyword">if</span> (other.prefix != <span class="hljs-keyword">null</span>)<br>                <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!prefix.equals(other.prefix))<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<blockquote>
<p>13ã€æ•°ç»„æœ‰æ²¡æœ‰ <code>length()</code> æ–¹æ³•ï¼ŸString æœ‰æ²¡æœ‰ <code>length()</code> æ–¹æ³•ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šæ•°ç»„æ²¡æœ‰ <code>length()</code> æ–¹æ³•ï¼Œæœ‰ <code>length</code> çš„å±æ€§ã€‚<code>String</code> æœ‰ <code>length()</code> æ–¹æ³•ã€‚<code>JavaScript</code> ä¸­ï¼Œè·å¾—å­—ç¬¦ä¸²çš„é•¿åº¦æ˜¯é€šè¿‡ <code>length</code> å±æ€§å¾—åˆ°çš„ï¼Œè¿™ä¸€ç‚¹å®¹æ˜“å’Œ Java æ··æ·†ã€‚</p>
<blockquote>
<p>14ã€åœ¨ Java ä¸­ï¼Œå¦‚ä½•è·³å‡ºå½“å‰çš„å¤šé‡åµŒå¥—å¾ªç¯ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šåœ¨æœ€å¤–å±‚å¾ªç¯å‰åŠ ä¸€ä¸ªæ ‡è®°å¦‚ <code>A</code>ï¼Œç„¶åç”¨ <code>break A;</code> å¯ä»¥è·³å‡ºå¤šé‡å¾ªç¯ã€‚ï¼ˆJava ä¸­æ”¯æŒå¸¦æ ‡ç­¾çš„ <code>break</code> å’Œ <code>continue</code> è¯­å¥ï¼Œä½œç”¨æœ‰ç‚¹ç±»ä¼¼äº C å’Œ C++ ä¸­çš„ <code>goto</code> è¯­å¥ï¼Œä½†æ˜¯å°±åƒè¦é¿å…ä½¿ç”¨ <code>goto</code> ä¸€æ ·ï¼Œåº”è¯¥é¿å…ä½¿ç”¨å¸¦æ ‡ç­¾çš„ <code>break</code> å’Œ <code>continue</code>ï¼Œå› ä¸ºå®ƒä¸ä¼šè®©ä½ çš„ç¨‹åºå˜å¾—æ›´ä¼˜é›…ï¼Œå¾ˆå¤šæ—¶å€™ç”šè‡³æœ‰ç›¸åçš„ä½œç”¨ï¼Œæ‰€ä»¥è¿™ç§è¯­æ³•å…¶å®ä¸çŸ¥é“æ›´å¥½ï¼‰</p>
<blockquote>
<p>15ã€æ„é€ å™¨ï¼ˆ<code>constructor</code>ï¼‰æ˜¯å¦å¯è¢«é‡å†™ï¼ˆ<code>override</code>ï¼‰ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šæ„é€ å™¨ä¸èƒ½è¢«ç»§æ‰¿ï¼Œå› æ­¤ä¸èƒ½è¢«é‡å†™ï¼Œä½†å¯ä»¥è¢«é‡è½½ã€‚</p>
<blockquote>
<p>16ã€ä¸¤ä¸ªå¯¹è±¡å€¼ç›¸åŒ (<code>x.equals(y) == true</code>)ï¼Œä½†å´å¯æœ‰ä¸åŒçš„ <code>hash code</code>ï¼Œè¿™å¥è¯å¯¹ä¸å¯¹ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šä¸å¯¹ï¼Œå¦‚æœä¸¤ä¸ªå¯¹è±¡ <code>x</code> å’Œ <code>y</code> æ»¡è¶³ <code>x.equals(y) == true</code>ï¼Œå®ƒä»¬çš„å“ˆå¸Œç ï¼ˆhash codeï¼‰åº”å½“ç›¸åŒã€‚Java å¯¹äº <code>eqauls</code> æ–¹æ³•å’Œ <code>hashCode</code> æ–¹æ³•æ˜¯è¿™æ ·è§„å®šçš„ï¼š</p>
<ol>
<li>å¦‚æœä¸¤ä¸ªå¯¹è±¡ç›¸åŒï¼ˆ<code>equals</code> æ–¹æ³•è¿”å› <code>true</code>ï¼‰ï¼Œé‚£ä¹ˆå®ƒä»¬çš„ <code>hashCode</code> å€¼ä¸€å®šè¦ç›¸åŒï¼›</li>
<li>å¦‚æœä¸¤ä¸ªå¯¹è±¡çš„ <code>hashCode</code> ç›¸åŒï¼Œå®ƒä»¬å¹¶ä¸ä¸€å®šç›¸åŒã€‚</li>
</ol>
<p>å½“ç„¶ï¼Œä½ æœªå¿…è¦æŒ‰ç…§è¦æ±‚å»åšï¼Œä½†æ˜¯å¦‚æœä½ è¿èƒŒäº†ä¸Šè¿°åŸåˆ™å°±ä¼šå‘ç°åœ¨ä½¿ç”¨å®¹å™¨æ—¶ï¼Œç›¸åŒçš„å¯¹è±¡å¯ä»¥å‡ºç°åœ¨ <code>Set</code> é›†åˆä¸­ï¼ŒåŒæ—¶å¢åŠ æ–°å…ƒç´ çš„æ•ˆç‡ä¼šå¤§å¤§ä¸‹é™ï¼ˆå¯¹äºä½¿ç”¨å“ˆå¸Œå­˜å‚¨çš„ç³»ç»Ÿï¼Œå¦‚æœå“ˆå¸Œç é¢‘ç¹çš„å†²çªå°†ä¼šé€ æˆå­˜å–æ€§èƒ½æ€¥å‰§ä¸‹é™ï¼‰ã€‚</p>
<p><strong>è¡¥å……ï¼š</strong>å…³äº <code>equals</code> å’Œ <code>hashCode</code> æ–¹æ³•ï¼Œå¾ˆå¤š Java ç¨‹åºå‘˜éƒ½çŸ¥é“ï¼Œä½†å¾ˆå¤šäººä¹Ÿå°±æ˜¯ä»…ä»…çŸ¥é“è€Œå·²ï¼Œåœ¨ Joshua Bloch çš„å¤§ä½œã€ŠEffective Javaã€‹ï¼ˆå¾ˆå¤šè½¯ä»¶å…¬å¸ï¼Œã€ŠEffective Javaã€‹ã€ã€ŠJavaç¼–ç¨‹æ€æƒ³ã€‹ä»¥åŠã€Šé‡æ„ï¼šæ”¹å–„æ—¢æœ‰ä»£ç è´¨é‡ã€‹æ˜¯ Java ç¨‹åºå‘˜å¿…çœ‹ä¹¦ç±ï¼Œå¦‚æœä½ è¿˜æ²¡çœ‹è¿‡ï¼Œé‚£å°±èµ¶ç´§å»äºšé©¬é€Šä¹°ä¸€æœ¬å§ï¼‰ä¸­æ˜¯è¿™æ ·ä»‹ç» <code>equals</code> æ–¹æ³•çš„ï¼šé¦–å…ˆ <code>equals</code> æ–¹æ³•å¿…é¡»æ»¡è¶³<strong>è‡ªåæ€§</strong>ï¼ˆ<code>x.equals(x)</code> å¿…é¡»è¿”å› <code>true</code>ï¼‰ã€<strong>å¯¹ç§°æ€§</strong>ï¼ˆ <code>x.equals(y)</code> è¿”å› <code>true</code> æ—¶ï¼Œ<code>y.equals(x)</code> ä¹Ÿå¿…é¡»è¿”å› <code>true</code>ï¼‰ã€<strong>ä¼ é€’æ€§</strong>ï¼ˆ<code>x.equals(y)</code> å’Œ <code>y.equals(z)</code> éƒ½è¿”å› <code>true</code> æ—¶ï¼Œ<code>x.equals(z)</code> ä¹Ÿå¿…é¡»è¿”å› <code>true</code>ï¼‰å’Œ<strong>ä¸€è‡´æ€§</strong>ï¼ˆå½“ <code>x</code> å’Œ <code>y</code> å¼•ç”¨çš„å¯¹è±¡ä¿¡æ¯æ²¡æœ‰è¢«ä¿®æ”¹æ—¶ï¼Œå¤šæ¬¡è°ƒç”¨ <code>x.equals(y)</code> åº”è¯¥å¾—åˆ°åŒæ ·çš„è¿”å›å€¼ï¼‰ï¼Œè€Œä¸”å¯¹äºä»»ä½•é <code>null</code> å€¼çš„å¼•ç”¨ <code>x</code>ï¼Œ<code>x.equals(null)</code> å¿…é¡»è¿”å› <code>false</code>ã€‚å®ç°é«˜è´¨é‡çš„ <code>equals</code> æ–¹æ³•çš„è¯€çªåŒ…æ‹¬ï¼š</p>
<ol>
<li>ä½¿ç”¨ <code>==</code> æ“ä½œç¬¦æ£€æŸ¥â€œå‚æ•°æ˜¯å¦ä¸ºè¿™ä¸ªå¯¹è±¡çš„å¼•ç”¨â€ï¼›</li>
<li>ä½¿ç”¨ <code>instanceof</code> æ“ä½œç¬¦æ£€æŸ¥â€œå‚æ•°æ˜¯å¦ä¸ºæ­£ç¡®çš„ç±»å‹â€ï¼›</li>
<li>å¯¹äºç±»ä¸­çš„å…³é”®å±æ€§ï¼Œæ£€æŸ¥å‚æ•°ä¼ å…¥å¯¹è±¡çš„å±æ€§æ˜¯å¦ä¸ä¹‹ç›¸åŒ¹é…ï¼›</li>
<li>ç¼–å†™å®Œ <code>equals</code> æ–¹æ³•åï¼Œé—®è‡ªå·±å®ƒæ˜¯å¦æ»¡è¶³å¯¹ç§°æ€§ã€ä¼ é€’æ€§ã€ä¸€è‡´æ€§ï¼›</li>
<li>é‡å†™ <code>equals</code> æ—¶æ€»æ˜¯è¦é‡å†™ <code>hashCode</code>ï¼›</li>
<li>ä¸è¦å°† <code>equals</code> æ–¹æ³•å‚æ•°ä¸­çš„ <code>Object</code> å¯¹è±¡æ›¿æ¢ä¸ºå…¶ä»–çš„ç±»å‹ï¼Œåœ¨é‡å†™æ—¶ä¸è¦å¿˜æ‰ <code>@Override</code> æ³¨è§£ã€‚</li>
</ol>
<blockquote>
<p>17ã€æ˜¯å¦å¯ä»¥ç»§æ‰¿ <code>String</code> ç±»ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼š<code>String</code> ç±»æ˜¯ <code>final</code> ç±»ï¼Œä¸å¯ä»¥è¢«ç»§æ‰¿ã€‚</p>
<p><strong>è¡¥å……ï¼š</strong>ç»§æ‰¿ <code>String</code> æœ¬èº«å°±æ˜¯ä¸€ä¸ªé”™è¯¯çš„è¡Œä¸ºï¼Œå¯¹ <code>String</code> ç±»å‹æœ€å¥½çš„é‡ç”¨æ–¹å¼æ˜¯å…³è”å…³ç³»ï¼ˆHas-Aï¼‰å’Œä¾èµ–å…³ç³»ï¼ˆUse-Aï¼‰è€Œä¸æ˜¯ç»§æ‰¿å…³ç³»ï¼ˆIs-Aï¼‰ã€‚</p>
<blockquote>
<p>18ã€å½“ä¸€ä¸ªå¯¹è±¡è¢«å½“ä½œå‚æ•°ä¼ é€’åˆ°ä¸€ä¸ªæ–¹æ³•åï¼Œæ­¤æ–¹æ³•å¯æ”¹å˜è¿™ä¸ªå¯¹è±¡çš„å±æ€§ï¼Œå¹¶å¯è¿”å›å˜åŒ–åçš„ç»“æœï¼Œé‚£ä¹ˆè¿™é‡Œåˆ°åº•æ˜¯å€¼ä¼ é€’è¿˜æ˜¯å¼•ç”¨ä¼ é€’ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šæ˜¯å€¼ä¼ é€’ã€‚Java è¯­è¨€çš„æ–¹æ³•è°ƒç”¨åªæ”¯æŒå‚æ•°çš„å€¼ä¼ é€’ã€‚å½“ä¸€ä¸ªå¯¹è±¡å®ä¾‹ä½œä¸ºä¸€ä¸ªå‚æ•°è¢«ä¼ é€’åˆ°æ–¹æ³•ä¸­æ—¶ï¼Œå‚æ•°çš„å€¼å°±æ˜¯å¯¹è¯¥å¯¹è±¡çš„å¼•ç”¨ã€‚å¯¹è±¡çš„å±æ€§å¯ä»¥åœ¨è¢«è°ƒç”¨è¿‡ç¨‹ä¸­è¢«æ”¹å˜ï¼Œä½†å¯¹å¯¹è±¡å¼•ç”¨çš„æ”¹å˜æ˜¯ä¸ä¼šå½±å“åˆ°è°ƒç”¨è€…çš„ã€‚C++ å’Œ C# ä¸­å¯ä»¥é€šè¿‡ä¼ å¼•ç”¨æˆ–ä¼ è¾“å‡ºå‚æ•°æ¥æ”¹å˜ä¼ å…¥çš„å‚æ•°çš„å€¼ã€‚åœ¨ C# ä¸­å¯ä»¥ç¼–å†™å¦‚ä¸‹æ‰€ç¤ºçš„ä»£ç ï¼Œä½†æ˜¯åœ¨ Java ä¸­å´åšä¸åˆ°ã€‚</p>
<p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs c#"><span class="hljs-keyword">using</span> System;<br><br><span class="hljs-keyword">namespace</span> <span class="hljs-title">CS01</span> &#123;<br><br>    <span class="hljs-keyword">class</span> <span class="hljs-title">Program</span> &#123;<br>        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">swap</span>(<span class="hljs-params"><span class="hljs-keyword">ref</span> <span class="hljs-built_in">int</span> x, <span class="hljs-keyword">ref</span> <span class="hljs-built_in">int</span> y</span>)</span> &#123;<br>            <span class="hljs-built_in">int</span> temp = x;<br>            x = y;<br>            y = temp;<br>        &#125;<br><br>        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span> (<span class="hljs-params"><span class="hljs-built_in">string</span>[] args</span>)</span> &#123;<br>            <span class="hljs-built_in">int</span> a = <span class="hljs-number">5</span>, b = <span class="hljs-number">10</span>;<br>            swap (<span class="hljs-keyword">ref</span> a, <span class="hljs-keyword">ref</span> b);<br>            <span class="hljs-comment">// a = 10, b = 5;</span><br>            Console.WriteLine (<span class="hljs-string">&quot;a = &#123;0&#125;, b = &#123;1&#125;&quot;</span>, a, b);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<p><strong>è¯´æ˜ï¼š</strong>Javaä¸­æ²¡æœ‰ä¼ å¼•ç”¨å®åœ¨æ˜¯éå¸¸çš„ä¸æ–¹ä¾¿ï¼Œè¿™ä¸€ç‚¹åœ¨ Java 8 ä¸­ä»ç„¶æ²¡æœ‰å¾—åˆ°æ”¹è¿›ï¼Œæ­£æ˜¯å¦‚æ­¤åœ¨ Java ç¼–å†™çš„ä»£ç ä¸­æ‰ä¼šå‡ºç°å¤§é‡çš„ <code>Wrapper</code> ç±»ï¼ˆå°†éœ€è¦é€šè¿‡æ–¹æ³•è°ƒç”¨ä¿®æ”¹çš„å¼•ç”¨ç½®äºä¸€ä¸ª <code>Wrapper</code> ç±»ä¸­ï¼Œå†å°† <code>Wrapper</code> å¯¹è±¡ä¼ å…¥æ–¹æ³•ï¼‰ï¼Œè¿™æ ·çš„åšæ³•åªä¼šè®©ä»£ç å˜å¾—è‡ƒè‚¿ï¼Œå°¤å…¶æ˜¯è®©ä» C å’Œ C++ è½¬å‹ä¸º Java ç¨‹åºå‘˜çš„å¼€å‘è€…æ— æ³•å®¹å¿ã€‚</p>
<blockquote>
<p>19ã€<code>String</code> å’Œ <code>StringBuilder</code>ã€<code>StringBuffer</code> çš„åŒºåˆ«ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šJava å¹³å°æä¾›äº†ä¸¤ç§ç±»å‹çš„å­—ç¬¦ä¸²ï¼š<code>String</code> å’Œ <code>StringBuffer/StringBuilder</code>ï¼Œå®ƒä»¬å¯ä»¥å‚¨å­˜å’Œæ“ä½œå­—ç¬¦ä¸²ã€‚å…¶ä¸­ <code>String</code> æ˜¯åªè¯»å­—ç¬¦ä¸²ï¼Œä¹Ÿå°±æ„å‘³ç€ String å¼•ç”¨çš„å­—ç¬¦ä¸²å†…å®¹æ˜¯ä¸èƒ½è¢«æ”¹å˜çš„ã€‚è€Œ <code>StringBuffer/StringBuilder</code> ç±»è¡¨ç¤ºçš„å­—ç¬¦ä¸²å¯¹è±¡å¯ä»¥ç›´æ¥è¿›è¡Œä¿®æ”¹ã€‚<code>StringBuilder</code> æ˜¯ Java 5 ä¸­å¼•å…¥çš„ï¼Œå®ƒå’Œ <code>StringBuffer</code> çš„æ–¹æ³•å®Œå…¨ç›¸åŒï¼ŒåŒºåˆ«åœ¨äºå®ƒæ˜¯åœ¨å•çº¿ç¨‹ç¯å¢ƒä¸‹ä½¿ç”¨çš„ï¼Œå› ä¸ºå®ƒçš„æ‰€æœ‰æ–¹é¢éƒ½æ²¡æœ‰è¢« <code>synchronized</code> ä¿®é¥°ï¼Œå› æ­¤å®ƒçš„æ•ˆç‡ä¹Ÿæ¯” <code>StringBuffer</code> è¦é«˜ã€‚</p>
<p>é¢è¯•é¢˜1 - ä»€ä¹ˆæƒ…å†µä¸‹ç”¨ <code>+</code> è¿ç®—ç¬¦è¿›è¡Œå­—ç¬¦ä¸²è¿æ¥æ¯”è°ƒç”¨ <code>StringBuffer/StringBuilder</code> å¯¹è±¡çš„ <code>append</code> æ–¹æ³•è¿æ¥å­—ç¬¦ä¸²æ€§èƒ½æ›´å¥½ï¼Ÿ</p>
<p>é¢è¯•é¢˜2 - è¯·è¯´å‡ºä¸‹é¢ç¨‹åºçš„è¾“å‡ºã€‚</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">StringEqualTest</span> </span>&#123;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        String s1 = <span class="hljs-string">&quot;Programming&quot;</span>;<br>        String s2 = <span class="hljs-keyword">new</span> String(<span class="hljs-string">&quot;Programming&quot;</span>);<br>        String s3 = <span class="hljs-string">&quot;Program&quot;</span>;<br>        String s4 = <span class="hljs-string">&quot;ming&quot;</span>;<br>        String s5 = <span class="hljs-string">&quot;Program&quot;</span> + <span class="hljs-string">&quot;ming&quot;</span>;<br>        String s6 = s3 + s4;<br>        System.out.println(s1 == s2);             <span class="hljs-comment">// false</span><br>        System.out.println(s1 == s5);             <span class="hljs-comment">// true</span><br>        System.out.println(s1 == s6);             <span class="hljs-comment">// false</span><br>        System.out.println(s1 == s6.intern());    <span class="hljs-comment">// true</span><br>        System.out.println(s2 == s2.intern());    <span class="hljs-comment">// false</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<p><strong>è¡¥å……ï¼š</strong>è§£ç­”ä¸Šé¢çš„é¢è¯•é¢˜éœ€è¦æ¸…æ¥šä¸¤ç‚¹ï¼š</p>
<ol>
<li><p><code>String</code> å¯¹è±¡çš„ <code>intern</code> æ–¹æ³•ä¼šå¾—åˆ°å­—ç¬¦ä¸²å¯¹è±¡åœ¨å¸¸é‡æ± ä¸­å¯¹åº”çš„ç‰ˆæœ¬çš„å¼•ç”¨ï¼ˆå¦‚æœå¸¸é‡æ± ä¸­æœ‰ä¸€ä¸ªå­—ç¬¦ä¸²ä¸ <code>String</code> å¯¹è±¡çš„ <code>equals</code> ç»“æœæ˜¯ <code>true</code>ï¼‰ï¼Œå¦‚æœå¸¸é‡æ± ä¸­æ²¡æœ‰å¯¹åº”çš„å­—ç¬¦ä¸²ï¼Œåˆ™è¯¥å­—ç¬¦ä¸²å°†è¢«æ·»åŠ åˆ°å¸¸é‡æ± ä¸­ï¼Œç„¶åè¿”å›å¸¸é‡æ± ä¸­å­—ç¬¦ä¸²çš„å¼•ç”¨ï¼›</p>
</li>
<li><p>å­—ç¬¦ä¸²çš„ <code>+</code> æ“ä½œå…¶æœ¬è´¨æ˜¯åˆ›å»ºäº† <code>StringBuilder</code> å¯¹è±¡è¿›è¡Œ <code>append</code> æ“ä½œï¼Œç„¶åå°†æ‹¼æ¥åçš„ <code>StringBuilder</code> å¯¹è±¡ç”¨ <code>toString</code> æ–¹æ³•å¤„ç†æˆ <code>String</code> å¯¹è±¡ï¼Œè¿™ä¸€ç‚¹å¯ä»¥ç”¨ <code>javap -c StringEqualTest.class</code> å‘½ä»¤è·å¾— class æ–‡ä»¶å¯¹åº”çš„ JVM å­—èŠ‚ç æŒ‡ä»¤å°±å¯ä»¥çœ‹å‡ºæ¥ã€‚</p>
</li>
</ol>
<blockquote>
<p>20ã€é‡è½½ï¼ˆOverloadï¼‰å’Œé‡å†™ï¼ˆOverrideï¼‰çš„åŒºåˆ«ã€‚é‡è½½çš„æ–¹æ³•èƒ½å¦æ ¹æ®è¿”å›ç±»å‹è¿›è¡ŒåŒºåˆ†ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šæ–¹æ³•çš„é‡è½½å’Œé‡å†™éƒ½æ˜¯å®ç°å¤šæ€çš„æ–¹å¼ï¼ŒåŒºåˆ«åœ¨äºå‰è€…å®ç°çš„æ˜¯ç¼–è¯‘æ—¶çš„å¤šæ€æ€§ï¼Œè€Œåè€…å®ç°çš„æ˜¯è¿è¡Œæ—¶çš„å¤šæ€æ€§ã€‚é‡è½½å‘ç”Ÿåœ¨ä¸€ä¸ªç±»ä¸­ï¼ŒåŒåçš„æ–¹æ³•å¦‚æœæœ‰ä¸åŒçš„å‚æ•°åˆ—è¡¨ï¼ˆå‚æ•°ç±»å‹ä¸åŒã€å‚æ•°ä¸ªæ•°ä¸åŒæˆ–è€…äºŒè€…éƒ½ä¸åŒï¼‰åˆ™è§†ä¸ºé‡è½½ï¼›é‡å†™å‘ç”Ÿåœ¨å­ç±»ä¸çˆ¶ç±»ä¹‹é—´ï¼Œé‡å†™è¦æ±‚å­ç±»è¢«é‡å†™æ–¹æ³•ä¸çˆ¶ç±»è¢«é‡å†™æ–¹æ³•æœ‰ç›¸åŒçš„è¿”å›ç±»å‹ï¼Œæ¯”çˆ¶ç±»è¢«é‡å†™æ–¹æ³•æ›´å¥½è®¿é—®ï¼Œä¸èƒ½æ¯”çˆ¶ç±»è¢«é‡å†™æ–¹æ³•å£°æ˜æ›´å¤šçš„å¼‚å¸¸ï¼ˆé‡Œæ°ä»£æ¢åŸåˆ™ï¼‰ã€‚é‡è½½å¯¹è¿”å›ç±»å‹æ²¡æœ‰ç‰¹æ®Šçš„è¦æ±‚ã€‚</p>
<p>é¢è¯•é¢˜ï¼šåä¸ºçš„é¢è¯•é¢˜ä¸­æ›¾ç»é—®è¿‡è¿™æ ·ä¸€ä¸ªé—®é¢˜ - &quot;ä¸ºä»€ä¹ˆä¸èƒ½æ ¹æ®è¿”å›ç±»å‹æ¥åŒºåˆ†é‡è½½&quot;ï¼Œå¿«è¯´å‡ºä½ çš„ç­”æ¡ˆå§ï¼</p>
<blockquote>
<p>21ã€æè¿°ä¸€ä¸‹ JVM åŠ è½½ <code>class</code> æ–‡ä»¶çš„åŸç†æœºåˆ¶ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šJVM ä¸­ç±»çš„è£…è½½æ˜¯ç”±ç±»åŠ è½½å™¨ï¼ˆClassLoaderï¼‰å’Œå®ƒçš„å­ç±»æ¥å®ç°çš„ï¼ŒJavaä¸­çš„ç±»åŠ è½½å™¨æ˜¯ä¸€ä¸ªé‡è¦çš„ Java è¿è¡Œæ—¶ç³»ç»Ÿç»„ä»¶ï¼Œå®ƒè´Ÿè´£åœ¨è¿è¡Œæ—¶æŸ¥æ‰¾å’Œè£…å…¥ç±»æ–‡ä»¶ä¸­çš„ç±»ã€‚</p>
<p>ç”±äº Java çš„è·¨å¹³å°æ€§ï¼Œç»è¿‡ç¼–è¯‘çš„ Java æºç¨‹åºå¹¶ä¸æ˜¯ä¸€ä¸ªå¯æ‰§è¡Œç¨‹åºï¼Œè€Œæ˜¯ä¸€ä¸ªæˆ–å¤šä¸ªç±»æ–‡ä»¶ã€‚å½“ Java ç¨‹åºéœ€è¦ä½¿ç”¨æŸä¸ªç±»æ—¶ï¼ŒJVM ä¼šç¡®ä¿è¿™ä¸ªç±»å·²ç»è¢«åŠ è½½ã€è¿æ¥ï¼ˆéªŒè¯ã€å‡†å¤‡å’Œè§£æï¼‰å’Œåˆå§‹åŒ–ã€‚ç±»çš„åŠ è½½æ˜¯æŒ‡æŠŠç±»çš„ <code>.class</code> æ–‡ä»¶ä¸­çš„æ•°æ®è¯»å…¥åˆ°å†…å­˜ä¸­ï¼Œé€šå¸¸æ˜¯åˆ›å»ºä¸€ä¸ªå­—èŠ‚æ•°ç»„è¯»å…¥ <code>.class</code> æ–‡ä»¶ï¼Œç„¶åäº§ç”Ÿä¸æ‰€åŠ è½½ç±»å¯¹åº”çš„ <code>Class</code> å¯¹è±¡ã€‚åŠ è½½å®Œæˆåï¼Œ<code>Class</code> å¯¹è±¡è¿˜ä¸å®Œæ•´ï¼Œæ‰€ä»¥æ­¤æ—¶çš„ç±»è¿˜ä¸å¯ç”¨ã€‚å½“ç±»è¢«åŠ è½½åå°±è¿›å…¥è¿æ¥é˜¶æ®µï¼Œè¿™ä¸€é˜¶æ®µåŒ…æ‹¬<strong>éªŒè¯</strong>ã€<strong>å‡†å¤‡</strong>ï¼ˆä¸ºé™æ€å˜é‡åˆ†é…å†…å­˜å¹¶è®¾ç½®é»˜è®¤çš„åˆå§‹å€¼ï¼‰å’Œ<strong>è§£æ</strong>ï¼ˆå°†ç¬¦å·å¼•ç”¨æ›¿æ¢ä¸ºç›´æ¥å¼•ç”¨ï¼‰ä¸‰ä¸ªæ­¥éª¤ã€‚æœ€å JVM å¯¹ç±»è¿›è¡Œåˆå§‹åŒ–ï¼ŒåŒ…æ‹¬ï¼š(1)å¦‚æœç±»å­˜åœ¨ç›´æ¥çš„çˆ¶ç±»å¹¶ä¸”è¿™ä¸ªç±»è¿˜æ²¡æœ‰è¢«åˆå§‹åŒ–ï¼Œé‚£ä¹ˆå°±å…ˆåˆå§‹åŒ–çˆ¶ç±»ï¼›(2)å¦‚æœç±»ä¸­å­˜åœ¨åˆå§‹åŒ–è¯­å¥ï¼Œå°±ä¾æ¬¡æ‰§è¡Œè¿™äº›åˆå§‹åŒ–è¯­å¥ã€‚</p>
<p>ç±»çš„åŠ è½½æ˜¯ç”±ç±»åŠ è½½å™¨å®Œæˆçš„ï¼Œç±»åŠ è½½å™¨åŒ…æ‹¬ï¼šæ ¹åŠ è½½å™¨ï¼ˆBootStrapï¼‰ã€æ‰©å±•åŠ è½½å™¨ï¼ˆExtensionï¼‰ã€ç³»ç»ŸåŠ è½½å™¨ï¼ˆSystemï¼‰å’Œç”¨æˆ·è‡ªå®šä¹‰ç±»åŠ è½½å™¨ï¼ˆ<code>java.lang.ClassLoader</code> çš„å­ç±»ï¼‰ã€‚ä» Java 2ï¼ˆJDK 1.2ï¼‰å¼€å§‹ï¼Œç±»åŠ è½½è¿‡ç¨‹é‡‡å–äº†çˆ¶äº²å§”æ‰˜æœºåˆ¶ï¼ˆPDMï¼‰ã€‚PDM æ›´å¥½çš„ä¿è¯äº† Java å¹³å°çš„å®‰å…¨æ€§ï¼Œåœ¨è¯¥æœºåˆ¶ä¸­ï¼ŒJVM è‡ªå¸¦çš„ Bootstrap æ˜¯æ ¹åŠ è½½å™¨ï¼Œå…¶ä»–çš„åŠ è½½å™¨éƒ½æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªçˆ¶ç±»åŠ è½½å™¨ã€‚ç±»çš„åŠ è½½é¦–å…ˆè¯·æ±‚çˆ¶ç±»åŠ è½½å™¨åŠ è½½ï¼Œçˆ¶ç±»åŠ è½½å™¨æ— èƒ½ä¸ºåŠ›æ—¶æ‰ç”±å…¶å­ç±»åŠ è½½å™¨è‡ªè¡ŒåŠ è½½ã€‚JVM ä¸ä¼šå‘ Java ç¨‹åºæä¾›å¯¹ Bootstrap çš„å¼•ç”¨ã€‚ä¸‹é¢æ˜¯å…³äºå‡ ä¸ªç±»åŠ è½½å™¨çš„è¯´æ˜ï¼š</p>
<ul>
<li>Bootstrapï¼šä¸€èˆ¬ç”¨æœ¬åœ°ä»£ç å®ç°ï¼Œè´Ÿè´£åŠ è½½ JVM åŸºç¡€æ ¸å¿ƒç±»åº“ï¼ˆ<code>rt.jar</code>ï¼‰ï¼›</li>
<li>Extensionï¼šä» <code>java.ext.dirs</code> ç³»ç»Ÿå±æ€§æ‰€æŒ‡å®šçš„ç›®å½•ä¸­åŠ è½½ç±»åº“ï¼Œå®ƒçš„çˆ¶åŠ è½½å™¨æ˜¯ Bootstrapï¼›</li>
<li>Systemï¼šåˆå«åº”ç”¨ç±»åŠ è½½å™¨ï¼Œå…¶çˆ¶ç±»æ˜¯ <code>Extension</code>ã€‚å®ƒæ˜¯åº”ç”¨æœ€å¹¿æ³›çš„ç±»åŠ è½½å™¨ã€‚å®ƒä»ç¯å¢ƒå˜é‡ <code>classpath</code> æˆ–è€…ç³»ç»Ÿå±æ€§ <code>java.class.path</code> æ‰€æŒ‡å®šçš„ç›®å½•ä¸­è®°è½½ç±»ï¼Œæ˜¯ç”¨æˆ·è‡ªå®šä¹‰åŠ è½½å™¨çš„é»˜è®¤çˆ¶åŠ è½½å™¨ã€‚</li>
</ul>
<blockquote>
<p>22ã€<code>char</code> ç±»å‹å˜é‡ä¸­èƒ½ä¸èƒ½å­˜å‚¨ä¸€ä¸ªä¸­æ–‡æ±‰å­—ï¼Œä¸ºä»€ä¹ˆï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼š<code>char</code> ç±»å‹å¯ä»¥å­˜å‚¨ä¸€ä¸ªä¸­æ–‡æ±‰å­—ï¼Œå› ä¸º Java ä¸­ä½¿ç”¨çš„ç¼–ç æ˜¯ <code>Unicode</code>ï¼ˆä¸é€‰æ‹©ä»»ä½•ç‰¹å®šçš„ç¼–ç ï¼Œç›´æ¥ä½¿ç”¨å­—ç¬¦åœ¨å­—ç¬¦é›†ä¸­çš„ç¼–å·ï¼Œè¿™æ˜¯ç»Ÿä¸€çš„å”¯ä¸€æ–¹æ³•ï¼‰ï¼Œä¸€ä¸ª <code>char</code> ç±»å‹å  2 ä¸ªå­—èŠ‚ï¼ˆ16 æ¯”ç‰¹ï¼‰ï¼Œæ‰€ä»¥æ”¾ä¸€ä¸ªä¸­æ–‡æ˜¯æ²¡é—®é¢˜çš„ã€‚</p>
<p><strong>è¡¥å……ï¼š</strong>ä½¿ç”¨ <code>Unicode</code> æ„å‘³ç€å­—ç¬¦åœ¨ JVM å†…éƒ¨å’Œå¤–éƒ¨æœ‰ä¸åŒçš„è¡¨ç°å½¢å¼ï¼Œåœ¨ JVM å†…éƒ¨éƒ½æ˜¯ <code>Unicode</code>ï¼Œå½“è¿™ä¸ªå­—ç¬¦è¢«ä» JVM å†…éƒ¨è½¬ç§»åˆ°å¤–éƒ¨æ—¶ï¼ˆä¾‹å¦‚å­˜å…¥æ–‡ä»¶ç³»ç»Ÿä¸­ï¼‰ï¼Œéœ€è¦è¿›è¡Œç¼–ç è½¬æ¢ã€‚æ‰€ä»¥ Java ä¸­æœ‰å­—èŠ‚æµå’Œå­—ç¬¦æµï¼Œä»¥åŠåœ¨å­—ç¬¦æµå’Œå­—èŠ‚æµä¹‹é—´è¿›è¡Œè½¬æ¢çš„è½¬æ¢æµï¼Œå¦‚ <code>InputStreamReader</code> å’Œ <code>OutputStreamReader</code>ï¼Œè¿™ä¸¤ä¸ªç±»æ˜¯å­—èŠ‚æµå’Œå­—ç¬¦æµä¹‹é—´çš„é€‚é…å™¨ç±»ï¼Œæ‰¿æ‹…äº†ç¼–ç è½¬æ¢çš„ä»»åŠ¡ï¼›å¯¹äº C ç¨‹åºå‘˜æ¥è¯´ï¼Œè¦å®Œæˆè¿™æ ·çš„ç¼–ç è½¬æ¢ææ€•è¦ä¾èµ–äº <code>union</code>ï¼ˆè”åˆä½“/å…±ç”¨ä½“ï¼‰å…±äº«å†…å­˜çš„ç‰¹å¾æ¥å®ç°äº†ã€‚</p>
<blockquote>
<p>23ã€æŠ½è±¡ç±»ï¼ˆabstract classï¼‰å’Œæ¥å£ï¼ˆinterfaceï¼‰æœ‰ä»€ä¹ˆå¼‚åŒï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šæŠ½è±¡ç±»å’Œæ¥å£éƒ½ä¸èƒ½å¤Ÿå®ä¾‹åŒ–ï¼Œä½†å¯ä»¥å®šä¹‰æŠ½è±¡ç±»å’Œæ¥å£ç±»å‹çš„å¼•ç”¨ã€‚ä¸€ä¸ªç±»å¦‚æœç»§æ‰¿äº†æŸä¸ªæŠ½è±¡ç±»æˆ–è€…å®ç°äº†æŸä¸ªæ¥å£éƒ½éœ€è¦å¯¹å…¶ä¸­çš„æŠ½è±¡æ–¹æ³•å…¨éƒ¨è¿›è¡Œå®ç°ï¼Œå¦åˆ™è¯¥ç±»ä»ç„¶éœ€è¦è¢«å£°æ˜ä¸ºæŠ½è±¡ç±»ã€‚æ¥å£æ¯”æŠ½è±¡ç±»æ›´åŠ æŠ½è±¡ï¼Œå› ä¸ºæŠ½è±¡ç±»ä¸­å¯ä»¥å®šä¹‰æ„é€ å™¨ï¼Œå¯ä»¥æœ‰æŠ½è±¡æ–¹æ³•å’Œå…·ä½“æ–¹æ³•ï¼Œè€Œæ¥å£ä¸­ä¸èƒ½å®šä¹‰æ„é€ å™¨è€Œä¸”å…¶ä¸­çš„æ–¹æ³•å…¨éƒ¨éƒ½æ˜¯æŠ½è±¡æ–¹æ³•ã€‚æŠ½è±¡ç±»ä¸­çš„æˆå‘˜å¯ä»¥æ˜¯ <code>private</code>ã€<code>é»˜è®¤</code>ã€<code>protected</code>ã€<code>public</code> çš„ï¼Œè€Œæ¥å£ä¸­çš„æˆå‘˜å…¨éƒ½æ˜¯ <code>public</code> çš„ã€‚æŠ½è±¡ç±»ä¸­å¯ä»¥å®šä¹‰æˆå‘˜å˜é‡ï¼Œè€Œæ¥å£ä¸­å®šä¹‰çš„æˆå‘˜å˜é‡å®é™…ä¸Šéƒ½æ˜¯å¸¸é‡ã€‚æœ‰æŠ½è±¡æ–¹æ³•çš„ç±»å¿…é¡»è¢«å£°æ˜ä¸ºæŠ½è±¡ç±»ï¼Œè€ŒæŠ½è±¡ç±»æœªå¿…è¦æœ‰æŠ½è±¡æ–¹æ³•ã€‚</p>
<blockquote>
<p>24ã€é™æ€åµŒå¥—ç±»ï¼ˆStatic Nested Classï¼‰å’Œå†…éƒ¨ç±»ï¼ˆInner Classï¼‰çš„ä¸åŒï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šStatic Nested Class æ˜¯è¢«å£°æ˜ä¸ºé™æ€ï¼ˆ<code>static</code>ï¼‰çš„å†…éƒ¨ç±»ï¼Œå®ƒå¯ä»¥ä¸ä¾èµ–äºå¤–éƒ¨ç±»å®ä¾‹è¢«å®ä¾‹åŒ–ã€‚è€Œé€šå¸¸çš„å†…éƒ¨ç±»éœ€è¦åœ¨å¤–éƒ¨ç±»å®ä¾‹åŒ–åæ‰èƒ½å®ä¾‹åŒ–ï¼Œå…¶è¯­æ³•çœ‹èµ·æ¥æŒºè¯¡å¼‚çš„ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * æ‰‘å…‹ç±»ï¼ˆä¸€å‰¯æ‰‘å…‹ï¼‰</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Poker</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> String[] suites = &#123;<span class="hljs-string">&quot;é»‘æ¡ƒ&quot;</span>, <span class="hljs-string">&quot;çº¢æ¡ƒ&quot;</span>, <span class="hljs-string">&quot;è‰èŠ±&quot;</span>, <span class="hljs-string">&quot;æ–¹å—&quot;</span>&#125;;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span>[] faces = &#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>, <span class="hljs-number">10</span>, <span class="hljs-number">11</span>, <span class="hljs-number">12</span>, <span class="hljs-number">13</span>&#125;;<br><br>    <span class="hljs-keyword">private</span> Card[] cards;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ„é€ å™¨</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Poker</span><span class="hljs-params">()</span> </span>&#123;<br>        cards = <span class="hljs-keyword">new</span> Card[<span class="hljs-number">52</span>];<br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; suites.length; i++) &#123;<br>            <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; faces.length; j++) &#123;<br>                cards[i * <span class="hljs-number">13</span> + j] = <span class="hljs-keyword">new</span> Card(suites[i], faces[j]);<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ´—ç‰Œ ï¼ˆéšæœºä¹±åºï¼‰</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">shuffle</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>, len = cards.length; i &lt; len; i++) &#123;<br>            <span class="hljs-keyword">int</span> index = (<span class="hljs-keyword">int</span>) (Math.random() * len);<br>            Card temp = cards[index];<br>            cards[index] = cards[i];<br>            cards[i] = temp;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * å‘ç‰Œ</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> index å‘ç‰Œçš„ä½ç½®</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Card <span class="hljs-title">deal</span><span class="hljs-params">(<span class="hljs-keyword">int</span> index)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> cards[index];<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * å¡ç‰‡ç±»ï¼ˆä¸€å¼ æ‰‘å…‹ï¼‰</span><br><span class="hljs-comment">     * [å†…éƒ¨ç±»]</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Card</span> </span>&#123;<br>        <span class="hljs-keyword">private</span> String suite;   <span class="hljs-comment">// èŠ±è‰²</span><br>        <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> face;       <span class="hljs-comment">// ç‚¹æ•°</span><br><br>        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Card</span><span class="hljs-params">(String suite, <span class="hljs-keyword">int</span> face)</span> </span>&#123;<br>            <span class="hljs-keyword">this</span>.suite = suite;<br>            <span class="hljs-keyword">this</span>.face = face;<br>        &#125;<br><br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">toString</span><span class="hljs-params">()</span> </span>&#123;<br>            String faceStr = <span class="hljs-string">&quot;&quot;</span>;<br>            <span class="hljs-keyword">switch</span>(face) &#123;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>: faceStr = <span class="hljs-string">&quot;A&quot;</span>; <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">11</span>: faceStr = <span class="hljs-string">&quot;J&quot;</span>; <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">12</span>: faceStr = <span class="hljs-string">&quot;Q&quot;</span>; <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">13</span>: faceStr = <span class="hljs-string">&quot;K&quot;</span>; <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">default</span>: faceStr = String.valueOf(face);<br>            &#125;<br>            <span class="hljs-keyword">return</span> suite + faceStr;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<p>æµ‹è¯•ä»£ç ï¼š</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PokerTest</span> </span>&#123;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        Poker poker = <span class="hljs-keyword">new</span> Poker();<br>        poker.shuffle();                  <span class="hljs-comment">// æ´—ç‰Œ</span><br>        Poker.Card c1 = poker.deal(<span class="hljs-number">0</span>);    <span class="hljs-comment">// å‘ç¬¬ä¸€å¼ ç‰Œ</span><br>        <span class="hljs-comment">// å¯¹äºéé™æ€å†…éƒ¨ç±»Card</span><br>        <span class="hljs-comment">// åªæœ‰é€šè¿‡å…¶å¤–éƒ¨ç±»Pokerå¯¹è±¡æ‰èƒ½åˆ›å»ºCardå¯¹è±¡</span><br>        Poker.Card c2 = poker.<span class="hljs-function">new <span class="hljs-title">Card</span><span class="hljs-params">(<span class="hljs-string">&quot;çº¢å¿ƒ&quot;</span>, <span class="hljs-number">1</span>)</span></span>;    <span class="hljs-comment">// è‡ªå·±åˆ›å»ºä¸€å¼ ç‰Œ</span><br><br>        System.out.println(c1);           <span class="hljs-comment">// æ´—ç‰Œåçš„ç¬¬ä¸€å¼ </span><br>        System.out.println(c2);           <span class="hljs-comment">// æ‰“å°: çº¢å¿ƒA</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<p>é¢è¯•é¢˜ - ä¸‹é¢çš„ä»£ç å“ªäº›åœ°æ–¹ä¼šäº§ç”Ÿç¼–è¯‘é”™è¯¯ï¼Ÿ</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Outer</span> </span>&#123;<br><br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Inner</span> </span>&#123;&#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">foo</span><span class="hljs-params">()</span> </span>&#123; <span class="hljs-keyword">new</span> Inner(); &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">bar</span><span class="hljs-params">()</span> </span>&#123; <span class="hljs-keyword">new</span> Inner(); &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        <span class="hljs-keyword">new</span> Inner();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<p><strong>æ³¨æ„ï¼š</strong>Java ä¸­éé™æ€å†…éƒ¨ç±»å¯¹è±¡çš„åˆ›å»ºè¦ä¾èµ–å…¶å¤–éƒ¨ç±»å¯¹è±¡ï¼Œä¸Šé¢çš„é¢è¯•é¢˜ä¸­ <code>foo</code> å’Œ <code>main</code> æ–¹æ³•éƒ½æ˜¯é™æ€æ–¹æ³•ï¼Œé™æ€æ–¹æ³•ä¸­æ²¡æœ‰ <code>this</code>ï¼Œä¹Ÿå°±æ˜¯è¯´æ²¡æœ‰æ‰€è°“çš„å¤–éƒ¨ç±»å¯¹è±¡ï¼Œå› æ­¤æ— æ³•åˆ›å»ºå†…éƒ¨ç±»å¯¹è±¡ï¼Œå¦‚æœè¦åœ¨é™æ€æ–¹æ³•ä¸­åˆ›å»ºå†…éƒ¨ç±»å¯¹è±¡ï¼Œå¯ä»¥è¿™æ ·åšï¼š</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">new</span> Outer().<span class="hljs-function">new <span class="hljs-title">Inner</span><span class="hljs-params">()</span></span>;<br></code></pre></td></tr></table></figure>
</p>
<blockquote>
<p>25ã€Java ä¸­ä¼šå­˜åœ¨å†…å­˜æ³„æ¼å—ï¼Œè¯·ç®€å•æè¿°ã€‚</p>
</blockquote>
<p>ç­”ï¼šç†è®ºä¸Š Java å› ä¸ºæœ‰åƒåœ¾å›æ”¶æœºåˆ¶ï¼ˆGCï¼‰ä¸ä¼šå­˜åœ¨å†…å­˜æ³„éœ²é—®é¢˜ï¼ˆè¿™ä¹Ÿæ˜¯ Java è¢«å¹¿æ³›ä½¿ç”¨äºæœåŠ¡å™¨ç«¯ç¼–ç¨‹çš„ä¸€ä¸ªé‡è¦åŸå› ï¼‰ï¼›ç„¶è€Œåœ¨å®é™…å¼€å‘ä¸­ï¼Œå¯èƒ½ä¼šå­˜åœ¨æ— ç”¨ä½†å¯è¾¾çš„å¯¹è±¡ï¼Œè¿™äº›å¯¹è±¡ä¸èƒ½è¢« GC å›æ”¶ï¼Œå› æ­¤ä¹Ÿä¼šå¯¼è‡´å†…å­˜æ³„éœ²çš„å‘ç”Ÿã€‚ä¾‹å¦‚ Hibernate çš„ Sessionï¼ˆä¸€çº§ç¼“å­˜ï¼‰ä¸­çš„å¯¹è±¡å±äºæŒä¹…æ€ï¼Œåƒåœ¾å›æ”¶å™¨æ˜¯ä¸ä¼šå›æ”¶è¿™äº›å¯¹è±¡çš„ï¼Œç„¶è€Œè¿™äº›å¯¹è±¡ä¸­å¯èƒ½å­˜åœ¨æ— ç”¨çš„åƒåœ¾å¯¹è±¡ï¼Œå¦‚æœä¸åŠæ—¶å…³é—­ï¼ˆcloseï¼‰æˆ–æ¸…ç©ºï¼ˆflushï¼‰ä¸€çº§ç¼“å­˜å°±å¯èƒ½å¯¼è‡´å†…å­˜æ³„éœ²ã€‚ä¸‹é¢ä¾‹å­ä¸­çš„ä»£ç ä¹Ÿä¼šå¯¼è‡´å†…å­˜æ³„éœ²ã€‚</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.Arrays;<br><span class="hljs-keyword">import</span> java.util.EmptyStackException;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyStack</span>&lt;<span class="hljs-title">T</span>&gt; </span>&#123;<br>    <span class="hljs-keyword">private</span> T[] elements;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> size = <span class="hljs-number">0</span>;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> INIT_CAPACITY = <span class="hljs-number">16</span>;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">MyStack</span><span class="hljs-params">()</span> </span>&#123;<br>        elements = (T[]) <span class="hljs-keyword">new</span> Object[INIT_CAPACITY];<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">push</span><span class="hljs-params">(T elem)</span> </span>&#123;<br>        ensureCapacity();<br>        elements[size++] = elem;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> T <span class="hljs-title">pop</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">if</span>(size == <span class="hljs-number">0</span>) <br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> EmptyStackException();<br>        <span class="hljs-keyword">return</span> elements[--size];<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">ensureCapacity</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">if</span>(elements.length == size) &#123;<br>            elements = Arrays.copyOf(elements, <span class="hljs-number">2</span> * size + <span class="hljs-number">1</span>);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<p>ä¸Šé¢çš„ä»£ç å®ç°äº†ä¸€ä¸ªæ ˆï¼ˆå…ˆè¿›åå‡ºï¼ˆFILOï¼‰ï¼‰ç»“æ„ï¼Œä¹çœ‹ä¹‹ä¸‹ä¼¼ä¹æ²¡æœ‰ä»€ä¹ˆæ˜æ˜¾çš„é—®é¢˜ï¼Œå®ƒç”šè‡³å¯ä»¥é€šè¿‡ä½ ç¼–å†™çš„å„ç§å•å…ƒæµ‹è¯•ã€‚ç„¶è€Œå…¶ä¸­çš„ <code>pop</code> æ–¹æ³•å´å­˜åœ¨å†…å­˜æ³„éœ²çš„é—®é¢˜ï¼Œå½“æˆ‘ä»¬ç”¨ <code>pop</code> æ–¹æ³•å¼¹å‡ºæ ˆä¸­çš„å¯¹è±¡æ—¶ï¼Œè¯¥å¯¹è±¡ä¸ä¼šè¢«å½“ä½œåƒåœ¾å›æ”¶ï¼Œå³ä½¿ä½¿ç”¨æ ˆçš„ç¨‹åºä¸å†å¼•ç”¨è¿™äº›å¯¹è±¡ï¼Œå› ä¸ºæ ˆå†…éƒ¨ç»´æŠ¤ç€å¯¹è¿™äº›å¯¹è±¡çš„è¿‡æœŸå¼•ç”¨ï¼ˆobsolete referenceï¼‰ã€‚åœ¨æ”¯æŒåƒåœ¾å›æ”¶çš„è¯­è¨€ä¸­ï¼Œå†…å­˜æ³„éœ²æ˜¯å¾ˆéšè”½çš„ï¼Œè¿™ç§å†…å­˜æ³„éœ²å…¶å®å°±æ˜¯æ— æ„è¯†çš„å¯¹è±¡ä¿æŒã€‚å¦‚æœä¸€ä¸ªå¯¹è±¡å¼•ç”¨è¢«æ— æ„è¯†çš„ä¿ç•™èµ·æ¥äº†ï¼Œé‚£ä¹ˆåƒåœ¾å›æ”¶å™¨ä¸ä¼šå¤„ç†è¿™ä¸ªå¯¹è±¡ï¼Œä¹Ÿä¸ä¼šå¤„ç†è¯¥å¯¹è±¡å¼•ç”¨çš„å…¶ä»–å¯¹è±¡ï¼Œå³ä½¿è¿™æ ·çš„å¯¹è±¡åªæœ‰å°‘æ•°å‡ ä¸ªï¼Œä¹Ÿå¯èƒ½ä¼šå¯¼è‡´å¾ˆå¤šçš„å¯¹è±¡è¢«æ’é™¤åœ¨åƒåœ¾å›æ”¶ä¹‹å¤–ï¼Œä»è€Œå¯¹æ€§èƒ½é€ æˆé‡å¤§å½±å“ï¼Œæç«¯æƒ…å†µä¸‹ä¼šå¼•å‘ Disk Pagingï¼ˆç‰©ç†å†…å­˜ä¸ç¡¬ç›˜çš„è™šæ‹Ÿå†…å­˜äº¤æ¢æ•°æ®ï¼‰ï¼Œç”šè‡³é€ æˆ OutOfMemoryErrorã€‚</p>
<blockquote>
<p>26ã€æŠ½è±¡çš„ï¼ˆ<code>abstract</code>ï¼‰æ–¹æ³•æ˜¯å¦å¯åŒæ—¶æ˜¯é™æ€çš„ï¼ˆ<code>static</code>ï¼‰ï¼Œæ˜¯å¦å¯åŒæ—¶æ˜¯æœ¬åœ°æ–¹æ³•ï¼ˆ<code>native</code>ï¼‰ï¼Œæ˜¯å¦å¯åŒæ—¶è¢« <code>synchronized</code> ä¿®é¥°ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šéƒ½ä¸èƒ½ã€‚æŠ½è±¡æ–¹æ³•éœ€è¦å­ç±»é‡å†™ï¼Œè€Œé™æ€çš„æ–¹æ³•æ˜¯æ— æ³•è¢«é‡å†™çš„ï¼Œå› æ­¤äºŒè€…æ˜¯çŸ›ç›¾çš„ã€‚æœ¬åœ°æ–¹æ³•æ˜¯ç”±æœ¬åœ°ä»£ç ï¼ˆå¦‚ C ä»£ç ï¼‰å®ç°çš„æ–¹æ³•ï¼Œè€ŒæŠ½è±¡æ–¹æ³•æ˜¯æ²¡æœ‰å®ç°çš„ï¼Œä¹Ÿæ˜¯çŸ›ç›¾çš„ã€‚<code>synchronized</code> å’Œæ–¹æ³•çš„å®ç°ç»†èŠ‚æœ‰å…³ï¼ŒæŠ½è±¡æ–¹æ³•ä¸æ¶‰åŠå®ç°ç»†èŠ‚ï¼Œå› æ­¤ä¹Ÿæ˜¯ç›¸äº’çŸ›ç›¾çš„ã€‚</p>
<blockquote>
<p>27ã€é˜è¿°é™æ€å˜é‡å’Œå®ä¾‹å˜é‡çš„åŒºåˆ«ã€‚</p>
</blockquote>
<p>ç­”ï¼šé™æ€å˜é‡æ˜¯è¢« <code>static</code> ä¿®é¥°ç¬¦ä¿®é¥°çš„å˜é‡ï¼Œä¹Ÿç§°ä¸ºç±»å˜é‡ï¼Œå®ƒå±äºç±»ï¼Œä¸å±äºç±»çš„ä»»ä½•ä¸€ä¸ªå¯¹è±¡ï¼Œä¸€ä¸ªç±»ä¸ç®¡åˆ›å»ºå¤šå°‘ä¸ªå¯¹è±¡ï¼Œé™æ€å˜é‡åœ¨å†…å­˜ä¸­æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªæ‹·è´ï¼›å®ä¾‹å˜é‡å¿…é¡»ä¾å­˜äºæŸä¸€å®ä¾‹ï¼Œéœ€è¦å…ˆåˆ›å»ºå¯¹è±¡ç„¶åé€šè¿‡å¯¹è±¡æ‰èƒ½è®¿é—®åˆ°å®ƒã€‚é™æ€å˜é‡å¯ä»¥å®ç°è®©å¤šä¸ªå¯¹è±¡å…±äº«å†…å­˜ã€‚</p>
<p><strong>è¡¥å……ï¼š</strong>åœ¨ Java å¼€å‘ä¸­ï¼Œä¸Šä¸‹æ–‡ç±»å’Œå·¥å…·ç±»ä¸­é€šå¸¸ä¼šæœ‰å¤§é‡çš„é™æ€æˆå‘˜ã€‚</p>
<blockquote>
<p>28ã€æ˜¯å¦å¯ä»¥ä»ä¸€ä¸ªé™æ€ï¼ˆstaticï¼‰æ–¹æ³•å†…éƒ¨å‘å‡ºå¯¹éé™æ€ï¼ˆnon-staticï¼‰æ–¹æ³•çš„è°ƒç”¨ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šä¸å¯ä»¥ï¼Œé™æ€æ–¹æ³•åªèƒ½è®¿é—®é™æ€æˆå‘˜ï¼Œå› ä¸ºéé™æ€æ–¹æ³•çš„è°ƒç”¨è¦å…ˆåˆ›å»ºå¯¹è±¡ï¼Œåœ¨è°ƒç”¨é™æ€æ–¹æ³•æ—¶å¯èƒ½å¯¹è±¡å¹¶æ²¡æœ‰è¢«åˆå§‹åŒ–ã€‚</p>
<blockquote>
<p>29ã€å¦‚ä½•å®ç°å¯¹è±¡å…‹éš†ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šæœ‰ä¸¤ç§æ–¹å¼ï¼š</p>
<ul>
<li>å®ç° <code>Cloneable</code> æ¥å£å¹¶é‡å†™ <code>Object</code> ç±»ä¸­çš„ <code>clone()</code> æ–¹æ³•ï¼›</li>
<li>å®ç° <code>Serializable</code> æ¥å£ï¼Œé€šè¿‡å¯¹è±¡çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–å®ç°å…‹éš†ï¼Œå¯ä»¥å®ç°çœŸæ­£çš„æ·±åº¦å…‹éš†ï¼Œä»£ç å¦‚ä¸‹ã€‚</li>
</ul>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.io.ByteArrayInputStream;<br><span class="hljs-keyword">import</span> java.io.ByteArrayOutputStream;<br><span class="hljs-keyword">import</span> java.io.ObjectInputStream;<br><span class="hljs-keyword">import</span> java.io.ObjectOutputStream;<br><span class="hljs-keyword">import</span> java.io.Serializable;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyUtil</span> </span>&#123;<br><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-title">MyUtil</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> AssertionError();<br>    &#125;<br><br>    <span class="hljs-meta">@SuppressWarnings(&quot;unchecked&quot;)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T extends Serializable&gt; <span class="hljs-function">T <span class="hljs-title">clone</span><span class="hljs-params">(T obj)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>        ByteArrayOutputStream bout = <span class="hljs-keyword">new</span> ByteArrayOutputStream();<br>        ObjectOutputStream oos = <span class="hljs-keyword">new</span> ObjectOutputStream(bout);<br>        oos.writeObject(obj);<br><br>        ByteArrayInputStream bin = <span class="hljs-keyword">new</span> ByteArrayInputStream(bout.toByteArray());<br>        ObjectInputStream ois = <span class="hljs-keyword">new</span> ObjectInputStream(bin);<br>        <span class="hljs-keyword">return</span> (T) ois.readObject();<br><br>        <span class="hljs-comment">// **è¯´æ˜ï¼š**è°ƒç”¨ByteArrayInputStreamæˆ–ByteArrayOutputStreamå¯¹è±¡çš„closeæ–¹æ³•æ²¡æœ‰ä»»ä½•æ„ä¹‰</span><br>        <span class="hljs-comment">// è¿™ä¸¤ä¸ªåŸºäºå†…å­˜çš„æµåªè¦åƒåœ¾å›æ”¶å™¨æ¸…ç†å¯¹è±¡å°±èƒ½å¤Ÿé‡Šæ”¾èµ„æºï¼Œè¿™ä¸€ç‚¹ä¸åŒäºå¯¹å¤–éƒ¨èµ„æºï¼ˆå¦‚æ–‡ä»¶æµï¼‰çš„é‡Šæ”¾</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<p>ä¸‹é¢æ˜¯æµ‹è¯•ä»£ç ï¼š</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.io.Serializable;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * äººç±»</span><br><span class="hljs-comment"> */</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Person</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Serializable</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">long</span> serialVersionUID = -<span class="hljs-number">9102017020286042305L</span>;<br><br>    <span class="hljs-keyword">private</span> String name;    <span class="hljs-comment">// å§“å</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> age;        <span class="hljs-comment">// å¹´é¾„</span><br>    <span class="hljs-keyword">private</span> Car car;        <span class="hljs-comment">// åº§é©¾</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Person</span><span class="hljs-params">(String name, <span class="hljs-keyword">int</span> age, Car car)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.name = name;<br>        <span class="hljs-keyword">this</span>.age = age;<br>        <span class="hljs-keyword">this</span>.car = car;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getName</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> name;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setName</span><span class="hljs-params">(String name)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.name = name;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getAge</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> age;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setAge</span><span class="hljs-params">(<span class="hljs-keyword">int</span> age)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.age = age;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Car <span class="hljs-title">getCar</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> car;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setCar</span><span class="hljs-params">(Car car)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.car = car;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">toString</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Person [name=&quot;</span> + name + <span class="hljs-string">&quot;, age=&quot;</span> + age + <span class="hljs-string">&quot;, car=&quot;</span> + car + <span class="hljs-string">&quot;]&quot;</span>;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * å°æ±½è½¦ç±»</span><br><span class="hljs-comment"> */</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Car</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Serializable</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">long</span> serialVersionUID = -<span class="hljs-number">5713945027627603702L</span>;<br><br>    <span class="hljs-keyword">private</span> String brand;       <span class="hljs-comment">// å“ç‰Œ</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> maxSpeed;       <span class="hljs-comment">// æœ€é«˜æ—¶é€Ÿ</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Car</span><span class="hljs-params">(String brand, <span class="hljs-keyword">int</span> maxSpeed)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.brand = brand;<br>        <span class="hljs-keyword">this</span>.maxSpeed = maxSpeed;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getBrand</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> brand;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setBrand</span><span class="hljs-params">(String brand)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.brand = brand;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getMaxSpeed</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> maxSpeed;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setMaxSpeed</span><span class="hljs-params">(<span class="hljs-keyword">int</span> maxSpeed)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.maxSpeed = maxSpeed;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">toString</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Car [brand=&quot;</span> + brand + <span class="hljs-string">&quot;, maxSpeed=&quot;</span> + maxSpeed + <span class="hljs-string">&quot;]&quot;</span>;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CloneTest</span> </span>&#123;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            Person p1 = <span class="hljs-keyword">new</span> Person(<span class="hljs-string">&quot;Hao LUO&quot;</span>, <span class="hljs-number">33</span>, <span class="hljs-keyword">new</span> Car(<span class="hljs-string">&quot;Benz&quot;</span>, <span class="hljs-number">300</span>));<br>            Person p2 = MyUtil.clone(p1); <span class="hljs-comment">// æ·±åº¦å…‹éš†</span><br>            p2.getCar().setBrand(<span class="hljs-string">&quot;BYD&quot;</span>);<br>            <span class="hljs-comment">// ä¿®æ”¹å…‹éš†çš„ Person å¯¹è±¡ p2 å…³è”çš„æ±½è½¦å¯¹è±¡çš„å“ç‰Œå±æ€§</span><br>            <span class="hljs-comment">// åŸæ¥çš„ Person å¯¹è±¡ p1 å…³è”çš„æ±½è½¦ä¸ä¼šå—åˆ°ä»»ä½•å½±å“</span><br>            <span class="hljs-comment">// å› ä¸ºåœ¨å…‹éš† Person å¯¹è±¡æ—¶å…¶å…³è”çš„æ±½è½¦å¯¹è±¡ä¹Ÿè¢«å…‹éš†äº†</span><br>            System.out.println(p1);<br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<p><strong>æ³¨æ„ï¼š</strong>åŸºäºåºåˆ—åŒ–å’Œååºåˆ—åŒ–å®ç°çš„å…‹éš†ä¸ä»…ä»…æ˜¯æ·±åº¦å…‹éš†ï¼Œæ›´é‡è¦çš„æ˜¯é€šè¿‡æ³›å‹é™å®šï¼Œå¯ä»¥æ£€æŸ¥å‡ºè¦å…‹éš†çš„å¯¹è±¡æ˜¯å¦æ”¯æŒåºåˆ—åŒ–ï¼Œè¿™é¡¹æ£€æŸ¥æ˜¯ç¼–è¯‘å™¨å®Œæˆçš„ï¼Œä¸æ˜¯åœ¨è¿è¡Œæ—¶æŠ›å‡ºå¼‚å¸¸ï¼Œè¿™ç§æ˜¯æ–¹æ¡ˆæ˜æ˜¾ä¼˜äºä½¿ç”¨ <code>Object</code> ç±»çš„ <code>clone()</code> æ–¹æ³•å…‹éš†å¯¹è±¡ã€‚è®©é—®é¢˜åœ¨ç¼–è¯‘çš„æ—¶å€™æš´éœ²å‡ºæ¥æ€»æ˜¯å¥½è¿‡æŠŠé—®é¢˜ç•™åˆ°è¿è¡Œæ—¶ã€‚</p>
<blockquote>
<p>30ã€GC æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆè¦æœ‰ GCï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šGC æ˜¯åƒåœ¾æ”¶é›†çš„æ„æ€ï¼Œå†…å­˜å¤„ç†æ˜¯ç¼–ç¨‹äººå‘˜å®¹æ˜“å‡ºç°é—®é¢˜çš„åœ°æ–¹ï¼Œå¿˜è®°æˆ–è€…é”™è¯¯çš„å†…å­˜å›æ”¶ä¼šå¯¼è‡´ç¨‹åºæˆ–ç³»ç»Ÿçš„ä¸ç¨³å®šç”šè‡³å´©æºƒï¼ŒJava æä¾›çš„ GC åŠŸèƒ½å¯ä»¥è‡ªåŠ¨ç›‘æµ‹å¯¹è±¡æ˜¯å¦è¶…è¿‡ä½œç”¨åŸŸä»è€Œè¾¾åˆ°è‡ªåŠ¨å›æ”¶å†…å­˜çš„ç›®çš„ï¼ŒJava è¯­è¨€æ²¡æœ‰æä¾›é‡Šæ”¾å·²åˆ†é…å†…å­˜çš„æ˜¾ç¤ºæ“ä½œæ–¹æ³•ã€‚Java ç¨‹åºå‘˜ä¸ç”¨æ‹…å¿ƒå†…å­˜ç®¡ç†ï¼Œå› ä¸ºåƒåœ¾æ”¶é›†å™¨ä¼šè‡ªåŠ¨è¿›è¡Œç®¡ç†ã€‚è¦è¯·æ±‚åƒåœ¾æ”¶é›†ï¼Œå¯ä»¥è°ƒç”¨ä¸‹é¢çš„æ–¹æ³•ä¹‹ä¸€ï¼š<code>System.gc()</code> æˆ– <code>Runtime.getRuntime().gc()</code> ï¼Œä½† JVM å¯ä»¥å±è”½æ‰æ˜¾ç¤ºçš„åƒåœ¾å›æ”¶è°ƒç”¨ã€‚</p>
<p>åƒåœ¾å›æ”¶å¯ä»¥æœ‰æ•ˆçš„é˜²æ­¢å†…å­˜æ³„éœ²ï¼Œæœ‰æ•ˆçš„ä½¿ç”¨å¯ä»¥ä½¿ç”¨çš„å†…å­˜ã€‚åƒåœ¾å›æ”¶å™¨é€šå¸¸æ˜¯ä½œä¸ºä¸€ä¸ªå•ç‹¬çš„ä½ä¼˜å…ˆçº§çš„çº¿ç¨‹è¿è¡Œï¼Œä¸å¯é¢„çŸ¥çš„æƒ…å†µä¸‹å¯¹å†…å­˜å †ä¸­å·²ç»æ­»äº¡çš„æˆ–è€…é•¿æ—¶é—´æ²¡æœ‰ä½¿ç”¨çš„å¯¹è±¡è¿›è¡Œæ¸…é™¤å’Œå›æ”¶ï¼Œç¨‹åºå‘˜ä¸èƒ½å®æ—¶çš„è°ƒç”¨åƒåœ¾å›æ”¶å™¨å¯¹æŸä¸ªå¯¹è±¡æˆ–æ‰€æœ‰å¯¹è±¡è¿›è¡Œåƒåœ¾å›æ”¶ã€‚åœ¨ Java è¯ç”ŸåˆæœŸï¼Œåƒåœ¾å›æ”¶æ˜¯ Java æœ€å¤§çš„äº®ç‚¹ä¹‹ä¸€ï¼Œå› ä¸ºæœåŠ¡å™¨ç«¯çš„ç¼–ç¨‹éœ€è¦æœ‰æ•ˆçš„é˜²æ­¢å†…å­˜æ³„éœ²é—®é¢˜ï¼Œç„¶è€Œæ—¶è¿‡å¢ƒè¿ï¼Œå¦‚ä»Š Java çš„åƒåœ¾å›æ”¶æœºåˆ¶å·²ç»æˆä¸ºè¢«è¯Ÿç—…çš„ä¸œè¥¿ã€‚ç§»åŠ¨æ™ºèƒ½ç»ˆç«¯ç”¨æˆ·é€šå¸¸è§‰å¾— iOS çš„ç³»ç»Ÿæ¯” Android ç³»ç»Ÿæœ‰æ›´å¥½çš„ç”¨æˆ·ä½“éªŒï¼Œå…¶ä¸­ä¸€ä¸ªæ·±å±‚æ¬¡çš„åŸå› å°±åœ¨äº Android ç³»ç»Ÿä¸­åƒåœ¾å›æ”¶çš„ä¸å¯é¢„çŸ¥æ€§ã€‚</p>
<p><strong>è¡¥å……ï¼š</strong>åƒåœ¾å›æ”¶æœºåˆ¶æœ‰å¾ˆå¤šç§ï¼ŒåŒ…æ‹¬ï¼šåˆ†ä»£å¤åˆ¶åƒåœ¾å›æ”¶ã€æ ‡è®°åƒåœ¾å›æ”¶ã€å¢é‡åƒåœ¾å›æ”¶ç­‰æ–¹å¼ã€‚æ ‡å‡†çš„ Java è¿›ç¨‹æ—¢æœ‰æ ˆåˆæœ‰å †ã€‚æ ˆä¿å­˜äº†åŸå§‹å‹å±€éƒ¨å˜é‡ï¼Œå †ä¿å­˜äº†è¦åˆ›å»ºçš„å¯¹è±¡ã€‚Java å¹³å°å¯¹å †å†…å­˜å›æ”¶å’Œå†åˆ©ç”¨çš„åŸºæœ¬ç®—æ³•è¢«ç§°ä¸ºæ ‡è®°å’Œæ¸…é™¤ï¼Œä½†æ˜¯ Java å¯¹å…¶è¿›è¡Œäº†æ”¹è¿›ï¼Œé‡‡ç”¨â€œåˆ†ä»£å¼åƒåœ¾æ”¶é›†â€ã€‚è¿™ç§æ–¹æ³•ä¼šè·Ÿ Java å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸå°†å †å†…å­˜åˆ’åˆ†ä¸ºä¸åŒçš„åŒºåŸŸï¼Œåœ¨åƒåœ¾æ”¶é›†è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½ä¼šå°†å¯¹è±¡ç§»åŠ¨åˆ°ä¸åŒåŒºåŸŸï¼š</p>
<ul>
<li>ä¼Šç”¸å›­ï¼ˆEdenï¼‰ï¼šè¿™æ˜¯å¯¹è±¡æœ€åˆè¯ç”Ÿçš„åŒºåŸŸï¼Œå¹¶ä¸”å¯¹å¤§å¤šæ•°å¯¹è±¡æ¥è¯´ï¼Œè¿™é‡Œæ˜¯å®ƒä»¬å”¯ä¸€å­˜åœ¨è¿‡çš„åŒºåŸŸã€‚</li>
<li>å¹¸å­˜è€…ä¹å›­ï¼ˆSurvivorï¼‰ï¼šä»ä¼Šç”¸å›­å¹¸å­˜ä¸‹æ¥çš„å¯¹è±¡ä¼šè¢«æŒªåˆ°è¿™é‡Œã€‚</li>
<li>ç»ˆèº«é¢å…»å›­ï¼ˆTenuredï¼‰ï¼šè¿™æ˜¯è¶³å¤Ÿè€çš„å¹¸å­˜å¯¹è±¡çš„å½’å®¿ã€‚å¹´è½»ä»£æ”¶é›†ï¼ˆMinor-GCï¼‰è¿‡ç¨‹æ˜¯ä¸ä¼šè§¦åŠè¿™ä¸ªåœ°æ–¹çš„ã€‚å½“å¹´è½»ä»£æ”¶é›†ä¸èƒ½æŠŠå¯¹è±¡æ”¾è¿›ç»ˆèº«é¢å…»å›­æ—¶ï¼Œå°±ä¼šè§¦å‘ä¸€æ¬¡å®Œå…¨æ”¶é›†ï¼ˆMajor-GCï¼‰ï¼Œè¿™é‡Œå¯èƒ½è¿˜ä¼šç‰µæ‰¯åˆ°å‹ç¼©ï¼Œä»¥ä¾¿ä¸ºå¤§å¯¹è±¡è…¾å‡ºè¶³å¤Ÿçš„ç©ºé—´ã€‚</li>
</ul>
<p>ä¸åƒåœ¾å›æ”¶ç›¸å…³çš„ JVM å‚æ•°ï¼š</p>
<ul>
<li><code>-Xms / -Xmx</code>ï¼šå †çš„åˆå§‹å¤§å° / å †çš„æœ€å¤§å¤§å°</li>
<li><code>-Xmn</code>ï¼šå †ä¸­å¹´è½»ä»£çš„å¤§å°</li>
<li><code>-XX:-DisableExplicitGC</code>ï¼šè®©System.gc()ä¸äº§ç”Ÿä»»ä½•ä½œç”¨</li>
<li><code>-XX:+PrintGCDetails</code>ï¼šæ‰“å°GCçš„ç»†èŠ‚</li>
<li><code>-XX:+PrintGCDateStamps</code>ï¼šæ‰“å°GCæ“ä½œçš„æ—¶é—´æˆ³</li>
<li><code>-XX:NewSize / XX:MaxNewSize</code>ï¼šè®¾ç½®æ–°ç”Ÿä»£å¤§å°/æ–°ç”Ÿä»£æœ€å¤§å¤§å°</li>
<li><code>-XX:NewRatio</code>ï¼šå¯ä»¥è®¾ç½®è€ç”Ÿä»£å’Œæ–°ç”Ÿä»£çš„æ¯”ä¾‹</li>
<li><code>-XX:PrintTenuringDistribution</code>ï¼šè®¾ç½®æ¯æ¬¡æ–°ç”Ÿä»£GCåè¾“å‡ºå¹¸å­˜è€…ä¹å›­ä¸­å¯¹è±¡å¹´é¾„çš„åˆ†å¸ƒ</li>
<li><code>-XX:InitialTenuringThreshold / -XX:MaxTenuringThreshold</code>ï¼šè®¾ç½®è€å¹´ä»£é˜€å€¼çš„åˆå§‹å€¼å’Œæœ€å¤§å€¼</li>
<li><code>-XX:TargetSurvivorRatio</code>ï¼šè®¾ç½®å¹¸å­˜åŒºçš„ç›®æ ‡ä½¿ç”¨ç‡</li>
</ul>
<blockquote>
<p>31ã€<code>String s = new String(&quot;xyz&quot;);</code> åˆ›å»ºäº†å‡ ä¸ªå­—ç¬¦ä¸²å¯¹è±¡ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šä¸¤ä¸ªå¯¹è±¡ï¼Œä¸€ä¸ªæ˜¯é™æ€åŒºçš„ <code>&quot;xyz&quot;</code>ï¼Œä¸€ä¸ªæ˜¯ç”¨ <code>new</code> åˆ›å»ºåœ¨å †ä¸Šçš„å¯¹è±¡ã€‚</p>
<blockquote>
<p>32ã€æ¥å£æ˜¯å¦å¯ç»§æ‰¿ï¼ˆextendsï¼‰æ¥å£ï¼ŸæŠ½è±¡ç±»æ˜¯å¦å¯å®ç°ï¼ˆimplementsï¼‰æ¥å£ï¼ŸæŠ½è±¡ç±»æ˜¯å¦å¯ç»§æ‰¿å…·ä½“ç±»ï¼ˆconcrete classï¼‰ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šæ¥å£å¯ä»¥ç»§æ‰¿æ¥å£ï¼Œè€Œä¸”æ”¯æŒå¤šé‡ç»§æ‰¿ã€‚æŠ½è±¡ç±»å¯ä»¥å®ç°ï¼ˆimplementsï¼‰æ¥å£ï¼ŒæŠ½è±¡ç±»å¯ç»§æ‰¿å…·ä½“ç±»ä¹Ÿå¯ä»¥ç»§æ‰¿æŠ½è±¡ç±»ã€‚</p>
<blockquote>
<p>33ã€ä¸€ä¸ª <code>.java</code> æºæ–‡ä»¶ä¸­æ˜¯å¦å¯ä»¥åŒ…å«å¤šä¸ªç±»ï¼ˆä¸æ˜¯å†…éƒ¨ç±»ï¼‰ï¼Ÿæœ‰ä»€ä¹ˆé™åˆ¶ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šå¯ä»¥ï¼Œä½†ä¸€ä¸ªæºæ–‡ä»¶ä¸­æœ€å¤šåªèƒ½æœ‰ä¸€ä¸ªå…¬å¼€ç±»ï¼ˆpublic classï¼‰è€Œä¸”æ–‡ä»¶åå¿…é¡»å’Œå…¬å¼€ç±»çš„ç±»åå®Œå…¨ä¿æŒä¸€è‡´ã€‚</p>
<blockquote>
<p>34ã€Anonymous Inner Classï¼ˆåŒ¿åå†…éƒ¨ç±»ï¼‰æ˜¯å¦å¯ä»¥ç»§æ‰¿å…¶å®ƒç±»ï¼Ÿæ˜¯å¦å¯ä»¥å®ç°æ¥å£ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šå¯ä»¥ç»§æ‰¿å…¶ä»–ç±»æˆ–å®ç°å…¶ä»–æ¥å£ï¼Œåœ¨ Swing ç¼–ç¨‹å’Œ Android å¼€å‘ä¸­å¸¸ç”¨æ­¤æ–¹å¼æ¥å®ç°äº‹ä»¶ç›‘å¬å’Œå›è°ƒã€‚</p>
<blockquote>
<p>35ã€å†…éƒ¨ç±»å¯ä»¥å¼•ç”¨å®ƒçš„åŒ…å«ç±»ï¼ˆå¤–éƒ¨ç±»ï¼‰çš„æˆå‘˜å—ï¼Ÿæœ‰æ²¡æœ‰ä»€ä¹ˆé™åˆ¶ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šä¸€ä¸ªå†…éƒ¨ç±»å¯¹è±¡å¯ä»¥è®¿é—®åˆ›å»ºå®ƒçš„å¤–éƒ¨ç±»å¯¹è±¡çš„æˆå‘˜ï¼ŒåŒ…æ‹¬ç§æœ‰æˆå‘˜ã€‚</p>
<blockquote>
<p>36ã€Java ä¸­çš„ <code>final</code> å…³é”®å­—æœ‰å“ªäº›ç”¨æ³•ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼š</p>
<ul>
<li>ä¿®é¥°ç±»ï¼šè¡¨ç¤ºè¯¥ç±»ä¸èƒ½è¢«ç»§æ‰¿ï¼›</li>
<li>ä¿®é¥°æ–¹æ³•ï¼šè¡¨ç¤ºæ–¹æ³•ä¸èƒ½è¢«é‡å†™ï¼›</li>
<li>ä¿®é¥°å˜é‡ï¼šè¡¨ç¤ºå˜é‡åªèƒ½ä¸€æ¬¡èµ‹å€¼ä»¥åå€¼ä¸èƒ½è¢«ä¿®æ”¹ï¼ˆå¸¸é‡ï¼‰ã€‚</li>
</ul>
<blockquote>
<p>37ã€æŒ‡å‡ºä¸‹é¢ç¨‹åºçš„è¿è¡Œç»“æœã€‚</p>
</blockquote>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">A</span> </span>&#123;<br><br>    <span class="hljs-keyword">static</span> &#123;<br>        System.out.print(<span class="hljs-string">&quot;1&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">A</span><span class="hljs-params">()</span> </span>&#123;<br>        System.out.print(<span class="hljs-string">&quot;2&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">B</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">A</span></span>&#123;<br><br>    <span class="hljs-keyword">static</span> &#123;<br>        System.out.print(<span class="hljs-string">&quot;a&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">B</span><span class="hljs-params">()</span> </span>&#123;<br>        System.out.print(<span class="hljs-string">&quot;b&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Hello</span> </span>&#123;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        A ab = <span class="hljs-keyword">new</span> B();<br>        ab = <span class="hljs-keyword">new</span> B();<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<p>ç­”ï¼šæ‰§è¡Œç»“æœï¼š<code>1a2b2b</code>ã€‚åˆ›å»ºå¯¹è±¡æ—¶æ„é€ å™¨çš„è°ƒç”¨é¡ºåºæ˜¯ï¼šå…ˆåˆå§‹åŒ–é™æ€æˆå‘˜ï¼Œç„¶åè°ƒç”¨çˆ¶ç±»æ„é€ å™¨ï¼Œå†åˆå§‹åŒ–éé™æ€æˆå‘˜ï¼Œæœ€åè°ƒç”¨è‡ªèº«æ„é€ å™¨ã€‚</p>
<p><strong>æ³¨æ„ï¼š</strong>å¦‚æœä¸èƒ½ç»™å‡ºæ­¤é¢˜çš„æ­£ç¡®ç­”æ¡ˆï¼Œè¯´æ˜ä¹‹å‰ç¬¬ 21 é¢˜ Java ç±»åŠ è½½æœºåˆ¶è¿˜æ²¡æœ‰å®Œå…¨ç†è§£ï¼Œèµ¶ç´§å†çœ‹çœ‹å§ã€‚</p>
<blockquote>
<p>38ã€æ•°æ®ç±»å‹ä¹‹é—´çš„è½¬æ¢ï¼š</p>
<ul>
<li>å¦‚ä½•å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºåŸºæœ¬æ•°æ®ç±»å‹ï¼Ÿ</li>
<li>å¦‚ä½•å°†åŸºæœ¬æ•°æ®ç±»å‹è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Ÿ</li>
</ul>
</blockquote>
<p>ç­”ï¼š</p>
<ul>
<li>è°ƒç”¨åŸºæœ¬æ•°æ®ç±»å‹å¯¹åº”çš„åŒ…è£…ç±»ä¸­çš„æ–¹æ³• <code>parseXXX(String)</code> æˆ– <code>valueOf(String)</code> å³å¯è¿”å›ç›¸åº”åŸºæœ¬ç±»å‹ï¼›</li>
<li>ä¸€ç§æ–¹æ³•æ˜¯å°†åŸºæœ¬æ•°æ®ç±»å‹ä¸ç©ºå­—ç¬¦ä¸²ï¼ˆ<code>&quot;&quot;</code>ï¼‰è¿æ¥ï¼ˆ<code>+</code>ï¼‰å³å¯è·å¾—å…¶æ‰€å¯¹åº”çš„å­—ç¬¦ä¸²ï¼›å¦ä¸€ç§æ–¹æ³•æ˜¯è°ƒç”¨ <code>String</code> ç±»ä¸­çš„ <code>valueOf()</code> æ–¹æ³•è¿”å›ç›¸åº”å­—ç¬¦ä¸²</li>
</ul>
<blockquote>
<p>39ã€å¦‚ä½•å®ç°å­—ç¬¦ä¸²çš„åè½¬åŠæ›¿æ¢ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šæ–¹æ³•å¾ˆå¤šï¼Œå¯ä»¥è‡ªå·±å†™å®ç°ä¹Ÿå¯ä»¥ä½¿ç”¨ <code>String</code> æˆ– <code>StringBuffer/StringBuilder</code> ä¸­çš„æ–¹æ³•ã€‚æœ‰ä¸€é“å¾ˆå¸¸è§çš„é¢è¯•é¢˜æ˜¯ç”¨é€’å½’å®ç°å­—ç¬¦ä¸²åè½¬ï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title">reverse</span><span class="hljs-params">(String originStr)</span> </span>&#123;<br>    <span class="hljs-keyword">if</span>(originStr == <span class="hljs-keyword">null</span> || originStr.length() &lt;= <span class="hljs-number">1</span>) <br>        <span class="hljs-keyword">return</span> originStr;<br>    <span class="hljs-keyword">return</span> reverse(originStr.substring(<span class="hljs-number">1</span>)) + originStr.charAt(<span class="hljs-number">0</span>);<br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<blockquote>
<p>40ã€æ€æ ·å°† GB2312 ç¼–ç çš„å­—ç¬¦ä¸²è½¬æ¢ä¸º ISO-8859-1 ç¼–ç çš„å­—ç¬¦ä¸²ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">String s1 = <span class="hljs-string">&quot;ä½ å¥½&quot;</span>;<br>String s2 = <span class="hljs-keyword">new</span> String(s1.getBytes(<span class="hljs-string">&quot;GB2312&quot;</span>), <span class="hljs-string">&quot;ISO-8859-1&quot;</span>);<br></code></pre></td></tr></table></figure>
</p>
<blockquote>
<p>41ã€æ—¥æœŸå’Œæ—¶é—´ï¼š
é—®é¢˜1ï¼šå¦‚ä½•å–å¾—å¹´æœˆæ—¥ã€å°æ—¶åˆ†é’Ÿç§’ï¼Ÿ</p>
</blockquote>
<p>åˆ›å»º <code>java.util.Calendar</code> å®ä¾‹ï¼Œè°ƒç”¨å…¶ <code>get()</code> æ–¹æ³•ä¼ å…¥ä¸åŒçš„å‚æ•°å³å¯è·å¾—å‚æ•°æ‰€å¯¹åº”çš„å€¼ã€‚Java 8ä¸­å¯ä»¥ä½¿ç”¨ <code>java.time.LocalDateTime</code> æ¥è·å–ï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤ºã€‚</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DateTimeTest</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        Calendar cal = Calendar.getInstance();<br>        System.out.println(cal.get(Calendar.YEAR));<br>        System.out.println(cal.get(Calendar.MONTH));    <span class="hljs-comment">// 0 - 11</span><br>        System.out.println(cal.get(Calendar.DATE));<br>        System.out.println(cal.get(Calendar.HOUR_OF_DAY));<br>        System.out.println(cal.get(Calendar.MINUTE));<br>        System.out.println(cal.get(Calendar.SECOND));<br><br>        <span class="hljs-comment">// Java 8</span><br>        LocalDateTime dt = LocalDateTime.now();<br>        System.out.println(dt.getYear());<br>        System.out.println(dt.getMonthValue());     <span class="hljs-comment">// 1 - 12</span><br>        System.out.println(dt.getDayOfMonth());<br>        System.out.println(dt.getHour());<br>        System.out.println(dt.getMinute());<br>        System.out.println(dt.getSecond());<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<blockquote>
<p>é—®é¢˜2ï¼šå¦‚ä½•å–å¾—ä» 1970 å¹´ 1 æœˆ 1 æ—¥ 0 æ—¶ 0 åˆ† 0 ç§’åˆ°ç°åœ¨çš„æ¯«ç§’æ•°ï¼Ÿ</p>
</blockquote>
<p>ä»¥ä¸‹æ–¹æ³•å‡å¯è·å¾—è¯¥æ¯«ç§’æ•°ã€‚</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">Calendar.getInstance().getTimeInMillis();<br>System.currentTimeMillis();<br>Clock.systemDefaultZone().millis(); <span class="hljs-comment">// Java 8</span><br></code></pre></td></tr></table></figure>
</p>
<blockquote>
<p>é—®é¢˜3ï¼šå¦‚ä½•å–å¾—æŸæœˆçš„æœ€åä¸€å¤©ï¼Ÿ</p>
</blockquote>
<p>ä»£ç å¦‚ä¸‹æ‰€ç¤ºã€‚</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">Calendar time = Calendar.getInstance();<br>time.getActualMaximum(Calendar.DAY_OF_MONTH);<br></code></pre></td></tr></table></figure>
</p>
<blockquote>
<p>é—®é¢˜4ï¼šå¦‚ä½•æ ¼å¼åŒ–æ—¥æœŸï¼Ÿ</p>
</blockquote>
<p>åˆ©ç”¨ <code>java.text.DataFormat</code> çš„å­ç±»ï¼ˆå¦‚ <code>SimpleDateFormat</code> ç±»ï¼‰ä¸­çš„ <code>format(Date)</code> æ–¹æ³•å¯å°†æ—¥æœŸæ ¼å¼åŒ–ã€‚Java 8 ä¸­å¯ä»¥ç”¨ <code>java.time.format.DateTimeFormatter</code> æ¥æ ¼å¼åŒ–æ—¶é—´æ—¥æœŸï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤ºã€‚</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.text.SimpleDateFormat;<br><span class="hljs-keyword">import</span> java.time.LocalDate;<br><span class="hljs-keyword">import</span> java.time.format.DateTimeFormatter;<br><span class="hljs-keyword">import</span> java.util.Date;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DateFormatTest</span> </span>&#123;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        SimpleDateFormat oldFormatter = <span class="hljs-keyword">new</span> SimpleDateFormat(<span class="hljs-string">&quot;yyyy/MM/dd&quot;</span>);<br>        Date date1 = <span class="hljs-keyword">new</span> Date();<br>        System.out.println(oldFormatter.format(date1));<br><br>        <span class="hljs-comment">// Java 8</span><br>        DateTimeFormatter newFormatter = DateTimeFormatter.ofPattern(<span class="hljs-string">&quot;yyyy/MM/dd&quot;</span>);<br>        LocalDate date2 = LocalDate.now();<br>        System.out.println(date2.format(newFormatter));<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<p><strong>è¡¥å……ï¼š</strong>Java çš„æ—¶é—´æ—¥æœŸ API ä¸€ç›´ä»¥æ¥éƒ½æ˜¯è¢«è¯Ÿç—…çš„ä¸œè¥¿ï¼Œä¸ºäº†è§£å†³è¿™ä¸€é—®é¢˜ï¼ŒJava 8 ä¸­å¼•å…¥äº†æ–°çš„æ—¶é—´æ—¥æœŸ APIï¼Œå…¶ä¸­åŒ…æ‹¬ <code>LocalDate</code>ã€<code>LocalTime</code>ã€<code>LocalDateTime</code>ã€<code>Clock</code>ã€<code>Instant</code> ç­‰ç±»ï¼Œè¿™äº›çš„ç±»çš„è®¾è®¡éƒ½ä½¿ç”¨äº†ä¸å˜æ¨¡å¼ï¼Œå› æ­¤æ˜¯çº¿ç¨‹å®‰å…¨çš„è®¾è®¡ã€‚å¦‚æœä¸ç†è§£è¿™äº›å†…å®¹ï¼Œå¯ä»¥å‚è€ƒæˆ‘çš„å¦ä¸€ç¯‡æ–‡ç« <a target="_blank" rel="noopener" href="https://blog.csdn.net/jackfrued/article/details/44499227">ã€Šå…³äº Java å¹¶å‘ç¼–ç¨‹çš„æ€»ç»“å’Œæ€è€ƒã€‹</a>ã€‚</p>
<blockquote>
<p>42ã€æ‰“å°æ˜¨å¤©çš„å½“å‰æ—¶åˆ»ã€‚</p>
</blockquote>
<p>ç­”ï¼š</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.Calendar;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">YesterdayCurrent</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span></span>&#123;<br>        Calendar cal = Calendar.getInstance();<br>        cal.add(Calendar.DATE, -<span class="hljs-number">1</span>);<br>        System.out.println(cal.getTime());<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<p>åœ¨Java 8ä¸­ï¼Œå¯ä»¥ç”¨ä¸‹é¢çš„ä»£ç å®ç°ç›¸åŒçš„åŠŸèƒ½ã€‚</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.time.LocalDateTime;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">YesterdayCurrent</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        LocalDateTime today = LocalDateTime.now();<br>        LocalDateTime yesterday = today.minusDays(<span class="hljs-number">1</span>);<br>        System.out.println(yesterday);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<blockquote>
<p>43ã€æ¯”è¾ƒä¸€ä¸‹ Java å’Œ JavaSciprtã€‚</p>
</blockquote>
<p>ç­”ï¼šJavaScript ä¸ Java æ˜¯ä¸¤ä¸ªå…¬å¸å¼€å‘çš„ä¸åŒçš„ä¸¤ä¸ªäº§å“ã€‚Java æ˜¯åŸ Sun Microsystems å…¬å¸æ¨å‡ºçš„é¢å‘å¯¹è±¡çš„ç¨‹åºè®¾è®¡è¯­è¨€ï¼Œç‰¹åˆ«é€‚åˆäºäº’è”ç½‘åº”ç”¨ç¨‹åºå¼€å‘ï¼›è€Œ JavaScript æ˜¯ Netscape å…¬å¸çš„äº§å“ï¼Œä¸ºäº†æ‰©å±• Netscape æµè§ˆå™¨çš„åŠŸèƒ½è€Œå¼€å‘çš„ä¸€ç§å¯ä»¥åµŒå…¥ Web é¡µé¢ä¸­è¿è¡Œçš„åŸºäºå¯¹è±¡å’Œäº‹ä»¶é©±åŠ¨çš„è§£é‡Šæ€§è¯­è¨€ã€‚JavaScript çš„å‰èº«æ˜¯ LiveScriptï¼›è€Œ Java çš„å‰èº«æ˜¯ Oak è¯­è¨€ã€‚</p>
<p>ä¸‹é¢å¯¹ä¸¤ç§è¯­è¨€é—´çš„å¼‚åŒä½œå¦‚ä¸‹æ¯”è¾ƒï¼š</p>
<ul>
<li>åŸºäºå¯¹è±¡å’Œé¢å‘å¯¹è±¡ï¼šJava æ˜¯ä¸€ç§çœŸæ­£çš„é¢å‘å¯¹è±¡çš„è¯­è¨€ï¼Œå³ä½¿æ˜¯å¼€å‘ç®€å•çš„ç¨‹åºï¼Œå¿…é¡»è®¾è®¡å¯¹è±¡ï¼› JavaScript æ˜¯ç§è„šæœ¬è¯­è¨€ï¼Œå®ƒå¯ä»¥ç”¨æ¥åˆ¶ä½œä¸ç½‘ç»œæ— å…³çš„ï¼Œä¸ç”¨æˆ·äº¤äº’ä½œç”¨çš„å¤æ‚è½¯ä»¶ã€‚å®ƒæ˜¯ä¸€ç§åŸºäºå¯¹è±¡ï¼ˆObject-Basedï¼‰å’Œäº‹ä»¶é©±åŠ¨ï¼ˆEvent-Drivenï¼‰çš„ç¼–ç¨‹è¯­è¨€ï¼Œå› è€Œå®ƒæœ¬èº«æä¾›äº†éå¸¸ä¸°å¯Œçš„å†…éƒ¨å¯¹è±¡ä¾›è®¾è®¡äººå‘˜ä½¿ç”¨ã€‚</li>
<li>è§£é‡Šå’Œç¼–è¯‘ï¼šJava çš„æºä»£ç åœ¨æ‰§è¡Œä¹‹å‰ï¼Œå¿…é¡»ç»è¿‡ç¼–è¯‘ã€‚JavaScript æ˜¯ä¸€ç§è§£é‡Šæ€§ç¼–ç¨‹è¯­è¨€ï¼Œå…¶æºä»£ç ä¸éœ€ç»è¿‡ç¼–è¯‘ï¼Œç”±æµè§ˆå™¨è§£é‡Šæ‰§è¡Œã€‚ï¼ˆç›®å‰çš„æµè§ˆå™¨å‡ ä¹éƒ½ä½¿ç”¨äº† JITï¼ˆå³æ—¶ç¼–è¯‘ï¼‰æŠ€æœ¯æ¥æå‡ JavaScript çš„è¿è¡Œæ•ˆç‡ï¼‰</li>
<li>å¼ºç±»å‹å˜é‡å’Œç±»å‹å¼±å˜é‡ï¼šJava é‡‡ç”¨å¼ºç±»å‹å˜é‡æ£€æŸ¥ï¼Œå³æ‰€æœ‰å˜é‡åœ¨ç¼–è¯‘ä¹‹å‰å¿…é¡»ä½œå£°æ˜ï¼›JavaScript ä¸­å˜é‡æ˜¯å¼±ç±»å‹çš„ï¼Œç”šè‡³åœ¨ä½¿ç”¨å˜é‡å‰å¯ä»¥ä¸ä½œå£°æ˜ï¼ŒJavaScript çš„è§£é‡Šå™¨åœ¨è¿è¡Œæ—¶æ£€æŸ¥æ¨æ–­å…¶æ•°æ®ç±»å‹ã€‚</li>
<li>ä»£ç æ ¼å¼ä¸ä¸€æ ·ã€‚</li>
</ul>
<p><strong>è¡¥å……ï¼š</strong>ä¸Šé¢åˆ—å‡ºçš„å››ç‚¹æ˜¯ç½‘ä¸Šæµä¼ çš„æ‰€è°“çš„æ ‡å‡†ç­”æ¡ˆã€‚å…¶å® Java å’Œ JavaScript æœ€é‡è¦çš„åŒºåˆ«æ˜¯ä¸€ä¸ªæ˜¯é™æ€è¯­è¨€ï¼Œä¸€ä¸ªæ˜¯åŠ¨æ€è¯­è¨€ã€‚ç›®å‰çš„ç¼–ç¨‹è¯­è¨€çš„å‘å±•è¶‹åŠ¿æ˜¯å‡½æ•°å¼è¯­è¨€å’ŒåŠ¨æ€è¯­è¨€ã€‚åœ¨ Java ä¸­ç±»ï¼ˆclassï¼‰æ˜¯ä¸€ç­‰å…¬æ°‘ï¼Œè€Œ JavaScript ä¸­å‡½æ•°ï¼ˆfunctionï¼‰æ˜¯ä¸€ç­‰å…¬æ°‘ï¼Œå› æ­¤ JavaScript æ”¯æŒå‡½æ•°å¼ç¼–ç¨‹ï¼Œå¯ä»¥ä½¿ç”¨ Lambda å‡½æ•°å’Œé—­åŒ…ï¼ˆclosureï¼‰ï¼Œå½“ç„¶ Java 8 ä¹Ÿå¼€å§‹æ”¯æŒå‡½æ•°å¼ç¼–ç¨‹ï¼Œæä¾›äº†å¯¹ Lambda è¡¨è¾¾å¼ä»¥åŠå‡½æ•°å¼æ¥å£çš„æ”¯æŒã€‚å¯¹äºè¿™ç±»é—®é¢˜ï¼Œåœ¨é¢è¯•çš„æ—¶å€™æœ€å¥½è¿˜æ˜¯ç”¨è‡ªå·±çš„è¯­è¨€å›ç­”ä¼šæ›´åŠ é è°±ï¼Œä¸è¦èƒŒç½‘ä¸Šæ‰€è°“çš„æ ‡å‡†ç­”æ¡ˆã€‚</p>
<blockquote>
<p>44ã€ä»€ä¹ˆæ—¶å€™ç”¨æ–­è¨€ï¼ˆassertï¼‰ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šæ–­è¨€åœ¨è½¯ä»¶å¼€å‘ä¸­æ˜¯ä¸€ç§å¸¸ç”¨çš„è°ƒè¯•æ–¹å¼ï¼Œå¾ˆå¤šå¼€å‘è¯­è¨€ä¸­éƒ½æ”¯æŒè¿™ç§æœºåˆ¶ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œæ–­è¨€ç”¨äºä¿è¯ç¨‹åºæœ€åŸºæœ¬ã€å…³é”®çš„æ­£ç¡®æ€§ã€‚æ–­è¨€æ£€æŸ¥é€šå¸¸åœ¨å¼€å‘å’Œæµ‹è¯•æ—¶å¼€å¯ã€‚ä¸ºäº†ä¿è¯ç¨‹åºçš„æ‰§è¡Œæ•ˆç‡ï¼Œåœ¨è½¯ä»¶å‘å¸ƒåæ–­è¨€æ£€æŸ¥é€šå¸¸æ˜¯å…³é—­çš„ã€‚æ–­è¨€æ˜¯ä¸€ä¸ªåŒ…å«å¸ƒå°”è¡¨è¾¾å¼çš„è¯­å¥ï¼Œåœ¨æ‰§è¡Œè¿™ä¸ªè¯­å¥æ—¶å‡å®šè¯¥è¡¨è¾¾å¼ä¸º <code>true</code>ï¼›å¦‚æœè¡¨è¾¾å¼çš„å€¼ä¸º <code>false</code>ï¼Œé‚£ä¹ˆç³»ç»Ÿä¼šæŠ¥å‘Šä¸€ä¸ª AssertionErrorã€‚æ–­è¨€çš„ä½¿ç”¨å¦‚ä¸‹é¢çš„ä»£ç æ‰€ç¤ºï¼š</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">assert</span>(a &gt; <span class="hljs-number">0</span>); <span class="hljs-comment">// throws an AssertionError if a &lt;= 0</span><br></code></pre></td></tr></table></figure>
</p>
<p>æ–­è¨€å¯ä»¥æœ‰ä¸¤ç§å½¢å¼ï¼š</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">assert</span> Expression1;<br><span class="hljs-keyword">assert</span> Expression1 : Expression2 ;<br></code></pre></td></tr></table></figure>
</p>
<p>Expression1 åº”è¯¥æ€»æ˜¯äº§ç”Ÿä¸€ä¸ªå¸ƒå°”å€¼ã€‚
Expression2 å¯ä»¥æ˜¯å¾—å‡ºä¸€ä¸ªå€¼çš„ä»»æ„è¡¨è¾¾å¼ï¼›è¿™ä¸ªå€¼ç”¨äºç”Ÿæˆæ˜¾ç¤ºæ›´å¤šè°ƒè¯•ä¿¡æ¯çš„å­—ç¬¦ä¸²æ¶ˆæ¯ã€‚</p>
<p>è¦åœ¨è¿è¡Œæ—¶å¯ç”¨æ–­è¨€ï¼Œå¯ä»¥åœ¨å¯åŠ¨ JVM æ—¶ä½¿ç”¨ <code>-enableassertions</code> æˆ–è€… <code>-ea</code> æ ‡è®°ã€‚è¦åœ¨è¿è¡Œæ—¶é€‰æ‹©ç¦ç”¨æ–­è¨€ï¼Œå¯ä»¥åœ¨å¯åŠ¨ JVM æ—¶ä½¿ç”¨ <code>-da</code> æˆ–è€… <code>-disableassertions</code> æ ‡è®°ã€‚è¦åœ¨ç³»ç»Ÿç±»ä¸­å¯ç”¨æˆ–ç¦ç”¨æ–­è¨€ï¼Œå¯ä½¿ç”¨ <code>-esa</code> æˆ– <code>-dsa</code> æ ‡è®°ã€‚è¿˜å¯ä»¥åœ¨åŒ…çš„åŸºç¡€ä¸Šå¯ç”¨æˆ–è€…ç¦ç”¨æ–­è¨€ã€‚</p>
<p><strong>æ³¨æ„ï¼š</strong>æ–­è¨€ä¸åº”è¯¥ä»¥ä»»ä½•æ–¹å¼æ”¹å˜ç¨‹åºçš„çŠ¶æ€ã€‚ç®€å•çš„è¯´ï¼Œå¦‚æœå¸Œæœ›åœ¨ä¸æ»¡è¶³æŸäº›æ¡ä»¶æ—¶é˜»æ­¢ä»£ç çš„æ‰§è¡Œï¼Œå°±å¯ä»¥è€ƒè™‘ç”¨æ–­è¨€æ¥é˜»æ­¢å®ƒã€‚</p>
<blockquote>
<p>45ã€Error å’Œ Exceptionæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼š</p>
<ul>
<li>Error è¡¨ç¤ºç³»ç»Ÿçº§çš„é”™è¯¯å’Œç¨‹åºä¸å¿…å¤„ç†çš„å¼‚å¸¸ï¼Œæ˜¯æ¢å¤ä¸æ˜¯ä¸å¯èƒ½ä½†å¾ˆå›°éš¾çš„æƒ…å†µä¸‹çš„ä¸€ç§ä¸¥é‡é—®é¢˜ï¼›æ¯”å¦‚å†…å­˜æº¢å‡ºï¼Œä¸å¯èƒ½æŒ‡æœ›ç¨‹åºèƒ½å¤„ç†è¿™æ ·çš„æƒ…å†µï¼›</li>
<li>Exception è¡¨ç¤ºéœ€è¦æ•æ‰æˆ–è€…éœ€è¦ç¨‹åºè¿›è¡Œå¤„ç†çš„å¼‚å¸¸ï¼Œæ˜¯ä¸€ç§è®¾è®¡æˆ–å®ç°é—®é¢˜ï¼›ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒè¡¨ç¤ºå¦‚æœç¨‹åºè¿è¡Œæ­£å¸¸ï¼Œä»ä¸ä¼šå‘ç”Ÿçš„æƒ…å†µã€‚</li>
</ul>
<p>é¢è¯•é¢˜ï¼š2005 å¹´æ‘©æ‰˜ç½—æ‹‰çš„é¢è¯•ä¸­æ›¾ç»é—®è¿‡è¿™ä¹ˆä¸€ä¸ªé—®é¢˜â€œIf a process reports a stack overflow run-time error, whatâ€™s the most possible cause?â€ï¼Œç»™äº†å››ä¸ªé€‰é¡¹ a. lack of memory; b. write on an invalid memory space; c. recursive function calling; d. array index out of boundary. Java ç¨‹åºåœ¨è¿è¡Œæ—¶ä¹Ÿå¯èƒ½ä¼šé­é‡ StackOverflowErrorï¼Œè¿™æ˜¯ä¸€ä¸ªæ— æ³•æ¢å¤çš„é”™è¯¯ï¼Œåªèƒ½é‡æ–°ä¿®æ”¹ä»£ç äº†ï¼Œè¿™ä¸ªé¢è¯•é¢˜çš„ç­”æ¡ˆæ˜¯ cã€‚å¦‚æœå†™äº†ä¸èƒ½è¿…é€Ÿæ”¶æ•›çš„é€’å½’ï¼Œåˆ™å¾ˆæœ‰å¯èƒ½å¼•å‘æ ˆæº¢å‡ºçš„é”™è¯¯ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">StackOverflowErrorTest</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        main(<span class="hljs-keyword">null</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<p><strong>æ³¨æ„ï¼š</strong>ç”¨é€’å½’ç¼–å†™ç¨‹åºæ—¶ä¸€å®šè¦ç‰¢è®°ä¸¤ç‚¹ï¼š1. é€’å½’å…¬å¼ï¼›2. æ”¶æ•›æ¡ä»¶ï¼ˆä»€ä¹ˆæ—¶å€™å°±ä¸å†ç»§ç»­é€’å½’ï¼‰ã€‚</p>
<blockquote>
<p>46ã€<code>try&#123;&#125;</code> é‡Œæœ‰ä¸€ä¸ª <code>return</code> è¯­å¥ï¼Œé‚£ä¹ˆç´§è·Ÿåœ¨è¿™ä¸ª <code>try</code> åçš„ <code>finally&#123;&#125;</code> é‡Œçš„ä»£ç ä¼šä¸ä¼šè¢«æ‰§è¡Œï¼Œä»€ä¹ˆæ—¶å€™è¢«æ‰§è¡Œï¼Œåœ¨ <code>return</code> å‰è¿˜æ˜¯å?</p>
</blockquote>
<p>ç­”ï¼šä¼šæ‰§è¡Œï¼Œåœ¨æ–¹æ³•è¿”å›è°ƒç”¨è€…å‰æ‰§è¡Œã€‚</p>
<p><strong>æ³¨æ„ï¼š</strong>åœ¨ <code>finally</code> ä¸­æ”¹å˜è¿”å›å€¼çš„åšæ³•æ˜¯ä¸å¥½çš„ï¼Œå› ä¸ºå¦‚æœå­˜åœ¨ <code>finally</code> ä»£ç å—ï¼Œ<code>try</code> ä¸­çš„ <code>return</code> è¯­å¥ä¸ä¼šç«‹é©¬è¿”å›è°ƒç”¨è€…ï¼Œè€Œæ˜¯è®°å½•ä¸‹è¿”å›å€¼å¾… <code>finally</code> ä»£ç å—æ‰§è¡Œå®Œæ¯•ä¹‹åå†å‘è°ƒç”¨è€…è¿”å›å…¶å€¼ï¼Œç„¶åå¦‚æœåœ¨ <code>finally</code> ä¸­ä¿®æ”¹äº†è¿”å›å€¼ï¼Œå°±ä¼šè¿”å›ä¿®æ”¹åçš„å€¼ã€‚æ˜¾ç„¶ï¼Œåœ¨ <code>finally</code> ä¸­è¿”å›æˆ–è€…ä¿®æ”¹è¿”å›å€¼ä¼šå¯¹ç¨‹åºé€ æˆå¾ˆå¤§çš„å›°æ‰°ï¼ŒC# ä¸­ç›´æ¥ç”¨ç¼–è¯‘é”™è¯¯çš„æ–¹å¼æ¥é˜»æ­¢ç¨‹åºå‘˜å¹²è¿™ç§é¾Œé¾Šçš„äº‹æƒ…ï¼ŒJava ä¸­ä¹Ÿå¯ä»¥é€šè¿‡æå‡ç¼–è¯‘å™¨çš„è¯­æ³•æ£€æŸ¥çº§åˆ«æ¥äº§ç”Ÿè­¦å‘Šæˆ–é”™è¯¯ï¼ŒEclipse ä¸­å¯ä»¥åœ¨å¦‚å›¾æ‰€ç¤ºçš„åœ°æ–¹è¿›è¡Œè®¾ç½®ï¼Œå¼ºçƒˆå»ºè®®å°†æ­¤é¡¹è®¾ç½®ä¸ºç¼–è¯‘é”™è¯¯ã€‚</p>
<p><img src= "https://cdn.jsdelivr.net/gh/Eurkon/CDN/hexo/images/user/loading.gif" data-lazy-src="/images/post/java_interview/46.png" alt></p>
<blockquote>
<p>47ã€Java è¯­è¨€å¦‚ä½•è¿›è¡Œå¼‚å¸¸å¤„ç†ï¼Œå…³é”®å­—ï¼š<code>throws</code>ã€<code>throw</code>ã€<code>try</code>ã€<code>catch</code>ã€<code>finally</code> åˆ†åˆ«å¦‚ä½•ä½¿ç”¨ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šJava é€šè¿‡é¢å‘å¯¹è±¡çš„æ–¹æ³•è¿›è¡Œå¼‚å¸¸å¤„ç†ï¼ŒæŠŠå„ç§ä¸åŒçš„å¼‚å¸¸è¿›è¡Œåˆ†ç±»ï¼Œå¹¶æä¾›äº†è‰¯å¥½çš„æ¥å£ã€‚åœ¨ Java ä¸­ï¼Œæ¯ä¸ªå¼‚å¸¸éƒ½æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒæ˜¯ <code>Throwable</code> ç±»æˆ–å…¶å­ç±»çš„å®ä¾‹ã€‚å½“ä¸€ä¸ªæ–¹æ³•å‡ºç°å¼‚å¸¸åä¾¿æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸å¯¹è±¡ï¼Œè¯¥å¯¹è±¡ä¸­åŒ…å«æœ‰å¼‚å¸¸ä¿¡æ¯ï¼Œè°ƒç”¨è¿™ä¸ªå¯¹è±¡çš„æ–¹æ³•å¯ä»¥æ•è·åˆ°è¿™ä¸ªå¼‚å¸¸å¹¶å¯ä»¥å¯¹å…¶è¿›è¡Œå¤„ç†ã€‚</p>
<p>Java çš„å¼‚å¸¸å¤„ç†æ˜¯é€šè¿‡5ä¸ªå…³é”®è¯æ¥å®ç°çš„ï¼š<code>try</code>ã€<code>catch</code>ã€<code>throw</code>ã€<code>throws</code> å’Œ <code>finally</code>ã€‚</p>
<p>ä¸€èˆ¬æƒ…å†µä¸‹æ˜¯ç”¨ <code>try</code> æ¥æ‰§è¡Œä¸€æ®µç¨‹åºï¼Œå¦‚æœç³»ç»Ÿä¼šæŠ›å‡ºï¼ˆthrowï¼‰ä¸€ä¸ªå¼‚å¸¸å¯¹è±¡ï¼Œå¯ä»¥é€šè¿‡å®ƒçš„ç±»å‹æ¥æ•è·ï¼ˆcatchï¼‰å®ƒï¼Œæˆ–é€šè¿‡æ€»æ˜¯æ‰§è¡Œä»£ç å—ï¼ˆfinallyï¼‰æ¥å¤„ç†ï¼›<code>try</code> ç”¨æ¥æŒ‡å®šä¸€å—é¢„é˜²æ‰€æœ‰å¼‚å¸¸çš„ç¨‹åºï¼›<code>catch</code> å­å¥ç´§è·Ÿåœ¨ <code>try</code> å—åé¢ï¼Œç”¨æ¥æŒ‡å®šä½ æƒ³è¦æ•è·çš„å¼‚å¸¸çš„ç±»å‹ï¼›<code>throw</code> è¯­å¥ç”¨æ¥æ˜ç¡®åœ°æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ï¼›<code>throws</code> ç”¨æ¥å£°æ˜ä¸€ä¸ªæ–¹æ³•å¯èƒ½æŠ›å‡ºçš„å„ç§å¼‚å¸¸ï¼ˆå½“ç„¶å£°æ˜å¼‚å¸¸æ—¶å…è®¸æ— ç—…å‘»åŸï¼‰ï¼›<code>finally</code> ä¸ºç¡®ä¿ä¸€æ®µä»£ç ä¸ç®¡å‘ç”Ÿä»€ä¹ˆå¼‚å¸¸çŠ¶å†µéƒ½è¦è¢«æ‰§è¡Œï¼›<code>try</code> è¯­å¥å¯ä»¥åµŒå¥—ï¼Œæ¯å½“é‡åˆ°ä¸€ä¸ª <code>try</code> è¯­å¥ï¼Œå¼‚å¸¸çš„ç»“æ„å°±ä¼šè¢«æ”¾å…¥å¼‚å¸¸æ ˆä¸­ï¼Œç›´åˆ°æ‰€æœ‰çš„ <code>try</code> è¯­å¥éƒ½å®Œæˆã€‚å¦‚æœä¸‹ä¸€çº§çš„ <code>try</code> è¯­å¥æ²¡æœ‰å¯¹æŸç§å¼‚å¸¸è¿›è¡Œå¤„ç†ï¼Œå¼‚å¸¸æ ˆå°±ä¼šæ‰§è¡Œå‡ºæ ˆæ“ä½œï¼Œç›´åˆ°é‡åˆ°æœ‰å¤„ç†è¿™ç§å¼‚å¸¸çš„ <code>try</code> è¯­å¥æˆ–è€…æœ€ç»ˆå°†å¼‚å¸¸æŠ›ç»™ JVMã€‚</p>
<blockquote>
<p>48ã€è¿è¡Œæ—¶å¼‚å¸¸ä¸å—æ£€å¼‚å¸¸æœ‰ä½•å¼‚åŒï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šå¼‚å¸¸è¡¨ç¤ºç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­å¯èƒ½å‡ºç°çš„éæ­£å¸¸çŠ¶æ€ï¼Œè¿è¡Œæ—¶å¼‚å¸¸è¡¨ç¤ºè™šæ‹Ÿæœºçš„é€šå¸¸æ“ä½œä¸­å¯èƒ½é‡åˆ°çš„å¼‚å¸¸ï¼Œæ˜¯ä¸€ç§å¸¸è§è¿è¡Œé”™è¯¯ï¼Œåªè¦ç¨‹åºè®¾è®¡å¾—æ²¡æœ‰é—®é¢˜é€šå¸¸å°±ä¸ä¼šå‘ç”Ÿã€‚å—æ£€å¼‚å¸¸è·Ÿç¨‹åºè¿è¡Œçš„ä¸Šä¸‹æ–‡ç¯å¢ƒæœ‰å…³ï¼Œå³ä½¿ç¨‹åºè®¾è®¡æ— è¯¯ï¼Œä»ç„¶å¯èƒ½å› ä½¿ç”¨çš„é—®é¢˜è€Œå¼•å‘ã€‚Java ç¼–è¯‘å™¨è¦æ±‚æ–¹æ³•å¿…é¡»å£°æ˜æŠ›å‡ºå¯èƒ½å‘ç”Ÿçš„å—æ£€å¼‚å¸¸ï¼Œä½†æ˜¯å¹¶ä¸è¦æ±‚å¿…é¡»å£°æ˜æŠ›å‡ºæœªè¢«æ•è·çš„è¿è¡Œæ—¶å¼‚å¸¸ã€‚å¼‚å¸¸å’Œç»§æ‰¿ä¸€æ ·ï¼Œæ˜¯é¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡ä¸­ç»å¸¸è¢«æ»¥ç”¨çš„ä¸œè¥¿ï¼Œåœ¨ã€ŠEffective Javaã€‹ä¸­å¯¹å¼‚å¸¸çš„ä½¿ç”¨ç»™å‡ºäº†ä»¥ä¸‹æŒ‡å¯¼åŸåˆ™ï¼š</p>
<ul>
<li>ä¸è¦å°†å¼‚å¸¸å¤„ç†ç”¨äºæ­£å¸¸çš„æ§åˆ¶æµï¼ˆè®¾è®¡è‰¯å¥½çš„ API ä¸åº”è¯¥å¼ºè¿«å®ƒçš„è°ƒç”¨è€…ä¸ºäº†æ­£å¸¸çš„æ§åˆ¶æµè€Œä½¿ç”¨å¼‚å¸¸ï¼‰</li>
<li>å¯¹å¯ä»¥æ¢å¤çš„æƒ…å†µä½¿ç”¨å—æ£€å¼‚å¸¸ï¼Œå¯¹ç¼–ç¨‹é”™è¯¯ä½¿ç”¨è¿è¡Œæ—¶å¼‚å¸¸</li>
<li>é¿å…ä¸å¿…è¦çš„ä½¿ç”¨å—æ£€å¼‚å¸¸ï¼ˆå¯ä»¥é€šè¿‡ä¸€äº›çŠ¶æ€æ£€æµ‹æ‰‹æ®µæ¥é¿å…å¼‚å¸¸çš„å‘ç”Ÿï¼‰</li>
<li>ä¼˜å…ˆä½¿ç”¨æ ‡å‡†çš„å¼‚å¸¸</li>
<li>æ¯ä¸ªæ–¹æ³•æŠ›å‡ºçš„å¼‚å¸¸éƒ½è¦æœ‰æ–‡æ¡£</li>
<li>ä¿æŒå¼‚å¸¸çš„åŸå­æ€§</li>
<li>ä¸è¦åœ¨ <code>catch</code> ä¸­å¿½ç•¥æ‰æ•è·åˆ°çš„å¼‚å¸¸</li>
</ul>
<blockquote>
<p>49ã€åˆ—å‡ºä¸€äº›ä½ å¸¸è§çš„è¿è¡Œæ—¶å¼‚å¸¸ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼š</p>
<ul>
<li><code>ArithmeticException</code>ï¼šç®—æœ¯å¼‚å¸¸</li>
<li><code>ClassCastException</code>ï¼šç±»è½¬æ¢å¼‚å¸¸</li>
<li><code>IllegalArgumentException</code>ï¼šéæ³•å‚æ•°å¼‚å¸¸</li>
<li><code>IndexOutOfBoundsException</code>ï¼šä¸‹æ ‡è¶Šç•Œå¼‚å¸¸</li>
<li><code>NullPointerException</code>ï¼šç©ºæŒ‡é’ˆå¼‚å¸¸</li>
<li><code>SecurityException</code>ï¼šå®‰å…¨å¼‚å¸¸</li>
</ul>
<blockquote>
<p>50ã€é˜è¿° <code>final</code>ã€<code>finally</code>ã€<code>finalize</code> çš„åŒºåˆ«ã€‚</p>
</blockquote>
<p>ç­”ï¼š</p>
<ul>
<li><code>final</code>ï¼šä¿®é¥°ç¬¦ï¼ˆå…³é”®å­—ï¼‰æœ‰ä¸‰ç§ç”¨æ³•ï¼šå¦‚æœä¸€ä¸ªç±»è¢«å£°æ˜ä¸º <code>final</code>ï¼Œæ„å‘³ç€å®ƒä¸èƒ½å†æ´¾ç”Ÿå‡ºæ–°çš„å­ç±»ï¼Œå³ä¸èƒ½è¢«ç»§æ‰¿ï¼Œå› æ­¤å®ƒå’Œ <code>abstract</code> æ˜¯åä¹‰è¯ã€‚å°†å˜é‡å£°æ˜ä¸º <code>final</code>ï¼Œå¯ä»¥ä¿è¯å®ƒä»¬åœ¨ä½¿ç”¨ä¸­ä¸è¢«æ”¹å˜ï¼Œè¢«å£°æ˜ä¸º <code>final</code> çš„å˜é‡å¿…é¡»åœ¨å£°æ˜æ—¶ç»™å®šåˆå€¼ï¼Œè€Œåœ¨ä»¥åçš„å¼•ç”¨ä¸­åªèƒ½è¯»å–ä¸å¯ä¿®æ”¹ã€‚è¢«å£°æ˜ä¸º <code>final</code> çš„æ–¹æ³•ä¹ŸåŒæ ·åªèƒ½ä½¿ç”¨ï¼Œä¸èƒ½åœ¨å­ç±»ä¸­è¢«é‡å†™ã€‚</li>
<li><code>finally</code>ï¼šé€šå¸¸æ”¾åœ¨ <code>tryâ€¦catchâ€¦</code> çš„åé¢æ„é€ æ€»æ˜¯æ‰§è¡Œä»£ç å—ï¼Œè¿™å°±æ„å‘³ç€ç¨‹åºæ— è®ºæ­£å¸¸æ‰§è¡Œè¿˜æ˜¯å‘ç”Ÿå¼‚å¸¸ï¼Œè¿™é‡Œçš„ä»£ç åªè¦ JVM ä¸å…³é—­éƒ½èƒ½æ‰§è¡Œï¼Œå¯ä»¥å°†é‡Šæ”¾å¤–éƒ¨èµ„æºçš„ä»£ç å†™åœ¨ <code>finally</code> å—ä¸­ã€‚</li>
<li><code>finalize</code>ï¼š<code>Object</code> ç±»ä¸­å®šä¹‰çš„æ–¹æ³•ï¼ŒJava ä¸­å…è®¸ä½¿ç”¨ <code>finalize()</code> æ–¹æ³•åœ¨åƒåœ¾æ”¶é›†å™¨å°†å¯¹è±¡ä»å†…å­˜ä¸­æ¸…é™¤å‡ºå»ä¹‹å‰åšå¿…è¦çš„æ¸…ç†å·¥ä½œã€‚è¿™ä¸ªæ–¹æ³•æ˜¯ç”±åƒåœ¾æ”¶é›†å™¨åœ¨é”€æ¯å¯¹è±¡æ—¶è°ƒç”¨çš„ï¼Œé€šè¿‡é‡å†™ <code>finalize()</code> æ–¹æ³•å¯ä»¥æ•´ç†ç³»ç»Ÿèµ„æºæˆ–è€…æ‰§è¡Œå…¶ä»–æ¸…ç†å·¥ä½œã€‚</li>
</ul>
<blockquote>
<p>51ã€ç±» <code>ExampleA</code> ç»§æ‰¿ <code>Exception</code>ï¼Œç±» <code>ExampleB</code> ç»§æ‰¿ <code>ExampleA</code>ã€‚æœ‰å¦‚ä¸‹ä»£ç ç‰‡æ®µï¼š</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">try</span> &#123;<br>    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ExampleB(<span class="hljs-string">&quot;b&quot;</span>)<br>&#125; <span class="hljs-keyword">catch</span>(ExampleA e)&#123;<br>    System.out.println(<span class="hljs-string">&quot;ExampleA&quot;</span>);<br>&#125; <span class="hljs-keyword">catch</span>(Exception e)&#123;<br>    System.out.println(<span class="hljs-string">&quot;Exception&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<p>è¯·é—®æ‰§è¡Œæ­¤æ®µä»£ç çš„è¾“å‡ºæ˜¯ä»€ä¹ˆï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šè¾“å‡ºï¼š<code>ExampleA</code>ã€‚æ ¹æ®é‡Œæ°ä»£æ¢åŸåˆ™ï¼ˆèƒ½ä½¿ç”¨çˆ¶ç±»å‹çš„åœ°æ–¹ä¸€å®šèƒ½ä½¿ç”¨å­ç±»å‹ï¼‰ï¼ŒæŠ“å–<code>ExampleA</code> ç±»å‹å¼‚å¸¸çš„ <code>catch</code> å—èƒ½å¤ŸæŠ“ä½ <code>try</code> å—ä¸­æŠ›å‡ºçš„ <code>ExampleB</code> ç±»å‹çš„å¼‚å¸¸ã€‚</p>
<p>é¢è¯•é¢˜ - è¯´å‡ºä¸‹é¢ä»£ç çš„è¿è¡Œç»“æœã€‚ï¼ˆæ­¤é¢˜çš„å‡ºå¤„æ˜¯ã€ŠJavaç¼–ç¨‹æ€æƒ³ã€‹ä¸€ä¹¦ï¼‰</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Annoyance</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Exception</span> </span>&#123;&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Sneeze</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Annoyance</span> </span>&#123;&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Human</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span><br><span class="hljs-function">        <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> Sneeze();<br>            &#125; <br>            <span class="hljs-keyword">catch</span> ( Annoyance a ) &#123;<br>                System.out.println(<span class="hljs-string">&quot;Caught Annoyance&quot;</span>);<br>                <span class="hljs-keyword">throw</span> a;<br>            &#125;<br>        &#125; <br>        <span class="hljs-keyword">catch</span> ( Sneeze s ) &#123;<br>            System.out.println(<span class="hljs-string">&quot;Caught Sneeze&quot;</span>);<br>            <span class="hljs-keyword">return</span> ;<br>        &#125;<br>        <span class="hljs-keyword">finally</span> &#123;<br>            System.out.println(<span class="hljs-string">&quot;Hello World!&quot;</span>);<br>        &#125;<br><span class="hljs-comment">//       è¾“å‡ºç»“æœï¼š</span><br><span class="hljs-comment">//       Caught Annoyance</span><br><span class="hljs-comment">//       Caught Sneeze</span><br><span class="hljs-comment">//       Hello World!</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<h1 id="Java-å®¹å™¨ï¼ˆ52-56ï¼‰"><a href="#Java-å®¹å™¨ï¼ˆ52-56ï¼‰" class="headerlink" title="Java å®¹å™¨ï¼ˆ52~56ï¼‰"></a>Java å®¹å™¨ï¼ˆ52~56ï¼‰</h1><blockquote>
<p>52ã€<code>List</code>ã€<code>Set</code>ã€<code>Map</code> æ˜¯å¦ç»§æ‰¿è‡ª <code>Collection</code> æ¥å£ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼š<code>List</code>ã€<code>Set</code> æ˜¯ï¼Œ<code>Map</code> ä¸æ˜¯ã€‚<code>Map</code> æ˜¯é”®å€¼å¯¹æ˜ å°„å®¹å™¨ï¼Œä¸ <code>List</code> å’Œ <code>Set</code> æœ‰æ˜æ˜¾çš„åŒºåˆ«ï¼Œè€Œ <code>Set</code> å­˜å‚¨çš„é›¶æ•£çš„å…ƒç´ ä¸”ä¸å…è®¸æœ‰é‡å¤å…ƒç´ ï¼ˆæ•°å­¦ä¸­çš„é›†åˆä¹Ÿæ˜¯å¦‚æ­¤ï¼‰ï¼Œ<code>List</code> æ˜¯çº¿æ€§ç»“æ„çš„å®¹å™¨ï¼Œé€‚ç”¨äºæŒ‰æ•°å€¼ç´¢å¼•è®¿é—®å…ƒç´ çš„æƒ…å½¢ã€‚</p>
<blockquote>
<p>53ã€é˜è¿° <code>ArrayList</code>ã€<code>Vector</code>ã€<code>LinkedList</code> çš„å­˜å‚¨æ€§èƒ½å’Œç‰¹æ€§ã€‚</p>
</blockquote>
<p>ç­”ï¼š</p>
<ul>
<li><p><code>ArrayList</code> å’Œ <code>Vector</code> éƒ½æ˜¯ä½¿ç”¨<strong>æ•°ç»„æ–¹å¼</strong>å­˜å‚¨æ•°æ®ï¼Œæ­¤æ•°ç»„å…ƒç´ æ•°å¤§äºå®é™…å­˜å‚¨çš„æ•°æ®ä»¥ä¾¿å¢åŠ å’Œæ’å…¥å…ƒç´ ï¼Œå®ƒä»¬éƒ½å…è®¸ç›´æ¥æŒ‰åºå·ç´¢å¼•å…ƒç´ ï¼Œä½†æ˜¯æ’å…¥å…ƒç´ è¦æ¶‰åŠæ•°ç»„å…ƒç´ ç§»åŠ¨ç­‰å†…å­˜æ“ä½œï¼Œæ‰€ä»¥ç´¢å¼•æ•°æ®å¿«è€Œæ’å…¥æ•°æ®æ…¢ï¼Œ<code>Vector</code> ä¸­çš„æ–¹æ³•ç”±äºæ·»åŠ äº† <code>synchronized</code> ä¿®é¥°ï¼Œå› æ­¤ <code>Vector</code> æ˜¯<strong>çº¿ç¨‹å®‰å…¨</strong>çš„å®¹å™¨ï¼Œä½†æ€§èƒ½ä¸Šè¾ƒ <code>ArrayList</code> å·®ï¼Œå› æ­¤å·²ç»æ˜¯ Java ä¸­çš„é—ç•™å®¹å™¨ã€‚</p>
</li>
<li><p><code>LinkedList</code> ä½¿ç”¨<strong>åŒå‘é“¾è¡¨</strong>å®ç°å­˜å‚¨ï¼ˆå°†å†…å­˜ä¸­é›¶æ•£çš„å†…å­˜å•å…ƒé€šè¿‡é™„åŠ çš„å¼•ç”¨å…³è”èµ·æ¥ï¼Œå½¢æˆä¸€ä¸ªå¯ä»¥æŒ‰åºå·ç´¢å¼•çš„çº¿æ€§ç»“æ„ï¼Œè¿™ç§é“¾å¼å­˜å‚¨æ–¹å¼ä¸æ•°ç»„çš„è¿ç»­å­˜å‚¨æ–¹å¼ç›¸æ¯”ï¼Œå†…å­˜çš„åˆ©ç”¨ç‡æ›´é«˜ï¼‰ï¼ŒæŒ‰åºå·ç´¢å¼•æ•°æ®éœ€è¦è¿›è¡Œå‰å‘æˆ–åå‘éå†ï¼Œä½†æ˜¯æ’å…¥æ•°æ®æ—¶åªéœ€è¦è®°å½•æœ¬é¡¹çš„å‰åé¡¹å³å¯ï¼Œæ‰€ä»¥æ’å…¥é€Ÿåº¦è¾ƒå¿«ã€‚</p>
</li>
<li><p><code>Vector</code> å±äºé—ç•™å®¹å™¨ï¼ˆJava æ—©æœŸçš„ç‰ˆæœ¬ä¸­æä¾›çš„å®¹å™¨ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œ<code>Hashtable</code>ã€<code>Dictionary</code>ã€<code>BitSet</code>ã€<code>Stack</code>ã€<code>Properties</code> éƒ½æ˜¯é—ç•™å®¹å™¨ï¼‰ï¼Œå·²ç»ä¸æ¨èä½¿ç”¨ï¼Œä½†æ˜¯ç”±äº <code>ArrayList</code> å’Œ <code>LinkedListed</code> éƒ½æ˜¯<strong>éçº¿ç¨‹å®‰å…¨</strong>çš„ï¼Œå¦‚æœé‡åˆ°å¤šä¸ªçº¿ç¨‹æ“ä½œåŒä¸€ä¸ªå®¹å™¨çš„åœºæ™¯ï¼Œåˆ™å¯ä»¥é€šè¿‡å·¥å…·ç±» <code>Collections</code> ä¸­çš„ <code>synchronizedList</code> æ–¹æ³•å°†å…¶è½¬æ¢æˆçº¿ç¨‹å®‰å…¨çš„å®¹å™¨åå†ä½¿ç”¨ï¼ˆè¿™æ˜¯å¯¹è£…æ½¢æ¨¡å¼çš„åº”ç”¨ï¼Œå°†å·²æœ‰å¯¹è±¡ä¼ å…¥å¦ä¸€ä¸ªç±»çš„æ„é€ å™¨ä¸­åˆ›å»ºæ–°çš„å¯¹è±¡æ¥å¢å¼ºå®ç°ï¼‰ã€‚</p>
</li>
</ul>
<p><strong>è¡¥å……ï¼š</strong>é—ç•™å®¹å™¨ä¸­çš„ <code>Properties</code> ç±»å’Œ <code>Stack</code> ç±»åœ¨è®¾è®¡ä¸Šæœ‰ä¸¥é‡çš„é—®é¢˜ï¼Œ<code>Properties</code> æ˜¯ä¸€ä¸ªé”®å’Œå€¼éƒ½æ˜¯å­—ç¬¦ä¸²çš„ç‰¹æ®Šçš„é”®å€¼å¯¹æ˜ å°„ï¼Œåœ¨è®¾è®¡ä¸Šåº”è¯¥æ˜¯å…³è”ä¸€ä¸ª <code>Hashtable</code> å¹¶å°†å…¶ä¸¤ä¸ªæ³›å‹å‚æ•°è®¾ç½®ä¸º <code>String</code> ç±»å‹ï¼Œä½†æ˜¯ Java API ä¸­çš„ <code>Properties</code> ç›´æ¥ç»§æ‰¿äº† <code>Hashtable</code>ï¼Œè¿™å¾ˆæ˜æ˜¾æ˜¯å¯¹ç»§æ‰¿çš„æ»¥ç”¨ã€‚è¿™é‡Œå¤ç”¨ä»£ç çš„æ–¹å¼åº”è¯¥æ˜¯ Has-A å…³ç³»è€Œä¸æ˜¯ Is-A å…³ç³»ï¼Œå¦ä¸€æ–¹é¢å®¹å™¨éƒ½å±äºå·¥å…·ç±»ï¼Œç»§æ‰¿å·¥å…·ç±»æœ¬èº«å°±æ˜¯ä¸€ä¸ªé”™è¯¯çš„åšæ³•ï¼Œä½¿ç”¨å·¥å…·ç±»æœ€å¥½çš„æ–¹å¼æ˜¯ Has-A å…³ç³»ï¼ˆå…³è”ï¼‰æˆ– Use-A å…³ç³»ï¼ˆä¾èµ–ï¼‰ã€‚åŒç†ï¼Œ<code>Stack</code> ç±»ç»§æ‰¿ <code>Vector</code> ä¹Ÿæ˜¯ä¸æ­£ç¡®çš„ã€‚Sun å…¬å¸çš„å·¥ç¨‹å¸ˆä»¬ä¹Ÿä¼šçŠ¯è¿™ç§ä½çº§é”™è¯¯ï¼Œè®©äººå”å˜˜ä¸å·²ã€‚</p>
<blockquote>
<p>54ã€<code>Collection</code> å’Œ <code>Collections</code> çš„åŒºåˆ«ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼š<code>Collection</code> æ˜¯ä¸€ä¸ªæ¥å£ï¼Œå®ƒæ˜¯ <code>Set</code>ã€<code>List</code> ç­‰å®¹å™¨çš„çˆ¶æ¥å£ï¼›<code>Collections</code> æ˜¯ä¸ªä¸€ä¸ªå·¥å…·ç±»ï¼Œæä¾›äº†ä¸€ç³»åˆ—çš„é™æ€æ–¹æ³•æ¥è¾…åŠ©å®¹å™¨æ“ä½œï¼Œè¿™äº›æ–¹æ³•åŒ…æ‹¬å¯¹å®¹å™¨çš„æœç´¢ã€æ’åºã€çº¿ç¨‹å®‰å…¨åŒ–ç­‰ç­‰ã€‚</p>
<blockquote>
<p>55ã€<code>List</code>ã€<code>Map</code>ã€<code>Set</code> ä¸‰ä¸ªæ¥å£å­˜å–å…ƒç´ æ—¶ï¼Œå„æœ‰ä»€ä¹ˆç‰¹ç‚¹ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼š<code>List</code> ä»¥ç‰¹å®šç´¢å¼•æ¥å­˜å–å…ƒç´ ï¼Œå¯ä»¥æœ‰é‡å¤å…ƒç´ ã€‚<code>Set</code> ä¸èƒ½å­˜æ”¾é‡å¤å…ƒç´ ï¼ˆç”¨å¯¹è±¡çš„ <code>equals()</code> æ–¹æ³•æ¥åŒºåˆ†å…ƒç´ æ˜¯å¦é‡å¤ï¼‰ã€‚<code>Map</code> ä¿å­˜é”®å€¼å¯¹ï¼ˆkey-value pairï¼‰æ˜ å°„ï¼Œæ˜ å°„å…³ç³»å¯ä»¥æ˜¯ä¸€å¯¹ä¸€æˆ–å¤šå¯¹ä¸€ã€‚<code>Set</code> å’Œ <code>Map</code> å®¹å™¨éƒ½æœ‰åŸºäºå“ˆå¸Œå­˜å‚¨å’Œæ’åºæ ‘çš„ä¸¤ç§å®ç°ç‰ˆæœ¬ï¼ŒåŸºäºå“ˆå¸Œå­˜å‚¨çš„ç‰ˆæœ¬ç†è®ºå­˜å–æ—¶é—´å¤æ‚åº¦ä¸º <code>O(1)</code>ï¼Œè€ŒåŸºäºæ’åºæ ‘ç‰ˆæœ¬çš„å®ç°åœ¨æ’å…¥æˆ–åˆ é™¤å…ƒç´ æ—¶ä¼šæŒ‰ç…§å…ƒç´ æˆ–å…ƒç´ çš„é”®ï¼ˆkeyï¼‰æ„æˆæ’åºæ ‘ä»è€Œè¾¾åˆ°æ’åºå’Œå»é‡çš„æ•ˆæœã€‚</p>
<blockquote>
<p>56ã€<code>TreeMap</code> å’Œ <code>TreeSet</code> åœ¨æ’åºæ—¶å¦‚ä½•æ¯”è¾ƒå…ƒç´ ï¼Ÿ<code>Collections</code>å·¥å…·ç±»ä¸­çš„<code>sort()</code>æ–¹æ³•å¦‚ä½•æ¯”è¾ƒå…ƒç´ ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼š<code>TreeSet</code> è¦æ±‚å­˜æ”¾çš„å¯¹è±¡æ‰€å±çš„ç±»å¿…é¡»å®ç° <code>Comparable</code> æ¥å£ï¼Œè¯¥æ¥å£æä¾›äº†æ¯”è¾ƒå…ƒç´ çš„ <code>compareTo()</code> æ–¹æ³•ï¼Œå½“æ’å…¥å…ƒç´ æ—¶ä¼šå›è°ƒè¯¥æ–¹æ³•æ¯”è¾ƒå…ƒç´ çš„å¤§å°ã€‚<code>TreeMap</code> è¦æ±‚å­˜æ”¾çš„é”®å€¼å¯¹æ˜ å°„çš„é”®å¿…é¡»å®ç° <code>Comparable</code> æ¥å£ä»è€Œæ ¹æ®é”®å¯¹å…ƒç´ è¿›è¡Œæ’åºã€‚<code>Collections</code> å·¥å…·ç±»çš„ <code>sort()</code> æ–¹æ³•æœ‰ä¸¤ç§é‡è½½çš„å½¢å¼ï¼Œç¬¬ä¸€ç§è¦æ±‚ä¼ å…¥çš„å¾…æ’åºå®¹å™¨ä¸­å­˜æ”¾çš„å¯¹è±¡æ¯”è¾ƒå®ç° <code>Comparable</code> æ¥å£ä»¥å®ç°å…ƒç´ çš„æ¯”è¾ƒï¼›ç¬¬äºŒç§ä¸å¼ºåˆ¶æ€§çš„è¦æ±‚å®¹å™¨ä¸­çš„å…ƒç´ å¿…é¡»å¯æ¯”è¾ƒï¼Œä½†æ˜¯è¦æ±‚ä¼ å…¥ç¬¬äºŒä¸ªå‚æ•°ï¼Œå‚æ•°æ˜¯ <code>Comparator</code> æ¥å£çš„å­ç±»å‹ï¼ˆéœ€è¦é‡å†™ <code>compare</code> æ–¹æ³•å®ç°å…ƒç´ çš„æ¯”è¾ƒï¼‰ï¼Œç›¸å½“äºä¸€ä¸ªä¸´æ—¶å®šä¹‰çš„æ’åºè§„åˆ™ï¼Œå…¶å®å°±æ˜¯é€šè¿‡æ¥å£æ³¨å…¥æ¯”è¾ƒå…ƒç´ å¤§å°çš„ç®—æ³•ï¼Œä¹Ÿæ˜¯å¯¹å›è°ƒæ¨¡å¼çš„åº”ç”¨ï¼ˆJava ä¸­å¯¹å‡½æ•°å¼ç¼–ç¨‹çš„æ”¯æŒï¼‰ã€‚
ä¾‹å­1ï¼š</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Student</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Comparable</span>&lt;<span class="hljs-title">Student</span>&gt; </span>&#123;<br>    <span class="hljs-keyword">private</span> String name;        <span class="hljs-comment">// å§“å</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> age;            <span class="hljs-comment">// å¹´é¾„</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Student</span><span class="hljs-params">(String name, <span class="hljs-keyword">int</span> age)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.name = name;<br>        <span class="hljs-keyword">this</span>.age = age;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">toString</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Student [name=&quot;</span> + name + <span class="hljs-string">&quot;, age=&quot;</span> + age + <span class="hljs-string">&quot;]&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">compareTo</span><span class="hljs-params">(Student o)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.age - o.age; <span class="hljs-comment">// æ¯”è¾ƒå¹´é¾„(å¹´é¾„çš„å‡åº)</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.Set;<br><span class="hljs-keyword">import</span> java.util.TreeSet;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test01</span> </span>&#123;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        Set&lt;Student&gt; set = <span class="hljs-keyword">new</span> TreeSet&lt;&gt;();     <span class="hljs-comment">// Java 7 çš„é’»çŸ³è¯­æ³•(æ„é€ å™¨åé¢çš„å°–æ‹¬å·ä¸­ä¸éœ€è¦å†™ç±»å‹)</span><br>        set.add(<span class="hljs-keyword">new</span> Student(<span class="hljs-string">&quot;Hao LUO&quot;</span>, <span class="hljs-number">33</span>));<br>        set.add(<span class="hljs-keyword">new</span> Student(<span class="hljs-string">&quot;XJ WANG&quot;</span>, <span class="hljs-number">32</span>));<br>        set.add(<span class="hljs-keyword">new</span> Student(<span class="hljs-string">&quot;Bruce LEE&quot;</span>, <span class="hljs-number">60</span>));<br>        set.add(<span class="hljs-keyword">new</span> Student(<span class="hljs-string">&quot;Bob YANG&quot;</span>, <span class="hljs-number">22</span>));<br><br>        <span class="hljs-keyword">for</span>(Student stu : set) &#123;<br>            System.out.println(stu);<br>        &#125;<br><span class="hljs-comment">//      è¾“å‡ºç»“æœï¼š</span><br><span class="hljs-comment">//      Student [name=Bob YANG, age=22]</span><br><span class="hljs-comment">//      Student [name=XJ WANG, age=32]</span><br><span class="hljs-comment">//      Student [name=Hao LUO, age=33]</span><br><span class="hljs-comment">//      Student [name=Bruce LEE, age=60]</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<p>ä¾‹å­2ï¼š</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Student</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> String name;    <span class="hljs-comment">// å§“å</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> age;        <span class="hljs-comment">// å¹´é¾„</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Student</span><span class="hljs-params">(String name, <span class="hljs-keyword">int</span> age)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.name = name;<br>        <span class="hljs-keyword">this</span>.age = age;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * è·å–å­¦ç”Ÿå§“å</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getName</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> name;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * è·å–å­¦ç”Ÿå¹´é¾„</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getAge</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> age;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">toString</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Student [name=&quot;</span> + name + <span class="hljs-string">&quot;, age=&quot;</span> + age + <span class="hljs-string">&quot;]&quot;</span>;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.ArrayList;<br><span class="hljs-keyword">import</span> java.util.Collections;<br><span class="hljs-keyword">import</span> java.util.Comparator;<br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test02</span> </span>&#123;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        List&lt;Student&gt; list = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();     <span class="hljs-comment">// Java 7çš„é’»çŸ³è¯­æ³•(æ„é€ å™¨åé¢çš„å°–æ‹¬å·ä¸­ä¸éœ€è¦å†™ç±»å‹)</span><br>        list.add(<span class="hljs-keyword">new</span> Student(<span class="hljs-string">&quot;Hao LUO&quot;</span>, <span class="hljs-number">33</span>));<br>        list.add(<span class="hljs-keyword">new</span> Student(<span class="hljs-string">&quot;XJ WANG&quot;</span>, <span class="hljs-number">32</span>));<br>        list.add(<span class="hljs-keyword">new</span> Student(<span class="hljs-string">&quot;Bruce LEE&quot;</span>, <span class="hljs-number">60</span>));<br>        list.add(<span class="hljs-keyword">new</span> Student(<span class="hljs-string">&quot;Bob YANG&quot;</span>, <span class="hljs-number">22</span>));<br><br>        <span class="hljs-comment">// é€šè¿‡ sort æ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°ä¼ å…¥ä¸€ä¸ª Comparator æ¥å£å¯¹è±¡</span><br>        <span class="hljs-comment">// ç›¸å½“äºæ˜¯ä¼ å…¥ä¸€ä¸ªæ¯”è¾ƒå¯¹è±¡å¤§å°çš„ç®—æ³•åˆ° sort æ–¹æ³•ä¸­</span><br>        <span class="hljs-comment">// ç”±äº Java ä¸­æ²¡æœ‰å‡½æ•°æŒ‡é’ˆã€ä»¿å‡½æ•°ã€å§”æ‰˜è¿™æ ·çš„æ¦‚å¿µ</span><br>        <span class="hljs-comment">// å› æ­¤è¦å°†ä¸€ä¸ªç®—æ³•ä¼ å…¥ä¸€ä¸ªæ–¹æ³•ä¸­å”¯ä¸€çš„é€‰æ‹©å°±æ˜¯é€šè¿‡æ¥å£å›è°ƒ</span><br>        Collections.sort(list, <span class="hljs-keyword">new</span> Comparator&lt;Student&gt; () &#123;<br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">compare</span><span class="hljs-params">(Student o1, Student o2)</span> </span>&#123;<br>                <span class="hljs-keyword">return</span> o1.getName().compareTo(o2.getName());    <span class="hljs-comment">// æ¯”è¾ƒå­¦ç”Ÿå§“å</span><br>            &#125;<br>        &#125;);<br><br>        <span class="hljs-keyword">for</span>(Student stu : list) &#123;<br>            System.out.println(stu);<br>        &#125;<br><span class="hljs-comment">//      è¾“å‡ºç»“æœ: </span><br><span class="hljs-comment">//      Student [name=Bob YANG, age=22]</span><br><span class="hljs-comment">//      Student [name=Bruce LEE, age=60]</span><br><span class="hljs-comment">//      Student [name=Hao LUO, age=33]</span><br><span class="hljs-comment">//      Student [name=XJ WANG, age=32]</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<h1 id="Java-å¹¶å‘ï¼ˆ57-67ï¼‰"><a href="#Java-å¹¶å‘ï¼ˆ57-67ï¼‰" class="headerlink" title="Java å¹¶å‘ï¼ˆ57~67ï¼‰"></a>Java å¹¶å‘ï¼ˆ57~67ï¼‰</h1><blockquote>
<p>57ã€<code>Thread</code> ç±»çš„ <code>sleep()</code> æ–¹æ³•å’Œå¯¹è±¡çš„ <code>wait()</code> æ–¹æ³•éƒ½å¯ä»¥è®©çº¿ç¨‹æš‚åœæ‰§è¡Œï¼Œå®ƒä»¬æœ‰ä»€ä¹ˆåŒºåˆ«?</p>
</blockquote>
<p>ç­”ï¼š<code>sleep()</code> æ–¹æ³•ï¼ˆä¼‘çœ ï¼‰æ˜¯çº¿ç¨‹ç±» <code>Thread</code> çš„é™æ€æ–¹æ³•ï¼Œè°ƒç”¨æ­¤æ–¹æ³•ä¼šè®©å½“å‰çº¿ç¨‹æš‚åœæ‰§è¡ŒæŒ‡å®šçš„æ—¶é—´ï¼Œå°†æ‰§è¡Œæœºä¼šï¼ˆCPUï¼‰è®©ç»™å…¶ä»–çº¿ç¨‹ï¼Œä½†æ˜¯å¯¹è±¡çš„é”ä¾ç„¶ä¿æŒï¼Œå› æ­¤ä¼‘çœ æ—¶é—´ç»“æŸåä¼šè‡ªåŠ¨æ¢å¤ï¼ˆçº¿ç¨‹å›åˆ°å°±ç»ªçŠ¶æ€ï¼Œè¯·å‚è€ƒç¬¬ 66 é¢˜ä¸­çš„çº¿ç¨‹çŠ¶æ€è½¬æ¢å›¾ï¼‰ã€‚<code>wait()</code> æ˜¯ <code>Object</code> ç±»çš„æ–¹æ³•ï¼Œè°ƒç”¨å¯¹è±¡çš„ <code>wait()</code> æ–¹æ³•å¯¼è‡´å½“å‰çº¿ç¨‹æ”¾å¼ƒå¯¹è±¡çš„é”ï¼ˆçº¿ç¨‹æš‚åœæ‰§è¡Œï¼‰ï¼Œè¿›å…¥å¯¹è±¡çš„ç­‰å¾…æ± ï¼ˆwait poolï¼‰ï¼Œåªæœ‰è°ƒç”¨å¯¹è±¡çš„ <code>notify()</code> æ–¹æ³•ï¼ˆæˆ– <code>notifyAll()</code> æ–¹æ³•ï¼‰æ—¶æ‰èƒ½å”¤é†’ç­‰å¾…æ± ä¸­çš„çº¿ç¨‹è¿›å…¥ç­‰é”æ± ï¼ˆlock poolï¼‰ï¼Œå¦‚æœçº¿ç¨‹é‡æ–°è·å¾—å¯¹è±¡çš„é”å°±å¯ä»¥è¿›å…¥å°±ç»ªçŠ¶æ€ã€‚</p>
<p><strong>è¡¥å……ï¼š</strong>å¯èƒ½ä¸å°‘äººå¯¹ä»€ä¹ˆæ˜¯è¿›ç¨‹ï¼Œä»€ä¹ˆæ˜¯çº¿ç¨‹è¿˜æ¯”è¾ƒæ¨¡ç³Šï¼Œå¯¹äºä¸ºä»€ä¹ˆéœ€è¦å¤šçº¿ç¨‹ç¼–ç¨‹ä¹Ÿä¸æ˜¯ç‰¹åˆ«ç†è§£ã€‚ç®€å•çš„è¯´ï¼šè¿›ç¨‹æ˜¯å…·æœ‰ä¸€å®šç‹¬ç«‹åŠŸèƒ½çš„ç¨‹åºå…³äºæŸä¸ªæ•°æ®é›†åˆä¸Šçš„ä¸€æ¬¡è¿è¡Œæ´»åŠ¨ï¼Œæ˜¯æ“ä½œç³»ç»Ÿè¿›è¡Œèµ„æºåˆ†é…å’Œè°ƒåº¦çš„ä¸€ä¸ªç‹¬ç«‹å•ä½ï¼›çº¿ç¨‹æ˜¯è¿›ç¨‹çš„ä¸€ä¸ªå®ä½“ï¼Œæ˜¯ CPU è°ƒåº¦å’Œåˆ†æ´¾çš„åŸºæœ¬å•ä½ï¼Œæ˜¯æ¯”è¿›ç¨‹æ›´å°çš„èƒ½ç‹¬ç«‹è¿è¡Œçš„åŸºæœ¬å•ä½ã€‚çº¿ç¨‹çš„åˆ’åˆ†å°ºåº¦å°äºè¿›ç¨‹ï¼Œè¿™ä½¿å¾—å¤šçº¿ç¨‹ç¨‹åºçš„å¹¶å‘æ€§é«˜ï¼›è¿›ç¨‹åœ¨æ‰§è¡Œæ—¶é€šå¸¸æ‹¥æœ‰ç‹¬ç«‹çš„å†…å­˜å•å…ƒï¼Œè€Œçº¿ç¨‹ä¹‹é—´å¯ä»¥å…±äº«å†…å­˜ã€‚ä½¿ç”¨å¤šçº¿ç¨‹çš„ç¼–ç¨‹é€šå¸¸èƒ½å¤Ÿå¸¦æ¥æ›´å¥½çš„æ€§èƒ½å’Œç”¨æˆ·ä½“éªŒï¼Œä½†æ˜¯å¤šçº¿ç¨‹çš„ç¨‹åºå¯¹äºå…¶ä»–ç¨‹åºæ˜¯ä¸å‹å¥½çš„ï¼Œå› ä¸ºå®ƒå¯èƒ½å ç”¨äº†æ›´å¤šçš„ CPU èµ„æºã€‚å½“ç„¶ï¼Œä¹Ÿä¸æ˜¯çº¿ç¨‹è¶Šå¤šï¼Œç¨‹åºçš„æ€§èƒ½å°±è¶Šå¥½ï¼Œå› ä¸ºçº¿ç¨‹ä¹‹é—´çš„è°ƒåº¦å’Œåˆ‡æ¢ä¹Ÿä¼šæµªè´¹ CPU æ—¶é—´ã€‚æ—¶ä¸‹å¾ˆæ—¶é«¦çš„ Node.js å°±é‡‡ç”¨äº†å•çº¿ç¨‹å¼‚æ­¥ I/O çš„å·¥ä½œæ¨¡å¼ã€‚</p>
<blockquote>
<p>58ã€çº¿ç¨‹çš„ <code>sleep()</code> æ–¹æ³•å’Œ <code>yield()</code> æ–¹æ³•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼š</p>
<ol>
<li><code>sleep()</code> æ–¹æ³•ç»™å…¶ä»–çº¿ç¨‹è¿è¡Œæœºä¼šæ—¶ä¸è€ƒè™‘çº¿ç¨‹çš„ä¼˜å…ˆçº§ï¼Œå› æ­¤ä¼šç»™ä½ä¼˜å…ˆçº§çš„çº¿ç¨‹ä»¥è¿è¡Œçš„æœºä¼šï¼›<code>yield()</code> æ–¹æ³•åªä¼šç»™ç›¸åŒä¼˜å…ˆçº§æˆ–æ›´é«˜ä¼˜å…ˆçº§çš„çº¿ç¨‹ä»¥è¿è¡Œçš„æœºä¼šï¼›</li>
<li>çº¿ç¨‹æ‰§è¡Œ <code>sleep()</code> æ–¹æ³•åè½¬å…¥é˜»å¡ï¼ˆblockedï¼‰çŠ¶æ€ï¼Œè€Œæ‰§è¡Œ <code>yield()</code> æ–¹æ³•åè½¬å…¥å°±ç»ªï¼ˆreadyï¼‰çŠ¶æ€ï¼›</li>
<li><code>sleep()</code> æ–¹æ³•å£°æ˜æŠ›å‡º <code>InterruptedException</code>ï¼Œè€Œ <code>yield()</code> æ–¹æ³•æ²¡æœ‰å£°æ˜ä»»ä½•å¼‚å¸¸ï¼›</li>
<li><code>sleep()</code> æ–¹æ³•æ¯” <code>yield()</code> æ–¹æ³•ï¼ˆè·Ÿæ“ä½œç³»ç»Ÿ CPU è°ƒåº¦ç›¸å…³ï¼‰å…·æœ‰æ›´å¥½çš„å¯ç§»æ¤æ€§ã€‚</li>
</ol>
<blockquote>
<p>59ã€å½“ä¸€ä¸ªçº¿ç¨‹è¿›å…¥ä¸€ä¸ªå¯¹è±¡çš„ <code>synchronized</code> æ–¹æ³• <code>A</code> ä¹‹åï¼Œå…¶å®ƒçº¿ç¨‹æ˜¯å¦å¯è¿›å…¥æ­¤å¯¹è±¡çš„ <code>synchronized</code> æ–¹æ³• <code>B</code>ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šä¸èƒ½ã€‚å…¶å®ƒçº¿ç¨‹åªèƒ½è®¿é—®è¯¥å¯¹è±¡çš„éåŒæ­¥æ–¹æ³•ï¼ŒåŒæ­¥æ–¹æ³•åˆ™ä¸èƒ½è¿›å…¥ã€‚å› ä¸ºéé™æ€æ–¹æ³•ä¸Šçš„ <code>synchronized</code> ä¿®é¥°ç¬¦è¦æ±‚æ‰§è¡Œæ–¹æ³•æ—¶è¦è·å¾—å¯¹è±¡çš„é”ï¼Œå¦‚æœå·²ç»è¿›å…¥ <code>A</code> æ–¹æ³•è¯´æ˜å¯¹è±¡é”å·²ç»è¢«å–èµ°ï¼Œé‚£ä¹ˆè¯•å›¾è¿›å…¥ <code>B</code> æ–¹æ³•çš„çº¿ç¨‹å°±åªèƒ½åœ¨<strong>ç­‰é”æ± </strong>ï¼ˆæ³¨æ„ä¸æ˜¯ç­‰å¾…æ± å“¦ï¼‰ä¸­ç­‰å¾…å¯¹è±¡çš„é”ã€‚</p>
<blockquote>
<p>60ã€è¯·è¯´å‡ºä¸çº¿ç¨‹åŒæ­¥ä»¥åŠçº¿ç¨‹è°ƒåº¦ç›¸å…³çš„æ–¹æ³•ã€‚</p>
</blockquote>
<p>ç­”ï¼š</p>
<ul>
<li><code>wait()</code>ï¼šä½¿ä¸€ä¸ªçº¿ç¨‹å¤„äºç­‰å¾…ï¼ˆé˜»å¡ï¼‰çŠ¶æ€ï¼Œå¹¶ä¸”é‡Šæ”¾æ‰€æŒæœ‰çš„å¯¹è±¡çš„é”ï¼›</li>
<li><code>sleep()</code>ï¼šä½¿ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„çº¿ç¨‹å¤„äºç¡çœ çŠ¶æ€ï¼Œæ˜¯ä¸€ä¸ªé™æ€æ–¹æ³•ï¼Œè°ƒç”¨æ­¤æ–¹æ³•è¦å¤„ç† <code>InterruptedException</code> å¼‚å¸¸ï¼›</li>
<li><code>notify()</code>ï¼šå”¤é†’ä¸€ä¸ªå¤„äºç­‰å¾…çŠ¶æ€çš„çº¿ç¨‹ï¼Œå½“ç„¶åœ¨è°ƒç”¨æ­¤æ–¹æ³•çš„æ—¶å€™ï¼Œå¹¶ä¸èƒ½ç¡®åˆ‡çš„å”¤é†’æŸä¸€ä¸ªç­‰å¾…çŠ¶æ€çš„çº¿ç¨‹ï¼Œè€Œæ˜¯ç”± JVM ç¡®å®šå”¤é†’å“ªä¸ªçº¿ç¨‹ï¼Œè€Œä¸”<strong>ä¸ä¼˜å…ˆçº§æ— å…³</strong>ï¼›</li>
<li><code>notityAll()</code>ï¼šå”¤é†’æ‰€æœ‰å¤„äºç­‰å¾…çŠ¶æ€çš„çº¿ç¨‹ï¼Œè¯¥æ–¹æ³•å¹¶ä¸æ˜¯å°†å¯¹è±¡çš„é”ç»™æ‰€æœ‰çº¿ç¨‹ï¼Œè€Œæ˜¯è®©å®ƒä»¬<strong>ç«äº‰</strong>ï¼Œåªæœ‰è·å¾—é”çš„çº¿ç¨‹æ‰èƒ½è¿›å…¥å°±ç»ªçŠ¶æ€ï¼›</li>
</ul>
<p><strong>è¯´æ˜ï¼š</strong>å…³äº Java å¤šçº¿ç¨‹å’Œå¹¶å‘ç¼–ç¨‹çš„é—®é¢˜ï¼Œå»ºè®®å¤§å®¶çœ‹æˆ‘çš„å¦ä¸€ç¯‡æ–‡ç« <a target="_blank" rel="noopener" href="https://blog.csdn.net/jackfrued/article/details/44499227">ã€Šå…³äºJavaå¹¶å‘ç¼–ç¨‹çš„æ€»ç»“å’Œæ€è€ƒã€‹</a>ã€‚</p>
<p><strong>è¡¥å……ï¼š</strong>Java 5 é€šè¿‡ <code>Lock</code> æ¥å£æä¾›äº†æ˜¾å¼çš„é”æœºåˆ¶ï¼ˆexplicit lockï¼‰ï¼Œå¢å¼ºäº†çµæ´»æ€§ä»¥åŠå¯¹çº¿ç¨‹çš„åè°ƒã€‚<code>Lock</code> æ¥å£ä¸­å®šä¹‰äº†åŠ é” <code>lock()</code> å’Œè§£é” <code>unlock()</code> çš„æ–¹æ³•ï¼ŒåŒæ—¶è¿˜æä¾›äº† <code>newCondition()</code> æ–¹æ³•æ¥äº§ç”Ÿç”¨äºçº¿ç¨‹ä¹‹é—´é€šä¿¡çš„ <code>Condition</code> å¯¹è±¡ï¼›æ­¤å¤–ï¼ŒJava 5 è¿˜æä¾›äº†ä¿¡å·é‡æœºåˆ¶ï¼ˆsemaphoreï¼‰ï¼Œä¿¡å·é‡å¯ä»¥ç”¨æ¥é™åˆ¶å¯¹æŸä¸ªå…±äº«èµ„æºè¿›è¡Œè®¿é—®çš„çº¿ç¨‹çš„æ•°é‡ã€‚åœ¨å¯¹èµ„æºè¿›è¡Œè®¿é—®ä¹‹å‰ï¼Œçº¿ç¨‹å¿…é¡»å¾—åˆ°ä¿¡å·é‡çš„è®¸å¯ï¼ˆè°ƒç”¨ <code>Semaphore</code> å¯¹è±¡çš„ <code>acquire()</code> æ–¹æ³•ï¼‰ï¼›åœ¨å®Œæˆå¯¹èµ„æºçš„è®¿é—®åï¼Œçº¿ç¨‹å¿…é¡»å‘ä¿¡å·é‡å½’è¿˜è®¸å¯ï¼ˆè°ƒç”¨ <code>Semaphore</code> å¯¹è±¡çš„ <code>release()</code> æ–¹æ³•ï¼‰ã€‚</p>
<p>ä¸‹é¢çš„ä¾‹å­æ¼”ç¤ºäº† 100 ä¸ªçº¿ç¨‹åŒæ—¶å‘ä¸€ä¸ªé“¶è¡Œè´¦æˆ·ä¸­å­˜å…¥ 1 å…ƒé’±ï¼Œåœ¨æ²¡æœ‰ä½¿ç”¨åŒæ­¥æœºåˆ¶å’Œä½¿ç”¨åŒæ­¥æœºåˆ¶æƒ…å†µä¸‹çš„æ‰§è¡Œæƒ…å†µã€‚</p>
<p>é“¶è¡Œè´¦æˆ·ç±»ï¼š</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * é“¶è¡Œè´¦æˆ·</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Account</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">double</span> balance;       <span class="hljs-comment">// è´¦æˆ·ä½™é¢</span><br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * å­˜æ¬¾</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> money å­˜å…¥é‡‘é¢</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">deposit</span><span class="hljs-params">(<span class="hljs-keyword">double</span> money)</span> </span>&#123;<br>        <span class="hljs-keyword">double</span> newBalance = balance + money;<br>        <span class="hljs-keyword">try</span> &#123;<br>            Thread.sleep(<span class="hljs-number">10</span>);     <span class="hljs-comment">// æ¨¡æ‹Ÿæ­¤ä¸šåŠ¡éœ€è¦ä¸€æ®µå¤„ç†æ—¶é—´</span><br>        &#125;<br>        <span class="hljs-keyword">catch</span>(InterruptedException ex) &#123;<br>            ex.printStackTrace();<br>        &#125;<br>        balance = newBalance;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * è·å¾—è´¦æˆ·ä½™é¢</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">double</span> <span class="hljs-title">getBalance</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> balance;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * å­˜é’±çº¿ç¨‹ç±»</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AddMoneyThread</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Runnable</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> Account account;    <span class="hljs-comment">// å­˜å…¥è´¦æˆ·</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">double</span> money;       <span class="hljs-comment">// å­˜å…¥é‡‘é¢</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">AddMoneyThread</span><span class="hljs-params">(Account account, <span class="hljs-keyword">double</span> money)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.account = account;<br>        <span class="hljs-keyword">this</span>.money = money;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">run</span><span class="hljs-params">()</span> </span>&#123;<br>        account.deposit(money);   <span class="hljs-comment">// è°ƒç”¨å­˜æ¬¾æ–¹æ³•</span><br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.concurrent.ExecutorService;<br><span class="hljs-keyword">import</span> java.util.concurrent.Executors;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * æµ‹è¯•ç±»</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test01</span> </span>&#123;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        Account account = <span class="hljs-keyword">new</span> Account();<br>        ExecutorService service = Executors.newFixedThreadPool(<span class="hljs-number">100</span>);<br><br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= <span class="hljs-number">100</span>; i++) &#123;<br>            service.execute(<span class="hljs-keyword">new</span> AddMoneyThread(account, <span class="hljs-number">1</span>));<br>        &#125;<br>        <br>        service.shutdown();<br><br>        <span class="hljs-keyword">while</span>(!service.isTerminated()) &#123;&#125;<br><br>        System.out.println(<span class="hljs-string">&quot;è´¦æˆ·ä½™é¢: &quot;</span> + account.getBalance());<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<p>åœ¨æ²¡æœ‰åŒæ­¥çš„æƒ…å†µä¸‹ï¼Œæ‰§è¡Œç»“æœé€šå¸¸æ˜¯æ˜¾ç¤ºè´¦æˆ·ä½™é¢åœ¨ 10 å…ƒä»¥ä¸‹ï¼Œå‡ºç°è¿™ç§çŠ¶å†µçš„åŸå› æ˜¯ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹ A è¯•å›¾å­˜å…¥ 1 å…ƒçš„æ—¶å€™ï¼Œå¦å¤–ä¸€ä¸ªçº¿ç¨‹ B ä¹Ÿèƒ½å¤Ÿè¿›å…¥å­˜æ¬¾çš„æ–¹æ³•ä¸­ï¼Œçº¿ç¨‹ B è¯»å–åˆ°çš„è´¦æˆ·ä½™é¢ä»ç„¶æ˜¯çº¿ç¨‹ A å­˜å…¥ 1 å…ƒé’±ä¹‹å‰çš„è´¦æˆ·ä½™é¢ï¼Œå› æ­¤ä¹Ÿæ˜¯åœ¨åŸæ¥çš„ä½™é¢ 0 ä¸Šé¢åšäº†åŠ  1 å…ƒçš„æ“ä½œï¼ŒåŒç†çº¿ç¨‹ C ä¹Ÿä¼šåšç±»ä¼¼çš„äº‹æƒ…ï¼Œæ‰€ä»¥æœ€å 100 ä¸ªçº¿ç¨‹æ‰§è¡Œç»“æŸæ—¶ï¼Œæœ¬æ¥æœŸæœ›è´¦æˆ·ä½™é¢ä¸º 100 å…ƒï¼Œä½†å®é™…å¾—åˆ°çš„é€šå¸¸åœ¨ 10 å…ƒä»¥ä¸‹ï¼ˆå¾ˆå¯èƒ½æ˜¯ 1 å…ƒå“¦ï¼‰ã€‚è§£å†³è¿™ä¸ªé—®é¢˜çš„åŠæ³•å°±æ˜¯åŒæ­¥ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹å¯¹é“¶è¡Œè´¦æˆ·å­˜é’±æ—¶ï¼Œéœ€è¦å°†æ­¤è´¦æˆ·é”å®šï¼Œå¾…å…¶æ“ä½œå®Œæˆåæ‰å…è®¸å…¶ä»–çš„çº¿ç¨‹è¿›è¡Œæ“ä½œï¼Œä»£ç æœ‰å¦‚ä¸‹å‡ ç§è°ƒæ•´æ–¹æ¡ˆï¼š</p>
<ol>
<li><p>åœ¨é“¶è¡Œè´¦æˆ·çš„å­˜æ¬¾ï¼ˆ<code>deposit</code>ï¼‰æ–¹æ³•ä¸ŠåŒæ­¥ï¼ˆ<code>synchronized</code>ï¼‰å…³é”®å­—</p>
<p> <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment">* é“¶è¡Œè´¦æˆ·</span><br><span class="hljs-comment">*/</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Account</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">double</span> balance;     <span class="hljs-comment">// è´¦æˆ·ä½™é¢</span><br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">    * å­˜æ¬¾</span><br><span class="hljs-comment">    * <span class="hljs-doctag">@param</span> money å­˜å…¥é‡‘é¢</span><br><span class="hljs-comment">    */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title">deposit</span><span class="hljs-params">(<span class="hljs-keyword">double</span> money)</span> </span>&#123;  <span class="hljs-comment">// åŠ ä¸ŠåŒæ­¥ï¼ˆsynchronizedï¼‰å…³é”®å­—</span><br>        <span class="hljs-keyword">double</span> newBalance = balance + money;<br>        <span class="hljs-keyword">try</span> &#123;<br>            Thread.sleep(<span class="hljs-number">10</span>);   <span class="hljs-comment">// æ¨¡æ‹Ÿæ­¤ä¸šåŠ¡éœ€è¦ä¸€æ®µå¤„ç†æ—¶é—´</span><br>        &#125;<br>        <span class="hljs-keyword">catch</span>(InterruptedException ex) &#123;<br>            ex.printStackTrace();<br>        &#125;<br>        balance = newBalance;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">    * è·å¾—è´¦æˆ·ä½™é¢</span><br><span class="hljs-comment">    */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">double</span> <span class="hljs-title">getBalance</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> balance;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></p>
</li>
<li><p>åœ¨çº¿ç¨‹è°ƒç”¨å­˜æ¬¾æ–¹æ³•æ—¶å¯¹é“¶è¡Œè´¦æˆ·è¿›è¡ŒåŒæ­¥</p>
<p> <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment">* å­˜é’±çº¿ç¨‹</span><br><span class="hljs-comment">*/</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AddMoneyThread</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Runnable</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> Account account;    <span class="hljs-comment">// å­˜å…¥è´¦æˆ·</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">double</span> money;       <span class="hljs-comment">// å­˜å…¥é‡‘é¢</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">AddMoneyThread</span><span class="hljs-params">(Account account, <span class="hljs-keyword">double</span> money)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.account = account;<br>        <span class="hljs-keyword">this</span>.money = money;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">run</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">synchronized</span> (account) &#123;      <span class="hljs-comment">// åŠ ä¸ŠåŒæ­¥ï¼ˆsynchronizedï¼‰å…³é”®å­—</span><br>            account.deposit(money);<br>        &#125;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></p>
</li>
<li><p>é€šè¿‡ Java 5 æ˜¾ç¤ºçš„é”æœºåˆ¶ï¼Œä¸ºæ¯ä¸ªé“¶è¡Œè´¦æˆ·åˆ›å»ºä¸€ä¸ªé”å¯¹è±¡ï¼Œåœ¨å­˜æ¬¾æ“ä½œè¿›è¡ŒåŠ é”å’Œè§£é”çš„æ“ä½œ</p>
<p> <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.concurrent.locks.Lock;<br><span class="hljs-keyword">import</span> java.util.concurrent.locks.ReentrantLock;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment">* é“¶è¡Œè´¦æˆ·</span><br><span class="hljs-comment">*/</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Account</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> Lock accountLock = <span class="hljs-keyword">new</span> ReentrantLock();<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">double</span> balance; <span class="hljs-comment">// è´¦æˆ·ä½™é¢</span><br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">    * å­˜å…¥é‡‘é¢</span><br><span class="hljs-comment">    * <span class="hljs-doctag">@param</span> money</span><br><span class="hljs-comment">    */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">deposit</span><span class="hljs-params">(<span class="hljs-keyword">double</span> money)</span> </span>&#123;<br>        accountLock.lock(); <span class="hljs-comment">// åŠ é”</span><br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-keyword">double</span> newBalance = balance + money;<br>            <span class="hljs-keyword">try</span> &#123;<br>                Thread.sleep(<span class="hljs-number">10</span>); <span class="hljs-comment">// æ¨¡æ‹Ÿæ­¤ä¸šåŠ¡éœ€è¦ä¸€æ®µå¤„ç†æ—¶é—´</span><br>            &#125;<br>            <span class="hljs-keyword">catch</span> (InterruptedException ex) &#123;<br>                ex.printStackTrace();<br>            &#125;<br>            balance = newBalance;<br>        &#125;<br>        <span class="hljs-keyword">finally</span> &#123;<br>            accountLock.unlock(); <span class="hljs-comment">// è§£é”</span><br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">    * è·å¾—è´¦æˆ·ä½™é¢</span><br><span class="hljs-comment">    */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">double</span> <span class="hljs-title">getBalance</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> balance;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<p>æŒ‰ç…§ä¸Šè¿°ä¸‰ç§æ–¹å¼å¯¹ä»£ç è¿›è¡Œä¿®æ”¹åï¼Œé‡å†™æ‰§è¡Œæµ‹è¯•ä»£ç  Test01ï¼Œå°†çœ‹åˆ°æœ€ç»ˆçš„è´¦æˆ·ä½™é¢ä¸º 100 å…ƒã€‚å½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨ <code>Semaphore</code> æˆ– <code>CountdownLatch</code> æ¥å®ç°åŒæ­¥ã€‚</p>
</li>
</ol>
<blockquote>
<p>61ã€ç¼–å†™å¤šçº¿ç¨‹ç¨‹åºæœ‰å‡ ç§å®ç°æ–¹å¼ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šJava 5 ä»¥å‰å®ç°å¤šçº¿ç¨‹æœ‰ä¸¤ç§å®ç°æ–¹æ³•ï¼šä¸€ç§æ˜¯ç»§æ‰¿ <code>Thread</code> ç±»ï¼›å¦ä¸€ç§æ˜¯å®ç° <code>Runnable</code> æ¥å£ã€‚ä¸¤ç§æ–¹å¼éƒ½è¦é€šè¿‡é‡å†™ <code>run()</code> æ–¹æ³•æ¥å®šä¹‰çº¿ç¨‹çš„è¡Œä¸ºï¼Œæ¨èä½¿ç”¨åè€…ï¼Œå› ä¸º Java ä¸­çš„ç»§æ‰¿æ˜¯å•ç»§æ‰¿ï¼Œä¸€ä¸ªç±»æœ‰ä¸€ä¸ªçˆ¶ç±»ï¼Œå¦‚æœç»§æ‰¿äº† <code>Thread</code> ç±»å°±æ— æ³•å†ç»§æ‰¿å…¶ä»–ç±»äº†ï¼Œæ˜¾ç„¶ä½¿ç”¨ <code>Runnable</code> æ¥å£æ›´ä¸ºçµæ´»ã€‚</p>
<p><strong>è¡¥å……ï¼š</strong>Java 5 ä»¥ååˆ›å»ºçº¿ç¨‹è¿˜æœ‰ç¬¬ä¸‰ç§æ–¹å¼ï¼šå®ç° <code>Callable</code> æ¥å£ï¼Œè¯¥æ¥å£ä¸­çš„ <code>call</code> æ–¹æ³•å¯ä»¥åœ¨çº¿ç¨‹æ‰§è¡Œç»“æŸæ—¶äº§ç”Ÿä¸€ä¸ªè¿”å›å€¼ï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.ArrayList;<br><span class="hljs-keyword">import</span> java.util.List;<br><span class="hljs-keyword">import</span> java.util.concurrent.Callable;<br><span class="hljs-keyword">import</span> java.util.concurrent.ExecutorService;<br><span class="hljs-keyword">import</span> java.util.concurrent.Executors;<br><span class="hljs-keyword">import</span> java.util.concurrent.Future;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyTask</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Callable</span>&lt;<span class="hljs-title">Integer</span>&gt; </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> upperBounds;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">MyTask</span><span class="hljs-params">(<span class="hljs-keyword">int</span> upperBounds)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.upperBounds = upperBounds;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Integer <span class="hljs-title">call</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>        <span class="hljs-keyword">int</span> sum = <span class="hljs-number">0</span>; <br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= upperBounds; i++) &#123;<br>            sum += i;<br>        &#125;<br>        <span class="hljs-keyword">return</span> sum;<br>    &#125;<br><br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>        List&lt;Future&lt;Integer&gt;&gt; list = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();<br>        ExecutorService service = Executors.newFixedThreadPool(<span class="hljs-number">10</span>);<br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++) &#123;<br>            list.add(service.submit(<span class="hljs-keyword">new</span> MyTask((<span class="hljs-keyword">int</span>) (Math.random() * <span class="hljs-number">100</span>))));<br>        &#125;<br><br>        <span class="hljs-keyword">int</span> sum = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span>(Future&lt;Integer&gt; future : list) &#123;<br>            <span class="hljs-comment">// while(!future.isDone()) ;</span><br>            sum += future.get();<br>        &#125;<br><br>        System.out.println(sum);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<blockquote>
<p>62ã€<code>synchronized</code> å…³é”®å­—çš„ç”¨æ³•ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼š<code>synchronized</code> å…³é”®å­—å¯ä»¥å°†å¯¹è±¡æˆ–è€…æ–¹æ³•æ ‡è®°ä¸º<strong>åŒæ­¥</strong>ï¼Œä»¥å®ç°å¯¹å¯¹è±¡å’Œæ–¹æ³•çš„äº’æ–¥è®¿é—®ï¼Œå¯ä»¥ç”¨ <code>synchronized(å¯¹è±¡) &#123; â€¦ &#125;</code> å®šä¹‰åŒæ­¥ä»£ç å—ï¼Œæˆ–è€…åœ¨å£°æ˜æ–¹æ³•æ—¶å°† <code>synchronized</code> ä½œä¸ºæ–¹æ³•çš„ä¿®é¥°ç¬¦ã€‚åœ¨ç¬¬ 60 é¢˜çš„ä¾‹å­ä¸­å·²ç»å±•ç¤ºäº† <code>synchronized</code> å…³é”®å­—çš„ç”¨æ³•ã€‚</p>
<blockquote>
<p>63ã€ä¸¾ä¾‹è¯´æ˜åŒæ­¥å’Œå¼‚æ­¥ã€‚</p>
</blockquote>
<p>ç­”ï¼šå¦‚æœç³»ç»Ÿä¸­å­˜åœ¨ä¸´ç•Œèµ„æºï¼ˆèµ„æºæ•°é‡å°‘äºç«äº‰èµ„æºçš„çº¿ç¨‹æ•°é‡çš„èµ„æºï¼‰ï¼Œä¾‹å¦‚æ­£åœ¨å†™çš„æ•°æ®ä»¥åå¯èƒ½è¢«å¦ä¸€ä¸ªçº¿ç¨‹è¯»åˆ°ï¼Œæˆ–è€…æ­£åœ¨è¯»çš„æ•°æ®å¯èƒ½å·²ç»è¢«å¦ä¸€ä¸ªçº¿ç¨‹å†™è¿‡äº†ï¼Œé‚£ä¹ˆè¿™äº›æ•°æ®å°±å¿…é¡»è¿›è¡ŒåŒæ­¥å­˜å–ï¼ˆæ•°æ®åº“æ“ä½œä¸­çš„æ’ä»–é”å°±æ˜¯æœ€å¥½çš„ä¾‹å­ï¼‰ã€‚å½“åº”ç”¨ç¨‹åºåœ¨å¯¹è±¡ä¸Šè°ƒç”¨äº†ä¸€ä¸ªéœ€è¦èŠ±è´¹å¾ˆé•¿æ—¶é—´æ¥æ‰§è¡Œçš„æ–¹æ³•ï¼Œå¹¶ä¸”ä¸å¸Œæœ›è®©ç¨‹åºç­‰å¾…æ–¹æ³•çš„è¿”å›æ—¶ï¼Œå°±åº”è¯¥ä½¿ç”¨å¼‚æ­¥ç¼–ç¨‹ï¼Œåœ¨å¾ˆå¤šæƒ…å†µä¸‹é‡‡ç”¨å¼‚æ­¥é€”å¾„å¾€å¾€æ›´æœ‰æ•ˆç‡ã€‚äº‹å®ä¸Šï¼Œæ‰€è°“çš„åŒæ­¥å°±æ˜¯æŒ‡<strong>é˜»å¡å¼æ“ä½œ</strong>ï¼Œè€Œå¼‚æ­¥å°±æ˜¯<strong>éé˜»å¡å¼æ“ä½œ</strong>ã€‚</p>
<blockquote>
<p>64ã€å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹æ˜¯è°ƒç”¨ <code>run()</code> è¿˜æ˜¯ <code>start()</code> æ–¹æ³•ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šå¯åŠ¨ä¸€ä¸ªçº¿ç¨‹æ˜¯è°ƒç”¨ <code>start()</code> æ–¹æ³•ï¼Œä½¿çº¿ç¨‹æ‰€ä»£è¡¨çš„è™šæ‹Ÿå¤„ç†æœºå¤„äºå¯è¿è¡ŒçŠ¶æ€ï¼Œè¿™æ„å‘³ç€å®ƒå¯ä»¥ç”± JVM è°ƒåº¦å¹¶æ‰§è¡Œï¼Œè¿™å¹¶ä¸æ„å‘³ç€çº¿ç¨‹å°±ä¼šç«‹å³è¿è¡Œã€‚<code>run()</code> æ–¹æ³•æ˜¯çº¿ç¨‹å¯åŠ¨åè¦è¿›è¡Œå›è°ƒï¼ˆcallbackï¼‰çš„æ–¹æ³•ã€‚</p>
<blockquote>
<p>65ã€ä»€ä¹ˆæ˜¯çº¿ç¨‹æ± ï¼ˆthread poolï¼‰ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šåœ¨é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­ï¼Œåˆ›å»ºå’Œé”€æ¯å¯¹è±¡æ˜¯å¾ˆè´¹æ—¶é—´çš„ï¼Œå› ä¸ºåˆ›å»ºä¸€ä¸ªå¯¹è±¡è¦è·å–å†…å­˜èµ„æºæˆ–è€…å…¶å®ƒæ›´å¤šèµ„æºã€‚åœ¨ Java ä¸­æ›´æ˜¯å¦‚æ­¤ï¼Œè™šæ‹Ÿæœºå°†è¯•å›¾è·Ÿè¸ªæ¯ä¸€ä¸ªå¯¹è±¡ï¼Œä»¥ä¾¿èƒ½å¤Ÿåœ¨å¯¹è±¡é”€æ¯åè¿›è¡Œåƒåœ¾å›æ”¶ã€‚æ‰€ä»¥æé«˜æœåŠ¡ç¨‹åºæ•ˆç‡çš„ä¸€ä¸ªæ‰‹æ®µå°±æ˜¯å°½å¯èƒ½å‡å°‘åˆ›å»ºå’Œé”€æ¯å¯¹è±¡çš„æ¬¡æ•°ï¼Œç‰¹åˆ«æ˜¯ä¸€äº›å¾ˆè€—èµ„æºçš„å¯¹è±¡åˆ›å»ºå’Œé”€æ¯ï¼Œè¿™å°±æ˜¯â€œæ± åŒ–èµ„æºâ€æŠ€æœ¯äº§ç”Ÿçš„åŸå› ã€‚çº¿ç¨‹æ± é¡¾åæ€ä¹‰å°±æ˜¯äº‹å…ˆåˆ›å»ºè‹¥å¹²ä¸ªå¯æ‰§è¡Œçš„çº¿ç¨‹æ”¾å…¥ä¸€ä¸ªæ± ï¼ˆå®¹å™¨ï¼‰ä¸­ï¼Œéœ€è¦çš„æ—¶å€™ä»æ± ä¸­è·å–çº¿ç¨‹ä¸ç”¨è‡ªè¡Œåˆ›å»ºï¼Œä½¿ç”¨å®Œæ¯•ä¸éœ€è¦é”€æ¯çº¿ç¨‹è€Œæ˜¯æ”¾å›æ± ä¸­ï¼Œä»è€Œå‡å°‘åˆ›å»ºå’Œé”€æ¯çº¿ç¨‹å¯¹è±¡çš„å¼€é”€ã€‚</p>
<p>Java 5+ ä¸­çš„ <code>Executor</code> æ¥å£å®šä¹‰ä¸€ä¸ªæ‰§è¡Œçº¿ç¨‹çš„å·¥å…·ã€‚å®ƒçš„å­ç±»å‹å³çº¿ç¨‹æ± æ¥å£æ˜¯ <code>ExecutorService</code>ã€‚è¦é…ç½®ä¸€ä¸ªçº¿ç¨‹æ± æ˜¯æ¯”è¾ƒå¤æ‚çš„ï¼Œå°¤å…¶æ˜¯å¯¹äºçº¿ç¨‹æ± çš„åŸç†ä¸æ˜¯å¾ˆæ¸…æ¥šçš„æƒ…å†µä¸‹ï¼Œå› æ­¤åœ¨å·¥å…·ç±» <code>Executors</code> é‡Œé¢æä¾›äº†ä¸€äº›é™æ€å·¥å‚æ–¹æ³•ï¼Œç”Ÿæˆä¸€äº›å¸¸ç”¨çš„çº¿ç¨‹æ± ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<ul>
<li><code>newSingleThreadExecutor</code>ï¼šåˆ›å»ºä¸€ä¸ªå•çº¿ç¨‹çš„çº¿ç¨‹æ± ã€‚è¿™ä¸ªçº¿ç¨‹æ± åªæœ‰ä¸€ä¸ªçº¿ç¨‹åœ¨å·¥ä½œï¼Œä¹Ÿå°±æ˜¯ç›¸å½“äºå•çº¿ç¨‹ä¸²è¡Œæ‰§è¡Œæ‰€æœ‰ä»»åŠ¡ã€‚å¦‚æœè¿™ä¸ªå”¯ä¸€çš„çº¿ç¨‹å› ä¸ºå¼‚å¸¸ç»“æŸï¼Œé‚£ä¹ˆä¼šæœ‰ä¸€ä¸ªæ–°çš„çº¿ç¨‹æ¥æ›¿ä»£å®ƒã€‚æ­¤çº¿ç¨‹æ± ä¿è¯æ‰€æœ‰ä»»åŠ¡çš„æ‰§è¡Œé¡ºåºæŒ‰ç…§ä»»åŠ¡çš„æäº¤é¡ºåºæ‰§è¡Œã€‚</li>
<li><code>newFixedThreadPool</code>ï¼šåˆ›å»ºå›ºå®šå¤§å°çš„çº¿ç¨‹æ± ã€‚æ¯æ¬¡æäº¤ä¸€ä¸ªä»»åŠ¡å°±åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ï¼Œç›´åˆ°çº¿ç¨‹è¾¾åˆ°çº¿ç¨‹æ± çš„æœ€å¤§å¤§å°ã€‚çº¿ç¨‹æ± çš„å¤§å°ä¸€æ—¦è¾¾åˆ°æœ€å¤§å€¼å°±ä¼šä¿æŒä¸å˜ï¼Œå¦‚æœæŸä¸ªçº¿ç¨‹å› ä¸ºæ‰§è¡Œå¼‚å¸¸è€Œç»“æŸï¼Œé‚£ä¹ˆçº¿ç¨‹æ± ä¼šè¡¥å……ä¸€ä¸ªæ–°çº¿ç¨‹ã€‚</li>
<li><code>newCachedThreadPool</code>ï¼šåˆ›å»ºä¸€ä¸ªå¯ç¼“å­˜çš„çº¿ç¨‹æ± ã€‚å¦‚æœçº¿ç¨‹æ± çš„å¤§å°è¶…è¿‡äº†å¤„ç†ä»»åŠ¡æ‰€éœ€è¦çš„çº¿ç¨‹ï¼Œé‚£ä¹ˆå°±ä¼šå›æ”¶éƒ¨åˆ†ç©ºé—²ï¼ˆ60 ç§’ä¸æ‰§è¡Œä»»åŠ¡ï¼‰çš„çº¿ç¨‹ï¼Œå½“ä»»åŠ¡æ•°å¢åŠ æ—¶ï¼Œæ­¤çº¿ç¨‹æ± åˆå¯ä»¥æ™ºèƒ½çš„æ·»åŠ æ–°çº¿ç¨‹æ¥å¤„ç†ä»»åŠ¡ã€‚æ­¤çº¿ç¨‹æ± ä¸ä¼šå¯¹çº¿ç¨‹æ± å¤§å°åšé™åˆ¶ï¼Œçº¿ç¨‹æ± å¤§å°å®Œå…¨ä¾èµ–äºæ“ä½œç³»ç»Ÿï¼ˆæˆ–è€…è¯´ JVMï¼‰èƒ½å¤Ÿåˆ›å»ºçš„æœ€å¤§çº¿ç¨‹å¤§å°ã€‚</li>
<li><code>newScheduledThreadPool</code>ï¼šåˆ›å»ºä¸€ä¸ªå¤§å°æ— é™çš„çº¿ç¨‹æ± ã€‚æ­¤çº¿ç¨‹æ± æ”¯æŒå®šæ—¶ä»¥åŠå‘¨æœŸæ€§æ‰§è¡Œä»»åŠ¡çš„éœ€æ±‚ã€‚</li>
<li><code>newSingleThreadScheduledExecutor</code>ï¼šåˆ›å»ºä¸€ä¸ªå•çº¿ç¨‹çš„çº¿ç¨‹æ± ã€‚æ­¤çº¿ç¨‹æ± æ”¯æŒå®šæ—¶ä»¥åŠå‘¨æœŸæ€§æ‰§è¡Œä»»åŠ¡çš„éœ€æ±‚ã€‚</li>
</ul>
<p>ç¬¬ 60 é¢˜çš„ä¾‹å­ä¸­æ¼”ç¤ºäº†é€šè¿‡ <code>Executors</code> å·¥å…·ç±»åˆ›å»ºçº¿ç¨‹æ± å¹¶ä½¿ç”¨çº¿ç¨‹æ± æ‰§è¡Œçº¿ç¨‹çš„ä»£ç ã€‚å¦‚æœå¸Œæœ›åœ¨æœåŠ¡å™¨ä¸Šä½¿ç”¨çº¿ç¨‹æ± ï¼Œå¼ºçƒˆå»ºè®®ä½¿ç”¨ <code>newFixedThreadPool</code> æ–¹æ³•æ¥åˆ›å»ºçº¿ç¨‹æ± ï¼Œè¿™æ ·èƒ½è·å¾—æ›´å¥½çš„æ€§èƒ½ã€‚</p>
<blockquote>
<p>66ã€çº¿ç¨‹çš„åŸºæœ¬çŠ¶æ€ä»¥åŠçŠ¶æ€ä¹‹é—´çš„å…³ç³»ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼š</p>
<p><img src= "https://cdn.jsdelivr.net/gh/Eurkon/CDN/hexo/images/user/loading.gif" data-lazy-src="/images/post/java_interview/66.png" alt></p>
<p><strong>è¯´æ˜ï¼š</strong>å…¶ä¸­ <code>Running</code> è¡¨ç¤ºè¿è¡ŒçŠ¶æ€ï¼Œ<code>Runnable</code> è¡¨ç¤ºå°±ç»ªçŠ¶æ€ï¼ˆä¸‡äº‹ä¿±å¤‡ï¼Œåªæ¬  CPUï¼‰ï¼Œ<code>Blocked</code> è¡¨ç¤ºé˜»å¡çŠ¶æ€ï¼Œé˜»å¡çŠ¶æ€åˆæœ‰å¤šç§æƒ…å†µï¼Œå¯èƒ½æ˜¯å› ä¸ºè°ƒç”¨ <code>wait()</code> æ–¹æ³•è¿›å…¥ç­‰å¾…æ± ï¼Œä¹Ÿå¯èƒ½æ˜¯æ‰§è¡ŒåŒæ­¥æ–¹æ³•æˆ–åŒæ­¥ä»£ç å—è¿›å…¥ç­‰é”æ± ï¼Œæˆ–è€…æ˜¯è°ƒç”¨äº† <code>sleep()</code> æ–¹æ³•æˆ– <code>join()</code> æ–¹æ³•ç­‰å¾…ä¼‘çœ æˆ–å…¶ä»–çº¿ç¨‹ç»“æŸï¼Œæˆ–æ˜¯å› ä¸ºå‘ç”Ÿäº† I/O ä¸­æ–­ã€‚</p>
<blockquote>
<p>67ã€ç®€è¿° <code>synchronized</code> å’Œ <code>java.util.concurrent.locks.Lock</code> çš„å¼‚åŒï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼š<code>Lock</code> æ˜¯ Java 5 ä»¥åå¼•å…¥çš„æ–°çš„ APIï¼Œå’Œå…³é”®å­— <code>synchronized</code> ç›¸æ¯”ä¸»è¦ç›¸åŒç‚¹ï¼š<code>Lock</code> èƒ½å®Œæˆ <code>synchronized</code> æ‰€å®ç°çš„æ‰€æœ‰åŠŸèƒ½ï¼›ä¸»è¦ä¸åŒç‚¹ï¼š<code>Lock</code> æœ‰æ¯” <code>synchronized</code> æ›´ç²¾ç¡®çš„çº¿ç¨‹è¯­ä¹‰å’Œæ›´å¥½çš„æ€§èƒ½ï¼Œè€Œä¸”ä¸å¼ºåˆ¶æ€§çš„è¦æ±‚ä¸€å®šè¦è·å¾—é”ã€‚<code>synchronized</code> ä¼šè‡ªåŠ¨é‡Šæ”¾é”ï¼Œè€Œ <code>Lock</code> ä¸€å®šè¦æ±‚ç¨‹åºå‘˜æ‰‹å·¥é‡Šæ”¾ï¼Œå¹¶ä¸”æœ€å¥½åœ¨ <code>finally</code> å—ä¸­é‡Šæ”¾ï¼ˆè¿™æ˜¯é‡Šæ”¾å¤–éƒ¨èµ„æºçš„æœ€å¥½çš„åœ°æ–¹ï¼‰ã€‚</p>
<h1 id="Java-I-Oï¼ˆ68-72ï¼‰"><a href="#Java-I-Oï¼ˆ68-72ï¼‰" class="headerlink" title="Java I/Oï¼ˆ68~72ï¼‰"></a>Java I/Oï¼ˆ68~72ï¼‰</h1><blockquote>
<p>68ã€Java ä¸­å¦‚ä½•å®ç°åºåˆ—åŒ–ï¼Œæœ‰ä»€ä¹ˆæ„ä¹‰ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šåºåˆ—åŒ–å°±æ˜¯ä¸€ç§ç”¨æ¥å¤„ç†å¯¹è±¡æµçš„æœºåˆ¶ï¼Œæ‰€è°“å¯¹è±¡æµä¹Ÿå°±æ˜¯å°†å¯¹è±¡çš„å†…å®¹è¿›è¡ŒæµåŒ–ã€‚å¯ä»¥å¯¹æµåŒ–åçš„å¯¹è±¡è¿›è¡Œè¯»å†™æ“ä½œï¼Œä¹Ÿå¯å°†æµåŒ–åçš„å¯¹è±¡ä¼ è¾“äºç½‘ç»œä¹‹é—´ã€‚åºåˆ—åŒ–æ˜¯ä¸ºäº†è§£å†³å¯¹è±¡æµè¯»å†™æ“ä½œæ—¶å¯èƒ½å¼•å‘çš„é—®é¢˜ï¼ˆå¦‚æœä¸è¿›è¡Œåºåˆ—åŒ–å¯èƒ½ä¼šå­˜åœ¨æ•°æ®ä¹±åºçš„é—®é¢˜ï¼‰ã€‚</p>
<p>è¦å®ç°åºåˆ—åŒ–ï¼Œéœ€è¦è®©ä¸€ä¸ªç±»å®ç° <code>Serializable</code> æ¥å£ï¼Œè¯¥æ¥å£æ˜¯ä¸€ä¸ªæ ‡è¯†æ€§æ¥å£ï¼Œæ ‡æ³¨è¯¥ç±»å¯¹è±¡æ˜¯å¯è¢«åºåˆ—åŒ–çš„ï¼Œç„¶åä½¿ç”¨ä¸€ä¸ªè¾“å‡ºæµæ¥æ„é€ ä¸€ä¸ªå¯¹è±¡è¾“å‡ºæµå¹¶é€šè¿‡ <code>writeObject(Object)</code> æ–¹æ³•å°±å¯ä»¥å°†å®ç°å¯¹è±¡å†™å‡ºï¼ˆå³ä¿å­˜å…¶çŠ¶æ€ï¼‰ï¼›å¦‚æœéœ€è¦ååºåˆ—åŒ–åˆ™å¯ä»¥ç”¨ä¸€ä¸ªè¾“å…¥æµå»ºç«‹å¯¹è±¡è¾“å…¥æµï¼Œç„¶åé€šè¿‡ <code>readObject</code> æ–¹æ³•ä»æµä¸­è¯»å–å¯¹è±¡ã€‚åºåˆ—åŒ–é™¤äº†èƒ½å¤Ÿå®ç°å¯¹è±¡çš„æŒä¹…åŒ–ä¹‹å¤–ï¼Œè¿˜èƒ½å¤Ÿç”¨äºå¯¹è±¡çš„æ·±åº¦å…‹éš†ï¼ˆå¯ä»¥å‚è€ƒç¬¬ 29 é¢˜ï¼‰ã€‚</p>
<blockquote>
<p>69ã€Java ä¸­æœ‰å‡ ç§ç±»å‹çš„æµï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼š<strong>å­—èŠ‚æµ</strong>å’Œ<strong>å­—ç¬¦æµ</strong>ã€‚å­—èŠ‚æµç»§æ‰¿äº <code>InputStream</code>ã€<code>OutputStream</code>ï¼Œå­—ç¬¦æµç»§æ‰¿äº <code>Reader</code>ã€<code>Writer</code>ã€‚åœ¨ <code>java.io</code> åŒ…ä¸­è¿˜æœ‰è®¸å¤šå…¶ä»–çš„æµï¼Œä¸»è¦æ˜¯ä¸ºäº†æé«˜æ€§èƒ½å’Œä½¿ç”¨æ–¹ä¾¿ã€‚å…³äº Java çš„ I/O éœ€è¦æ³¨æ„çš„æœ‰ä¸¤ç‚¹ï¼šä¸€æ˜¯ä¸¤ç§<strong>å¯¹ç§°æ€§</strong>ï¼ˆè¾“å…¥å’Œè¾“å‡ºçš„å¯¹ç§°æ€§ï¼Œå­—èŠ‚å’Œå­—ç¬¦çš„å¯¹ç§°æ€§ï¼‰ï¼›äºŒæ˜¯ä¸¤ç§<strong>è®¾è®¡æ¨¡å¼</strong>ï¼ˆé€‚é…å™¨æ¨¡å¼å’Œè£…æ½¢æ¨¡å¼ï¼‰ã€‚å¦å¤– Java ä¸­çš„æµä¸åŒäº C# çš„æ˜¯å®ƒåªæœ‰ä¸€ä¸ªç»´åº¦ä¸€ä¸ªæ–¹å‘ã€‚</p>
<p>é¢è¯•é¢˜ - ç¼–ç¨‹å®ç°æ–‡ä»¶æ‹·è´ã€‚ï¼ˆè¿™ä¸ªé¢˜ç›®åœ¨ç¬”è¯•çš„æ—¶å€™ç»å¸¸å‡ºç°ï¼Œä¸‹é¢çš„ä»£ç ç»™å‡ºäº†ä¸¤ç§å®ç°æ–¹æ¡ˆï¼‰</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.io.FileInputStream;<br><span class="hljs-keyword">import</span> java.io.FileOutputStream;<br><span class="hljs-keyword">import</span> java.io.IOException;<br><span class="hljs-keyword">import</span> java.io.InputStream;<br><span class="hljs-keyword">import</span> java.io.OutputStream;<br><span class="hljs-keyword">import</span> java.nio.ByteBuffer;<br><span class="hljs-keyword">import</span> java.nio.channels.FileChannel;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyUtil</span> </span>&#123;<br><br>    <span class="hljs-comment">// å·¥å…·ç±»ä¸­çš„æ–¹æ³•éƒ½æ˜¯é™æ€æ–¹å¼è®¿é—®çš„ï¼Œå› æ­¤å°†æ„é€ å™¨ç§æœ‰ä¸å…è®¸åˆ›å»ºå¯¹è±¡(ç»å¯¹å¥½ä¹ æƒ¯)</span><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-title">MyUtil</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> AssertionError();<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">fileCopy</span><span class="hljs-params">(String source, String target)</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;<br>        <span class="hljs-keyword">try</span> (InputStream in = <span class="hljs-keyword">new</span> FileInputStream(source)) &#123;<br>            <span class="hljs-keyword">try</span> (OutputStream out = <span class="hljs-keyword">new</span> FileOutputStream(target)) &#123;<br>                <span class="hljs-keyword">byte</span>[] buffer = <span class="hljs-keyword">new</span> <span class="hljs-keyword">byte</span>[<span class="hljs-number">4096</span>];<br>                <span class="hljs-keyword">int</span> bytesToRead;<br>                <span class="hljs-keyword">while</span>((bytesToRead = in.read(buffer)) != -<span class="hljs-number">1</span>) &#123;<br>                    out.write(buffer, <span class="hljs-number">0</span>, bytesToRead);<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">fileCopyNIO</span><span class="hljs-params">(String source, String target)</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;<br>        <span class="hljs-keyword">try</span> (FileInputStream in = <span class="hljs-keyword">new</span> FileInputStream(source)) &#123;<br>            <span class="hljs-keyword">try</span> (FileOutputStream out = <span class="hljs-keyword">new</span> FileOutputStream(target)) &#123;<br>                FileChannel inChannel = in.getChannel();<br>                FileChannel outChannel = out.getChannel();<br>                ByteBuffer buffer = ByteBuffer.allocate(<span class="hljs-number">4096</span>);<br>                <span class="hljs-keyword">while</span>(inChannel.read(buffer) != -<span class="hljs-number">1</span>) &#123;<br>                    buffer.flip();<br>                    outChannel.write(buffer);<br>                    buffer.clear();<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<p><strong>æ³¨æ„ï¼š</strong>ä¸Šé¢ç”¨åˆ° Java 7 çš„ TWRï¼Œä½¿ç”¨ TWR åå¯ä»¥ä¸ç”¨åœ¨ <code>finally</code> ä¸­é‡Šæ”¾å¤–éƒ¨èµ„æº ï¼Œä»è€Œè®©ä»£ç æ›´åŠ ä¼˜é›…ã€‚</p>
<blockquote>
<p>70ã€å†™ä¸€ä¸ªæ–¹æ³•ï¼Œè¾“å…¥ä¸€ä¸ªæ–‡ä»¶åå’Œä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œç»Ÿè®¡è¿™ä¸ªå­—ç¬¦ä¸²åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­å‡ºç°çš„æ¬¡æ•°ã€‚</p>
</blockquote>
<p>ç­”ï¼šä»£ç å¦‚ä¸‹ï¼š</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.io.BufferedReader;<br><span class="hljs-keyword">import</span> java.io.FileReader;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyUtil</span> </span>&#123;<br><br>    <span class="hljs-comment">// å·¥å…·ç±»ä¸­çš„æ–¹æ³•éƒ½æ˜¯é™æ€æ–¹å¼è®¿é—®çš„ï¼Œå› æ­¤å°†æ„é€ å™¨ç§æœ‰ä¸å…è®¸åˆ›å»ºå¯¹è±¡(ç»å¯¹å¥½ä¹ æƒ¯)</span><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-title">MyUtil</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> AssertionError();<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * ç»Ÿè®¡ç»™å®šæ–‡ä»¶ä¸­ç»™å®šå­—ç¬¦ä¸²çš„å‡ºç°æ¬¡æ•°</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> filename æ–‡ä»¶å</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> word å­—ç¬¦ä¸²</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> å­—ç¬¦ä¸²åœ¨æ–‡ä»¶ä¸­å‡ºç°çš„æ¬¡æ•°</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> <span class="hljs-title">countWordInFile</span><span class="hljs-params">(String filename, String word)</span> </span>&#123;<br>        <span class="hljs-keyword">int</span> counter = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">try</span> (FileReader fr = <span class="hljs-keyword">new</span> FileReader(filename)) &#123;<br>            <span class="hljs-keyword">try</span> (BufferedReader br = <span class="hljs-keyword">new</span> BufferedReader(fr)) &#123;<br>                String line = <span class="hljs-keyword">null</span>;<br>                <span class="hljs-keyword">while</span> ((line = br.readLine()) != <span class="hljs-keyword">null</span>) &#123;<br>                    <span class="hljs-keyword">int</span> index = -<span class="hljs-number">1</span>;<br>                    <span class="hljs-keyword">while</span> (line.length() &gt;= word.length() &amp;&amp; (index = line.indexOf(word)) &gt;= <span class="hljs-number">0</span>) &#123;<br>                        counter++;<br>                        line = line.substring(index + word.length());<br>                    &#125;<br>                &#125;<br>            &#125;<br>        &#125; <span class="hljs-keyword">catch</span> (Exception ex) &#123;<br>            ex.printStackTrace();<br>        &#125;<br>        <span class="hljs-keyword">return</span> counter;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<blockquote>
<p>71ã€å¦‚ä½•ç”¨ Java ä»£ç åˆ—å‡ºä¸€ä¸ªç›®å½•ä¸‹æ‰€æœ‰çš„æ–‡ä»¶ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼š</p>
<p>å¦‚æœåªè¦æ±‚åˆ—å‡ºå½“å‰æ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶ï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.io.File;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test12</span> </span>&#123;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        File f = <span class="hljs-keyword">new</span> File(<span class="hljs-string">&quot;/Users/Hao/Downloads&quot;</span>);<br>        <span class="hljs-keyword">for</span>(File temp : f.listFiles()) &#123;<br>            <span class="hljs-keyword">if</span>(temp.isFile()) &#123;<br>                System.out.println(temp.getName());<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<p>å¦‚æœéœ€è¦å¯¹æ–‡ä»¶å¤¹ç»§ç»­å±•å¼€ï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.io.File;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test12</span> </span>&#123;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        showDirectory(<span class="hljs-keyword">new</span> File(<span class="hljs-string">&quot;/Users/Hao/Downloads&quot;</span>));<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">showDirectory</span><span class="hljs-params">(File f)</span> </span>&#123;<br>        _walkDirectory(f, <span class="hljs-number">0</span>);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">_walkDirectory</span><span class="hljs-params">(File f, <span class="hljs-keyword">int</span> level)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span>(f.isDirectory()) &#123;<br>            <span class="hljs-keyword">for</span>(File temp : f.listFiles()) &#123;<br>                _walkDirectory(temp, level + <span class="hljs-number">1</span>);<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; level - <span class="hljs-number">1</span>; i++) &#123;<br>                System.out.print(<span class="hljs-string">&quot;\t&quot;</span>);<br>            &#125;<br>            System.out.println(f.getName());<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<p>åœ¨ Java 7 ä¸­å¯ä»¥ä½¿ç”¨ NIO.2 çš„ API æ¥åšåŒæ ·çš„äº‹æƒ…ï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ShowFileTest</span> </span>&#123;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;<br>        Path initPath = Paths.get(<span class="hljs-string">&quot;/Users/Hao/Downloads&quot;</span>);<br>        Files.walkFileTree(initPath, <span class="hljs-keyword">new</span> SimpleFileVisitor&lt;Path&gt;() &#123;<br><br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-function"><span class="hljs-keyword">public</span> FileVisitResult <span class="hljs-title">visitFile</span><span class="hljs-params">(Path file, BasicFileAttributes attrs)</span> </span><br><span class="hljs-function">                    <span class="hljs-keyword">throws</span> IOException </span>&#123;<br>                System.out.println(file.getFileName().toString());<br>                <span class="hljs-keyword">return</span> FileVisitResult.CONTINUE;<br>            &#125;<br><br>        &#125;);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<blockquote>
<p>72ã€ç”¨ Java çš„å¥—æ¥å­—ç¼–ç¨‹å®ç°ä¸€ä¸ªå¤šçº¿ç¨‹çš„å›æ˜¾ï¼ˆechoï¼‰æœåŠ¡å™¨ã€‚</p>
</blockquote>
<p>ç­”ï¼š</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.io.BufferedReader;<br><span class="hljs-keyword">import</span> java.io.IOException;<br><span class="hljs-keyword">import</span> java.io.InputStreamReader;<br><span class="hljs-keyword">import</span> java.io.PrintWriter;<br><span class="hljs-keyword">import</span> java.net.ServerSocket;<br><span class="hljs-keyword">import</span> java.net.Socket;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">EchoServer</span> </span>&#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> ECHO_SERVER_PORT = <span class="hljs-number">6789</span>;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;        <br>        <span class="hljs-keyword">try</span>(ServerSocket server = <span class="hljs-keyword">new</span> ServerSocket(ECHO_SERVER_PORT)) &#123;<br>            System.out.println(<span class="hljs-string">&quot;æœåŠ¡å™¨å·²ç»å¯åŠ¨...&quot;</span>);<br>            <span class="hljs-keyword">while</span>(<span class="hljs-keyword">true</span>) &#123;<br>                Socket client = server.accept();<br>                <span class="hljs-keyword">new</span> Thread(<span class="hljs-keyword">new</span> ClientHandler(client)).start();<br>            &#125;<br>        &#125; <span class="hljs-keyword">catch</span> (IOException e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ClientHandler</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Runnable</span> </span>&#123;<br>        <span class="hljs-keyword">private</span> Socket client;<br><br>        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">ClientHandler</span><span class="hljs-params">(Socket client)</span> </span>&#123;<br>            <span class="hljs-keyword">this</span>.client = client;<br>        &#125;<br><br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">run</span><span class="hljs-params">()</span> </span>&#123;<br>            <span class="hljs-keyword">try</span>(BufferedReader br = <span class="hljs-keyword">new</span> BufferedReader(<span class="hljs-keyword">new</span> InputStreamReader(client.getInputStream()));<br>                    PrintWriter pw = <span class="hljs-keyword">new</span> PrintWriter(client.getOutputStream())) &#123;<br>                String msg = br.readLine();<br>                System.out.println(<span class="hljs-string">&quot;æ”¶åˆ°&quot;</span> + client.getInetAddress() + <span class="hljs-string">&quot;å‘é€çš„: &quot;</span> + msg);<br>                pw.println(msg);<br>                pw.flush();<br>            &#125; <span class="hljs-keyword">catch</span>(Exception ex) &#123;<br>                ex.printStackTrace();<br>            &#125; <span class="hljs-keyword">finally</span> &#123;<br>                <span class="hljs-keyword">try</span> &#123;<br>                    client.close();<br>                &#125; <span class="hljs-keyword">catch</span> (IOException e) &#123;<br>                    e.printStackTrace();<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<p><strong>æ³¨æ„ï¼š</strong>ä¸Šé¢çš„ä»£ç ä½¿ç”¨äº† Java 7 çš„ TWR è¯­æ³•ï¼Œç”±äºå¾ˆå¤šå¤–éƒ¨èµ„æºç±»éƒ½é—´æ¥çš„å®ç°äº† <code>AutoCloseable</code> æ¥å£ï¼ˆå•æ–¹æ³•å›è°ƒæ¥å£ï¼‰ï¼Œå› æ­¤å¯ä»¥åˆ©ç”¨ TWR è¯­æ³•åœ¨ <code>try</code> ç»“æŸçš„æ—¶å€™é€šè¿‡å›è°ƒçš„æ–¹å¼è‡ªåŠ¨è°ƒç”¨å¤–éƒ¨èµ„æºç±»çš„ <code>close()</code> æ–¹æ³•ï¼Œé¿å…ä¹¦å†™å†—é•¿çš„ <code>finally</code> ä»£ç å—ã€‚æ­¤å¤–ï¼Œä¸Šé¢çš„ä»£ç ç”¨ä¸€ä¸ªé™æ€å†…éƒ¨ç±»å®ç°çº¿ç¨‹çš„åŠŸèƒ½ï¼Œä½¿ç”¨å¤šçº¿ç¨‹å¯ä»¥é¿å…ä¸€ä¸ªç”¨æˆ· I/O æ“ä½œæ‰€äº§ç”Ÿçš„ä¸­æ–­å½±å“å…¶ä»–ç”¨æˆ·å¯¹æœåŠ¡å™¨çš„è®¿é—®ï¼Œç®€å•çš„è¯´å°±æ˜¯ä¸€ä¸ªç”¨æˆ·çš„è¾“å…¥æ“ä½œä¸ä¼šé€ æˆå…¶ä»–ç”¨æˆ·çš„é˜»å¡ã€‚å½“ç„¶ï¼Œä¸Šé¢çš„ä»£ç ä½¿ç”¨çº¿ç¨‹æ± å¯ä»¥è·å¾—æ›´å¥½çš„æ€§èƒ½ï¼Œå› ä¸ºé¢‘ç¹çš„åˆ›å»ºå’Œé”€æ¯çº¿ç¨‹æ‰€é€ æˆçš„å¼€é”€ä¹Ÿæ˜¯ä¸å¯å¿½è§†çš„ã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€æ®µå›æ˜¾å®¢æˆ·ç«¯æµ‹è¯•ä»£ç ï¼š</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.io.BufferedReader;<br><span class="hljs-keyword">import</span> java.io.InputStreamReader;<br><span class="hljs-keyword">import</span> java.io.PrintWriter;<br><span class="hljs-keyword">import</span> java.net.Socket;<br><span class="hljs-keyword">import</span> java.util.Scanner;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">EchoClient</span> </span>&#123;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>        Socket client = <span class="hljs-keyword">new</span> Socket(<span class="hljs-string">&quot;localhost&quot;</span>, <span class="hljs-number">6789</span>);<br>        Scanner sc = <span class="hljs-keyword">new</span> Scanner(System.in);<br>        System.out.print(<span class="hljs-string">&quot;è¯·è¾“å…¥å†…å®¹: &quot;</span>);<br>        String msg = sc.nextLine();<br>        sc.close();<br>        PrintWriter pw = <span class="hljs-keyword">new</span> PrintWriter(client.getOutputStream());<br>        pw.println(msg);<br>        pw.flush();<br>        BufferedReader br = <span class="hljs-keyword">new</span> BufferedReader(<span class="hljs-keyword">new</span> InputStreamReader(client.getInputStream()));<br>        System.out.println(br.readLine());<br>        client.close();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<p>å¦‚æœå¸Œæœ›ç”¨ NIO çš„å¤šè·¯å¤ç”¨å¥—æ¥å­—å®ç°æœåŠ¡å™¨ï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤ºã€‚NIO çš„æ“ä½œè™½ç„¶å¸¦æ¥äº†æ›´å¥½çš„æ€§èƒ½ï¼Œä½†æ˜¯æœ‰äº›æ“ä½œæ˜¯æ¯”è¾ƒåº•å±‚çš„ï¼Œå¯¹äºåˆå­¦è€…æ¥è¯´è¿˜æ˜¯æœ‰äº›éš¾äºç†è§£ã€‚</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.io.IOException;<br><span class="hljs-keyword">import</span> java.net.InetSocketAddress;<br><span class="hljs-keyword">import</span> java.nio.ByteBuffer;<br><span class="hljs-keyword">import</span> java.nio.CharBuffer;<br><span class="hljs-keyword">import</span> java.nio.channels.SelectionKey;<br><span class="hljs-keyword">import</span> java.nio.channels.Selector;<br><span class="hljs-keyword">import</span> java.nio.channels.ServerSocketChannel;<br><span class="hljs-keyword">import</span> java.nio.channels.SocketChannel;<br><span class="hljs-keyword">import</span> java.util.Iterator;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">EchoServerNIO</span> </span>&#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> ECHO_SERVER_PORT = <span class="hljs-number">6789</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> ECHO_SERVER_TIMEOUT = <span class="hljs-number">5000</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> BUFFER_SIZE = <span class="hljs-number">1024</span>;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> ServerSocketChannel serverChannel = <span class="hljs-keyword">null</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Selector selector = <span class="hljs-keyword">null</span>;    <span class="hljs-comment">// å¤šè·¯å¤ç”¨é€‰æ‹©å™¨</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> ByteBuffer buffer = <span class="hljs-keyword">null</span>;    <span class="hljs-comment">// ç¼“å†²åŒº</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        init();<br>        listen();<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">init</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            serverChannel = ServerSocketChannel.open();<br>            buffer = ByteBuffer.allocate(BUFFER_SIZE);<br>            serverChannel.socket().bind(<span class="hljs-keyword">new</span> InetSocketAddress(ECHO_SERVER_PORT));<br>            serverChannel.configureBlocking(<span class="hljs-keyword">false</span>);<br>            selector = Selector.open();<br>            serverChannel.register(selector, SelectionKey.OP_ACCEPT);<br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> RuntimeException(e);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">listen</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">while</span> (<span class="hljs-keyword">true</span>) &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                <span class="hljs-keyword">if</span> (selector.select(ECHO_SERVER_TIMEOUT) != <span class="hljs-number">0</span>) &#123;<br>                    Iterator&lt;SelectionKey&gt; it = selector.selectedKeys().iterator();<br>                    <span class="hljs-keyword">while</span> (it.hasNext()) &#123;<br>                        SelectionKey key = it.next();<br>                        it.remove();<br>                        handleKey(key);<br>                    &#125;<br>                &#125;<br>            &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>                e.printStackTrace();<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">handleKey</span><span class="hljs-params">(SelectionKey key)</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;<br>        SocketChannel channel = <span class="hljs-keyword">null</span>;<br><br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-keyword">if</span> (key.isAcceptable()) &#123;<br>                ServerSocketChannel serverChannel = (ServerSocketChannel) key.channel();<br>                channel = serverChannel.accept();<br>                channel.configureBlocking(<span class="hljs-keyword">false</span>);<br>                channel.register(selector, SelectionKey.OP_READ);<br>            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (key.isReadable()) &#123;<br>                channel = (SocketChannel) key.channel();<br>                buffer.clear();<br>                <span class="hljs-keyword">if</span> (channel.read(buffer) &gt; <span class="hljs-number">0</span>) &#123;<br>                    buffer.flip();<br>                    CharBuffer charBuffer = CharsetHelper.decode(buffer);<br>                    String msg = charBuffer.toString();<br>                    System.out.println(<span class="hljs-string">&quot;æ”¶åˆ°&quot;</span> + channel.getRemoteAddress() + <span class="hljs-string">&quot;çš„æ¶ˆæ¯ï¼š&quot;</span> + msg);<br>                    channel.write(CharsetHelper.encode(CharBuffer.wrap(msg)));<br>                &#125; <span class="hljs-keyword">else</span> &#123;<br>                    channel.close();<br>                &#125;<br>            &#125;<br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            e.printStackTrace();<br>            <span class="hljs-keyword">if</span> (channel != <span class="hljs-keyword">null</span>) &#123;<br>                channel.close();<br>            &#125;<br>        &#125;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.nio.ByteBuffer;<br><span class="hljs-keyword">import</span> java.nio.CharBuffer;<br><span class="hljs-keyword">import</span> java.nio.charset.CharacterCodingException;<br><span class="hljs-keyword">import</span> java.nio.charset.Charset;<br><span class="hljs-keyword">import</span> java.nio.charset.CharsetDecoder;<br><span class="hljs-keyword">import</span> java.nio.charset.CharsetEncoder;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CharsetHelper</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String UTF_8 = <span class="hljs-string">&quot;UTF-8&quot;</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> CharsetEncoder encoder = Charset.forName(UTF_8).newEncoder();<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> CharsetDecoder decoder = Charset.forName(UTF_8).newDecoder();<br><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-title">CharsetHelper</span><span class="hljs-params">()</span> </span>&#123;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> ByteBuffer <span class="hljs-title">encode</span><span class="hljs-params">(CharBuffer in)</span> <span class="hljs-keyword">throws</span> CharacterCodingException</span>&#123;<br>        <span class="hljs-keyword">return</span> encoder.encode(in);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> CharBuffer <span class="hljs-title">decode</span><span class="hljs-params">(ByteBuffer in)</span> <span class="hljs-keyword">throws</span> CharacterCodingException</span>&#123;<br>        <span class="hljs-keyword">return</span> decoder.decode(in);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<h1 id="Java-æ•°æ®åº“ï¼ˆ73-84ï¼‰"><a href="#Java-æ•°æ®åº“ï¼ˆ73-84ï¼‰" class="headerlink" title="Java æ•°æ®åº“ï¼ˆ73~84ï¼‰"></a>Java æ•°æ®åº“ï¼ˆ73~84ï¼‰</h1><blockquote>
<p>73ã€XML æ–‡æ¡£å®šä¹‰æœ‰å‡ ç§å½¢å¼ï¼Ÿå®ƒä»¬ä¹‹é—´æœ‰ä½•æœ¬è´¨åŒºåˆ«ï¼Ÿè§£æ XML æ–‡æ¡£æœ‰å“ªå‡ ç§æ–¹å¼ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šXML æ–‡æ¡£å®šä¹‰åˆ†ä¸º DTD å’Œ Schema ä¸¤ç§å½¢å¼ï¼ŒäºŒè€…éƒ½æ˜¯å¯¹ XML è¯­æ³•çš„çº¦æŸï¼Œå…¶æœ¬è´¨åŒºåˆ«åœ¨äº Schema æœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ª XML æ–‡ä»¶ï¼Œå¯ä»¥è¢« XML è§£æå™¨è§£æï¼Œè€Œä¸”å¯ä»¥ä¸º XML æ‰¿è½½çš„æ•°æ®å®šä¹‰ç±»å‹ï¼Œçº¦æŸèƒ½åŠ›è¾ƒä¹‹ DTD æ›´å¼ºå¤§ã€‚å¯¹ XML çš„è§£æä¸»è¦æœ‰ DOMï¼ˆæ–‡æ¡£å¯¹è±¡æ¨¡å‹ï¼ŒDocument Object Modelï¼‰ã€SAXï¼ˆSimple API for XMLï¼‰å’Œ StAXï¼ˆJava 6 ä¸­å¼•å…¥çš„æ–°çš„è§£æ XML çš„æ–¹å¼ï¼ŒStreaming API for XMLï¼‰ï¼Œå…¶ä¸­ DOM å¤„ç†å¤§å‹æ–‡ä»¶æ—¶å…¶æ€§èƒ½ä¸‹é™çš„éå¸¸å‰å®³ï¼Œè¿™ä¸ªé—®é¢˜æ˜¯ç”± DOM æ ‘ç»“æ„å ç”¨çš„å†…å­˜è¾ƒå¤šé€ æˆçš„ï¼Œè€Œä¸” DOM è§£ææ–¹å¼å¿…é¡»åœ¨è§£ææ–‡ä»¶ä¹‹å‰æŠŠæ•´ä¸ªæ–‡æ¡£è£…å…¥å†…å­˜ï¼Œé€‚åˆå¯¹ XML çš„éšæœºè®¿é—®ï¼ˆå…¸å‹çš„ç”¨ç©ºé—´æ¢å–æ—¶é—´çš„ç­–ç•¥ï¼‰ï¼›SAX æ˜¯äº‹ä»¶é©±åŠ¨å‹çš„ XML è§£ææ–¹å¼ï¼Œå®ƒé¡ºåºè¯»å– XML æ–‡ä»¶ï¼Œä¸éœ€è¦ä¸€æ¬¡å…¨éƒ¨è£…è½½æ•´ä¸ªæ–‡ä»¶ã€‚å½“é‡åˆ°åƒæ–‡ä»¶å¼€å¤´ï¼Œæ–‡æ¡£ç»“æŸï¼Œæˆ–è€…æ ‡ç­¾å¼€å¤´ä¸æ ‡ç­¾ç»“æŸæ—¶ï¼Œå®ƒä¼šè§¦å‘ä¸€ä¸ªäº‹ä»¶ï¼Œç”¨æˆ·é€šè¿‡äº‹ä»¶å›è°ƒä»£ç æ¥å¤„ç†XMLæ–‡ä»¶ï¼Œé€‚åˆå¯¹ XML çš„é¡ºåºè®¿é—®ï¼›é¡¾åæ€ä¹‰ï¼ŒStAX æŠŠé‡ç‚¹æ”¾åœ¨æµä¸Šï¼Œå®é™…ä¸Š StAX ä¸å…¶ä»–è§£ææ–¹å¼çš„æœ¬è´¨åŒºåˆ«å°±åœ¨äºåº”ç”¨ç¨‹åºèƒ½å¤ŸæŠŠ XML ä½œä¸ºä¸€ä¸ªäº‹ä»¶æµæ¥å¤„ç†ã€‚å°† XML ä½œä¸ºä¸€ç»„äº‹ä»¶æ¥å¤„ç†çš„æƒ³æ³•å¹¶ä¸æ–°é¢–ï¼ˆSAX å°±æ˜¯è¿™æ ·åšçš„ï¼‰ï¼Œä½†ä¸åŒä¹‹å¤„åœ¨äº StAX å…è®¸åº”ç”¨ç¨‹åºä»£ç æŠŠè¿™äº›äº‹ä»¶é€ä¸ªæ‹‰å‡ºæ¥ï¼Œè€Œä¸ç”¨æä¾›åœ¨è§£æå™¨æ–¹ä¾¿æ—¶ä»è§£æå™¨ä¸­æ¥æ”¶äº‹ä»¶çš„å¤„ç†ç¨‹åºã€‚</p>
<blockquote>
<p>74ã€ä½ åœ¨é¡¹ç›®ä¸­å“ªäº›åœ°æ–¹ç”¨åˆ°äº† XMLï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šXML çš„ä¸»è¦ä½œç”¨æœ‰ä¸¤ä¸ªæ–¹é¢ï¼šæ•°æ®äº¤æ¢å’Œä¿¡æ¯é…ç½®ã€‚åœ¨åšæ•°æ®äº¤æ¢æ—¶ï¼ŒXML å°†æ•°æ®ç”¨æ ‡ç­¾ç»„è£…æˆèµ·æ¥ï¼Œç„¶åå‹ç¼©æ‰“åŒ…åŠ å¯†åé€šè¿‡ç½‘ç»œä¼ é€ç»™æ¥æ”¶è€…ï¼Œæ¥æ”¶è§£å¯†ä¸è§£å‹ç¼©åå†ä» XML æ–‡ä»¶ä¸­è¿˜åŸç›¸å…³ä¿¡æ¯è¿›è¡Œå¤„ç†ï¼ŒXML æ›¾ç»æ˜¯å¼‚æ„ç³»ç»Ÿé—´äº¤æ¢æ•°æ®çš„äº‹å®æ ‡å‡†ï¼Œä½†æ­¤é¡¹åŠŸèƒ½å‡ ä¹å·²ç»è¢« JSONï¼ˆJavaScript Object Notationï¼‰å–è€Œä»£ä¹‹ã€‚å½“ç„¶ï¼Œç›®å‰å¾ˆå¤šè½¯ä»¶ä»ç„¶ä½¿ç”¨ XML æ¥å­˜å‚¨é…ç½®ä¿¡æ¯ï¼Œæˆ‘ä»¬åœ¨å¾ˆå¤šé¡¹ç›®ä¸­é€šå¸¸ä¹Ÿä¼šå°†ä½œä¸ºé…ç½®ä¿¡æ¯çš„ç¡¬ä»£ç å†™åœ¨ XML æ–‡ä»¶ä¸­ï¼ŒJava çš„å¾ˆå¤šæ¡†æ¶ä¹Ÿæ˜¯è¿™ä¹ˆåšçš„ï¼Œè€Œä¸”è¿™äº›æ¡†æ¶éƒ½é€‰æ‹©äº† dom4j ä½œä¸ºå¤„ç† XML çš„å·¥å…·ï¼Œå› ä¸º Sun å…¬å¸çš„å®˜æ–¹ API å®åœ¨ä¸æ€ä¹ˆå¥½ç”¨ã€‚</p>
<p><strong>è¡¥å……ï¼š</strong>ç°åœ¨æœ‰å¾ˆå¤šæ—¶é«¦çš„è½¯ä»¶ï¼ˆå¦‚ Sublimeï¼‰å·²ç»å¼€å§‹å°†é…ç½®æ–‡ä»¶ä¹¦å†™æˆ JSON æ ¼å¼ï¼Œæˆ‘ä»¬å·²ç»å¼ºçƒˆçš„æ„Ÿå—åˆ° XML çš„å¦ä¸€é¡¹åŠŸèƒ½ä¹Ÿå°†é€æ¸è¢«ä¸šç•ŒæŠ›å¼ƒã€‚</p>
<blockquote>
<p>75ã€é˜è¿° JDBC æ“ä½œæ•°æ®åº“çš„æ­¥éª¤ã€‚</p>
</blockquote>
<p>ç­”ï¼šä¸‹é¢çš„ä»£ç ä»¥è¿æ¥æœ¬æœºçš„ Oracle æ•°æ®åº“ä¸ºä¾‹ï¼Œæ¼”ç¤º JDBC æ“ä½œæ•°æ®åº“çš„æ­¥éª¤ã€‚</p>
<ol>
<li><p>åŠ è½½é©±åŠ¨ã€‚</p>
<p> <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">Class.forName(<span class="hljs-string">&quot;oracle.jdbc.driver.OracleDriver&quot;</span>);<br></code></pre></td></tr></table></figure></p>
</li>
<li><p>åˆ›å»ºè¿æ¥ã€‚</p>
<p> <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">Connection con = DriverManager.getConnection(<span class="hljs-string">&quot;jdbc:oracle:thin:@localhost:1521:orcl&quot;</span>, <span class="hljs-string">&quot;scott&quot;</span>, <span class="hljs-string">&quot;tiger&quot;</span>);<br></code></pre></td></tr></table></figure></p>
</li>
<li><p>åˆ›å»ºè¯­å¥ã€‚</p>
<p> <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">PreparedStatement ps = con.prepareStatement(<span class="hljs-string">&quot;select * from emp where sal between ? and ?&quot;</span>);<br>ps.setInt(<span class="hljs-number">1</span>, <span class="hljs-number">1000</span>);<br>ps.setInt(<span class="hljs-number">2</span>, <span class="hljs-number">3000</span>);<br></code></pre></td></tr></table></figure></p>
</li>
<li><p>æ‰§è¡Œè¯­å¥ã€‚</p>
<p> <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">ResultSet rs = ps.executeQuery();<br></code></pre></td></tr></table></figure></p>
</li>
<li><p>å¤„ç†ç»“æœã€‚</p>
<p> <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">while</span>(rs.next()) &#123;<br>    System.out.println(rs.getInt(<span class="hljs-string">&quot;empno&quot;</span>) + <span class="hljs-string">&quot; - &quot;</span> + rs.getString(<span class="hljs-string">&quot;ename&quot;</span>));<br>&#125;<br></code></pre></td></tr></table></figure></p>
</li>
<li><p>å…³é—­èµ„æºã€‚</p>
<p> <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">finally</span> &#123;<br>    <span class="hljs-keyword">if</span>(con != <span class="hljs-keyword">null</span>) &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            con.close();<br>        &#125; <span class="hljs-keyword">catch</span> (SQLException e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
</p>
</li>
</ol>
<p><strong>æ³¨æ„ï¼š</strong>å…³é—­å¤–éƒ¨èµ„æºçš„é¡ºåºåº”è¯¥å’Œæ‰“å¼€çš„é¡ºåºç›¸åï¼Œä¹Ÿå°±æ˜¯è¯´å…ˆå…³é—­ <code>ResultSet</code>ã€å†å…³é—­ <code>Statement</code>ã€æœ€åå…³é—­ <code>Connection</code>ã€‚ä¸Šé¢çš„ä»£ç åªå…³é—­äº† Connection`ï¼ˆè¿æ¥ï¼‰ï¼Œè™½ç„¶é€šå¸¸æƒ…å†µä¸‹åœ¨å…³é—­è¿æ¥æ—¶ï¼Œè¿æ¥ä¸Šåˆ›å»ºçš„è¯­å¥å’Œæ‰“å¼€çš„æ¸¸æ ‡ä¹Ÿä¼šå…³é—­ï¼Œä½†ä¸èƒ½ä¿è¯æ€»æ˜¯å¦‚æ­¤ï¼Œå› æ­¤åº”è¯¥æŒ‰ç…§åˆšæ‰è¯´çš„é¡ºåºåˆ†åˆ«å…³é—­ã€‚æ­¤å¤–ï¼Œç¬¬ä¸€æ­¥åŠ è½½é©±åŠ¨åœ¨ JDBC 4.0 ä¸­æ˜¯å¯ä»¥çœç•¥çš„ï¼ˆè‡ªåŠ¨ä»ç±»è·¯å¾„ä¸­åŠ è½½é©±åŠ¨ï¼‰ï¼Œä½†æ˜¯æˆ‘ä»¬å»ºè®®ä¿ç•™ã€‚</p>
<blockquote>
<p>76ã€<code>Statement</code> å’Œ <code>PreparedStatement</code> æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿå“ªä¸ªæ€§èƒ½æ›´å¥½ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šä¸ <code>Statement</code> ç›¸æ¯”ï¼Œ<code>PreparedStatement</code> ä¸»è¦æœ‰ä»¥ä¸‹ä¼˜åŠ¿ï¼š</p>
<ol>
<li><code>PreparedStatement</code> æ¥å£ä»£è¡¨é¢„ç¼–è¯‘çš„è¯­å¥ï¼Œå®ƒä¸»è¦çš„ä¼˜åŠ¿åœ¨äºå¯ä»¥å‡å°‘ SQL çš„ç¼–è¯‘é”™è¯¯å¹¶å¢åŠ  SQL çš„å®‰å…¨æ€§ï¼ˆå‡å°‘ SQL æ³¨å°„æ”»å‡»çš„å¯èƒ½æ€§ï¼‰ï¼›</li>
<li><code>PreparedStatement</code> ä¸­çš„ SQL è¯­å¥æ˜¯å¯ä»¥å¸¦å‚æ•°çš„ï¼Œé¿å…äº†ç”¨å­—ç¬¦ä¸²è¿æ¥æ‹¼æ¥ SQL è¯­å¥çš„éº»çƒ¦å’Œä¸å®‰å…¨ï¼›</li>
<li>å½“æ‰¹é‡å¤„ç† SQL æˆ–é¢‘ç¹æ‰§è¡Œç›¸åŒçš„æŸ¥è¯¢æ—¶ï¼Œ<code>PreparedStatement</code>æœ‰æ˜æ˜¾çš„æ€§èƒ½ä¸Šçš„ä¼˜åŠ¿ï¼Œç”±äºæ•°æ®åº“å¯ä»¥å°†ç¼–è¯‘ä¼˜åŒ–åçš„ SQL è¯­å¥ç¼“å­˜èµ·æ¥ï¼Œä¸‹æ¬¡æ‰§è¡Œç›¸åŒç»“æ„çš„è¯­å¥æ—¶å°±ä¼šå¾ˆå¿«ï¼ˆä¸ç”¨å†æ¬¡ç¼–è¯‘å’Œç”Ÿæˆæ‰§è¡Œè®¡åˆ’ï¼‰ã€‚</li>
</ol>
<p><strong>è¡¥å……ï¼š</strong>ä¸ºäº†æä¾›å¯¹å­˜å‚¨è¿‡ç¨‹çš„è°ƒç”¨ï¼ŒJDBC API ä¸­è¿˜æä¾›äº† <code>CallableStatement</code> æ¥å£ã€‚å­˜å‚¨è¿‡ç¨‹ï¼ˆStored Procedureï¼‰æ˜¯æ•°æ®åº“ä¸­ä¸€ç»„ä¸ºäº†å®Œæˆç‰¹å®šåŠŸèƒ½çš„ SQL è¯­å¥çš„é›†åˆï¼Œç»ç¼–è¯‘åå­˜å‚¨åœ¨æ•°æ®åº“ä¸­ï¼Œç”¨æˆ·é€šè¿‡æŒ‡å®šå­˜å‚¨è¿‡ç¨‹çš„åå­—å¹¶ç»™å‡ºå‚æ•°ï¼ˆå¦‚æœè¯¥å­˜å‚¨è¿‡ç¨‹å¸¦æœ‰å‚æ•°ï¼‰æ¥æ‰§è¡Œå®ƒã€‚è™½ç„¶è°ƒç”¨å­˜å‚¨è¿‡ç¨‹ä¼šåœ¨ç½‘ç»œå¼€é”€ã€å®‰å…¨æ€§ã€æ€§èƒ½ä¸Šè·å¾—å¾ˆå¤šå¥½å¤„ï¼Œä½†æ˜¯å­˜åœ¨å¦‚æœåº•å±‚æ•°æ®åº“å‘ç”Ÿè¿ç§»æ—¶å°±ä¼šæœ‰å¾ˆå¤šéº»çƒ¦ï¼Œå› ä¸ºæ¯ç§æ•°æ®åº“çš„å­˜å‚¨è¿‡ç¨‹åœ¨ä¹¦å†™ä¸Šå­˜åœ¨ä¸å°‘çš„å·®åˆ«ã€‚</p>
<blockquote>
<p>77ã€ä½¿ç”¨ JDBC æ“ä½œæ•°æ®åº“æ—¶ï¼Œå¦‚ä½•æå‡è¯»å–æ•°æ®çš„æ€§èƒ½ï¼Ÿå¦‚ä½•æå‡æ›´æ–°æ•°æ®çš„æ€§èƒ½ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šè¦<strong>æå‡è¯»å–æ•°æ®çš„æ€§èƒ½</strong>ï¼Œå¯ä»¥æŒ‡å®šé€šè¿‡ç»“æœé›†ï¼ˆResultSetï¼‰å¯¹è±¡çš„ <code>setFetchSize()</code> æ–¹æ³•æŒ‡å®šæ¯æ¬¡æŠ“å–çš„è®°å½•æ•°ï¼ˆå…¸å‹çš„ç©ºé—´æ¢æ—¶é—´ç­–ç•¥ï¼‰ï¼›è¦æå‡æ›´æ–°æ•°æ®çš„æ€§èƒ½å¯ä»¥ä½¿ç”¨ <code>PreparedStatement</code> è¯­å¥æ„å»ºæ‰¹å¤„ç†ï¼Œå°†è‹¥å¹² SQL è¯­å¥ç½®äºä¸€ä¸ªæ‰¹å¤„ç†ä¸­æ‰§è¡Œã€‚</p>
<blockquote>
<p>78ã€åœ¨è¿›è¡Œæ•°æ®åº“ç¼–ç¨‹æ—¶ï¼Œè¿æ¥æ± æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šç”±äºåˆ›å»ºè¿æ¥å’Œé‡Šæ”¾è¿æ¥éƒ½æœ‰å¾ˆå¤§çš„å¼€é”€ï¼ˆå°¤å…¶æ˜¯æ•°æ®åº“æœåŠ¡å™¨ä¸åœ¨æœ¬åœ°æ—¶ï¼Œæ¯æ¬¡å»ºç«‹è¿æ¥éƒ½éœ€è¦è¿›è¡Œ TCP çš„ä¸‰æ¬¡æ¡æ‰‹ï¼Œé‡Šæ”¾è¿æ¥éœ€è¦è¿›è¡Œ TCP å››æ¬¡æ¡æ‰‹ï¼Œé€ æˆçš„å¼€é”€æ˜¯ä¸å¯å¿½è§†çš„ï¼‰ï¼Œä¸ºäº†æå‡ç³»ç»Ÿè®¿é—®æ•°æ®åº“çš„æ€§èƒ½ï¼Œå¯ä»¥äº‹å…ˆåˆ›å»ºè‹¥å¹²è¿æ¥ç½®äºè¿æ¥æ± ä¸­ï¼Œéœ€è¦æ—¶ç›´æ¥ä»è¿æ¥æ± è·å–ï¼Œä½¿ç”¨ç»“æŸæ—¶å½’è¿˜è¿æ¥æ± è€Œä¸å¿…å…³é—­è¿æ¥ï¼Œä»è€Œé¿å…é¢‘ç¹åˆ›å»ºå’Œé‡Šæ”¾è¿æ¥æ‰€é€ æˆçš„å¼€é”€ï¼Œè¿™æ˜¯å…¸å‹çš„ç”¨ç©ºé—´æ¢å–æ—¶é—´çš„ç­–ç•¥ï¼ˆæµªè´¹äº†ç©ºé—´å­˜å‚¨è¿æ¥ï¼Œä½†èŠ‚çœäº†åˆ›å»ºå’Œé‡Šæ”¾è¿æ¥çš„æ—¶é—´ï¼‰ã€‚æ± åŒ–æŠ€æœ¯åœ¨ Java å¼€å‘ä¸­æ˜¯å¾ˆå¸¸è§çš„ï¼Œåœ¨ä½¿ç”¨çº¿ç¨‹æ—¶åˆ›å»ºçº¿ç¨‹æ± çš„é“ç†ä¸æ­¤ç›¸åŒã€‚åŸºäº Java çš„å¼€æºæ•°æ®åº“è¿æ¥æ± ä¸»è¦æœ‰ï¼šC3P0ã€Proxoolã€DBCPã€BoneCPã€Druidç­‰ã€‚</p>
<p><strong>è¡¥å……ï¼š</strong>åœ¨è®¡ç®—æœºç³»ç»Ÿä¸­æ—¶é—´å’Œç©ºé—´æ˜¯ä¸å¯è°ƒå’Œçš„çŸ›ç›¾ï¼Œç†è§£è¿™ä¸€ç‚¹å¯¹è®¾è®¡æ»¡è¶³æ€§èƒ½è¦æ±‚çš„ç®—æ³•æ˜¯è‡³å…³é‡è¦çš„ã€‚å¤§å‹ç½‘ç«™æ€§èƒ½ä¼˜åŒ–çš„ä¸€ä¸ªå…³é”®å°±æ˜¯ä½¿ç”¨ç¼“å­˜ï¼Œè€Œç¼“å­˜è·Ÿä¸Šé¢è®²çš„è¿æ¥æ± é“ç†éå¸¸ç±»ä¼¼ï¼Œä¹Ÿæ˜¯ä½¿ç”¨ç©ºé—´æ¢æ—¶é—´çš„ç­–ç•¥ã€‚å¯ä»¥å°†çƒ­ç‚¹æ•°æ®ç½®äºç¼“å­˜ä¸­ï¼Œå½“ç”¨æˆ·æŸ¥è¯¢è¿™äº›æ•°æ®æ—¶å¯ä»¥ç›´æ¥ä»ç¼“å­˜ä¸­å¾—åˆ°ï¼Œè¿™æ— è®ºå¦‚ä½•ä¹Ÿå¿«è¿‡å»æ•°æ®åº“ä¸­æŸ¥è¯¢ã€‚å½“ç„¶ï¼Œç¼“å­˜çš„ç½®æ¢ç­–ç•¥ç­‰ä¹Ÿä¼šå¯¹ç³»ç»Ÿæ€§èƒ½äº§ç”Ÿé‡è¦å½±å“ï¼Œå¯¹äºè¿™ä¸ªé—®é¢˜çš„è®¨è®ºå·²ç»è¶…å‡ºäº†è¿™é‡Œè¦é˜è¿°çš„èŒƒå›´ã€‚</p>
<blockquote>
<p>79ã€ä»€ä¹ˆæ˜¯ DAO æ¨¡å¼ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šDAOï¼ˆData Access Objectï¼‰é¡¾åæ€ä¹‰æ˜¯ä¸€ä¸ªä¸ºæ•°æ®åº“æˆ–å…¶ä»–æŒä¹…åŒ–æœºåˆ¶æä¾›äº†æŠ½è±¡æ¥å£çš„å¯¹è±¡ï¼Œåœ¨ä¸æš´éœ²åº•å±‚æŒä¹…åŒ–æ–¹æ¡ˆå®ç°ç»†èŠ‚çš„å‰æä¸‹æä¾›äº†å„ç§æ•°æ®è®¿é—®æ“ä½œã€‚åœ¨å®é™…çš„å¼€å‘ä¸­ï¼Œåº”è¯¥å°†æ‰€æœ‰å¯¹æ•°æ®æºçš„è®¿é—®æ“ä½œè¿›è¡ŒæŠ½è±¡åŒ–åå°è£…åœ¨ä¸€ä¸ªå…¬å…± API ä¸­ã€‚ç”¨ç¨‹åºè®¾è®¡è¯­è¨€æ¥è¯´ï¼Œå°±æ˜¯å»ºç«‹ä¸€ä¸ªæ¥å£ï¼Œæ¥å£ä¸­å®šä¹‰äº†æ­¤åº”ç”¨ç¨‹åºä¸­å°†ä¼šç”¨åˆ°çš„æ‰€æœ‰äº‹åŠ¡æ–¹æ³•ã€‚åœ¨è¿™ä¸ªåº”ç”¨ç¨‹åºä¸­ï¼Œå½“éœ€è¦å’Œæ•°æ®æºè¿›è¡Œäº¤äº’çš„æ—¶å€™åˆ™ä½¿ç”¨è¿™ä¸ªæ¥å£ï¼Œå¹¶ä¸”ç¼–å†™ä¸€ä¸ªå•ç‹¬çš„ç±»æ¥å®ç°è¿™ä¸ªæ¥å£ï¼Œåœ¨é€»è¾‘ä¸Šè¯¥ç±»å¯¹åº”ä¸€ä¸ªç‰¹å®šçš„æ•°æ®å­˜å‚¨ã€‚DAO æ¨¡å¼å®é™…ä¸ŠåŒ…å«äº†ä¸¤ä¸ªæ¨¡å¼ï¼Œä¸€æ˜¯ Data Accessorï¼ˆæ•°æ®è®¿é—®å™¨ï¼‰ï¼ŒäºŒæ˜¯ Data Objectï¼ˆæ•°æ®å¯¹è±¡ï¼‰ï¼Œå‰è€…è¦è§£å†³å¦‚ä½•è®¿é—®æ•°æ®çš„é—®é¢˜ï¼Œè€Œåè€…è¦è§£å†³çš„æ˜¯å¦‚ä½•ç”¨å¯¹è±¡å°è£…æ•°æ®ã€‚</p>
<blockquote>
<p>80ã€äº‹åŠ¡çš„ ACID æ˜¯æŒ‡ä»€ä¹ˆï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼š</p>
<ul>
<li>åŸå­æ€§ï¼ˆAtomicï¼‰ï¼šäº‹åŠ¡ä¸­å„é¡¹æ“ä½œï¼Œè¦ä¹ˆå…¨åšè¦ä¹ˆå…¨ä¸åšï¼Œä»»ä½•ä¸€é¡¹æ“ä½œçš„å¤±è´¥éƒ½ä¼šå¯¼è‡´æ•´ä¸ªäº‹åŠ¡çš„å¤±è´¥ï¼›</li>
<li>ä¸€è‡´æ€§ï¼ˆConsistentï¼‰ï¼šäº‹åŠ¡ç»“æŸåç³»ç»ŸçŠ¶æ€æ˜¯ä¸€è‡´çš„ï¼›</li>
<li>éš”ç¦»æ€§ï¼ˆIsolatedï¼‰ï¼šå¹¶å‘æ‰§è¡Œçš„äº‹åŠ¡å½¼æ­¤æ— æ³•çœ‹åˆ°å¯¹æ–¹çš„ä¸­é—´çŠ¶æ€ï¼›</li>
<li>æŒä¹…æ€§ï¼ˆDurableï¼‰ï¼šäº‹åŠ¡å®Œæˆåæ‰€åšçš„æ”¹åŠ¨éƒ½ä¼šè¢«æŒä¹…åŒ–ï¼Œå³ä½¿å‘ç”Ÿç¾éš¾æ€§çš„å¤±è´¥ã€‚é€šè¿‡æ—¥å¿—å’ŒåŒæ­¥å¤‡ä»½å¯ä»¥åœ¨æ•…éšœå‘ç”Ÿåé‡å»ºæ•°æ®ã€‚</li>
</ul>
<p><strong>è¡¥å……ï¼š</strong>å…³äºäº‹åŠ¡ï¼Œåœ¨é¢è¯•ä¸­è¢«é—®åˆ°çš„æ¦‚ç‡æ˜¯å¾ˆé«˜çš„ï¼Œå¯ä»¥é—®çš„é—®é¢˜ä¹Ÿæ˜¯å¾ˆå¤šçš„ã€‚é¦–å…ˆéœ€è¦çŸ¥é“çš„æ˜¯ï¼Œåªæœ‰å­˜åœ¨<strong>å¹¶å‘æ•°æ®è®¿é—®</strong>æ—¶æ‰éœ€è¦äº‹åŠ¡ã€‚å½“å¤šä¸ªäº‹åŠ¡è®¿é—®åŒä¸€æ•°æ®æ—¶ï¼Œå¯èƒ½ä¼šå­˜åœ¨ 5 ç±»é—®é¢˜ï¼ŒåŒ…æ‹¬ 3 ç±»<strong>æ•°æ®è¯»å–</strong>é—®é¢˜ï¼ˆè„è¯»ã€ä¸å¯é‡å¤è¯»å’Œå¹»è¯»ï¼‰å’Œ 2 ç±»<strong>æ•°æ®æ›´æ–°</strong>é—®é¢˜ï¼ˆç¬¬ 1 ç±»ä¸¢å¤±æ›´æ–°å’Œç¬¬ 2 ç±»ä¸¢å¤±æ›´æ–°ï¼‰ã€‚</p>
<ul>
<li>è„è¯»ï¼ˆDirty Readï¼‰ï¼šA äº‹åŠ¡è¯»å– B äº‹åŠ¡å°šæœªæäº¤çš„æ•°æ®å¹¶åœ¨æ­¤åŸºç¡€ä¸Šæ“ä½œï¼Œè€Œ B äº‹åŠ¡æ‰§è¡Œå›æ»šï¼Œé‚£ä¹ˆ A è¯»å–åˆ°çš„æ•°æ®å°±æ˜¯è„æ•°æ®ã€‚</li>
</ul>
<div class="table-container">
<table>
<thead>
<tr>
<th>æ—¶é—´</th>
<th>è½¬è´¦äº‹åŠ¡A</th>
<th>å–æ¬¾äº‹åŠ¡B</th>
</tr>
</thead>
<tbody>
<tr>
<td>T1</td>
<td>&nbsp;</td>
<td>å¼€å§‹äº‹åŠ¡</td>
</tr>
<tr>
<td>T2</td>
<td>å¼€å§‹äº‹åŠ¡</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>T3</td>
<td>&nbsp;</td>
<td>æŸ¥è¯¢è´¦æˆ·ä½™é¢ä¸º1000å…ƒ</td>
</tr>
<tr>
<td>T4</td>
<td>&nbsp;</td>
<td>å–å‡º500å…ƒä½™é¢ä¿®æ”¹ä¸º500å…ƒ</td>
</tr>
<tr>
<td>T5</td>
<td>æŸ¥è¯¢è´¦æˆ·ä½™é¢ä¸º500å…ƒï¼ˆè„è¯»ï¼‰</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>T6</td>
<td>&nbsp;</td>
<td>æ’¤é”€äº‹åŠ¡ä½™é¢æ¢å¤ä¸º1000å…ƒ</td>
</tr>
<tr>
<td>T7</td>
<td>æ±‡å…¥100å…ƒæŠŠä½™é¢ä¿®æ”¹ä¸º600å…ƒ</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>T8</td>
<td>æäº¤äº‹åŠ¡</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
</div>
<ul>
<li>ä¸å¯é‡å¤è¯»ï¼ˆUnrepeatable Readï¼‰ï¼šäº‹åŠ¡ A é‡æ–°è¯»å–å‰é¢è¯»å–è¿‡çš„æ•°æ®ï¼Œå‘ç°è¯¥æ•°æ®å·²ç»è¢«å¦ä¸€ä¸ªå·²æäº¤çš„äº‹åŠ¡ B ä¿®æ”¹è¿‡äº†ã€‚</li>
</ul>
<div class="table-container">
<table>
<thead>
<tr>
<th>æ—¶é—´</th>
<th>è½¬è´¦äº‹åŠ¡A</th>
<th>å–æ¬¾äº‹åŠ¡B</th>
</tr>
</thead>
<tbody>
<tr>
<td>T1</td>
<td>&nbsp;</td>
<td>å¼€å§‹äº‹åŠ¡</td>
</tr>
<tr>
<td>T2</td>
<td>å¼€å§‹äº‹åŠ¡</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>T3</td>
<td>&nbsp;</td>
<td>æŸ¥è¯¢è´¦æˆ·ä½™é¢ä¸º1000å…ƒ</td>
</tr>
<tr>
<td>T4</td>
<td>æŸ¥è¯¢è´¦æˆ·ä½™é¢ä¸º1000å…ƒ</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>T5</td>
<td>&nbsp;</td>
<td>å–å‡º100å…ƒä¿®æ”¹ä½™é¢ä¸º900å…ƒ</td>
</tr>
<tr>
<td>T6</td>
<td>&nbsp;</td>
<td>æäº¤äº‹åŠ¡</td>
</tr>
<tr>
<td>T7</td>
<td>æŸ¥è¯¢è´¦æˆ·ä½™é¢ä¸º900å…ƒï¼ˆä¸å¯é‡å¤è¯»ï¼‰</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
</div>
<ul>
<li>å¹»è¯»ï¼ˆPhantom Readï¼‰ï¼šäº‹åŠ¡ A é‡æ–°æ‰§è¡Œä¸€ä¸ªæŸ¥è¯¢ï¼Œè¿”å›ä¸€ç³»åˆ—ç¬¦åˆæŸ¥è¯¢æ¡ä»¶çš„è¡Œï¼Œå‘ç°å…¶ä¸­æ’å…¥äº†è¢«äº‹åŠ¡ B æäº¤çš„è¡Œã€‚</li>
</ul>
<div class="table-container">
<table>
<thead>
<tr>
<th>æ—¶é—´</th>
<th>ç»Ÿè®¡é‡‘é¢äº‹åŠ¡A</th>
<th>è½¬è´¦äº‹åŠ¡B</th>
</tr>
</thead>
<tbody>
<tr>
<td>T1</td>
<td>&nbsp;</td>
<td>å¼€å§‹äº‹åŠ¡</td>
</tr>
<tr>
<td>T2</td>
<td>å¼€å§‹äº‹åŠ¡</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>T3</td>
<td>ç»Ÿè®¡æ€»å­˜æ¬¾ä¸º10000å…ƒ</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>T4</td>
<td>&nbsp;</td>
<td>æ–°å¢ä¸€ä¸ªå­˜æ¬¾è´¦æˆ·å­˜å…¥100å…ƒ</td>
</tr>
<tr>
<td>T5</td>
<td>&nbsp;</td>
<td>æäº¤äº‹åŠ¡</td>
</tr>
<tr>
<td>T6</td>
<td>å†æ¬¡ç»Ÿè®¡æ€»å­˜æ¬¾ä¸º10100å…ƒï¼ˆå¹»è¯»ï¼‰</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
</div>
<ul>
<li>ç¬¬ 1 ç±»ä¸¢å¤±æ›´æ–°ï¼šäº‹åŠ¡ A æ’¤é”€æ—¶ï¼ŒæŠŠå·²ç»æäº¤çš„äº‹åŠ¡ B çš„æ›´æ–°æ•°æ®è¦†ç›–äº†ã€‚</li>
</ul>
<div class="table-container">
<table>
<thead>
<tr>
<th>æ—¶é—´</th>
<th>å–æ¬¾äº‹åŠ¡A</th>
<th>è½¬è´¦äº‹åŠ¡B</th>
</tr>
</thead>
<tbody>
<tr>
<td>T1</td>
<td>å¼€å§‹äº‹åŠ¡</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>T2</td>
<td>&nbsp;</td>
<td>å¼€å§‹äº‹åŠ¡</td>
</tr>
<tr>
<td>T3</td>
<td>æŸ¥è¯¢è´¦æˆ·ä½™é¢ä¸º1000å…ƒ</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>T4</td>
<td>&nbsp;</td>
<td>æŸ¥è¯¢è´¦æˆ·ä½™é¢ä¸º1000å…ƒ</td>
</tr>
<tr>
<td>T5</td>
<td>&nbsp;</td>
<td>æ±‡å…¥100å…ƒä¿®æ”¹ä½™é¢ä¸º1100å…ƒ</td>
</tr>
<tr>
<td>T6</td>
<td>&nbsp;</td>
<td>æäº¤äº‹åŠ¡</td>
</tr>
<tr>
<td>T7</td>
<td>å–å‡º100å…ƒå°†ä½™é¢ä¿®æ”¹ä¸º900å…ƒ</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>T8</td>
<td>æ’¤é”€äº‹åŠ¡</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>T9</td>
<td>ä½™é¢æ¢å¤ä¸º1000å…ƒï¼ˆä¸¢å¤±æ›´æ–°ï¼‰</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
</div>
<ul>
<li>ç¬¬ 2 ç±»ä¸¢å¤±æ›´æ–°ï¼šäº‹åŠ¡ A è¦†ç›–äº‹åŠ¡ B å·²ç»æäº¤çš„æ•°æ®ï¼Œé€ æˆäº‹åŠ¡ B æ‰€åšçš„æ“ä½œä¸¢å¤±ã€‚</li>
</ul>
<div class="table-container">
<table>
<thead>
<tr>
<th>æ—¶é—´</th>
<th>è½¬è´¦äº‹åŠ¡A</th>
<th>å–æ¬¾äº‹åŠ¡B</th>
</tr>
</thead>
<tbody>
<tr>
<td>T1</td>
<td>&nbsp;</td>
<td>å¼€å§‹äº‹åŠ¡</td>
</tr>
<tr>
<td>T2</td>
<td>å¼€å§‹äº‹åŠ¡</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>T3</td>
<td>&nbsp;</td>
<td>æŸ¥è¯¢è´¦æˆ·ä½™é¢ä¸º1000å…ƒ</td>
</tr>
<tr>
<td>T4</td>
<td>æŸ¥è¯¢è´¦æˆ·ä½™é¢ä¸º1000å…ƒ</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>T5</td>
<td>&nbsp;</td>
<td>å–å‡º100å…ƒå°†ä½™é¢ä¿®æ”¹ä¸º900å…ƒ</td>
</tr>
<tr>
<td>T6</td>
<td>&nbsp;</td>
<td>æäº¤äº‹åŠ¡</td>
</tr>
<tr>
<td>T7</td>
<td>æ±‡å…¥100å…ƒå°†ä½™é¢ä¿®æ”¹ä¸º1100å…ƒ</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>T8</td>
<td>æäº¤äº‹åŠ¡</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>T9</td>
<td>æŸ¥è¯¢è´¦æˆ·ä½™é¢ä¸º1100å…ƒï¼ˆä¸¢å¤±æ›´æ–°ï¼‰</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
</div>
<p>æ•°æ®å¹¶å‘è®¿é—®æ‰€äº§ç”Ÿçš„é—®é¢˜ï¼Œåœ¨æœ‰äº›åœºæ™¯ä¸‹å¯èƒ½æ˜¯å…è®¸çš„ï¼Œä½†æ˜¯æœ‰äº›åœºæ™¯ä¸‹å¯èƒ½å°±æ˜¯è‡´å‘½çš„ï¼Œæ•°æ®åº“é€šå¸¸ä¼šé€šè¿‡<strong>é”æœºåˆ¶</strong>æ¥è§£å†³æ•°æ®å¹¶å‘è®¿é—®é—®é¢˜ï¼ŒæŒ‰é”å®šå¯¹è±¡ä¸åŒå¯ä»¥åˆ†ä¸º<strong>è¡¨çº§é”</strong>å’Œ<strong>è¡Œçº§é”</strong>ï¼›æŒ‰å¹¶å‘äº‹åŠ¡é”å®šå…³ç³»å¯ä»¥åˆ†ä¸º<strong>å…±äº«é”</strong>å’Œ<strong>ç‹¬å é”</strong>ï¼Œå…·ä½“çš„å†…å®¹å¤§å®¶å¯ä»¥è‡ªè¡ŒæŸ¥é˜…èµ„æ–™è¿›è¡Œäº†è§£ã€‚</p>
<p>ç›´æ¥ä½¿ç”¨é”æ˜¯éå¸¸éº»çƒ¦çš„ï¼Œä¸ºæ­¤æ•°æ®åº“ä¸ºç”¨æˆ·æä¾›äº†è‡ªåŠ¨é”æœºåˆ¶ï¼Œåªè¦ç”¨æˆ·æŒ‡å®šä¼šè¯çš„äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼Œæ•°æ®åº“å°±ä¼šé€šè¿‡åˆ†æ SQL è¯­å¥ç„¶åä¸ºäº‹åŠ¡è®¿é—®çš„èµ„æºåŠ ä¸Šåˆé€‚çš„é”ï¼Œæ­¤å¤–ï¼Œæ•°æ®åº“è¿˜ä¼šç»´æŠ¤è¿™äº›é”é€šè¿‡å„ç§æ‰‹æ®µæé«˜ç³»ç»Ÿçš„æ€§èƒ½ï¼Œè¿™äº›å¯¹ç”¨æˆ·æ¥è¯´éƒ½æ˜¯é€æ˜çš„ï¼ˆå°±æ˜¯è¯´ä½ ä¸ç”¨ç†è§£ï¼Œäº‹å®ä¸Šæˆ‘ç¡®å®ä¹Ÿä¸çŸ¥é“ï¼‰ã€‚ANSI/ISO SQL 92 æ ‡å‡†å®šä¹‰äº† 4 ä¸ªç­‰çº§çš„äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼Œå¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>éš”ç¦»çº§åˆ«</th>
<th>è„è¯»</th>
<th>ä¸å¯é‡å¤è¯»</th>
<th>å¹»è¯»</th>
<th>ç¬¬ä¸€ç±»ä¸¢å¤±æ›´æ–°</th>
<th>ç¬¬äºŒç±»ä¸¢å¤±æ›´æ–°</th>
</tr>
</thead>
<tbody>
<tr>
<td>READ UNCOMMITED</td>
<td>å…è®¸</td>
<td>å…è®¸</td>
<td>å…è®¸</td>
<td>ä¸å…è®¸</td>
<td>å…è®¸</td>
</tr>
<tr>
<td>READ COMMITTED</td>
<td>ä¸å…è®¸</td>
<td>å…è®¸</td>
<td>å…è®¸</td>
<td>ä¸å…è®¸</td>
<td>å…è®¸</td>
</tr>
<tr>
<td>REPEATABLE READ</td>
<td>ä¸å…è®¸</td>
<td>ä¸å…è®¸</td>
<td>å…è®¸</td>
<td>ä¸å…è®¸</td>
<td>ä¸å…è®¸</td>
</tr>
<tr>
<td>SERIALIZABLE</td>
<td>ä¸å…è®¸</td>
<td>ä¸å…è®¸</td>
<td>ä¸å…è®¸</td>
<td>ä¸å…è®¸</td>
<td>ä¸å…è®¸</td>
</tr>
</tbody>
</table>
</div>
<p><strong>æ³¨æ„ï¼š</strong>éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œäº‹åŠ¡éš”ç¦»çº§åˆ«å’Œæ•°æ®è®¿é—®çš„å¹¶å‘æ€§æ˜¯å¯¹ç«‹çš„ï¼Œäº‹åŠ¡éš”ç¦»çº§åˆ«è¶Šé«˜å¹¶å‘æ€§å°±è¶Šå·®ã€‚æ‰€ä»¥è¦æ ¹æ®å…·ä½“çš„åº”ç”¨æ¥ç¡®å®šåˆé€‚çš„äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼Œè¿™ä¸ªåœ°æ–¹æ²¡æœ‰ä¸‡èƒ½çš„åŸåˆ™ã€‚</p>
<blockquote>
<p>81ã€JDBC ä¸­å¦‚ä½•è¿›è¡Œäº‹åŠ¡å¤„ç†ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼š<code>Connection</code> æä¾›äº†äº‹åŠ¡å¤„ç†çš„æ–¹æ³•ï¼Œé€šè¿‡è°ƒç”¨ <code>setAutoCommit(false)</code> å¯ä»¥è®¾ç½®æ‰‹åŠ¨æäº¤äº‹åŠ¡ï¼›å½“äº‹åŠ¡å®Œæˆåç”¨ <code>commit()</code> æ˜¾å¼æäº¤äº‹åŠ¡ï¼›å¦‚æœåœ¨äº‹åŠ¡å¤„ç†è¿‡ç¨‹ä¸­å‘ç”Ÿå¼‚å¸¸åˆ™é€šè¿‡ <code>rollback()</code> è¿›è¡Œäº‹åŠ¡å›æ»šã€‚é™¤æ­¤ä¹‹å¤–ï¼Œä» JDBC 3.0 ä¸­è¿˜å¼•å…¥äº† Savepointï¼ˆä¿å­˜ç‚¹ï¼‰çš„æ¦‚å¿µï¼Œå…è®¸é€šè¿‡ä»£ç è®¾ç½®ä¿å­˜ç‚¹å¹¶è®©äº‹åŠ¡å›æ»šåˆ°æŒ‡å®šçš„ä¿å­˜ç‚¹ã€‚</p>
<p><img src= "https://cdn.jsdelivr.net/gh/Eurkon/CDN/hexo/images/user/loading.gif" data-lazy-src="/images/post/java_interview/81.png" alt></p>
<blockquote>
<p>82ã€JDBC èƒ½å¦å¤„ç† Blob å’Œ Clobï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼š Blob æ˜¯æŒ‡äºŒè¿›åˆ¶å¤§å¯¹è±¡ï¼ˆBinary Large Objectï¼‰ï¼Œè€Œ Clob æ˜¯æŒ‡å¤§å­—ç¬¦å¯¹è±¡ï¼ˆCharacter Large Objecï¼‰ï¼Œå› æ­¤å…¶ä¸­ Blob æ˜¯ä¸ºå­˜å‚¨å¤§çš„äºŒè¿›åˆ¶æ•°æ®è€Œè®¾è®¡çš„ï¼Œè€Œ Clob æ˜¯ä¸ºå­˜å‚¨å¤§çš„æ–‡æœ¬æ•°æ®è€Œè®¾è®¡çš„ã€‚JDBC çš„ <code>PreparedStatement</code> å’Œ <code>ResultSet</code> éƒ½æä¾›äº†ç›¸åº”çš„æ–¹æ³•æ¥æ”¯æŒ Blob å’Œ Clob æ“ä½œã€‚ä¸‹é¢çš„ä»£ç å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ JDBC æ“ä½œ LOBï¼š
ä¸‹é¢ä»¥ MySQL æ•°æ®åº“ä¸ºä¾‹ï¼Œåˆ›å»ºä¸€ä¸ªå¼ æœ‰ä¸‰ä¸ªå­—æ®µçš„ç”¨æˆ·è¡¨ï¼ŒåŒ…æ‹¬ç¼–å·ï¼ˆ<code>id</code>ï¼‰ã€å§“åï¼ˆ<code>name</code>ï¼‰å’Œç…§ç‰‡ï¼ˆ<code>photo</code>ï¼‰ï¼Œå»ºè¡¨è¯­å¥å¦‚ä¸‹ï¼š</p>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> tb_user (<br>  <span class="hljs-keyword">id</span> <span class="hljs-built_in">INT</span> PRIMARY <span class="hljs-keyword">KEY</span> auto_increment,<br>  <span class="hljs-keyword">name</span> <span class="hljs-built_in">VARCHAR</span> ( <span class="hljs-number">20</span> ) <span class="hljs-keyword">UNIQUE</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,<br>  photo LONGBLOB <br>);<br></code></pre></td></tr></table></figure>
</p>
<p>ä¸‹é¢çš„ Java ä»£ç å‘æ•°æ®åº“ä¸­æ’å…¥ä¸€æ¡è®°å½•ï¼š</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.io.FileInputStream;<br><span class="hljs-keyword">import</span> java.io.IOException;<br><span class="hljs-keyword">import</span> java.io.InputStream;<br><span class="hljs-keyword">import</span> java.sql.Connection;<br><span class="hljs-keyword">import</span> java.sql.DriverManager;<br><span class="hljs-keyword">import</span> java.sql.PreparedStatement;<br><span class="hljs-keyword">import</span> java.sql.SQLException;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">JdbcLobTest</span> </span>&#123;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        Connection con = <span class="hljs-keyword">null</span>;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-comment">// 1. åŠ è½½é©±åŠ¨ï¼ˆJava6ä»¥ä¸Šç‰ˆæœ¬å¯ä»¥çœç•¥ï¼‰</span><br>            Class.forName(<span class="hljs-string">&quot;com.mysql.jdbc.Driver&quot;</span>);<br>            <span class="hljs-comment">// 2. å»ºç«‹è¿æ¥</span><br>            con = DriverManager.getConnection(<span class="hljs-string">&quot;jdbc:mysql://localhost:3306/test&quot;</span>, <span class="hljs-string">&quot;root&quot;</span>, <span class="hljs-string">&quot;123456&quot;</span>);<br>            <span class="hljs-comment">// 3. åˆ›å»ºè¯­å¥å¯¹è±¡</span><br>            PreparedStatement ps = con.prepareStatement(<span class="hljs-string">&quot;insert into tb_user values (default, ?, ?)&quot;</span>);<br>            ps.setString(<span class="hljs-number">1</span>, <span class="hljs-string">&quot;Jack&quot;</span>);            <span class="hljs-comment">// å°†SQLè¯­å¥ä¸­ç¬¬ä¸€ä¸ªå ä½ç¬¦æ¢æˆå­—ç¬¦ä¸²</span><br><br>            <span class="hljs-keyword">try</span> (InputStream in = <span class="hljs-keyword">new</span> FileInputStream(<span class="hljs-string">&quot;test.jpg&quot;</span>)) &#123;    <span class="hljs-comment">// Java 7çš„TWR</span><br>                ps.setBinaryStream(<span class="hljs-number">2</span>, in);      <span class="hljs-comment">// å°†SQLè¯­å¥ä¸­ç¬¬äºŒä¸ªå ä½ç¬¦æ¢æˆäºŒè¿›åˆ¶æµ</span><br>                <br>                <span class="hljs-comment">// 4. SQL è¯­å¥è·å¾—å—å½±å“è¡Œæ•°</span><br>                System.out.println(ps.executeUpdate() == <span class="hljs-number">1</span> ? <span class="hljs-string">&quot;æ’å…¥æˆåŠŸ&quot;</span> : <span class="hljs-string">&quot;æ’å…¥å¤±è´¥&quot;</span>);<br>            &#125; <span class="hljs-keyword">catch</span>(IOException e) &#123;<br>                System.out.println(<span class="hljs-string">&quot;è¯»å–ç…§ç‰‡å¤±è´¥!&quot;</span>);<br>            &#125;<br>        &#125; <span class="hljs-keyword">catch</span> (ClassNotFoundException | SQLException e) &#123;     <span class="hljs-comment">// Java 7çš„å¤šå¼‚å¸¸æ•è·</span><br>            e.printStackTrace();<br>        &#125; <span class="hljs-keyword">finally</span> &#123;     <span class="hljs-comment">// é‡Šæ”¾å¤–éƒ¨èµ„æºçš„ä»£ç éƒ½åº”å½“æ”¾åœ¨finallyä¸­ä¿è¯å…¶èƒ½å¤Ÿå¾—åˆ°æ‰§è¡Œ</span><br>            <span class="hljs-keyword">try</span> &#123;<br>                <span class="hljs-keyword">if</span>(con != <span class="hljs-keyword">null</span> &amp;&amp; !con.isClosed()) &#123;<br>                    con.close();    <span class="hljs-comment">// 5. é‡Šæ”¾æ•°æ®åº“è¿æ¥ </span><br>                    con = <span class="hljs-keyword">null</span>;     <span class="hljs-comment">// æŒ‡ç¤ºåƒåœ¾å›æ”¶å™¨å¯ä»¥å›æ”¶è¯¥å¯¹è±¡</span><br>                &#125;<br>            &#125; <span class="hljs-keyword">catch</span> (SQLException e) &#123;<br>                e.printStackTrace();<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<blockquote>
<p>83ã€ç®€è¿°æ­£åˆ™è¡¨è¾¾å¼åŠå…¶ç”¨é€”ã€‚</p>
</blockquote>
<p>ç­”ï¼šåœ¨ç¼–å†™å¤„ç†å­—ç¬¦ä¸²çš„ç¨‹åºæ—¶ï¼Œç»å¸¸ä¼šæœ‰æŸ¥æ‰¾ç¬¦åˆæŸäº›å¤æ‚è§„åˆ™çš„å­—ç¬¦ä¸²çš„éœ€è¦ã€‚æ­£åˆ™è¡¨è¾¾å¼å°±æ˜¯ç”¨äºæè¿°è¿™äº›è§„åˆ™çš„å·¥å…·ã€‚æ¢å¥è¯è¯´ï¼Œæ­£åˆ™è¡¨è¾¾å¼å°±æ˜¯è®°å½•æ–‡æœ¬è§„åˆ™çš„ä»£ç ã€‚</p>
<p><strong>è¯´æ˜ï¼š</strong>è®¡ç®—æœºè¯ç”ŸåˆæœŸå¤„ç†çš„ä¿¡æ¯å‡ ä¹éƒ½æ˜¯æ•°å€¼ï¼Œä½†æ˜¯æ—¶è¿‡å¢ƒè¿ï¼Œä»Šå¤©æˆ‘ä»¬ä½¿ç”¨è®¡ç®—æœºå¤„ç†çš„ä¿¡æ¯æ›´å¤šçš„æ—¶å€™ä¸æ˜¯æ•°å€¼è€Œæ˜¯å­—ç¬¦ä¸²ï¼Œæ­£åˆ™è¡¨è¾¾å¼å°±æ˜¯åœ¨è¿›è¡Œå­—ç¬¦ä¸²åŒ¹é…å’Œå¤„ç†çš„æ—¶å€™æœ€ä¸ºå¼ºå¤§çš„å·¥å…·ï¼Œç»å¤§å¤šæ•°è¯­è¨€éƒ½æä¾›äº†å¯¹æ­£åˆ™è¡¨è¾¾å¼çš„æ”¯æŒã€‚</p>
<blockquote>
<p>84ã€Java ä¸­æ˜¯å¦‚ä½•æ”¯æŒæ­£åˆ™è¡¨è¾¾å¼æ“ä½œçš„ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šJava ä¸­çš„ <code>String</code> ç±»æä¾›äº†æ”¯æŒæ­£åˆ™è¡¨è¾¾å¼æ“ä½œçš„æ–¹æ³•ï¼ŒåŒ…æ‹¬ï¼š<code>matches()</code>ã€<code>replaceAll()</code>ã€<code>replaceFirst()</code>ã€<code>split()</code>ã€‚æ­¤å¤–ï¼ŒJava ä¸­å¯ä»¥ç”¨ <code>Pattern</code> ç±»è¡¨ç¤ºæ­£åˆ™è¡¨è¾¾å¼å¯¹è±¡ï¼Œå®ƒæä¾›äº†ä¸°å¯Œçš„ API è¿›è¡Œå„ç§æ­£åˆ™è¡¨è¾¾å¼æ“ä½œï¼Œè¯·å‚è€ƒä¸‹é¢é¢è¯•é¢˜çš„ä»£ç ã€‚</p>
<p>é¢è¯•é¢˜ï¼šå¦‚æœè¦ä»å­—ç¬¦ä¸²ä¸­æˆªå–ç¬¬ä¸€ä¸ªè‹±æ–‡å·¦æ‹¬å·ä¹‹å‰çš„å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ï¼šåŒ—äº¬å¸‚(æœé˜³åŒº)(è¥¿åŸåŒº)(æµ·æ·€åŒº)ï¼Œæˆªå–ç»“æœä¸ºï¼šåŒ—äº¬å¸‚ï¼Œé‚£ä¹ˆæ­£åˆ™è¡¨è¾¾å¼æ€ä¹ˆå†™ï¼Ÿ</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.regex.Matcher;<br><span class="hljs-keyword">import</span> java.util.regex.Pattern;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RegExpTest</span> </span>&#123;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        String str = <span class="hljs-string">&quot;åŒ—äº¬å¸‚(æœé˜³åŒº)(è¥¿åŸåŒº)(æµ·æ·€åŒº)&quot;</span>;<br>        Pattern p = Pattern.compile(<span class="hljs-string">&quot;.*?(?=\\()&quot;</span>);<br>        Matcher m = p.matcher(str);<br>        <span class="hljs-keyword">if</span>(m.find()) &#123;<br>            System.out.println(m.group());<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<p><strong>è¯´æ˜ï¼š</strong>ä¸Šé¢çš„æ­£åˆ™è¡¨è¾¾å¼ä¸­ä½¿ç”¨äº†æ‡’æƒ°åŒ¹é…å’Œå‰ç»ï¼Œå¦‚æœä¸æ¸…æ¥šè¿™äº›å†…å®¹ï¼Œæ¨èè¯»ä¸€ä¸‹ç½‘ä¸Šå¾ˆæœ‰åçš„<a target="_blank" rel="noopener" href="https://www.jb51.net/tools/zhengze.html">ã€Šæ­£åˆ™è¡¨è¾¾å¼30åˆ†é’Ÿå…¥é—¨æ•™ç¨‹ã€‹</a>ã€‚</p>
<h1 id="Java-åå°„ï¼ˆ85-88ï¼‰"><a href="#Java-åå°„ï¼ˆ85-88ï¼‰" class="headerlink" title="Java åå°„ï¼ˆ85~88ï¼‰"></a>Java åå°„ï¼ˆ85~88ï¼‰</h1><blockquote>
<p>85ã€è·å¾—ä¸€ä¸ªç±»çš„ç±»å¯¹è±¡æœ‰å“ªäº›æ–¹å¼ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼š</p>
<ul>
<li>ç±»å‹.classï¼Œä¾‹å¦‚ï¼š<code>String.class</code></li>
<li>å¯¹è±¡.getClass()ï¼Œä¾‹å¦‚ï¼š<code>&quot;hello&quot;.getClass()</code></li>
<li>Class.forName()ï¼Œä¾‹å¦‚ï¼š<code>Class.forName(&quot;java.lang.String&quot;)</code></li>
</ul>
<blockquote>
<p>86ã€å¦‚ä½•é€šè¿‡åå°„åˆ›å»ºå¯¹è±¡ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼š</p>
<ul>
<li>é€šè¿‡ç±»å¯¹è±¡è°ƒç”¨ <code>newInstance()</code> æ–¹æ³•ï¼Œä¾‹å¦‚ï¼š<code>String.class.newInstance()</code></li>
<li>é€šè¿‡ç±»å¯¹è±¡çš„ <code>getConstructor()</code> æˆ– <code>getDeclaredConstructor()</code> æ–¹æ³•è·å¾—æ„é€ å™¨ï¼ˆConstructorï¼‰å¯¹è±¡å¹¶è°ƒç”¨å…¶ <code>newInstance()</code> æ–¹æ³•åˆ›å»ºå¯¹è±¡ï¼Œä¾‹å¦‚ï¼š<code>String.class.getConstructor(String.class).newInstance(&quot;Hello&quot;);</code></li>
</ul>
<blockquote>
<p>87ã€å¦‚ä½•é€šè¿‡åå°„è·å–å’Œè®¾ç½®å¯¹è±¡ç§æœ‰å­—æ®µçš„å€¼ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šå¯ä»¥é€šè¿‡ç±»å¯¹è±¡çš„ <code>getDeclaredField()</code> æ–¹æ³•å­—æ®µï¼ˆFieldï¼‰å¯¹è±¡ï¼Œç„¶åå†é€šè¿‡å­—æ®µå¯¹è±¡çš„ <code>setAccessible(true)</code> å°†å…¶è®¾ç½®ä¸ºå¯ä»¥è®¿é—®ï¼Œæ¥ä¸‹æ¥å°±å¯ä»¥é€šè¿‡ get/set æ–¹æ³•æ¥è·å–/è®¾ç½®å­—æ®µçš„å€¼äº†ã€‚ä¸‹é¢çš„ä»£ç å®ç°äº†ä¸€ä¸ªåå°„çš„å·¥å…·ç±»ï¼Œå…¶ä¸­çš„ä¸¤ä¸ªé™æ€æ–¹æ³•åˆ†åˆ«ç”¨äºè·å–å’Œè®¾ç½®ç§æœ‰å­—æ®µçš„å€¼ï¼Œå­—æ®µå¯ä»¥æ˜¯åŸºæœ¬ç±»å‹ä¹Ÿå¯ä»¥æ˜¯å¯¹è±¡ç±»å‹ä¸”æ”¯æŒå¤šçº§å¯¹è±¡æ“ä½œï¼Œä¾‹å¦‚ <code>ReflectionUtil.get(dog, &quot;owner.car.engine.id&quot;);</code> å¯ä»¥è·å¾— dog å¯¹è±¡çš„ä¸»äººçš„æ±½è½¦çš„å¼•æ“çš„ ID å·ã€‚</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.lang.reflect.Constructor;<br><span class="hljs-keyword">import</span> java.lang.reflect.Field;<br><span class="hljs-keyword">import</span> java.lang.reflect.Modifier;<br><span class="hljs-keyword">import</span> java.util.ArrayList;<br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * åå°„å·¥å…·ç±»</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ReflectionUtil</span> </span>&#123;<br><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-title">ReflectionUtil</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> AssertionError();<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * é€šè¿‡åå°„å–å¯¹è±¡æŒ‡å®šå­—æ®µ(å±æ€§)çš„å€¼</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> target ç›®æ ‡å¯¹è±¡</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> fieldName å­—æ®µçš„åå­—</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@throws</span> å¦‚æœå–ä¸åˆ°å¯¹è±¡æŒ‡å®šå­—æ®µçš„å€¼åˆ™æŠ›å‡ºå¼‚å¸¸</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> å­—æ®µçš„å€¼</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Object <span class="hljs-title">getValue</span><span class="hljs-params">(Object target, String fieldName)</span> </span>&#123;<br>        Class&lt;?&gt; clazz = target.getClass();<br>        String[] fs = fieldName.split(<span class="hljs-string">&quot;\\.&quot;</span>);<br><br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; fs.length - <span class="hljs-number">1</span>; i++) &#123;<br>                Field f = clazz.getDeclaredField(fs[i]);<br>                f.setAccessible(<span class="hljs-keyword">true</span>);<br>                target = f.get(target);<br>                clazz = target.getClass();<br>            &#125;<br><br>            Field f = clazz.getDeclaredField(fs[fs.length - <span class="hljs-number">1</span>]);<br>            f.setAccessible(<span class="hljs-keyword">true</span>);<br>            <span class="hljs-keyword">return</span> f.get(target);<br>        &#125;<br>        <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> RuntimeException(e);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * é€šè¿‡åå°„ç»™å¯¹è±¡çš„æŒ‡å®šå­—æ®µèµ‹å€¼</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> target ç›®æ ‡å¯¹è±¡</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> fieldName å­—æ®µçš„åç§°</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> value å€¼</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setValue</span><span class="hljs-params">(Object target, String fieldName, Object value)</span> </span>&#123;<br>        Class&lt;?&gt; clazz = target.getClass();<br>        String[] fs = fieldName.split(<span class="hljs-string">&quot;\\.&quot;</span>);<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; fs.length - <span class="hljs-number">1</span>; i++) &#123;<br>                Field f = clazz.getDeclaredField(fs[i]);<br>                f.setAccessible(<span class="hljs-keyword">true</span>);<br>                Object val = f.get(target);<br>                <span class="hljs-keyword">if</span>(val == <span class="hljs-keyword">null</span>) &#123;<br>                    Constructor&lt;?&gt; c = f.getType().getDeclaredConstructor();<br>                    c.setAccessible(<span class="hljs-keyword">true</span>);<br>                    val = c.newInstance();<br>                    f.set(target, val);<br>                &#125;<br>                target = val;<br>                clazz = target.getClass();<br>            &#125;<br><br>            Field f = clazz.getDeclaredField(fs[fs.length - <span class="hljs-number">1</span>]);<br>            f.setAccessible(<span class="hljs-keyword">true</span>);<br>            f.set(target, value);<br>        &#125;<br>        <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> RuntimeException(e);<br>        &#125;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<blockquote>
<p>88ã€å¦‚ä½•é€šè¿‡åå°„è°ƒç”¨å¯¹è±¡çš„æ–¹æ³•ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šè¯·çœ‹ä¸‹é¢çš„ä»£ç ï¼š</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.lang.reflect.Method;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MethodInvokeTest</span> </span>&#123;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>        String str = <span class="hljs-string">&quot;hello&quot;</span>;<br>        Method m = str.getClass().getMethod(<span class="hljs-string">&quot;toUpperCase&quot;</span>);<br>        System.out.println(m.invoke(str));  <span class="hljs-comment">// HELLO</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<h1 id="Java-è®¾è®¡æ¨¡å¼ï¼ˆ89-95ï¼‰"><a href="#Java-è®¾è®¡æ¨¡å¼ï¼ˆ89-95ï¼‰" class="headerlink" title="Java è®¾è®¡æ¨¡å¼ï¼ˆ89~95ï¼‰"></a>Java è®¾è®¡æ¨¡å¼ï¼ˆ89~95ï¼‰</h1><blockquote>
<p>89ã€ç®€è¿°ä¸€ä¸‹é¢å‘å¯¹è±¡çš„&quot;å…­åŸåˆ™ä¸€æ³•åˆ™&quot;ã€‚</p>
</blockquote>
<p>ç­”ï¼š</p>
<ul>
<li><p><strong>å•ä¸€èŒè´£åŸåˆ™ï¼šä¸€ä¸ªç±»åªåšå®ƒè¯¥åšçš„äº‹æƒ…ã€‚</strong>ï¼ˆå•ä¸€èŒè´£åŸåˆ™æƒ³è¡¨è¾¾çš„å°±æ˜¯&quot;é«˜å†…èš&quot;ï¼Œå†™ä»£ç æœ€ç»ˆæçš„åŸåˆ™åªæœ‰å…­ä¸ªå­—â€œé«˜å†…èšã€ä½è€¦åˆâ€ï¼Œå°±å¦‚åŒè‘µèŠ±å®å…¸æˆ–è¾Ÿé‚ªå‰‘è°±çš„ä¸­å¿ƒæ€æƒ³å°±å…«ä¸ªå­—â€œæ¬²ç»ƒæ­¤åŠŸå¿…å…ˆè‡ªå®«â€ï¼Œæ‰€è°“çš„é«˜å†…èšå°±æ˜¯ä¸€ä¸ªä»£ç æ¨¡å—åªå®Œæˆä¸€é¡¹åŠŸèƒ½ï¼Œåœ¨é¢å‘å¯¹è±¡ä¸­ï¼Œå¦‚æœåªè®©ä¸€ä¸ªç±»å®Œæˆå®ƒè¯¥åšçš„äº‹ï¼Œè€Œä¸æ¶‰åŠä¸å®ƒæ— å…³çš„é¢†åŸŸå°±æ˜¯è·µè¡Œäº†é«˜å†…èšçš„åŸåˆ™ï¼Œè¿™ä¸ªç±»å°±åªæœ‰å•ä¸€èŒè´£ã€‚æˆ‘ä»¬éƒ½çŸ¥é“ä¸€å¥è¯å«â€œå› ä¸ºä¸“æ³¨ï¼Œæ‰€ä»¥ä¸“ä¸šâ€ï¼Œä¸€ä¸ªå¯¹è±¡å¦‚æœæ‰¿æ‹…å¤ªå¤šçš„èŒè´£ï¼Œé‚£ä¹ˆæ³¨å®šå®ƒä»€ä¹ˆéƒ½åšä¸å¥½ã€‚è¿™ä¸ªä¸–ç•Œä¸Šä»»ä½•å¥½çš„ä¸œè¥¿éƒ½æœ‰ä¸¤ä¸ªç‰¹å¾ï¼Œä¸€ä¸ªæ˜¯åŠŸèƒ½å•ä¸€ï¼Œå¥½çš„ç›¸æœºç»å¯¹ä¸æ˜¯ç”µè§†è´­ç‰©é‡Œé¢å–çš„é‚£ç§ä¸€ä¸ªæœºå™¨æœ‰ä¸€ç™¾å¤šç§åŠŸèƒ½çš„ï¼Œå®ƒåŸºæœ¬ä¸Šåªèƒ½ç…§ç›¸ï¼›å¦ä¸€ä¸ªæ˜¯æ¨¡å—åŒ–ï¼Œå¥½çš„è‡ªè¡Œè½¦æ˜¯ç»„è£…è½¦ï¼Œä»å‡éœ‡å‰ã€åˆ¹è½¦åˆ°å˜é€Ÿå™¨ï¼Œæ‰€æœ‰çš„éƒ¨ä»¶éƒ½æ˜¯å¯ä»¥æ‹†å¸å’Œé‡æ–°ç»„è£…çš„ï¼Œå¥½çš„ä¹’ä¹“çƒæ‹ä¹Ÿä¸æ˜¯æˆå“æ‹ï¼Œä¸€å®šæ˜¯åº•æ¿å’Œèƒ¶çš®å¯ä»¥æ‹†åˆ†å’Œè‡ªè¡Œç»„è£…çš„ï¼Œä¸€ä¸ªå¥½çš„è½¯ä»¶ç³»ç»Ÿï¼Œå®ƒé‡Œé¢çš„æ¯ä¸ªåŠŸèƒ½æ¨¡å—ä¹Ÿåº”è¯¥æ˜¯å¯ä»¥è½»æ˜“çš„æ‹¿åˆ°å…¶ä»–ç³»ç»Ÿä¸­ä½¿ç”¨çš„ï¼Œè¿™æ ·æ‰èƒ½å®ç°è½¯ä»¶å¤ç”¨çš„ç›®æ ‡ã€‚ï¼‰</p>
</li>
<li><p><strong>å¼€é—­åŸåˆ™ï¼šè½¯ä»¶å®ä½“åº”å½“å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­ã€‚</strong>ï¼ˆåœ¨ç†æƒ³çš„çŠ¶æ€ä¸‹ï¼Œå½“æˆ‘ä»¬éœ€è¦ä¸ºä¸€ä¸ªè½¯ä»¶ç³»ç»Ÿå¢åŠ æ–°åŠŸèƒ½æ—¶ï¼Œåªéœ€è¦ä»åŸæ¥çš„ç³»ç»Ÿæ´¾ç”Ÿå‡ºä¸€äº›æ–°ç±»å°±å¯ä»¥ï¼Œä¸éœ€è¦ä¿®æ”¹åŸæ¥çš„ä»»ä½•ä¸€è¡Œä»£ç ã€‚è¦åšåˆ°å¼€é—­æœ‰ä¸¤ä¸ªè¦ç‚¹ï¼š(1)æŠ½è±¡æ˜¯å…³é”®ï¼Œä¸€ä¸ªç³»ç»Ÿä¸­å¦‚æœæ²¡æœ‰æŠ½è±¡ç±»æˆ–æ¥å£ç³»ç»Ÿå°±æ²¡æœ‰æ‰©å±•ç‚¹ï¼›(2)å°è£…å¯å˜æ€§ï¼Œå°†ç³»ç»Ÿä¸­çš„å„ç§å¯å˜å› ç´ å°è£…åˆ°ä¸€ä¸ªç»§æ‰¿ç»“æ„ä¸­ï¼Œå¦‚æœå¤šä¸ªå¯å˜å› ç´ æ··æ‚åœ¨ä¸€èµ·ï¼Œç³»ç»Ÿå°†å˜å¾—å¤æ‚è€Œæ¢ä¹±ï¼Œå¦‚æœä¸æ¸…æ¥šå¦‚ä½•å°è£…å¯å˜æ€§ï¼Œå¯ä»¥å‚è€ƒã€Šè®¾è®¡æ¨¡å¼ç²¾è§£ã€‹ä¸€ä¹¦ä¸­å¯¹æ¡¥æ¢æ¨¡å¼çš„è®²è§£çš„ç« èŠ‚ã€‚ï¼‰</p>
</li>
<li><p><strong>ä¾èµ–å€’è½¬åŸåˆ™ï¼šé¢å‘æ¥å£ç¼–ç¨‹ã€‚</strong>ï¼ˆè¯¥åŸåˆ™è¯´å¾—ç›´ç™½å’Œå…·ä½“ä¸€äº›å°±æ˜¯å£°æ˜æ–¹æ³•çš„å‚æ•°ç±»å‹ã€æ–¹æ³•çš„è¿”å›ç±»å‹ã€å˜é‡çš„å¼•ç”¨ç±»å‹æ—¶ï¼Œå°½å¯èƒ½ä½¿ç”¨æŠ½è±¡ç±»å‹è€Œä¸ç”¨å…·ä½“ç±»å‹ï¼Œå› ä¸ºæŠ½è±¡ç±»å‹å¯ä»¥è¢«å®ƒçš„ä»»ä½•ä¸€ä¸ªå­ç±»å‹æ‰€æ›¿ä»£ï¼Œè¯·å‚è€ƒä¸‹é¢çš„é‡Œæ°æ›¿æ¢åŸåˆ™ã€‚ï¼‰<strong>é‡Œæ°æ›¿æ¢åŸåˆ™ï¼šä»»ä½•æ—¶å€™éƒ½å¯ä»¥ç”¨å­ç±»å‹æ›¿æ¢æ‰çˆ¶ç±»å‹ã€‚</strong>ï¼ˆå…³äºé‡Œæ°æ›¿æ¢åŸåˆ™çš„æè¿°ï¼ŒBarbara Liskov å¥³å£«çš„æè¿°æ¯”è¿™ä¸ªè¦å¤æ‚å¾—å¤šï¼Œä½†ç®€å•çš„è¯´å°±æ˜¯èƒ½ç”¨çˆ¶ç±»å‹çš„åœ°æ–¹å°±ä¸€å®šèƒ½ä½¿ç”¨å­ç±»å‹ã€‚é‡Œæ°æ›¿æ¢åŸåˆ™å¯ä»¥æ£€æŸ¥ç»§æ‰¿å…³ç³»æ˜¯å¦åˆç†ï¼Œå¦‚æœä¸€ä¸ªç»§æ‰¿å…³ç³»è¿èƒŒäº†é‡Œæ°æ›¿æ¢åŸåˆ™ï¼Œé‚£ä¹ˆè¿™ä¸ªç»§æ‰¿å…³ç³»ä¸€å®šæ˜¯é”™è¯¯çš„ï¼Œéœ€è¦å¯¹ä»£ç è¿›è¡Œé‡æ„ã€‚ä¾‹å¦‚è®©çŒ«ç»§æ‰¿ç‹—ï¼Œæˆ–è€…ç‹—ç»§æ‰¿çŒ«ï¼Œåˆæˆ–è€…è®©æ­£æ–¹å½¢ç»§æ‰¿é•¿æ–¹å½¢éƒ½æ˜¯é”™è¯¯çš„ç»§æ‰¿å…³ç³»ï¼Œå› ä¸ºä½ å¾ˆå®¹æ˜“æ‰¾åˆ°è¿åé‡Œæ°æ›¿æ¢åŸåˆ™çš„åœºæ™¯ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼šå­ç±»ä¸€å®šæ˜¯å¢åŠ çˆ¶ç±»çš„èƒ½åŠ›è€Œä¸æ˜¯å‡å°‘çˆ¶ç±»çš„èƒ½åŠ›ï¼Œå› ä¸ºå­ç±»æ¯”çˆ¶ç±»çš„èƒ½åŠ›æ›´å¤šï¼ŒæŠŠèƒ½åŠ›å¤šçš„å¯¹è±¡å½“æˆèƒ½åŠ›å°‘çš„å¯¹è±¡æ¥ç”¨å½“ç„¶æ²¡æœ‰ä»»ä½•é—®é¢˜ã€‚ï¼‰</p>
</li>
<li><p><strong>æ¥å£éš”ç¦»åŸåˆ™ï¼šæ¥å£è¦å°è€Œä¸“ï¼Œç»ä¸èƒ½å¤§è€Œå…¨ã€‚</strong>ï¼ˆè‡ƒè‚¿çš„æ¥å£æ˜¯å¯¹æ¥å£çš„æ±¡æŸ“ï¼Œæ—¢ç„¶æ¥å£è¡¨ç¤ºèƒ½åŠ›ï¼Œé‚£ä¹ˆä¸€ä¸ªæ¥å£åªåº”è¯¥æè¿°ä¸€ç§èƒ½åŠ›ï¼Œæ¥å£ä¹Ÿåº”è¯¥æ˜¯é«˜åº¦å†…èšçš„ã€‚ä¾‹å¦‚ï¼Œç´æ£‹ä¹¦ç”»å°±åº”è¯¥åˆ†åˆ«è®¾è®¡ä¸ºå››ä¸ªæ¥å£ï¼Œè€Œä¸åº”è®¾è®¡æˆä¸€ä¸ªæ¥å£ä¸­çš„å››ä¸ªæ–¹æ³•ï¼Œå› ä¸ºå¦‚æœè®¾è®¡æˆä¸€ä¸ªæ¥å£ä¸­çš„å››ä¸ªæ–¹æ³•ï¼Œé‚£ä¹ˆè¿™ä¸ªæ¥å£å¾ˆéš¾ç”¨ï¼Œæ¯•ç«Ÿç´æ£‹ä¹¦ç”»å››æ ·éƒ½ç²¾é€šçš„äººè¿˜æ˜¯å°‘æ•°ï¼Œè€Œå¦‚æœè®¾è®¡æˆå››ä¸ªæ¥å£ï¼Œä¼šå‡ é¡¹å°±å®ç°å‡ ä¸ªæ¥å£ï¼Œè¿™æ ·çš„è¯æ¯ä¸ªæ¥å£è¢«å¤ç”¨çš„å¯èƒ½æ€§æ˜¯å¾ˆé«˜çš„ã€‚Javaä¸­çš„æ¥å£ä»£è¡¨èƒ½åŠ›ã€ä»£è¡¨çº¦å®šã€ä»£è¡¨è§’è‰²ï¼Œèƒ½å¦æ­£ç¡®çš„ä½¿ç”¨æ¥å£ä¸€å®šæ˜¯ç¼–ç¨‹æ°´å¹³é«˜ä½çš„é‡è¦æ ‡è¯†ã€‚ï¼‰</p>
</li>
<li><p><strong>åˆæˆèšåˆå¤ç”¨åŸåˆ™ï¼šä¼˜å…ˆä½¿ç”¨èšåˆæˆ–åˆæˆå…³ç³»å¤ç”¨ä»£ç ã€‚</strong>ï¼ˆé€šè¿‡ç»§æ‰¿æ¥å¤ç”¨ä»£ç æ˜¯é¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡ä¸­è¢«æ»¥ç”¨å¾—æœ€å¤šçš„ä¸œè¥¿ï¼Œå› ä¸ºæ‰€æœ‰çš„æ•™ç§‘ä¹¦éƒ½æ— ä¸€ä¾‹å¤–çš„å¯¹ç»§æ‰¿è¿›è¡Œäº†é¼“å¹ä»è€Œè¯¯å¯¼äº†åˆå­¦è€…ï¼Œç±»ä¸ç±»ä¹‹é—´ç®€å•çš„è¯´æœ‰ä¸‰ç§å…³ç³»ï¼ŒIs-A å…³ç³»ã€Has-A å…³ç³»ã€Use-A å…³ç³»ï¼Œåˆ†åˆ«ä»£è¡¨ç»§æ‰¿ã€å…³è”å’Œä¾èµ–ã€‚å…¶ä¸­ï¼Œå…³è”å…³ç³»æ ¹æ®å…¶å…³è”çš„å¼ºåº¦åˆå¯ä»¥è¿›ä¸€æ­¥åˆ’åˆ†ä¸ºå…³è”ã€èšåˆå’Œåˆæˆï¼Œä½†è¯´ç™½äº†éƒ½æ˜¯ Has-Aå…³ ç³»ï¼Œåˆæˆèšåˆå¤ç”¨åŸåˆ™æƒ³è¡¨è¾¾çš„æ˜¯ä¼˜å…ˆè€ƒè™‘ Has-A å…³ç³»è€Œä¸æ˜¯ Is-A å…³ç³»å¤ç”¨ä»£ç ï¼ŒåŸå› å˜›å¯ä»¥è‡ªå·±ä»ç™¾åº¦ä¸Šæ‰¾åˆ°ä¸€ä¸‡ä¸ªç†ç”±ï¼Œéœ€è¦è¯´æ˜çš„æ˜¯ï¼Œå³ä½¿åœ¨ Java çš„ API ä¸­ä¹Ÿæœ‰ä¸å°‘æ»¥ç”¨ç»§æ‰¿çš„ä¾‹å­ï¼Œä¾‹å¦‚ Properties ç±»ç»§æ‰¿äº† Hashtable ç±»ï¼ŒStack ç±»ç»§æ‰¿äº† Vector ç±»ï¼Œè¿™äº›ç»§æ‰¿æ˜æ˜¾å°±æ˜¯é”™è¯¯çš„ï¼Œæ›´å¥½çš„åšæ³•æ˜¯åœ¨ Properties ç±»ä¸­æ”¾ç½®ä¸€ä¸ª Hashtable ç±»å‹çš„æˆå‘˜å¹¶ä¸”å°†å…¶é”®å’Œå€¼éƒ½è®¾ç½®ä¸ºå­—ç¬¦ä¸²æ¥å­˜å‚¨æ•°æ®ï¼Œè€Œ Stack ç±»çš„è®¾è®¡ä¹Ÿåº”è¯¥æ˜¯åœ¨ Stack ç±»ä¸­æ”¾ä¸€ä¸ª Vector å¯¹è±¡æ¥å­˜å‚¨æ•°æ®ã€‚è®°ä½ï¼šä»»ä½•æ—¶å€™éƒ½ä¸è¦ç»§æ‰¿å·¥å…·ç±»ï¼Œå·¥å…·æ˜¯å¯ä»¥æ‹¥æœ‰å¹¶å¯ä»¥ä½¿ç”¨çš„ï¼Œè€Œä¸æ˜¯æ‹¿æ¥ç»§æ‰¿çš„ã€‚ï¼‰</p>
</li>
<li><p><strong>è¿ªç±³ç‰¹æ³•åˆ™ï¼šè¿ªç±³ç‰¹æ³•åˆ™åˆå«æœ€å°‘çŸ¥è¯†åŸåˆ™ï¼Œä¸€ä¸ªå¯¹è±¡åº”å½“å¯¹å…¶ä»–å¯¹è±¡æœ‰å°½å¯èƒ½å°‘çš„äº†è§£ã€‚</strong>ï¼ˆè¿ªç±³ç‰¹æ³•åˆ™ç®€å•çš„è¯´å°±æ˜¯å¦‚ä½•åšåˆ°â€œä½è€¦åˆâ€ï¼Œé—¨é¢æ¨¡å¼å’Œè°ƒåœè€…æ¨¡å¼å°±æ˜¯å¯¹è¿ªç±³ç‰¹æ³•åˆ™çš„è·µè¡Œã€‚å¯¹äºé—¨é¢æ¨¡å¼å¯ä»¥ä¸¾ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œä½ å»ä¸€å®¶å…¬å¸æ´½è°ˆä¸šåŠ¡ï¼Œä½ ä¸éœ€è¦äº†è§£è¿™ä¸ªå…¬å¸å†…éƒ¨æ˜¯å¦‚ä½•è¿ä½œçš„ï¼Œä½ ç”šè‡³å¯ä»¥å¯¹è¿™ä¸ªå…¬å¸ä¸€æ— æ‰€çŸ¥ï¼Œå»çš„æ—¶å€™åªéœ€è¦æ‰¾åˆ°å…¬å¸å…¥å£å¤„çš„å‰å°ç¾å¥³ï¼Œå‘Šè¯‰å¥¹ä»¬ä½ è¦åšä»€ä¹ˆï¼Œå¥¹ä»¬ä¼šæ‰¾åˆ°åˆé€‚çš„äººè·Ÿä½ æ¥æ´½ï¼Œå‰å°çš„ç¾å¥³å°±æ˜¯å…¬å¸è¿™ä¸ªç³»ç»Ÿçš„é—¨é¢ã€‚å†å¤æ‚çš„ç³»ç»Ÿéƒ½å¯ä»¥ä¸ºç”¨æˆ·æä¾›ä¸€ä¸ªç®€å•çš„é—¨é¢ï¼ŒJava Web å¼€å‘ä¸­ä½œä¸ºå‰ç«¯æ§åˆ¶å™¨çš„ Servlet æˆ– Filter ä¸å°±æ˜¯ä¸€ä¸ªé—¨é¢å—ï¼Œæµè§ˆå™¨å¯¹æœåŠ¡å™¨çš„è¿ä½œæ–¹å¼ä¸€æ— æ‰€çŸ¥ï¼Œä½†æ˜¯é€šè¿‡å‰ç«¯æ§åˆ¶å™¨å°±èƒ½å¤Ÿæ ¹æ®ä½ çš„è¯·æ±‚å¾—åˆ°ç›¸åº”çš„æœåŠ¡ã€‚è°ƒåœè€…æ¨¡å¼ä¹Ÿå¯ä»¥ä¸¾ä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥è¯´æ˜ï¼Œä¾‹å¦‚ä¸€å°è®¡ç®—æœºï¼ŒCPUã€å†…å­˜ã€ç¡¬ç›˜ã€æ˜¾å¡ã€å£°å¡å„ç§è®¾å¤‡éœ€è¦ç›¸äº’é…åˆæ‰èƒ½å¾ˆå¥½çš„å·¥ä½œï¼Œä½†æ˜¯å¦‚æœè¿™äº›ä¸œè¥¿éƒ½ç›´æ¥è¿æ¥åˆ°ä¸€èµ·ï¼Œè®¡ç®—æœºçš„å¸ƒçº¿å°†å¼‚å¸¸å¤æ‚ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¸»æ¿ä½œä¸ºä¸€ä¸ªè°ƒåœè€…çš„èº«ä»½å‡ºç°ï¼Œå®ƒå°†å„ä¸ªè®¾å¤‡è¿æ¥åœ¨ä¸€èµ·è€Œä¸éœ€è¦æ¯ä¸ªè®¾å¤‡ä¹‹é—´ç›´æ¥äº¤æ¢æ•°æ®ï¼Œè¿™æ ·å°±å‡å°äº†ç³»ç»Ÿçš„è€¦åˆåº¦å’Œå¤æ‚åº¦ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚è¿ªç±³ç‰¹æ³•åˆ™ç”¨é€šä¿—çš„è¯æ¥å°†å°±æ˜¯ä¸è¦å’Œé™Œç”Ÿäººæ‰“äº¤é“ï¼Œå¦‚æœçœŸçš„éœ€è¦ï¼Œæ‰¾ä¸€ä¸ªè‡ªå·±çš„æœ‹å‹ï¼Œè®©ä»–æ›¿ä½ å’Œé™Œç”Ÿäººæ‰“äº¤é“ã€‚ï¼‰</p>
</li>
</ul>
<p><img src= "https://cdn.jsdelivr.net/gh/Eurkon/CDN/hexo/images/user/loading.gif" data-lazy-src="/images/post/java_interview/89_1.png" alt></p>
<p><img src= "https://cdn.jsdelivr.net/gh/Eurkon/CDN/hexo/images/user/loading.gif" data-lazy-src="/images/post/java_interview/89_2.png" alt></p>
<blockquote>
<p>90ã€ç®€è¿°ä¸€ä¸‹ä½ äº†è§£çš„è®¾è®¡æ¨¡å¼ã€‚</p>
</blockquote>
<p>ç­”ï¼šæ‰€è°“è®¾è®¡æ¨¡å¼ï¼Œå°±æ˜¯ä¸€å¥—è¢«åå¤ä½¿ç”¨çš„ä»£ç è®¾è®¡ç»éªŒçš„æ€»ç»“ï¼ˆæƒ…å¢ƒä¸­ä¸€ä¸ªé—®é¢˜ç»è¿‡è¯å®çš„ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼‰ã€‚ä½¿ç”¨è®¾è®¡æ¨¡å¼æ˜¯ä¸ºäº†å¯é‡ç”¨ä»£ç ã€è®©ä»£ç æ›´å®¹æ˜“è¢«ä»–äººç†è§£ã€ä¿è¯ä»£ç å¯é æ€§ã€‚è®¾è®¡æ¨¡å¼ä½¿äººä»¬å¯ä»¥æ›´åŠ ç®€å•æ–¹ä¾¿çš„å¤ç”¨æˆåŠŸçš„è®¾è®¡å’Œä½“ç³»ç»“æ„ã€‚å°†å·²è¯å®çš„æŠ€æœ¯è¡¨è¿°æˆè®¾è®¡æ¨¡å¼ä¹Ÿä¼šä½¿æ–°ç³»ç»Ÿå¼€å‘è€…æ›´åŠ å®¹æ˜“ç†è§£å…¶è®¾è®¡æ€è·¯ã€‚</p>
<p>åœ¨ GoF çš„ã€ŠDesign Patterns: Elements of Reusable Object-Oriented Softwareã€‹ä¸­ç»™å‡ºäº†ä¸‰ç±»ï¼ˆ<strong>åˆ›å»ºå‹</strong>[å¯¹ç±»çš„å®ä¾‹åŒ–è¿‡ç¨‹çš„æŠ½è±¡åŒ–]ã€<strong>ç»“æ„å‹</strong>[æè¿°å¦‚ä½•å°†ç±»æˆ–å¯¹è±¡ç»“åˆåœ¨ä¸€èµ·å½¢æˆæ›´å¤§çš„ç»“æ„]ã€<strong>è¡Œä¸ºå‹</strong>[å¯¹åœ¨ä¸åŒçš„å¯¹è±¡ä¹‹é—´åˆ’åˆ†è´£ä»»å’Œç®—æ³•çš„æŠ½è±¡åŒ–]ï¼‰å…± 23 ç§è®¾è®¡æ¨¡å¼ï¼ŒåŒ…æ‹¬ï¼šAbstract Factoryï¼ˆæŠ½è±¡å·¥å‚æ¨¡å¼ï¼‰ï¼ŒBuilderï¼ˆå»ºé€ è€…æ¨¡å¼ï¼‰ï¼ŒFactory Methodï¼ˆå·¥å‚æ–¹æ³•æ¨¡å¼ï¼‰ï¼ŒPrototypeï¼ˆåŸå§‹æ¨¡å‹æ¨¡å¼ï¼‰ï¼ŒSingletonï¼ˆå•ä¾‹æ¨¡å¼ï¼‰ï¼›Facadeï¼ˆé—¨é¢æ¨¡å¼ï¼‰ï¼ŒAdapterï¼ˆé€‚é…å™¨æ¨¡å¼ï¼‰ï¼ŒBridgeï¼ˆæ¡¥æ¢æ¨¡å¼ï¼‰ï¼ŒCompositeï¼ˆåˆæˆæ¨¡å¼ï¼‰ï¼ŒDecoratorï¼ˆè£…é¥°æ¨¡å¼ï¼‰ï¼ŒFlyweightï¼ˆäº«å…ƒæ¨¡å¼ï¼‰ï¼ŒProxyï¼ˆä»£ç†æ¨¡å¼ï¼‰ï¼›Commandï¼ˆå‘½ä»¤æ¨¡å¼ï¼‰ï¼ŒInterpreterï¼ˆè§£é‡Šå™¨æ¨¡å¼ï¼‰ï¼ŒVisitorï¼ˆè®¿é—®è€…æ¨¡å¼ï¼‰ï¼ŒIteratorï¼ˆè¿­ä»£å­æ¨¡å¼ï¼‰ï¼ŒMediatorï¼ˆè°ƒåœè€…æ¨¡å¼ï¼‰ï¼ŒMementoï¼ˆå¤‡å¿˜å½•æ¨¡å¼ï¼‰ï¼ŒObserverï¼ˆè§‚å¯Ÿè€…æ¨¡å¼ï¼‰ï¼ŒStateï¼ˆçŠ¶æ€æ¨¡å¼ï¼‰ï¼ŒStrategyï¼ˆç­–ç•¥æ¨¡å¼ï¼‰ï¼ŒTemplate Methodï¼ˆæ¨¡æ¿æ–¹æ³•æ¨¡å¼ï¼‰ï¼ŒChain Of Responsibilityï¼ˆè´£ä»»é“¾æ¨¡å¼ï¼‰ã€‚</p>
<p>é¢è¯•è¢«é—®åˆ°å…³äºè®¾è®¡æ¨¡å¼çš„çŸ¥è¯†æ—¶ï¼Œå¯ä»¥æ‹£æœ€å¸¸ç”¨çš„ä½œç­”ï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li>å·¥å‚æ¨¡å¼ï¼šå·¥å‚ç±»å¯ä»¥æ ¹æ®æ¡ä»¶ç”Ÿæˆä¸åŒçš„å­ç±»å®ä¾‹ï¼Œè¿™äº›å­ç±»æœ‰ä¸€ä¸ªå…¬å…±çš„æŠ½è±¡çˆ¶ç±»å¹¶ä¸”å®ç°äº†ç›¸åŒçš„æ–¹æ³•ï¼Œä½†æ˜¯è¿™äº›æ–¹æ³•é’ˆå¯¹ä¸åŒçš„æ•°æ®è¿›è¡Œäº†ä¸åŒçš„æ“ä½œï¼ˆå¤šæ€æ–¹æ³•ï¼‰ã€‚å½“å¾—åˆ°å­ç±»çš„å®ä¾‹åï¼Œå¼€å‘äººå‘˜å¯ä»¥è°ƒç”¨åŸºç±»ä¸­çš„æ–¹æ³•è€Œä¸å¿…è€ƒè™‘åˆ°åº•è¿”å›çš„æ˜¯å“ªä¸€ä¸ªå­ç±»çš„å®ä¾‹ã€‚</li>
<li>ä»£ç†æ¨¡å¼ï¼šç»™ä¸€ä¸ªå¯¹è±¡æä¾›ä¸€ä¸ªä»£ç†å¯¹è±¡ï¼Œå¹¶ç”±ä»£ç†å¯¹è±¡æ§åˆ¶åŸå¯¹è±¡çš„å¼•ç”¨ã€‚å®é™…å¼€å‘ä¸­ï¼ŒæŒ‰ç…§ä½¿ç”¨ç›®çš„çš„ä¸åŒï¼Œä»£ç†å¯ä»¥åˆ†ä¸ºï¼šè¿œç¨‹ä»£ç†ã€è™šæ‹Ÿä»£ç†ã€ä¿æŠ¤ä»£ç†ã€Cache ä»£ç†ã€é˜²ç«å¢™ä»£ç†ã€åŒæ­¥åŒ–ä»£ç†ã€æ™ºèƒ½å¼•ç”¨ä»£ç†ã€‚</li>
<li>é€‚é…å™¨æ¨¡å¼ï¼šæŠŠä¸€ä¸ªç±»çš„æ¥å£å˜æ¢æˆå®¢æˆ·ç«¯æ‰€æœŸå¾…çš„å¦ä¸€ç§æ¥å£ï¼Œä»è€Œä½¿åŸæœ¬å› æ¥å£ä¸åŒ¹é…è€Œæ— æ³•åœ¨ä¸€èµ·ä½¿ç”¨çš„ç±»èƒ½å¤Ÿä¸€èµ·å·¥ä½œã€‚</li>
<li>æ¨¡æ¿æ–¹æ³•æ¨¡å¼ï¼šæä¾›ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå°†éƒ¨åˆ†é€»è¾‘ä»¥å…·ä½“æ–¹æ³•æˆ–æ„é€ å™¨çš„å½¢å¼å®ç°ï¼Œç„¶åå£°æ˜ä¸€äº›æŠ½è±¡æ–¹æ³•æ¥è¿«ä½¿å­ç±»å®ç°å‰©ä½™çš„é€»è¾‘ã€‚ä¸åŒçš„å­ç±»å¯ä»¥ä»¥ä¸åŒçš„æ–¹å¼å®ç°è¿™äº›æŠ½è±¡æ–¹æ³•ï¼ˆå¤šæ€å®ç°ï¼‰ï¼Œä»è€Œå®ç°ä¸åŒçš„ä¸šåŠ¡é€»è¾‘ã€‚</li>
</ul>
<p>é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜å¯ä»¥è®²è®²ä¸Šé¢æåˆ°çš„é—¨é¢æ¨¡å¼ã€æ¡¥æ¢æ¨¡å¼ã€å•ä¾‹æ¨¡å¼ã€è£…æ½¢æ¨¡å¼ï¼ˆCollections å·¥å…·ç±»å’Œ I/O ç³»ç»Ÿä¸­éƒ½ä½¿ç”¨è£…æ½¢æ¨¡å¼ï¼‰ç­‰ï¼Œåæ­£åŸºæœ¬åŸåˆ™å°±æ˜¯æ‹£è‡ªå·±æœ€ç†Ÿæ‚‰çš„ã€ç”¨å¾—æœ€å¤šçš„ä½œç­”ï¼Œä»¥å…è¨€å¤šå¿…å¤±ã€‚</p>
<blockquote>
<p>91ã€ç”¨Javaå†™ä¸€ä¸ªå•ä¾‹ç±»ã€‚</p>
</blockquote>
<p>ç­”ï¼š</p>
<ul>
<li><p>é¥¿æ±‰å¼å•ä¾‹</p>
<p>  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Singleton</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-title">Singleton</span><span class="hljs-params">()</span></span>&#123;&#125;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Singleton instance = <span class="hljs-keyword">new</span> Singleton();<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Singleton <span class="hljs-title">getInstance</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">return</span> instance;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></p>
</li>
<li><p>æ‡’æ±‰å¼å•ä¾‹</p>
<p>  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Singleton</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Singleton instance = <span class="hljs-keyword">null</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-title">Singleton</span><span class="hljs-params">()</span> </span>&#123;&#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">synchronized</span> Singleton <span class="hljs-title">getInstance</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">if</span> (instance == <span class="hljs-keyword">null</span>) instance ï¼ <span class="hljs-keyword">new</span> Singleton();<br>        <span class="hljs-keyword">return</span> instance;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
</p>
</li>
</ul>
<p><strong>æ³¨æ„ï¼š</strong>å®ç°ä¸€ä¸ªå•ä¾‹æœ‰ä¸¤ç‚¹æ³¨æ„äº‹é¡¹ï¼Œ(1)å°†æ„é€ å™¨ç§æœ‰ï¼Œä¸å…è®¸å¤–ç•Œé€šè¿‡æ„é€ å™¨åˆ›å»ºå¯¹è±¡ï¼›(2)é€šè¿‡å…¬å¼€çš„é™æ€æ–¹æ³•å‘å¤–ç•Œè¿”å›ç±»çš„å”¯ä¸€å®ä¾‹ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªé—®é¢˜å¯ä»¥æ€è€ƒï¼šSpring çš„ IoC å®¹å™¨å¯ä»¥ä¸ºæ™®é€šçš„ç±»åˆ›å»ºå•ä¾‹ï¼Œå®ƒæ˜¯æ€ä¹ˆåšåˆ°çš„å‘¢ï¼Ÿ</p>
<blockquote>
<p>92ã€ä»€ä¹ˆæ˜¯ UMLï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šUML æ˜¯ç»Ÿä¸€å»ºæ¨¡è¯­è¨€ï¼ˆUnified Modeling Languageï¼‰çš„ç¼©å†™ï¼Œå®ƒå‘è¡¨äº 1997 å¹´ï¼Œç»¼åˆäº†å½“æ—¶å·²ç»å­˜åœ¨çš„é¢å‘å¯¹è±¡çš„å»ºæ¨¡è¯­è¨€ã€æ–¹æ³•å’Œè¿‡ç¨‹ï¼Œæ˜¯ä¸€ä¸ªæ”¯æŒæ¨¡å‹åŒ–å’Œè½¯ä»¶ç³»ç»Ÿå¼€å‘çš„å›¾å½¢åŒ–è¯­è¨€ï¼Œä¸ºè½¯ä»¶å¼€å‘çš„æ‰€æœ‰é˜¶æ®µæä¾›æ¨¡å‹åŒ–å’Œå¯è§†åŒ–æ”¯æŒã€‚ä½¿ç”¨UMLå¯ä»¥å¸®åŠ©æ²Ÿé€šä¸äº¤æµï¼Œè¾…åŠ©åº”ç”¨è®¾è®¡å’Œæ–‡æ¡£çš„ç”Ÿæˆï¼Œè¿˜èƒ½å¤Ÿé˜é‡Šç³»ç»Ÿçš„ç»“æ„å’Œè¡Œä¸ºã€‚</p>
<blockquote>
<p>93ã€UML ä¸­æœ‰å“ªäº›å¸¸ç”¨çš„å›¾ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šUML å®šä¹‰äº†å¤šç§å›¾å½¢åŒ–çš„ç¬¦å·æ¥æè¿°è½¯ä»¶ç³»ç»Ÿéƒ¨åˆ†æˆ–å…¨éƒ¨çš„é™æ€ç»“æ„å’ŒåŠ¨æ€ç»“æ„ï¼ŒåŒ…æ‹¬ï¼šç”¨ä¾‹å›¾ï¼ˆuse case diagramï¼‰ã€ç±»å›¾ï¼ˆclass diagramï¼‰ã€æ—¶åºå›¾ï¼ˆsequence diagramï¼‰ã€åä½œå›¾ï¼ˆcollaboration diagramï¼‰ã€çŠ¶æ€å›¾ï¼ˆstatechart diagramï¼‰ã€æ´»åŠ¨å›¾ï¼ˆactivity diagramï¼‰ã€æ„ä»¶å›¾ï¼ˆcomponent diagramï¼‰ã€éƒ¨ç½²å›¾ï¼ˆdeployment diagramï¼‰ç­‰ã€‚åœ¨è¿™äº›å›¾å½¢åŒ–ç¬¦å·ä¸­ï¼Œæœ‰ä¸‰ç§å›¾æœ€ä¸ºé‡è¦ï¼Œåˆ†åˆ«æ˜¯ï¼šç”¨ä¾‹å›¾ï¼ˆç”¨æ¥æ•è·éœ€æ±‚ï¼Œæè¿°ç³»ç»Ÿçš„åŠŸèƒ½ï¼Œé€šè¿‡è¯¥å›¾å¯ä»¥è¿…é€Ÿçš„äº†è§£ç³»ç»Ÿçš„åŠŸèƒ½æ¨¡å—åŠå…¶å…³ç³»ï¼‰ã€ç±»å›¾ï¼ˆæè¿°ç±»ä»¥åŠç±»ä¸ç±»ä¹‹é—´çš„å…³ç³»ï¼Œé€šè¿‡è¯¥å›¾å¯ä»¥å¿«é€Ÿäº†è§£ç³»ç»Ÿï¼‰ã€æ—¶åºå›¾ï¼ˆæè¿°æ‰§è¡Œç‰¹å®šä»»åŠ¡æ—¶å¯¹è±¡ä¹‹é—´çš„äº¤äº’å…³ç³»ä»¥åŠæ‰§è¡Œé¡ºåºï¼Œé€šè¿‡è¯¥å›¾å¯ä»¥äº†è§£å¯¹è±¡èƒ½æ¥æ”¶çš„æ¶ˆæ¯ä¹Ÿå°±æ˜¯è¯´å¯¹è±¡èƒ½å¤Ÿå‘å¤–ç•Œæä¾›çš„æœåŠ¡ï¼‰ã€‚</p>
<ul>
<li>ç”¨ä¾‹å›¾ï¼š</li>
</ul>
<p><img src= "https://cdn.jsdelivr.net/gh/Eurkon/CDN/hexo/images/user/loading.gif" data-lazy-src="/images/post/java_interview/93_1.png" alt></p>
<ul>
<li>ç±»å›¾ï¼š</li>
</ul>
<p><img src= "https://cdn.jsdelivr.net/gh/Eurkon/CDN/hexo/images/user/loading.gif" data-lazy-src="/images/post/java_interview/93_2.png" alt></p>
<ul>
<li>æ—¶åºå›¾ï¼š</li>
</ul>
<p><img src= "https://cdn.jsdelivr.net/gh/Eurkon/CDN/hexo/images/user/loading.gif" data-lazy-src="/images/post/java_interview/93_3.png" alt></p>
<blockquote>
<p>94ã€ç”¨ Java å†™ä¸€ä¸ªå†’æ³¡æ’åºã€‚</p>
</blockquote>
<p>ç­”ï¼šå†’æ³¡æ’åºå‡ ä¹æ˜¯ä¸ªç¨‹åºå‘˜éƒ½å†™å¾—å‡ºæ¥ï¼Œä½†æ˜¯é¢è¯•çš„æ—¶å€™å¦‚ä½•å†™ä¸€ä¸ªé€¼æ ¼é«˜çš„å†’æ³¡æ’åºå´ä¸æ˜¯æ¯ä¸ªäººéƒ½èƒ½åšåˆ°ï¼Œä¸‹é¢æä¾›ä¸€ä¸ªå‚è€ƒä»£ç ï¼š</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.Comparator;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * æ’åºå™¨æ¥å£(ç­–ç•¥æ¨¡å¼: å°†ç®—æ³•å°è£…åˆ°å…·æœ‰å…±åŒæ¥å£çš„ç‹¬ç«‹çš„ç±»ä¸­ä½¿å¾—å®ƒä»¬å¯ä»¥ç›¸äº’æ›¿æ¢)</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">Sorter</span> </span>&#123;<br><br>   <span class="hljs-comment">/**</span><br><span class="hljs-comment">    * æ’åº</span><br><span class="hljs-comment">    * <span class="hljs-doctag">@param</span> list å¾…æ’åºçš„æ•°ç»„</span><br><span class="hljs-comment">    */</span><br>   <span class="hljs-keyword">public</span> &lt;T extends Comparable&lt;T&gt;&gt; <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">sort</span><span class="hljs-params">(T[] list)</span></span>;<br><br>   <span class="hljs-comment">/**</span><br><span class="hljs-comment">    * æ’åº</span><br><span class="hljs-comment">    * <span class="hljs-doctag">@param</span> list å¾…æ’åºçš„æ•°ç»„</span><br><span class="hljs-comment">    * <span class="hljs-doctag">@param</span> comp æ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡çš„æ¯”è¾ƒå™¨</span><br><span class="hljs-comment">    */</span><br>   <span class="hljs-keyword">public</span> &lt;T&gt; <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">sort</span><span class="hljs-params">(T[] list, Comparator&lt;T&gt; comp)</span></span>;<br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.Comparator;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * å†’æ³¡æ’åº</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BubbleSorter</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Sorter</span> </span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> &lt;T extends Comparable&lt;T&gt;&gt; <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">sort</span><span class="hljs-params">(T[] list)</span> </span>&#123;<br>        <span class="hljs-keyword">boolean</span> swapped = <span class="hljs-keyword">true</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>, len = list.length; i &lt; len &amp;&amp; swapped; ++i) &#123;<br>            swapped = <span class="hljs-keyword">false</span>;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; len - i; ++j) &#123;<br>                <span class="hljs-keyword">if</span> (list[j].compareTo(list[j + <span class="hljs-number">1</span>]) &gt; <span class="hljs-number">0</span>) &#123;<br>                    T temp = list[j];<br>                    list[j] = list[j + <span class="hljs-number">1</span>];<br>                    list[j + <span class="hljs-number">1</span>] = temp;<br>                    swapped = <span class="hljs-keyword">true</span>;<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> &lt;T&gt; <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">sort</span><span class="hljs-params">(T[] list, Comparator&lt;T&gt; comp)</span> </span>&#123;<br>        <span class="hljs-keyword">boolean</span> swapped = <span class="hljs-keyword">true</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>, len = list.length; i &lt; len &amp;&amp; swapped; ++i) &#123;<br>            swapped = <span class="hljs-keyword">false</span>;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; len - i; ++j) &#123;<br>                <span class="hljs-keyword">if</span> (comp.compare(list[j], list[j + <span class="hljs-number">1</span>]) &gt; <span class="hljs-number">0</span>) &#123;<br>                    T temp = list[j];<br>                    list[j] = list[j + <span class="hljs-number">1</span>];<br>                    list[j + <span class="hljs-number">1</span>] = temp;<br>                    swapped = <span class="hljs-keyword">true</span>;<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<blockquote>
<p>95ã€ç”¨ Java å†™ä¸€ä¸ªæŠ˜åŠæŸ¥æ‰¾ã€‚</p>
</blockquote>
<p>ç­”ï¼šæŠ˜åŠæŸ¥æ‰¾ï¼Œä¹Ÿç§°äºŒåˆ†æŸ¥æ‰¾ã€äºŒåˆ†æœç´¢ï¼Œæ˜¯ä¸€ç§åœ¨æœ‰åºæ•°ç»„ä¸­æŸ¥æ‰¾æŸä¸€ç‰¹å®šå…ƒç´ çš„æœç´¢ç®—æ³•ã€‚æœç´ è¿‡ç¨‹ä»æ•°ç»„çš„ä¸­é—´å…ƒç´ å¼€å§‹ï¼Œå¦‚æœä¸­é—´å…ƒç´ æ­£å¥½æ˜¯è¦æŸ¥æ‰¾çš„å…ƒç´ ï¼Œåˆ™æœç´ è¿‡ç¨‹ç»“æŸï¼›å¦‚æœæŸä¸€ç‰¹å®šå…ƒç´ å¤§äºæˆ–è€…å°äºä¸­é—´å…ƒç´ ï¼Œåˆ™åœ¨æ•°ç»„å¤§äºæˆ–å°äºä¸­é—´å…ƒç´ çš„é‚£ä¸€åŠä¸­æŸ¥æ‰¾ï¼Œè€Œä¸”è·Ÿå¼€å§‹ä¸€æ ·ä»ä¸­é—´å…ƒç´ å¼€å§‹æ¯”è¾ƒã€‚å¦‚æœåœ¨æŸä¸€æ­¥éª¤æ•°ç»„å·²ç»ä¸ºç©ºï¼Œåˆ™è¡¨ç¤ºæ‰¾ä¸åˆ°æŒ‡å®šçš„å…ƒç´ ã€‚è¿™ç§æœç´¢ç®—æ³•æ¯ä¸€æ¬¡æ¯”è¾ƒéƒ½ä½¿æœç´¢èŒƒå›´ç¼©å°ä¸€åŠï¼Œå…¶æ—¶é—´å¤æ‚åº¦æ˜¯ O(logN)ã€‚</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.Comparator;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyUtil</span> </span>&#123;<br><br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T extends Comparable&lt;T&gt;&gt; <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">binarySearch</span><span class="hljs-params">(T[] x, T key)</span> </span>&#123;<br>      <span class="hljs-keyword">return</span> binarySearch(x, <span class="hljs-number">0</span>, x.length- <span class="hljs-number">1</span>, key);<br>   &#125;<br><br>   <span class="hljs-comment">// ä½¿ç”¨å¾ªç¯å®ç°çš„äºŒåˆ†æŸ¥æ‰¾</span><br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T&gt; <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">binarySearch</span><span class="hljs-params">(T[] x, T key, Comparator&lt;T&gt; comp)</span> </span>&#123;<br>      <span class="hljs-keyword">int</span> low = <span class="hljs-number">0</span>;<br>      <span class="hljs-keyword">int</span> high = x.length - <span class="hljs-number">1</span>;<br>      <span class="hljs-keyword">while</span> (low &lt;= high) &#123;<br>          <span class="hljs-keyword">int</span> mid = (low + high) &gt;&gt;&gt; <span class="hljs-number">1</span>;<br>          <span class="hljs-keyword">int</span> cmp = comp.compare(x[mid], key);<br>          <span class="hljs-keyword">if</span> (cmp &lt; <span class="hljs-number">0</span>) &#123;<br>            low= mid + <span class="hljs-number">1</span>;<br>          &#125;<br>          <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (cmp &gt; <span class="hljs-number">0</span>) &#123;<br>            high= mid - <span class="hljs-number">1</span>;<br>          &#125;<br>          <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">return</span> mid;<br>          &#125;<br>      &#125;<br>      <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;<br>   &#125;<br><br>   <span class="hljs-comment">// ä½¿ç”¨é€’å½’å®ç°çš„äºŒåˆ†æŸ¥æ‰¾</span><br>   <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span>&lt;T extends Comparable&lt;T&gt;&gt; <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">binarySearch</span><span class="hljs-params">(T[] x, <span class="hljs-keyword">int</span> low, <span class="hljs-keyword">int</span> high, T key)</span> </span>&#123;<br>      <span class="hljs-keyword">if</span>(low &lt;= high) &#123;<br>        <span class="hljs-keyword">int</span> mid = low + ((high -low) &gt;&gt; <span class="hljs-number">1</span>);<br>        <span class="hljs-keyword">if</span>(key.compareTo(x[mid])== <span class="hljs-number">0</span>) &#123;<br>           <span class="hljs-keyword">return</span> mid;<br>        &#125;<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(key.compareTo(x[mid])&lt; <span class="hljs-number">0</span>) &#123;<br>           <span class="hljs-keyword">return</span> binarySearch(x,low, mid - <span class="hljs-number">1</span>, key);<br>        &#125;<br>        <span class="hljs-keyword">else</span> &#123;<br>           <span class="hljs-keyword">return</span> binarySearch(x,mid + <span class="hljs-number">1</span>, high, key);<br>        &#125;<br>      &#125;<br>      <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;<br>   &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<p><strong>è¯´æ˜ï¼š</strong>ä¸Šé¢çš„ä»£ç ä¸­ç»™å‡ºäº†æŠ˜åŠæŸ¥æ‰¾çš„ä¸¤ä¸ªç‰ˆæœ¬ï¼Œä¸€ä¸ªç”¨é€’å½’å®ç°ï¼Œä¸€ä¸ªç”¨å¾ªç¯å®ç°ã€‚éœ€è¦æ³¨æ„çš„æ˜¯è®¡ç®—ä¸­é—´ä½ç½®æ—¶ä¸åº”è¯¥ä½¿ç”¨(high+ low) / 2çš„æ–¹å¼ï¼Œå› ä¸ºåŠ æ³•è¿ç®—å¯èƒ½å¯¼è‡´æ•´æ•°è¶Šç•Œï¼Œè¿™é‡Œåº”è¯¥ä½¿ç”¨ä»¥ä¸‹ä¸‰ç§æ–¹å¼ä¹‹ä¸€ï¼šlow + (high - low) / 2æˆ–low + (high â€“ low) &gt;&gt; 1æˆ–(low + high) &gt;&gt;&gt; 1ï¼ˆ&gt;&gt;&gt;æ˜¯é€»è¾‘å³ç§»ï¼Œæ˜¯ä¸å¸¦ç¬¦å·ä½çš„å³ç§»ï¼‰</p>
<h1 id="Java-Webï¼ˆ96-125ï¼‰"><a href="#Java-Webï¼ˆ96-125ï¼‰" class="headerlink" title="Java Webï¼ˆ96~125ï¼‰"></a>Java Webï¼ˆ96~125ï¼‰</h1><blockquote>
<p>96ã€é˜è¿° Servlet å’Œ CGI çš„åŒºåˆ«?</p>
</blockquote>
<p>ç­”ï¼šServlet ä¸ CGI çš„åŒºåˆ«åœ¨äº Servlet å¤„äºæœåŠ¡å™¨è¿›ç¨‹ä¸­ï¼Œå®ƒé€šè¿‡å¤šçº¿ç¨‹æ–¹å¼è¿è¡Œå…¶ <code>service()</code> æ–¹æ³•ï¼Œä¸€ä¸ªå®ä¾‹å¯ä»¥æœåŠ¡äºå¤šä¸ªè¯·æ±‚ï¼Œå¹¶ä¸”å…¶å®ä¾‹ä¸€èˆ¬ä¸ä¼šé”€æ¯ï¼Œè€Œ CGI å¯¹æ¯ä¸ªè¯·æ±‚éƒ½äº§ç”Ÿæ–°çš„è¿›ç¨‹ï¼ŒæœåŠ¡å®Œæˆåå°±é”€æ¯ï¼Œæ‰€ä»¥æ•ˆç‡ä¸Šä½äº Servletã€‚</p>
<p><strong>è¡¥å……ï¼š</strong>Sun Microsystems å…¬å¸åœ¨ 1996 å¹´å‘å¸ƒ Servlet æŠ€æœ¯å°±æ˜¯ä¸ºäº†å’Œ CGI è¿›è¡Œç«äº‰ï¼ŒServlet æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„ Java ç¨‹åºï¼Œä¸€ä¸ªåŸºäº Java çš„ Web åº”ç”¨é€šå¸¸åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ª Servlet ç±»ã€‚Servlet ä¸èƒ½å¤Ÿè‡ªè¡Œåˆ›å»ºå¹¶æ‰§è¡Œï¼Œå®ƒæ˜¯åœ¨ Servlet å®¹å™¨ä¸­è¿è¡Œçš„ï¼Œå®¹å™¨å°†ç”¨æˆ·çš„è¯·æ±‚ä¼ é€’ç»™ Servlet ç¨‹åºï¼Œå¹¶å°† Servlet çš„å“åº”å›ä¼ ç»™ç”¨æˆ·ã€‚é€šå¸¸ä¸€ä¸ª Servlet ä¼šå…³è”ä¸€ä¸ªæˆ–å¤šä¸ª JSP é¡µé¢ã€‚ä»¥å‰ CGI ç»å¸¸å› ä¸ºæ€§èƒ½å¼€é”€ä¸Šçš„é—®é¢˜è¢«è¯Ÿç—…ï¼Œç„¶è€Œ Fast CGI æ—©å°±å·²ç»è§£å†³äº† CGI æ•ˆç‡ä¸Šçš„é—®é¢˜ï¼Œæ‰€ä»¥é¢è¯•çš„æ—¶å€™å¤§å¯ä¸å¿…ä¿¡å£å¼€æ²³çš„è¯Ÿç—… CGIï¼Œäº‹å®ä¸Šæœ‰å¾ˆå¤šä½ ç†Ÿæ‚‰çš„ç½‘ç«™éƒ½ä½¿ç”¨äº† CGI æŠ€æœ¯ã€‚</p>
<blockquote>
<p>97ã€Servlet æ¥å£ä¸­æœ‰å“ªäº›æ–¹æ³•ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šServlet æ¥å£å®šä¹‰äº† 5 ä¸ªæ–¹æ³•ï¼Œå…¶ä¸­å‰ä¸‰ä¸ªæ–¹æ³•ä¸ Servlet ç”Ÿå‘½å‘¨æœŸç›¸å…³ï¼š</p>
<ul>
<li><code>void init(ServletConfig config) throws ServletException</code></li>
<li><code>void service(ServletRequest req, ServletResponse resp) throws ServletException, java.io.IOException</code></li>
<li><code>void destroy()</code></li>
<li><code>java.lang.String getServletInfo()</code></li>
<li><code>ServletConfig getServletConfig()</code></li>
</ul>
<p>Web å®¹å™¨åŠ è½½ Servlet å¹¶å°†å…¶å®ä¾‹åŒ–åï¼ŒServlet ç”Ÿå‘½å‘¨æœŸå¼€å§‹ï¼Œå®¹å™¨è¿è¡Œå…¶ <code>init()</code> æ–¹æ³•è¿›è¡Œ Servlet çš„åˆå§‹åŒ–ï¼›è¯·æ±‚åˆ°è¾¾æ—¶è°ƒç”¨ Servlet çš„ <code>service()</code> æ–¹æ³•ï¼Œ<code>service()</code> æ–¹æ³•ä¼šæ ¹æ®éœ€è¦è°ƒç”¨ä¸è¯·æ±‚å¯¹åº”çš„ <code>doGet</code> æˆ– <code>doPost</code> ç­‰æ–¹æ³•ï¼›å½“æœåŠ¡å™¨å…³é—­æˆ–é¡¹ç›®è¢«å¸è½½æ—¶æœåŠ¡å™¨ä¼šå°† Servlet å®ä¾‹é”€æ¯ï¼Œæ­¤æ—¶ä¼šè°ƒç”¨ Servlet çš„ <code>destroy()</code> æ–¹æ³•ã€‚</p>
<blockquote>
<p>98ã€è½¬å‘ï¼ˆforwardï¼‰å’Œé‡å®šå‘ï¼ˆredirectï¼‰çš„åŒºåˆ«ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼š<code>forward</code> æ˜¯å®¹å™¨ä¸­æ§åˆ¶æƒçš„è½¬å‘ï¼Œæ˜¯æœåŠ¡å™¨è¯·æ±‚èµ„æºï¼ŒæœåŠ¡å™¨ç›´æ¥è®¿é—®ç›®æ ‡åœ°å€çš„ URLï¼ŒæŠŠé‚£ä¸ª URL çš„å“åº”å†…å®¹è¯»å–è¿‡æ¥ï¼Œç„¶åæŠŠè¿™äº›å†…å®¹å†å‘ç»™æµè§ˆå™¨ï¼Œæµè§ˆå™¨æ ¹æœ¬ä¸çŸ¥é“æœåŠ¡å™¨å‘é€çš„å†…å®¹æ˜¯ä»å“ªå„¿æ¥çš„ï¼Œæ‰€ä»¥å®ƒçš„åœ°å€æ ä¸­è¿˜æ˜¯åŸæ¥çš„åœ°å€ã€‚<code>redirect</code> å°±æ˜¯æœåŠ¡å™¨ç«¯æ ¹æ®é€»è¾‘ï¼Œå‘é€ä¸€ä¸ªçŠ¶æ€ç ï¼Œå‘Šè¯‰æµè§ˆå™¨é‡æ–°å»è¯·æ±‚é‚£ä¸ªåœ°å€ï¼Œå› æ­¤ä»æµè§ˆå™¨çš„åœ°å€æ ä¸­å¯ä»¥çœ‹åˆ°è·³è½¬åçš„é“¾æ¥åœ°å€ï¼Œå¾ˆæ˜æ˜¾ <code>redirect</code> æ— æ³•è®¿é—®åˆ°æœåŠ¡å™¨ä¿æŠ¤èµ·æ¥èµ„æºï¼Œä½†æ˜¯å¯ä»¥ä»ä¸€ä¸ªç½‘ç«™ <code>redirect</code> åˆ°å…¶ä»–ç½‘ç«™ã€‚<code>forward</code> æ›´åŠ é«˜æ•ˆï¼Œæ‰€ä»¥åœ¨æ»¡è¶³éœ€è¦æ—¶å°½é‡ä½¿ç”¨ <code>forward</code>ï¼ˆé€šè¿‡è°ƒç”¨ <code>RequestDispatcher</code> å¯¹è±¡çš„ <code>forward()</code> æ–¹æ³•ï¼Œè¯¥å¯¹è±¡å¯ä»¥é€šè¿‡ <code>ServletRequest</code> å¯¹è±¡çš„ <code>getRequestDispatcher()</code> æ–¹æ³•è·å¾—ï¼‰ï¼Œå¹¶ä¸”è¿™æ ·ä¹Ÿæœ‰åŠ©äºéšè—å®é™…çš„é“¾æ¥ï¼›åœ¨æœ‰äº›æƒ…å†µä¸‹ï¼Œæ¯”å¦‚éœ€è¦è®¿é—®ä¸€ä¸ªå…¶å®ƒæœåŠ¡å™¨ä¸Šçš„èµ„æºï¼Œåˆ™å¿…é¡»ä½¿ç”¨é‡å®šå‘ï¼ˆé€šè¿‡ <code>HttpServletResponse</code> å¯¹è±¡è°ƒç”¨å…¶ <code>sendRedirect()</code> æ–¹æ³•å®ç°ï¼‰ã€‚</p>
<blockquote>
<p>99ã€JSP æœ‰å“ªäº›å†…ç½®å¯¹è±¡ï¼Ÿä½œç”¨åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šJSP æœ‰ 9 ä¸ªå†…ç½®å¯¹è±¡ï¼š</p>
<ul>
<li><code>request</code>ï¼šå°è£…å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«æ¥è‡ª GET æˆ– POST è¯·æ±‚çš„å‚æ•°ï¼›</li>
<li><code>response</code>ï¼šå°è£…æœåŠ¡å™¨å¯¹å®¢æˆ·ç«¯çš„å“åº”ï¼›</li>
<li><code>pageContext</code>ï¼šé€šè¿‡è¯¥å¯¹è±¡å¯ä»¥è·å–å…¶ä»–å¯¹è±¡ï¼›</li>
<li><code>session</code>ï¼šå°è£…ç”¨æˆ·ä¼šè¯çš„å¯¹è±¡ï¼›</li>
<li><code>application</code>ï¼šå°è£…æœåŠ¡å™¨è¿è¡Œç¯å¢ƒçš„å¯¹è±¡ï¼›</li>
<li><code>out</code>ï¼šè¾“å‡ºæœåŠ¡å™¨å“åº”çš„è¾“å‡ºæµå¯¹è±¡ï¼›</li>
<li><code>config</code>ï¼šWeb åº”ç”¨çš„é…ç½®å¯¹è±¡ï¼›</li>
<li><code>page</code>ï¼šJSP é¡µé¢æœ¬èº«ï¼ˆç›¸å½“äº Java ç¨‹åºä¸­çš„ <code>this</code>ï¼‰ï¼›</li>
<li><code>exception</code>ï¼šå°è£…é¡µé¢æŠ›å‡ºå¼‚å¸¸çš„å¯¹è±¡ã€‚</li>
</ul>
<p><strong>è¡¥å……ï¼š</strong>å¦‚æœç”¨ Servlet æ¥ç”Ÿæˆç½‘é¡µä¸­çš„åŠ¨æ€å†…å®¹æ— ç–‘æ˜¯éå¸¸ç¹ççš„å·¥ä½œï¼Œå¦ä¸€æ–¹é¢ï¼Œæ‰€æœ‰çš„æ–‡æœ¬å’Œ HTML æ ‡ç­¾éƒ½æ˜¯ç¡¬ç¼–ç ï¼Œå³ä½¿åšå‡ºå¾®å°çš„ä¿®æ”¹ï¼Œéƒ½éœ€è¦è¿›è¡Œé‡æ–°ç¼–è¯‘ã€‚JSP è§£å†³äº† Servlet çš„è¿™äº›é—®é¢˜ï¼Œå®ƒæ˜¯ Servlet å¾ˆå¥½çš„è¡¥å……ï¼Œå¯ä»¥ä¸“é—¨ç”¨ä½œä¸ºç”¨æˆ·å‘ˆç°è§†å›¾ï¼ˆViewï¼‰ï¼Œè€Œ Servlet ä½œä¸ºæ§åˆ¶å™¨ï¼ˆControllerï¼‰ä¸“é—¨è´Ÿè´£å¤„ç†ç”¨æˆ·è¯·æ±‚å¹¶è½¬å‘æˆ–é‡å®šå‘åˆ°æŸä¸ªé¡µé¢ã€‚åŸºäº Java çš„ Web å¼€å‘å¾ˆå¤šéƒ½åŒæ—¶ä½¿ç”¨äº† Servlet å’Œ JSPã€‚JSP é¡µé¢å…¶å®æ˜¯ä¸€ä¸ª Servletï¼Œèƒ½å¤Ÿè¿è¡Œ Servlet çš„æœåŠ¡å™¨ï¼ˆServlet å®¹å™¨ï¼‰é€šå¸¸ä¹Ÿæ˜¯ JSP å®¹å™¨ï¼Œå¯ä»¥æä¾› JSP é¡µé¢çš„è¿è¡Œç¯å¢ƒï¼ŒTomcat å°±æ˜¯ä¸€ä¸ª Servlet/JSP å®¹å™¨ã€‚ç¬¬ä¸€æ¬¡è¯·æ±‚ä¸€ä¸ª JSP é¡µé¢æ—¶ï¼ŒServlet/JSP å®¹å™¨é¦–å…ˆå°† JSP é¡µé¢è½¬æ¢æˆä¸€ä¸ª JSP é¡µé¢çš„å®ç°ç±»ï¼Œè¿™æ˜¯ä¸€ä¸ªå®ç°äº† JspPage æ¥å£æˆ–å…¶å­æ¥å£ HttpJspPage çš„ Java ç±»ã€‚JspPage æ¥å£æ˜¯ Servlet çš„å­æ¥å£ï¼Œå› æ­¤æ¯ä¸ª JSP é¡µé¢éƒ½æ˜¯ä¸€ä¸ª Servletã€‚è½¬æ¢æˆåŠŸåï¼Œå®¹å™¨ä¼šç¼–è¯‘ Servlet ç±»ï¼Œä¹‹åå®¹å™¨åŠ è½½å’Œå®ä¾‹åŒ– Java å­—èŠ‚ç ï¼Œå¹¶æ‰§è¡Œå®ƒé€šå¸¸å¯¹ Servlet æ‰€åšçš„ç”Ÿå‘½å‘¨æœŸæ“ä½œã€‚å¯¹åŒä¸€ä¸ª JSP é¡µé¢çš„åç»­è¯·æ±‚ï¼Œå®¹å™¨ä¼šæŸ¥çœ‹è¿™ä¸ª JSP é¡µé¢æ˜¯å¦è¢«ä¿®æ”¹è¿‡ï¼Œå¦‚æœä¿®æ”¹è¿‡å°±ä¼šé‡æ–°è½¬æ¢å¹¶é‡æ–°ç¼–è¯‘å¹¶æ‰§è¡Œã€‚å¦‚æœæ²¡æœ‰åˆ™æ‰§è¡Œå†…å­˜ä¸­å·²ç»å­˜åœ¨çš„ Servlet å®ä¾‹ã€‚æˆ‘ä»¬å¯ä»¥çœ‹ä¸€æ®µ JSP ä»£ç å¯¹åº”çš„ Java ç¨‹åºå°±çŸ¥é“ä¸€åˆ‡äº†ï¼Œè€Œä¸” 9 ä¸ªå†…ç½®å¯¹è±¡çš„ç¥ç§˜é¢çº±ä¹Ÿä¼šè¢«æ­å¼€ã€‚</p>
<p>JSP é¡µé¢ï¼š</p>
<p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs jsp">&lt;%@ page pageEncoding=<span class="hljs-string">&quot;UTF-8&quot;</span>%&gt;<br>&lt;%<br>String path = request.getContextPath();<br>String basePath = request.getScheme() + <span class="hljs-string">&quot;://&quot;</span> + request.getServerName() + <span class="hljs-string">&quot;:&quot;</span> + request.getServerPort() + path + <span class="hljs-string">&quot;/&quot;</span>;<br>%&gt;<br><br>&lt;!DOCTYPE html&gt;<br>&lt;html&gt;<br>  &lt;head&gt;<br>    &lt;base href=<span class="hljs-string">&quot;&lt;%=basePath%&gt;&quot;</span>&gt;<br>    &lt;title&gt;é¦–é¡µ&lt;/title&gt;<br>    &lt;style type=<span class="hljs-string">&quot;text/css&quot;</span>&gt;<br>        * &#123; font-family: <span class="hljs-string">&quot;Arial&quot;</span>; &#125;<br>    &lt;/style&gt;<br>  &lt;/head&gt;<br><br>  &lt;body&gt;<br>    &lt;h1&gt;Hello, World!&lt;/h1&gt;<br>    &lt;hr/&gt;<br>    &lt;h2&gt;Current time is: &lt;%= new java.util.Date().toString() %&gt;&lt;/h2&gt;<br>  &lt;/body&gt;<br>&lt;/html&gt;<br></code></pre></td></tr></table></figure>
</p>
<p>å¯¹åº”çš„ Java ä»£ç ï¼š</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/*</span><br><span class="hljs-comment"> * Generated by the Jasper component of Apache Tomcat</span><br><span class="hljs-comment"> * Version: Apache Tomcat/7.0.52</span><br><span class="hljs-comment"> * Generated at: 2014-10-13 13:28:38 UTC</span><br><span class="hljs-comment"> * Note: The last modified time of this file was set to</span><br><span class="hljs-comment"> *       the last modified time of the source file after</span><br><span class="hljs-comment"> *       generation to assist with modification tracking.</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">package</span> org.apache.jsp;<br><br><span class="hljs-keyword">import</span> javax.servlet.*;<br><span class="hljs-keyword">import</span> javax.servlet.http.*;<br><span class="hljs-keyword">import</span> javax.servlet.jsp.*;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">index_jsp</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">org</span>.<span class="hljs-title">apache</span>.<span class="hljs-title">jasper</span>.<span class="hljs-title">runtime</span>.<span class="hljs-title">HttpJspBase</span></span><br><span class="hljs-class">        <span class="hljs-keyword">implements</span> <span class="hljs-title">org</span>.<span class="hljs-title">apache</span>.<span class="hljs-title">jasper</span>.<span class="hljs-title">runtime</span>.<span class="hljs-title">JspSourceDependent</span> </span>&#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> javax.servlet.jsp.JspFactory _jspxFactory = javax.servlet.jsp.JspFactory<br>            .getDefaultFactory();<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> java.util.Map&lt;java.lang.String, java.lang.Long&gt; _jspx_dependants;<br><br>    <span class="hljs-keyword">private</span> javax.el.ExpressionFactory _el_expressionfactory;<br>    <span class="hljs-keyword">private</span> org.apache.tomcat.InstanceManager _jsp_instancemanager;<br><br>    <span class="hljs-keyword">public</span> java.util.Map&lt;java.lang.String, java.lang.Long&gt; getDependants() &#123;<br>        <span class="hljs-keyword">return</span> _jspx_dependants;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">_jspInit</span><span class="hljs-params">()</span> </span>&#123;<br>        _el_expressionfactory = _jspxFactory.getJspApplicationContext(<br>                getServletConfig().getServletContext()).getExpressionFactory();<br>        _jsp_instancemanager = org.apache.jasper.runtime.InstanceManagerFactory<br>                .getInstanceManager(getServletConfig());<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">_jspDestroy</span><span class="hljs-params">()</span> </span>&#123;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">_jspService</span><span class="hljs-params">(</span></span><br><span class="hljs-function"><span class="hljs-params">            <span class="hljs-keyword">final</span> javax.servlet.http.HttpServletRequest request,</span></span><br><span class="hljs-function"><span class="hljs-params">            <span class="hljs-keyword">final</span> javax.servlet.http.HttpServletResponse response)</span></span><br><span class="hljs-function">            <span class="hljs-keyword">throws</span> java.io.IOException, javax.servlet.ServletException </span>&#123;<br>        <span class="hljs-comment">// å†…ç½®å¯¹è±¡å°±æ˜¯åœ¨è¿™é‡Œå®šä¹‰çš„</span><br>        <span class="hljs-keyword">final</span> javax.servlet.jsp.PageContext pageContext;<br>        javax.servlet.http.HttpSession session = <span class="hljs-keyword">null</span>;<br>        <span class="hljs-keyword">final</span> javax.servlet.ServletContext application;<br>        <span class="hljs-keyword">final</span> javax.servlet.ServletConfig config;<br>        javax.servlet.jsp.JspWriter out = <span class="hljs-keyword">null</span>;<br>        <span class="hljs-keyword">final</span> java.lang.Object page = <span class="hljs-keyword">this</span>;<br>        javax.servlet.jsp.JspWriter _jspx_out = <span class="hljs-keyword">null</span>;<br>        javax.servlet.jsp.PageContext _jspx_page_context = <span class="hljs-keyword">null</span>;<br><br>        <span class="hljs-keyword">try</span> &#123;<br>            response.setContentType(<span class="hljs-string">&quot;text/html;charset=UTF-8&quot;</span>);<br>            pageContext = _jspxFactory.getPageContext(<span class="hljs-keyword">this</span>, request, response,<br>                    <span class="hljs-keyword">null</span>, <span class="hljs-keyword">true</span>, <span class="hljs-number">8192</span>, <span class="hljs-keyword">true</span>);<br>            _jspx_page_context = pageContext;<br>            application = pageContext.getServletContext();<br>            config = pageContext.getServletConfig();<br>            session = pageContext.getSession();<br>            out = pageContext.getOut();<br>            _jspx_out = out;<br><br>            out.write(<span class="hljs-string">&#x27;\r&#x27;</span>);<br>            out.write(<span class="hljs-string">&#x27;\n&#x27;</span>);<br><br>            String path = request.getContextPath();<br>            String basePath = request.getScheme() + <span class="hljs-string">&quot;://&quot;</span><br>                    + request.getServerName() + <span class="hljs-string">&quot;:&quot;</span> + request.getServerPort()<br>                    + path + <span class="hljs-string">&quot;/&quot;</span>;<br>            <br>            <span class="hljs-comment">// ä»¥ä¸‹ä»£ç é€šè¿‡è¾“å‡ºæµå°†HTMLæ ‡ç­¾è¾“å‡ºåˆ°æµè§ˆå™¨ä¸­</span><br>            out.write(<span class="hljs-string">&quot;\r\n&quot;</span>);<br>            out.write(<span class="hljs-string">&quot;\r\n&quot;</span>);<br>            out.write(<span class="hljs-string">&quot;&lt;!DOCTYPE html&gt;\r\n&quot;</span>);<br>            out.write(<span class="hljs-string">&quot;&lt;html&gt;\r\n&quot;</span>);<br>            out.write(<span class="hljs-string">&quot;  &lt;head&gt;\r\n&quot;</span>);<br>            out.write(<span class="hljs-string">&quot;    &lt;base href=\&quot;&quot;</span>);<br>            out.print(basePath);<br>            out.write(<span class="hljs-string">&quot;\&quot;&gt;\r\n&quot;</span>);<br>            out.write(<span class="hljs-string">&quot;    &lt;title&gt;é¦–é¡µ&lt;/title&gt;\r\n&quot;</span>);<br>            out.write(<span class="hljs-string">&quot;    &lt;style type=\&quot;text/css\&quot;&gt;\r\n&quot;</span>);<br>            out.write(<span class="hljs-string">&quot;    \t* &#123; font-family: \&quot;Arial\&quot;; &#125;\r\n&quot;</span>);<br>            out.write(<span class="hljs-string">&quot;    &lt;/style&gt;\r\n&quot;</span>);<br>            out.write(<span class="hljs-string">&quot;  &lt;/head&gt;\r\n&quot;</span>);<br>            out.write(<span class="hljs-string">&quot;  \r\n&quot;</span>);<br>            out.write(<span class="hljs-string">&quot;  &lt;body&gt;\r\n&quot;</span>);<br>            out.write(<span class="hljs-string">&quot;    &lt;h1&gt;Hello, World!&lt;/h1&gt;\r\n&quot;</span>);<br>            out.write(<span class="hljs-string">&quot;    &lt;hr/&gt;\r\n&quot;</span>);<br>            out.write(<span class="hljs-string">&quot;    &lt;h2&gt;Current time is: &quot;</span>);<br>            out.print(<span class="hljs-keyword">new</span> java.util.Date().toString());<br>            out.write(<span class="hljs-string">&quot;&lt;/h2&gt;\r\n&quot;</span>);<br>            out.write(<span class="hljs-string">&quot;  &lt;/body&gt;\r\n&quot;</span>);<br>            out.write(<span class="hljs-string">&quot;&lt;/html&gt;\r\n&quot;</span>);<br>        &#125; <span class="hljs-keyword">catch</span> (java.lang.Throwable t) &#123;<br>            <span class="hljs-keyword">if</span> (!(t <span class="hljs-keyword">instanceof</span> javax.servlet.jsp.SkipPageException)) &#123;<br>                out = _jspx_out;<br>                <span class="hljs-keyword">if</span> (out != <span class="hljs-keyword">null</span> &amp;&amp; out.getBufferSize() != <span class="hljs-number">0</span>)<br>                    <span class="hljs-keyword">try</span> &#123;<br>                        out.clearBuffer();<br>                    &#125; <span class="hljs-keyword">catch</span> (java.io.IOException e) &#123;<br>                    &#125;<br>                <span class="hljs-keyword">if</span> (_jspx_page_context != <span class="hljs-keyword">null</span>)<br>                    _jspx_page_context.handlePageException(t);<br>                <span class="hljs-keyword">else</span><br>                    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ServletException(t);<br>            &#125;<br>        &#125; <span class="hljs-keyword">finally</span> &#123;<br>            _jspxFactory.releasePageContext(_jspx_page_context);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<blockquote>
<p>100ã€get å’Œ post è¯·æ±‚çš„åŒºåˆ«ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼š</p>
<ol>
<li>get è¯·æ±‚ç”¨æ¥ä»æœåŠ¡å™¨ä¸Šè·å¾—èµ„æºï¼Œè€Œ post æ˜¯ç”¨æ¥å‘æœåŠ¡å™¨æäº¤æ•°æ®ï¼›</li>
<li>get å°†è¡¨å•ä¸­æ•°æ®æŒ‰ç…§ <code>name=value</code> çš„å½¢å¼ï¼Œæ·»åŠ åˆ° <code>action</code> æ‰€æŒ‡å‘çš„ URL åé¢ï¼Œå¹¶ä¸”ä¸¤è€…ä½¿ç”¨ <code>?</code> è¿æ¥ï¼Œè€Œå„ä¸ªå˜é‡ä¹‹é—´ä½¿ç”¨ <code>&amp;</code> è¿æ¥ï¼›post æ˜¯å°†è¡¨å•ä¸­çš„æ•°æ®æ”¾åœ¨ HTTP åè®®çš„è¯·æ±‚å¤´æˆ–æ¶ˆæ¯ä½“ä¸­ï¼Œä¼ é€’åˆ° <code>action</code> æ‰€æŒ‡å‘ URLï¼›</li>
<li>get ä¼ è¾“çš„æ•°æ®è¦å—åˆ° URL é•¿åº¦é™åˆ¶ï¼ˆ1024 å­—èŠ‚ï¼‰ï¼›è€Œ post å¯ä»¥ä¼ è¾“å¤§é‡çš„æ•°æ®ï¼Œä¸Šä¼ æ–‡ä»¶é€šå¸¸è¦ä½¿ç”¨ post æ–¹å¼ï¼›</li>
<li>ä½¿ç”¨ get æ—¶å‚æ•°ä¼šæ˜¾ç¤ºåœ¨åœ°å€æ ä¸Šï¼Œå¦‚æœè¿™äº›æ•°æ®ä¸æ˜¯æ•æ„Ÿæ•°æ®ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨ getï¼›å¯¹äºæ•æ„Ÿæ•°æ®è¿˜æ˜¯åº”ç”¨ä½¿ç”¨ postï¼›</li>
<li>get ä½¿ç”¨ MIME ç±»å‹ <code>application/x-www-form-urlencoded</code> çš„ URL ç¼–ç ï¼ˆä¹Ÿå«ç™¾åˆ†å·ç¼–ç ï¼‰æ–‡æœ¬çš„æ ¼å¼ä¼ é€’å‚æ•°ï¼Œä¿è¯è¢«ä¼ é€çš„å‚æ•°ç”±éµå¾ªè§„èŒƒçš„æ–‡æœ¬ç»„æˆï¼Œä¾‹å¦‚ä¸€ä¸ªç©ºæ ¼çš„ç¼–ç æ˜¯ <code>%20</code>ã€‚</li>
</ol>
<blockquote>
<p>101ã€å¸¸ç”¨çš„ Web æœåŠ¡å™¨æœ‰å“ªäº›ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šUnix å’Œ Linux å¹³å°ä¸‹ä½¿ç”¨æœ€å¹¿æ³›çš„å…è´¹ HTTP æœåŠ¡å™¨æ˜¯ Apache æœåŠ¡å™¨ï¼Œè€Œ Windows å¹³å°çš„æœåŠ¡å™¨é€šå¸¸ä½¿ç”¨ IIS ä½œä¸º Web æœåŠ¡å™¨ã€‚é€‰æ‹© Web æœåŠ¡å™¨åº”è€ƒè™‘çš„å› ç´ æœ‰ï¼šæ€§èƒ½ã€å®‰å…¨æ€§ã€æ—¥å¿—å’Œç»Ÿè®¡ã€è™šæ‹Ÿä¸»æœºã€ä»£ç†æœåŠ¡å™¨ã€ç¼“å†²æœåŠ¡å’Œé›†æˆåº”ç”¨ç¨‹åºç­‰ã€‚ä¸‹é¢æ˜¯å¯¹å¸¸è§æœåŠ¡å™¨çš„ç®€ä»‹ï¼š</p>
<ul>
<li><p>IISï¼šMicrosoft çš„ Web æœåŠ¡å™¨äº§å“ï¼Œå…¨ç§°æ˜¯ Internet Information Servicesã€‚IIS æ˜¯å…è®¸åœ¨å…¬å…± Intranet æˆ– Internet ä¸Šå‘å¸ƒä¿¡æ¯çš„ Web æœåŠ¡å™¨ã€‚IIS æ˜¯ç›®å‰æœ€æµè¡Œçš„ Web æœåŠ¡å™¨äº§å“ä¹‹ä¸€ï¼Œå¾ˆå¤šè‘—åçš„ç½‘ç«™éƒ½æ˜¯å»ºç«‹åœ¨ IIS çš„å¹³å°ä¸Šã€‚IIS æä¾›äº†ä¸€ä¸ªå›¾å½¢ç•Œé¢çš„ç®¡ç†å·¥å…·ï¼Œç§°ä¸º Internet æœåŠ¡ç®¡ç†å™¨ï¼Œå¯ç”¨äºç›‘è§†é…ç½®å’Œæ§åˆ¶ Internet æœåŠ¡ã€‚IIS æ˜¯ä¸€ç§ Web æœåŠ¡ç»„ä»¶ï¼Œå…¶ä¸­åŒ…æ‹¬ Web æœåŠ¡å™¨ã€FTP æœåŠ¡å™¨ã€NNTP æœåŠ¡å™¨å’Œ SMTP æœåŠ¡å™¨ï¼Œåˆ†åˆ«ç”¨äºç½‘é¡µæµè§ˆã€æ–‡ä»¶ä¼ è¾“ã€æ–°é—»æœåŠ¡å’Œé‚®ä»¶å‘é€ç­‰æ–¹é¢ï¼Œå®ƒä½¿å¾—åœ¨ç½‘ç»œï¼ˆåŒ…æ‹¬äº’è”ç½‘å’Œå±€åŸŸç½‘ï¼‰ä¸Šå‘å¸ƒä¿¡æ¯æˆäº†ä¸€ä»¶å¾ˆå®¹æ˜“çš„äº‹ã€‚å®ƒæä¾› ISAPIï¼ˆIntranet Server APIï¼‰ä½œä¸ºæ‰©å±• Web æœåŠ¡å™¨åŠŸèƒ½çš„ç¼–ç¨‹æ¥å£ï¼›åŒæ—¶ï¼Œå®ƒè¿˜æä¾›ä¸€ä¸ª Internet æ•°æ®åº“è¿æ¥å™¨ï¼Œå¯ä»¥å®ç°å¯¹æ•°æ®åº“çš„æŸ¥è¯¢å’Œæ›´æ–°ã€‚</p>
</li>
<li><p>Kangleï¼šKangle Web æœåŠ¡å™¨æ˜¯ä¸€æ¬¾è·¨å¹³å°ã€åŠŸèƒ½å¼ºå¤§ã€å®‰å…¨ç¨³å®šã€æ˜“æ“ä½œçš„é«˜æ€§èƒ½ Web æœåŠ¡å™¨å’Œåå‘ä»£ç†æœåŠ¡å™¨è½¯ä»¶ã€‚æ­¤å¤–ï¼ŒKangle ä¹Ÿæ˜¯ä¸€æ¬¾ä¸“ä¸ºåšè™šæ‹Ÿä¸»æœºç ”å‘çš„ Web æœåŠ¡å™¨ã€‚å®ç°è™šæ‹Ÿä¸»æœºç‹¬ç«‹è¿›ç¨‹ã€ç‹¬ç«‹èº«ä»½è¿è¡Œã€‚ç”¨æˆ·ä¹‹é—´å®‰å…¨éš”ç¦»ï¼Œä¸€ä¸ªç”¨æˆ·å‡ºé—®é¢˜ä¸å½±å“å…¶ä»–ç”¨æˆ·ã€‚æ”¯æŒ PHPã€ASPã€ASP.NETã€Javaã€Ruby ç­‰å¤šç§åŠ¨æ€å¼€å‘è¯­è¨€ã€‚</p>
</li>
<li><p>WebSphereï¼šWebSphere Application Server æ˜¯åŠŸèƒ½å®Œå–„ã€å¼€æ”¾çš„ Web åº”ç”¨ç¨‹åºæœåŠ¡å™¨ï¼Œæ˜¯ IBM ç”µå­å•†åŠ¡è®¡åˆ’çš„æ ¸å¿ƒéƒ¨åˆ†ï¼Œå®ƒæ˜¯åŸºäº Java çš„åº”ç”¨ç¯å¢ƒï¼Œç”¨äºå»ºç«‹ã€éƒ¨ç½²å’Œç®¡ç† Internet å’Œ Intranet Web åº”ç”¨ç¨‹åºï¼Œé€‚åº”å„ç§ Web åº”ç”¨ç¨‹åºæœåŠ¡å™¨çš„éœ€è¦ã€‚</p>
</li>
<li><p>WebLogicï¼šWebLogic Server æ˜¯ä¸€æ¬¾å¤šåŠŸèƒ½ã€åŸºäºæ ‡å‡†çš„ Web åº”ç”¨æœåŠ¡å™¨ï¼Œä¸ºä¼ä¸šæ„å»ºä¼ä¸šåº”ç”¨æä¾›äº†åšå®çš„åŸºç¡€ã€‚é’ˆå¯¹å„ç§åº”ç”¨å¼€å‘ã€å…³é”®æ€§ä»»åŠ¡çš„éƒ¨ç½²ï¼Œå„ç§ç³»ç»Ÿå’Œæ•°æ®åº“çš„é›†æˆã€è·¨ Internet åä½œç­‰ Weblogic éƒ½æä¾›äº†ç›¸åº”çš„æ”¯æŒã€‚ç”±äºå®ƒå…·æœ‰å…¨é¢çš„åŠŸèƒ½ã€å¯¹å¼€æ”¾æ ‡å‡†çš„éµä»æ€§ã€å¤šå±‚æ¶æ„ã€æ”¯æŒåŸºäºç»„ä»¶çš„å¼€å‘ç­‰ä¼˜åŠ¿ï¼Œå¾ˆå¤šå…¬å¸çš„ä¼ä¸šçº§åº”ç”¨éƒ½é€‰æ‹©å®ƒæ¥ä½œä¸ºå¼€å‘å’Œéƒ¨ç½²çš„ç¯å¢ƒã€‚WebLogic Server åœ¨ä½¿åº”ç”¨æœåŠ¡å™¨æˆä¸ºä¼ä¸šåº”ç”¨æ¶æ„çš„åŸºç¡€æ–¹é¢ä¸€ç›´å¤„äºé¢†å…ˆåœ°ä½ï¼Œä¸ºæ„å»ºé›†æˆåŒ–çš„ä¼ä¸šçº§åº”ç”¨æä¾›äº†ç¨³å›ºçš„åŸºç¡€ã€‚</p>
</li>
<li><p>Apacheï¼šç›®å‰ Apache ä»ç„¶æ˜¯ä¸–ç•Œä¸Šç”¨å¾—æœ€å¤šçš„ Web æœåŠ¡å™¨ï¼Œå…¶å¸‚åœºå æœ‰ç‡å¾ˆé•¿æ—¶é—´éƒ½ä¿æŒåœ¨ 60% ä»¥ä¸Šï¼ˆç›®å‰çš„å¸‚åœºä»½é¢çº¦ 40% å·¦å³ï¼‰ã€‚ä¸–ç•Œä¸Šå¾ˆå¤šè‘—åçš„ç½‘ç«™éƒ½æ˜¯ Apache çš„äº§ç‰©ï¼Œå®ƒçš„æˆåŠŸä¹‹å¤„ä¸»è¦åœ¨äºå®ƒçš„æºä»£ç å¼€æ”¾ã€æœ‰ä¸€æ”¯å¼ºå¤§çš„å¼€å‘å›¢é˜Ÿã€æ”¯æŒè·¨å¹³å°çš„åº”ç”¨ï¼ˆå¯ä»¥è¿è¡Œåœ¨å‡ ä¹æ‰€æœ‰çš„ Unixã€Windowsã€Linux ç³»ç»Ÿå¹³å°ä¸Šï¼‰ä»¥åŠå®ƒçš„å¯ç§»æ¤æ€§ç­‰æ–¹é¢ã€‚</p>
</li>
<li><p>Tomcatï¼šTomcat æ˜¯ä¸€ä¸ªå¼€æ”¾æºä»£ç ã€è¿è¡Œ Servlet å’Œ JSP çš„å®¹å™¨ã€‚Tomcat å®ç°äº† Servlet å’Œ JSP è§„èŒƒã€‚æ­¤å¤–ï¼ŒTomcat è¿˜å®ç°äº† Apache-Jakarta è§„èŒƒè€Œä¸”æ¯”ç»å¤§å¤šæ•°å•†ä¸šåº”ç”¨è½¯ä»¶æœåŠ¡å™¨è¦å¥½ï¼Œå› æ­¤ç›®å‰ä¹Ÿæœ‰ä¸å°‘çš„ Web æœåŠ¡å™¨éƒ½é€‰æ‹©äº† Tomcatã€‚</p>
</li>
<li><p>Nginxï¼šè¯»ä½œ&quot;engine x&quot;ï¼Œæ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„ HTTP å’Œåå‘ä»£ç†æœåŠ¡å™¨ï¼Œä¹Ÿæ˜¯ä¸€ä¸ª IMAP/POP3/SMTP ä»£ç†æœåŠ¡å™¨ã€‚ Nginx æ˜¯ç”± Igor Sysoev ä¸ºä¿„ç½—æ–¯è®¿é—®é‡ç¬¬äºŒçš„ Rambler ç«™ç‚¹å¼€å‘çš„ï¼Œç¬¬ä¸€ä¸ªå…¬å¼€ç‰ˆæœ¬ 0.1.0 å‘å¸ƒäº 2004 å¹´ 10 æœˆ 4 æ—¥ã€‚å…¶å°†æºä»£ç ä»¥ç±» BSD è®¸å¯è¯çš„å½¢å¼å‘å¸ƒï¼Œå› å®ƒçš„ç¨³å®šæ€§ã€ä¸°å¯Œçš„åŠŸèƒ½é›†ã€ç¤ºä¾‹é…ç½®æ–‡ä»¶å’Œä½ç³»ç»Ÿèµ„æºçš„æ¶ˆè€—è€Œé—»åã€‚åœ¨ 2014 å¹´ä¸‹åŠå¹´ï¼ŒNginx çš„å¸‚åœºä»½é¢è¾¾åˆ°äº† 14%ã€‚</p>
</li>
</ul>
<blockquote>
<p>102ã€JSP å’Œ Servlet æ˜¯ä»€ä¹ˆå…³ç³»ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šå…¶å®è¿™ä¸ªé—®é¢˜åœ¨ä¸Šé¢å·²ç»é˜è¿°è¿‡äº†ï¼ŒServlet æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„ Java ç¨‹åºï¼Œå®ƒè¿è¡ŒäºæœåŠ¡å™¨çš„ JVM ä¸­ï¼Œèƒ½å¤Ÿä¾é æœåŠ¡å™¨çš„æ”¯æŒå‘æµè§ˆå™¨æä¾›æ˜¾ç¤ºå†…å®¹ã€‚JSP æœ¬è´¨ä¸Šæ˜¯ Servlet çš„ä¸€ç§ç®€æ˜“å½¢å¼ï¼ŒJSP ä¼šè¢«æœåŠ¡å™¨å¤„ç†æˆä¸€ä¸ªç±»ä¼¼äº Servlet çš„ Java ç¨‹åºï¼Œå¯ä»¥ç®€åŒ–é¡µé¢å†…å®¹çš„ç”Ÿæˆã€‚Servlet å’Œ JSP æœ€ä¸»è¦çš„ä¸åŒç‚¹åœ¨äºï¼ŒServlet çš„åº”ç”¨é€»è¾‘æ˜¯åœ¨ Java æ–‡ä»¶ä¸­ï¼Œå¹¶ä¸”å®Œå…¨ä»è¡¨ç¤ºå±‚ä¸­çš„ HTML åˆ†ç¦»å¼€æ¥ã€‚è€Œ JSP çš„æƒ…å†µæ˜¯ Java å’Œ HTML å¯ä»¥ç»„åˆæˆä¸€ä¸ªæ‰©å±•åä¸º <code>.jsp</code> çš„æ–‡ä»¶ã€‚æœ‰äººè¯´ï¼ŒServlet å°±æ˜¯åœ¨ Java ä¸­å†™ HTMLï¼Œè€Œ JSP å°±æ˜¯åœ¨ HTML ä¸­å†™ Java ä»£ç ï¼Œå½“ç„¶è¿™ä¸ªè¯´æ³•æ˜¯å¾ˆç‰‡é¢ä¸”ä¸å¤Ÿå‡†ç¡®çš„ã€‚JSP ä¾§é‡äºè§†å›¾ï¼ŒServlet æ›´ä¾§é‡äºæ§åˆ¶é€»è¾‘ï¼Œåœ¨ MVC æ¶æ„æ¨¡å¼ä¸­ï¼ŒJSP é€‚åˆå……å½“è§†å›¾ï¼ˆviewï¼‰è€Œ Servlet é€‚åˆå……å½“æ§åˆ¶å™¨ï¼ˆcontrollerï¼‰ã€‚</p>
<blockquote>
<p>103ã€è®²è§£ JSP ä¸­çš„å››ç§ä½œç”¨åŸŸã€‚</p>
</blockquote>
<p>ç­”ï¼šJSP ä¸­çš„å››ç§ä½œç”¨åŸŸåŒ…æ‹¬ <code>page</code>ã€<code>request</code>ã€<code>session</code> å’Œ <code>application</code>ï¼Œå…·ä½“æ¥è¯´ï¼š</p>
<ul>
<li><code>page</code> ä»£è¡¨ä¸ä¸€ä¸ªé¡µé¢ç›¸å…³çš„å¯¹è±¡å’Œå±æ€§ã€‚</li>
<li><code>request</code> ä»£è¡¨ä¸ Web å®¢æˆ·æœºå‘å‡ºçš„ä¸€ä¸ªè¯·æ±‚ç›¸å…³çš„å¯¹è±¡å’Œå±æ€§ã€‚ä¸€ä¸ªè¯·æ±‚å¯èƒ½è·¨è¶Šå¤šä¸ªé¡µé¢ï¼Œæ¶‰åŠå¤šä¸ª Web ç»„ä»¶ï¼›éœ€è¦åœ¨é¡µé¢æ˜¾ç¤ºçš„ä¸´æ—¶æ•°æ®å¯ä»¥ç½®äºæ­¤ä½œç”¨åŸŸã€‚</li>
<li><code>session</code> ä»£è¡¨ä¸æŸä¸ªç”¨æˆ·ä¸æœåŠ¡å™¨å»ºç«‹çš„ä¸€æ¬¡ä¼šè¯ç›¸å…³çš„å¯¹è±¡å’Œå±æ€§ã€‚è·ŸæŸä¸ªç”¨æˆ·ç›¸å…³çš„æ•°æ®åº”è¯¥æ”¾åœ¨ç”¨æˆ·è‡ªå·±çš„ session ä¸­ã€‚</li>
<li><code>application</code> ä»£è¡¨ä¸æ•´ä¸ª Web åº”ç”¨ç¨‹åºç›¸å…³çš„å¯¹è±¡å’Œå±æ€§ï¼Œå®ƒå®è´¨ä¸Šæ˜¯è·¨è¶Šæ•´ä¸ª Web åº”ç”¨ç¨‹åºï¼ŒåŒ…æ‹¬å¤šä¸ªé¡µé¢ã€è¯·æ±‚å’Œä¼šè¯çš„ä¸€ä¸ªå…¨å±€ä½œç”¨åŸŸã€‚</li>
</ul>
<blockquote>
<p>104ã€å¦‚ä½•å®ç° JSP æˆ– Servlet çš„å•çº¿ç¨‹æ¨¡å¼ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼š</p>
<p>å¯¹äº JSP é¡µé¢ï¼Œå¯ä»¥é€šè¿‡ <code>page</code> æŒ‡ä»¤è¿›è¡Œè®¾ç½®ã€‚</p>
<p><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs jsp">&lt;%<span class="hljs-meta">@page</span> isThreadSafe=â€<span class="hljs-keyword">false</span>â€%&gt;<br></code></pre></td></tr></table></figure>
</p>
<p>å¯¹äº Servletï¼Œå¯ä»¥è®©è‡ªå®šä¹‰çš„ Servlet å®ç° <code>SingleThreadModel</code> æ ‡è¯†æ¥å£ã€‚</p>
<p><strong>è¯´æ˜ï¼š</strong>å¦‚æœå°† JSP æˆ– Servlet è®¾ç½®æˆå•çº¿ç¨‹å·¥ä½œæ¨¡å¼ï¼Œä¼šå¯¼è‡´æ¯ä¸ªè¯·æ±‚åˆ›å»ºä¸€ä¸ª Servlet å®ä¾‹ï¼Œè¿™ç§å®è·µå°†å¯¼è‡´ä¸¥é‡çš„æ€§èƒ½é—®é¢˜ï¼ˆæœåŠ¡å™¨çš„å†…å­˜å‹åŠ›å¾ˆå¤§ï¼Œè¿˜ä¼šå¯¼è‡´é¢‘ç¹çš„åƒåœ¾å›æ”¶ï¼‰ï¼Œæ‰€ä»¥é€šå¸¸æƒ…å†µä¸‹å¹¶ä¸ä¼šè¿™ä¹ˆåšã€‚</p>
<blockquote>
<p>105ã€å®ç°ä¼šè¯è·Ÿè¸ªçš„æŠ€æœ¯æœ‰å“ªäº›ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šç”±äº HTTP åè®®æœ¬èº«æ˜¯æ— çŠ¶æ€çš„ï¼ŒæœåŠ¡å™¨ä¸ºäº†åŒºåˆ†ä¸åŒçš„ç”¨æˆ·ï¼Œå°±éœ€è¦å¯¹ç”¨æˆ·ä¼šè¯è¿›è¡Œè·Ÿè¸ªï¼Œç®€å•çš„è¯´å°±æ˜¯ä¸ºç”¨æˆ·è¿›è¡Œç™»è®°ï¼Œä¸ºç”¨æˆ·åˆ†é…å”¯ä¸€çš„ IDï¼Œä¸‹ä¸€æ¬¡ç”¨æˆ·åœ¨è¯·æ±‚ä¸­åŒ…å«æ­¤ IDï¼ŒæœåŠ¡å™¨æ®æ­¤åˆ¤æ–­åˆ°åº•æ˜¯å“ªä¸€ä¸ªç”¨æˆ·ã€‚</p>
<ol>
<li>URL é‡å†™ï¼šåœ¨ URL ä¸­æ·»åŠ ç”¨æˆ·ä¼šè¯çš„ä¿¡æ¯ä½œä¸ºè¯·æ±‚çš„å‚æ•°ï¼Œæˆ–è€…å°†å”¯ä¸€çš„ä¼šè¯ ID æ·»åŠ åˆ° URL ç»“å°¾ä»¥æ ‡è¯†ä¸€ä¸ªä¼šè¯ã€‚</li>
<li>è®¾ç½®è¡¨å•éšè—åŸŸï¼šå°†å’Œä¼šè¯è·Ÿè¸ªç›¸å…³çš„å­—æ®µæ·»åŠ åˆ°éšå¼è¡¨å•åŸŸä¸­ï¼Œè¿™äº›ä¿¡æ¯ä¸ä¼šåœ¨æµè§ˆå™¨ä¸­æ˜¾ç¤ºä½†æ˜¯æäº¤è¡¨å•æ—¶ä¼šæäº¤ç»™æœåŠ¡å™¨ã€‚
è¿™ä¸¤ç§æ–¹å¼å¾ˆéš¾å¤„ç†è·¨è¶Šå¤šä¸ªé¡µé¢çš„ä¿¡æ¯ä¼ é€’ï¼Œå› ä¸ºå¦‚æœæ¯æ¬¡éƒ½è¦ä¿®æ”¹ URL æˆ–åœ¨é¡µé¢ä¸­æ·»åŠ éšå¼è¡¨å•åŸŸæ¥å­˜å‚¨ç”¨æˆ·ä¼šè¯ç›¸å…³ä¿¡æ¯ï¼Œäº‹æƒ…å°†å˜å¾—éå¸¸éº»çƒ¦ã€‚</li>
<li>cookieï¼šcookie æœ‰ä¸¤ç§ï¼Œä¸€ç§æ˜¯åŸºäºçª—å£çš„ï¼Œæµè§ˆå™¨çª—å£å…³é—­åï¼Œcookie å°±æ²¡æœ‰äº†ï¼›å¦ä¸€ç§æ˜¯å°†ä¿¡æ¯å­˜å‚¨åœ¨ä¸€ä¸ªä¸´æ—¶æ–‡ä»¶ä¸­ï¼Œå¹¶è®¾ç½®å­˜åœ¨çš„æ—¶é—´ã€‚å½“ç”¨æˆ·é€šè¿‡æµè§ˆå™¨å’ŒæœåŠ¡å™¨å»ºç«‹ä¸€æ¬¡ä¼šè¯åï¼Œä¼šè¯ ID å°±ä¼šéšå“åº”ä¿¡æ¯è¿”å›å­˜å‚¨åœ¨åŸºäºçª—å£çš„ cookie ä¸­ï¼Œé‚£å°±æ„å‘³ç€åªè¦æµè§ˆå™¨æ²¡æœ‰å…³é—­ï¼Œä¼šè¯æ²¡æœ‰è¶…æ—¶ï¼Œä¸‹ä¸€æ¬¡è¯·æ±‚æ—¶è¿™ä¸ªä¼šè¯ ID åˆä¼šæäº¤ç»™æœåŠ¡å™¨è®©æœåŠ¡å™¨è¯†åˆ«ç”¨æˆ·èº«ä»½ã€‚ä¼šè¯ä¸­å¯ä»¥ä¸ºç”¨æˆ·ä¿å­˜ä¿¡æ¯ã€‚ä¼šè¯å¯¹è±¡æ˜¯åœ¨æœåŠ¡å™¨å†…å­˜ä¸­çš„ï¼Œè€ŒåŸºäºçª—å£çš„ cookie æ˜¯åœ¨å®¢æˆ·ç«¯å†…å­˜ä¸­çš„ã€‚å¦‚æœæµè§ˆå™¨ç¦ç”¨äº† cookieï¼Œé‚£ä¹ˆå°±éœ€è¦é€šè¿‡ä¸‹é¢ä¸¤ç§æ–¹å¼è¿›è¡Œä¼šè¯è·Ÿè¸ªã€‚å½“ç„¶ï¼Œåœ¨ä½¿ç”¨ cookie æ—¶è¦æ³¨æ„å‡ ç‚¹ï¼šé¦–å…ˆä¸è¦åœ¨ cookie ä¸­å­˜æ”¾æ•æ„Ÿä¿¡æ¯ï¼›å…¶æ¬¡ cookie å­˜å‚¨çš„æ•°æ®é‡æœ‰é™ï¼ˆ4kï¼‰ï¼Œä¸èƒ½å°†è¿‡å¤šçš„å†…å®¹å­˜å‚¨ cookie ä¸­ï¼›å†è€…æµè§ˆå™¨é€šå¸¸åªå…è®¸ä¸€ä¸ªç«™ç‚¹æœ€å¤šå­˜æ”¾ 20 ä¸ª cookieã€‚å½“ç„¶ï¼Œå’Œç”¨æˆ·ä¼šè¯ç›¸å…³çš„å…¶ä»–ä¿¡æ¯ï¼ˆé™¤äº†ä¼šè¯ IDï¼‰ä¹Ÿå¯ä»¥å­˜åœ¨ cookie æ–¹ä¾¿è¿›è¡Œä¼šè¯è·Ÿè¸ªã€‚</li>
<li>HttpSessionï¼šåœ¨æ‰€æœ‰ä¼šè¯è·Ÿè¸ªæŠ€æœ¯ä¸­ï¼ŒHttpSession å¯¹è±¡æ˜¯æœ€å¼ºå¤§ä¹Ÿæ˜¯åŠŸèƒ½æœ€å¤šçš„ã€‚å½“ä¸€ä¸ªç”¨æˆ·ç¬¬ä¸€æ¬¡è®¿é—®æŸä¸ªç½‘ç«™æ—¶ä¼šè‡ªåŠ¨åˆ›å»º HttpSessionï¼Œæ¯ä¸ªç”¨æˆ·å¯ä»¥è®¿é—®ä»–è‡ªå·±çš„ HttpSessionã€‚å¯ä»¥é€šè¿‡ <code>HttpServletRequest</code> å¯¹è±¡çš„ <code>getSession</code> æ–¹æ³•è·å¾— HttpSessionï¼Œé€šè¿‡ HttpSession çš„ <code>setAttribute</code> æ–¹æ³•å¯ä»¥å°†ä¸€ä¸ªå€¼æ”¾åœ¨ HttpSession ä¸­ï¼Œé€šè¿‡è°ƒç”¨ HttpSession å¯¹è±¡çš„ <code>getAttribute</code> æ–¹æ³•ï¼ŒåŒæ—¶ä¼ å…¥å±æ€§åå°±å¯ä»¥è·å–ä¿å­˜åœ¨ HttpSession ä¸­çš„å¯¹è±¡ã€‚ä¸ä¸Šé¢ä¸‰ç§æ–¹å¼ä¸åŒçš„æ˜¯ï¼ŒHttpSession æ”¾åœ¨æœåŠ¡å™¨çš„å†…å­˜ä¸­ï¼Œå› æ­¤ä¸è¦å°†è¿‡å¤§çš„å¯¹è±¡æ”¾åœ¨é‡Œé¢ï¼Œå³ä½¿ç›®å‰çš„ Servlet å®¹å™¨å¯ä»¥åœ¨å†…å­˜å°†æ»¡æ—¶å°† HttpSession ä¸­çš„å¯¹è±¡ç§»åˆ°å…¶ä»–å­˜å‚¨è®¾å¤‡ä¸­ï¼Œä½†æ˜¯è¿™æ ·åŠ¿å¿…å½±å“æ€§èƒ½ã€‚æ·»åŠ åˆ° HttpSession ä¸­çš„å€¼å¯ä»¥æ˜¯ä»»æ„ Java å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡æœ€å¥½å®ç°äº† <code>Serializable</code> æ¥å£ï¼Œè¿™æ · Servlet å®¹å™¨åœ¨å¿…è¦çš„æ—¶å€™å¯ä»¥å°†å…¶åºåˆ—åŒ–åˆ°æ–‡ä»¶ä¸­ï¼Œå¦åˆ™åœ¨åºåˆ—åŒ–æ—¶å°±ä¼šå‡ºç°å¼‚å¸¸ã€‚</li>
</ol>
<p><strong>è¡¥å……ï¼š</strong>HTML5 ä¸­å¯ä»¥ä½¿ç”¨ Web Storage æŠ€æœ¯é€šè¿‡ JavaScript æ¥ä¿å­˜æ•°æ®ï¼Œä¾‹å¦‚å¯ä»¥ä½¿ç”¨ <code>localStorage</code> å’Œ <code>sessionStorage</code> æ¥ä¿å­˜ç”¨æˆ·ä¼šè¯çš„ä¿¡æ¯ï¼Œä¹Ÿèƒ½å¤Ÿå®ç°ä¼šè¯è·Ÿè¸ªã€‚</p>
<blockquote>
<p>106ã€è¿‡æ»¤å™¨æœ‰å“ªäº›ä½œç”¨å’Œç”¨æ³•ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šJava Web å¼€å‘ä¸­çš„è¿‡æ»¤å™¨ï¼ˆfilterï¼‰æ˜¯ä» Servlet 2.3 è§„èŒƒå¼€å§‹å¢åŠ çš„åŠŸèƒ½ï¼Œå¹¶åœ¨ Servlet 2.4 è§„èŒƒä¸­å¾—åˆ°å¢å¼ºã€‚å¯¹ Web åº”ç”¨æ¥è¯´ï¼Œè¿‡æ»¤å™¨æ˜¯ä¸€ä¸ªé©»ç•™åœ¨æœåŠ¡å™¨ç«¯çš„ Web ç»„ä»¶ï¼Œå®ƒå¯ä»¥æˆªå–å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´çš„è¯·æ±‚ä¸å“åº”ä¿¡æ¯ï¼Œå¹¶å¯¹è¿™äº›ä¿¡æ¯è¿›è¡Œè¿‡æ»¤ã€‚å½“ Web å®¹å™¨æ¥å—åˆ°ä¸€ä¸ªå¯¹èµ„æºçš„è¯·æ±‚æ—¶ï¼Œå®ƒå°†åˆ¤æ–­æ˜¯å¦æœ‰è¿‡æ»¤å™¨ä¸è¿™ä¸ªèµ„æºç›¸å…³è”ã€‚å¦‚æœæœ‰ï¼Œé‚£ä¹ˆå®¹å™¨å°†æŠŠè¯·æ±‚äº¤ç»™è¿‡æ»¤å™¨è¿›è¡Œå¤„ç†ã€‚åœ¨è¿‡æ»¤å™¨ä¸­ï¼Œä½ å¯ä»¥æ”¹å˜è¯·æ±‚çš„å†…å®¹ï¼Œæˆ–è€…é‡æ–°è®¾ç½®è¯·æ±‚çš„æŠ¥å¤´ä¿¡æ¯ï¼Œç„¶åå†å°†è¯·æ±‚å‘é€ç»™ç›®æ ‡èµ„æºã€‚å½“ç›®æ ‡èµ„æºå¯¹è¯·æ±‚ä½œå‡ºå“åº”æ—¶å€™ï¼Œå®¹å™¨åŒæ ·ä¼šå°†å“åº”å…ˆè½¬å‘ç»™è¿‡æ»¤å™¨ï¼Œåœ¨è¿‡æ»¤å™¨ä¸­ä½ å¯ä»¥å¯¹å“åº”çš„å†…å®¹è¿›è¡Œè½¬æ¢ï¼Œç„¶åå†å°†å“åº”å‘é€åˆ°å®¢æˆ·ç«¯ã€‚</p>
<p>å¸¸è§çš„è¿‡æ»¤å™¨ç”¨é€”ä¸»è¦åŒ…æ‹¬ï¼šå¯¹ç”¨æˆ·è¯·æ±‚è¿›è¡Œç»Ÿä¸€è®¤è¯ã€å¯¹ç”¨æˆ·çš„è®¿é—®è¯·æ±‚è¿›è¡Œè®°å½•å’Œå®¡æ ¸ã€å¯¹ç”¨æˆ·å‘é€çš„æ•°æ®è¿›è¡Œè¿‡æ»¤æˆ–æ›¿æ¢ã€è½¬æ¢å›¾è±¡æ ¼å¼ã€å¯¹å“åº”å†…å®¹è¿›è¡Œå‹ç¼©ä»¥å‡å°‘ä¼ è¾“é‡ã€å¯¹è¯·æ±‚æˆ–å“åº”è¿›è¡ŒåŠ è§£å¯†å¤„ç†ã€è§¦å‘èµ„æºè®¿é—®äº‹ä»¶ã€å¯¹ XML çš„è¾“å‡ºåº”ç”¨ XSLT ç­‰ã€‚</p>
<p>å’Œè¿‡æ»¤å™¨ç›¸å…³çš„æ¥å£ä¸»è¦æœ‰ï¼š<code>Filter</code>ã€<code>FilterConfig</code> å’Œ <code>FilterChain</code>ã€‚</p>
<p>ç¼–ç è¿‡æ»¤å™¨çš„ä¾‹å­ï¼š</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.io.IOException;<br><br><span class="hljs-keyword">import</span> javax.servlet.Filter;<br><span class="hljs-keyword">import</span> javax.servlet.FilterChain;<br><span class="hljs-keyword">import</span> javax.servlet.FilterConfig;<br><span class="hljs-keyword">import</span> javax.servlet.ServletException;<br><span class="hljs-keyword">import</span> javax.servlet.ServletRequest;<br><span class="hljs-keyword">import</span> javax.servlet.ServletResponse;<br><span class="hljs-keyword">import</span> javax.servlet.annotation.WebFilter;<br><span class="hljs-keyword">import</span> javax.servlet.annotation.WebInitParam;<br><br><span class="hljs-meta">@WebFilter(urlPatterns = &#123; &quot;*&quot; &#125;, initParams = &#123;@WebInitParam(name=&quot;encoding&quot;, value=&quot;utf-8&quot;)&#125;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CodingFilter</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Filter</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> String defaultEncoding = <span class="hljs-string">&quot;utf-8&quot;</span>;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">destroy</span><span class="hljs-params">()</span> </span>&#123;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doFilter</span><span class="hljs-params">(ServletRequest req, ServletResponse resp,</span></span><br><span class="hljs-function"><span class="hljs-params">            FilterChain chain)</span> <span class="hljs-keyword">throws</span> IOException, ServletException </span>&#123;<br>        req.setCharacterEncoding(defaultEncoding);<br>        resp.setCharacterEncoding(defaultEncoding);<br>        chain.doFilter(req, resp);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">init</span><span class="hljs-params">(FilterConfig config)</span> <span class="hljs-keyword">throws</span> ServletException </span>&#123;<br>        String encoding = config.getInitParameter(<span class="hljs-string">&quot;encoding&quot;</span>);<br>        <span class="hljs-keyword">if</span> (encoding != <span class="hljs-keyword">null</span>) &#123;<br>            defaultEncoding = encoding;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<p>ä¸‹è½½è®¡æ•°è¿‡æ»¤å™¨çš„ä¾‹å­ï¼š</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.io.File;<br><span class="hljs-keyword">import</span> java.io.FileReader;<br><span class="hljs-keyword">import</span> java.io.FileWriter;<br><span class="hljs-keyword">import</span> java.io.IOException;<br><span class="hljs-keyword">import</span> java.util.Properties;<br><span class="hljs-keyword">import</span> java.util.concurrent.ExecutorService;<br><span class="hljs-keyword">import</span> java.util.concurrent.Executors;<br><br><span class="hljs-keyword">import</span> javax.servlet.Filter;<br><span class="hljs-keyword">import</span> javax.servlet.FilterChain;<br><span class="hljs-keyword">import</span> javax.servlet.FilterConfig;<br><span class="hljs-keyword">import</span> javax.servlet.ServletException;<br><span class="hljs-keyword">import</span> javax.servlet.ServletRequest;<br><span class="hljs-keyword">import</span> javax.servlet.ServletResponse;<br><span class="hljs-keyword">import</span> javax.servlet.annotation.WebFilter;<br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServletRequest;<br><br><span class="hljs-meta">@WebFilter(urlPatterns = &#123;&quot;/*&quot;&#125;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DownloadCounterFilter</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Filter</span> </span>&#123;<br><br>    <span class="hljs-keyword">private</span> ExecutorService executorService = Executors.newSingleThreadExecutor();<br>    <span class="hljs-keyword">private</span> Properties downloadLog;<br>    <span class="hljs-keyword">private</span> File logFile;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">destroy</span><span class="hljs-params">()</span> </span>&#123;<br>        executorService.shutdown();<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doFilter</span><span class="hljs-params">(ServletRequest req, ServletResponse resp,</span></span><br><span class="hljs-function"><span class="hljs-params">            FilterChain chain)</span> <span class="hljs-keyword">throws</span> IOException, ServletException </span>&#123;<br>        HttpServletRequest request = (HttpServletRequest) req;<br>        <span class="hljs-keyword">final</span> String uri = request.getRequestURI();<br>        executorService.execute(<span class="hljs-keyword">new</span> Runnable() &#123;<br><br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">run</span><span class="hljs-params">()</span> </span>&#123;<br>                String value = downloadLog.getProperty(uri);<br>                <span class="hljs-keyword">if</span>(value == <span class="hljs-keyword">null</span>) &#123;<br>                    downloadLog.setProperty(uri, <span class="hljs-string">&quot;1&quot;</span>);<br>                &#125;<br>                <span class="hljs-keyword">else</span> &#123;<br>                    <span class="hljs-keyword">int</span> count = Integer.parseInt(value);<br>                    downloadLog.setProperty(uri, String.valueOf(++count));<br>                &#125;<br>                <span class="hljs-keyword">try</span> &#123;<br>                    downloadLog.store(<span class="hljs-keyword">new</span> FileWriter(logFile), <span class="hljs-string">&quot;&quot;</span>);<br>                &#125; <br>                <span class="hljs-keyword">catch</span> (IOException e) &#123;<br>                    e.printStackTrace();<br>                &#125;<br>            &#125;<br>        &#125;);<br>        chain.doFilter(req, resp);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">init</span><span class="hljs-params">(FilterConfig config)</span> <span class="hljs-keyword">throws</span> ServletException </span>&#123;<br>        String appPath = config.getServletContext().getRealPath(<span class="hljs-string">&quot;/&quot;</span>);<br>        logFile = <span class="hljs-keyword">new</span> File(appPath, <span class="hljs-string">&quot;downloadLog.txt&quot;</span>);<br>        <span class="hljs-keyword">if</span>(!logFile.exists()) &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                logFile.createNewFile();<br>            &#125; <br>            <span class="hljs-keyword">catch</span>(IOException e) &#123;<br>                e.printStackTrace();<br>            &#125;<br>        &#125;<br>        downloadLog = <span class="hljs-keyword">new</span> Properties();<br>        <span class="hljs-keyword">try</span> &#123;<br>            downloadLog.load(<span class="hljs-keyword">new</span> FileReader(logFile));<br>        &#125; <span class="hljs-keyword">catch</span> (IOException e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<p><strong>è¯´æ˜ï¼š</strong>è¿™é‡Œä½¿ç”¨äº† Servlet 3 è§„èŒƒä¸­çš„æ³¨è§£æ¥éƒ¨ç½²è¿‡æ»¤å™¨ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥åœ¨ web.xml ä¸­ä½¿ç”¨ <code>&lt;filter&gt;</code> å’Œ <code>&lt;filter-mapping&gt;</code> æ ‡ç­¾éƒ¨ç½²è¿‡æ»¤å™¨ï¼Œå¦‚ 108 é¢˜ä¸­æ‰€ç¤ºã€‚</p>
<blockquote>
<p>107ã€ç›‘å¬å™¨æœ‰å“ªäº›ä½œç”¨å’Œç”¨æ³•ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šJava Web å¼€å‘ä¸­çš„ç›‘å¬å™¨ï¼ˆlistenerï¼‰å°±æ˜¯ <code>application</code>ã€<code>session</code>ã€<code>request</code> ä¸‰ä¸ªå¯¹è±¡åˆ›å»ºã€é”€æ¯æˆ–è€…å¾€å…¶ä¸­æ·»åŠ ä¿®æ”¹åˆ é™¤å±æ€§æ—¶è‡ªåŠ¨æ‰§è¡Œä»£ç çš„åŠŸèƒ½ç»„ä»¶ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<ol>
<li><code>ServletContextListener</code>ï¼šå¯¹ Servlet ä¸Šä¸‹æ–‡çš„åˆ›å»ºå’Œé”€æ¯è¿›è¡Œç›‘å¬ã€‚</li>
<li><code>ServletContextAttributeListener</code>ï¼šç›‘å¬ Servlet ä¸Šä¸‹æ–‡å±æ€§çš„æ·»åŠ ã€åˆ é™¤å’Œæ›¿æ¢ã€‚</li>
<li><code>HttpSessionListener</code>ï¼šå¯¹ Session çš„åˆ›å»ºå’Œé”€æ¯è¿›è¡Œç›‘å¬ã€‚</li>
<li><code>HttpSessionAttributeListener</code>ï¼šå¯¹ Session å¯¹è±¡ä¸­å±æ€§çš„æ·»åŠ ã€åˆ é™¤å’Œæ›¿æ¢è¿›è¡Œç›‘å¬ã€‚</li>
<li><code>ServletRequestListener</code>ï¼šå¯¹è¯·æ±‚å¯¹è±¡çš„åˆå§‹åŒ–å’Œé”€æ¯è¿›è¡Œç›‘å¬ã€‚</li>
<li><code>ServletRequestAttributeListener</code>ï¼šå¯¹è¯·æ±‚å¯¹è±¡å±æ€§çš„æ·»åŠ ã€åˆ é™¤å’Œæ›¿æ¢è¿›è¡Œç›‘å¬ã€‚</li>
</ol>
<p><strong>è¡¥å……ï¼š</strong>session çš„é”€æ¯æœ‰ä¸¤ç§æƒ…å†µï¼š(1)session è¶…æ—¶ï¼ˆå¯ä»¥åœ¨ web.xml ä¸­é€šè¿‡ <code>&lt;session-config&gt;/&lt;session-timeout&gt;</code> æ ‡ç­¾é…ç½®è¶…æ—¶æ—¶é—´ï¼‰ï¼›(2)é€šè¿‡è°ƒç”¨ session å¯¹è±¡çš„ <code>invalidate()</code> æ–¹æ³•ä½¿ session å¤±æ•ˆã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªç»Ÿè®¡ç½‘ç«™æœ€å¤šåœ¨çº¿äººæ•°ç›‘å¬å™¨çš„ä¾‹å­ã€‚</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> javax.servlet.ServletContextEvent;<br><span class="hljs-keyword">import</span> javax.servlet.ServletContextListener;<br><span class="hljs-keyword">import</span> javax.servlet.annotation.WebListener;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> ä¸Šä¸‹æ–‡ç›‘å¬å™¨ï¼Œåœ¨æœåŠ¡å™¨å¯åŠ¨æ—¶åˆå§‹åŒ–onLineCountå’ŒmaxOnLineCountä¸¤ä¸ªå˜é‡</span><br><span class="hljs-comment"> å¹¶å°†å…¶ç½®äºæœåŠ¡å™¨ä¸Šä¸‹æ–‡ï¼ˆServletContextï¼‰ä¸­ï¼Œå…¶åˆå§‹å€¼éƒ½æ˜¯0</span><br><span class="hljs-comment">*/</span><br><span class="hljs-meta">@WebListener</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">InitListener</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">ServletContextListener</span> </span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">contextDestroyed</span><span class="hljs-params">(ServletContextEvent evt)</span> </span>&#123;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">contextInitialized</span><span class="hljs-params">(ServletContextEvent evt)</span> </span>&#123;<br>        evt.getServletContext().setAttribute(<span class="hljs-string">&quot;onLineCount&quot;</span>, <span class="hljs-number">0</span>);<br>        evt.getServletContext().setAttribute(<span class="hljs-string">&quot;maxOnLineCount&quot;</span>, <span class="hljs-number">0</span>);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.text.DateFormat;<br><span class="hljs-keyword">import</span> java.text.SimpleDateFormat;<br><span class="hljs-keyword">import</span> java.util.Date;<br><br><span class="hljs-keyword">import</span> javax.servlet.ServletContext;<br><span class="hljs-keyword">import</span> javax.servlet.annotation.WebListener;<br><span class="hljs-keyword">import</span> javax.servlet.http.HttpSessionEvent;<br><span class="hljs-keyword">import</span> javax.servlet.http.HttpSessionListener;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> ä¼šè¯ç›‘å¬å™¨ï¼Œåœ¨ç”¨æˆ·ä¼šè¯åˆ›å»ºå’Œé”€æ¯çš„æ—¶å€™æ ¹æ®æƒ…å†µ</span><br><span class="hljs-comment"> ä¿®æ”¹onLineCountå’ŒmaxOnLineCountçš„å€¼</span><br><span class="hljs-comment">*/</span><br><span class="hljs-meta">@WebListener</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MaxCountListener</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">HttpSessionListener</span> </span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">sessionCreated</span><span class="hljs-params">(HttpSessionEvent event)</span> </span>&#123;<br>        ServletContext ctx = event.getSession().getServletContext();<br>        <span class="hljs-keyword">int</span> count = Integer.parseInt(ctx.getAttribute(<span class="hljs-string">&quot;onLineCount&quot;</span>).toString());<br>        count++;<br>        ctx.setAttribute(<span class="hljs-string">&quot;onLineCount&quot;</span>, count);<br>        <span class="hljs-keyword">int</span> maxOnLineCount = Integer.parseInt(ctx.getAttribute(<span class="hljs-string">&quot;maxOnLineCount&quot;</span>).toString());<br>        <span class="hljs-keyword">if</span> (count &gt; maxOnLineCount) &#123;<br>            ctx.setAttribute(<span class="hljs-string">&quot;maxOnLineCount&quot;</span>, count);<br>            DateFormat df = <span class="hljs-keyword">new</span> SimpleDateFormat(<span class="hljs-string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>);<br>            ctx.setAttribute(<span class="hljs-string">&quot;date&quot;</span>, df.format(<span class="hljs-keyword">new</span> Date()));<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">sessionDestroyed</span><span class="hljs-params">(HttpSessionEvent event)</span> </span>&#123;<br>        ServletContext app = event.getSession().getServletContext();<br>        <span class="hljs-keyword">int</span> count = Integer.parseInt(app.getAttribute(<span class="hljs-string">&quot;onLineCount&quot;</span>).toString());<br>        count--;<br>        app.setAttribute(<span class="hljs-string">&quot;onLineCount&quot;</span>, count);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<p><strong>è¯´æ˜ï¼š</strong>è¿™é‡Œä½¿ç”¨äº† Servlet 3 è§„èŒƒä¸­çš„ @WebListener æ³¨è§£é…ç½®ç›‘å¬å™¨ï¼Œå½“ç„¶ä½ å¯ä»¥åœ¨ web.xml æ–‡ä»¶ä¸­ç”¨ <code>&lt;listener&gt;</code> æ ‡ç­¾é…ç½®ç›‘å¬å™¨ï¼Œå¦‚ 108 é¢˜ä¸­æ‰€ç¤ºã€‚</p>
<blockquote>
<p>108ã€web.xml æ–‡ä»¶ä¸­å¯ä»¥é…ç½®å“ªäº›å†…å®¹ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šweb.xml ç”¨äºé…ç½® Web åº”ç”¨çš„ç›¸å…³ä¿¡æ¯ï¼Œå¦‚ï¼šç›‘å¬å™¨ï¼ˆlistenerï¼‰ã€è¿‡æ»¤å™¨ï¼ˆfilterï¼‰ã€Servletã€ç›¸å…³å‚æ•°ã€ä¼šè¯è¶…æ—¶æ—¶é—´ã€å®‰å…¨éªŒè¯æ–¹å¼ã€é”™è¯¯é¡µé¢ç­‰ï¼Œä¸‹é¢æ˜¯ä¸€äº›å¼€å‘ä¸­å¸¸è§çš„é…ç½®ï¼š</p>
<ol>
<li>é…ç½®Springä¸Šä¸‹æ–‡åŠ è½½ç›‘å¬å™¨åŠ è½½Springé…ç½®æ–‡ä»¶å¹¶åˆ›å»ºIoCå®¹å™¨ï¼š</li>
</ol>
<p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">context-param</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">param-name</span>&gt;</span>contextConfigLocation<span class="hljs-tag">&lt;/<span class="hljs-name">param-name</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">param-value</span>&gt;</span>classpath:applicationContext.xml<span class="hljs-tag">&lt;/<span class="hljs-name">param-value</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">context-param</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">listener</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">listener-class</span>&gt;</span><br>     org.springframework.web.context.ContextLoaderListener<br>   <span class="hljs-tag">&lt;/<span class="hljs-name">listener-class</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">listener</span>&gt;</span><br></code></pre></td></tr></table></figure>
</p>
<ol>
<li>é…ç½®Springçš„OpenSessionInViewè¿‡æ»¤å™¨æ¥è§£å†³å»¶è¿ŸåŠ è½½å’ŒHibernateä¼šè¯å…³é—­çš„çŸ›ç›¾ï¼š</li>
</ol>
<p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">filter</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">filter-name</span>&gt;</span>openSessionInView<span class="hljs-tag">&lt;/<span class="hljs-name">filter-name</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">filter-class</span>&gt;</span><br>       org.springframework.orm.hibernate3.support.OpenSessionInViewFilter<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">filter-class</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">filter</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">filter-mapping</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">filter-name</span>&gt;</span>openSessionInView<span class="hljs-tag">&lt;/<span class="hljs-name">filter-name</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">url-pattern</span>&gt;</span>/*<span class="hljs-tag">&lt;/<span class="hljs-name">url-pattern</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">filter-mapping</span>&gt;</span><br></code></pre></td></tr></table></figure>
</p>
<ol>
<li>é…ç½®ä¼šè¯è¶…æ—¶æ—¶é—´ä¸º10åˆ†é’Ÿï¼š</li>
</ol>
<p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">session-config</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">session-timeout</span>&gt;</span>10<span class="hljs-tag">&lt;/<span class="hljs-name">session-timeout</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">session-config</span>&gt;</span><br></code></pre></td></tr></table></figure>
</p>
<ol>
<li>é…ç½®404å’ŒExceptionçš„é”™è¯¯é¡µé¢ï¼š</li>
</ol>
<p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">error-page</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">error-code</span>&gt;</span>404<span class="hljs-tag">&lt;/<span class="hljs-name">error-code</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">location</span>&gt;</span>/error.jsp<span class="hljs-tag">&lt;/<span class="hljs-name">location</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">error-page</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">error-page</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">exception-type</span>&gt;</span>java.lang.Exception<span class="hljs-tag">&lt;/<span class="hljs-name">exception-type</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">location</span>&gt;</span>/error.jsp<span class="hljs-tag">&lt;/<span class="hljs-name">location</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">error-page</span>&gt;</span><br></code></pre></td></tr></table></figure>
</p>
<ol>
<li>é…ç½®å®‰å…¨è®¤è¯æ–¹å¼ï¼š</li>
</ol>
<p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">security-constraint</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">web-resource-collection</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">web-resource-name</span>&gt;</span>ProtectedArea<span class="hljs-tag">&lt;/<span class="hljs-name">web-resource-name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">url-pattern</span>&gt;</span>/admin/*<span class="hljs-tag">&lt;/<span class="hljs-name">url-pattern</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">http-method</span>&gt;</span>GET<span class="hljs-tag">&lt;/<span class="hljs-name">http-method</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">http-method</span>&gt;</span>POST<span class="hljs-tag">&lt;/<span class="hljs-name">http-method</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">web-resource-collection</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">auth-constraint</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">role-name</span>&gt;</span>admin<span class="hljs-tag">&lt;/<span class="hljs-name">role-name</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">auth-constraint</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">security-constraint</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">login-config</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">auth-method</span>&gt;</span>BASIC<span class="hljs-tag">&lt;/<span class="hljs-name">auth-method</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">login-config</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">security-role</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">role-name</span>&gt;</span>admin<span class="hljs-tag">&lt;/<span class="hljs-name">role-name</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">security-role</span>&gt;</span><br></code></pre></td></tr></table></figure>
</p>
<p><strong>è¯´æ˜ï¼š</strong>å¯¹ Servletï¼ˆå°æœåŠ¡ï¼‰ã€Listenerï¼ˆç›‘å¬å™¨ï¼‰å’Œ Filterï¼ˆè¿‡æ»¤å™¨ï¼‰ç­‰ Web ç»„ä»¶çš„é…ç½®ï¼ŒServlet 3 è§„èŒƒæä¾›äº†åŸºäºæ³¨è§£çš„é…ç½®æ–¹å¼ï¼Œå¯ä»¥åˆ†åˆ«ä½¿ç”¨ <code>@WebServlet</code>ã€<code>@WebListener</code>ã€<code>@WebFilter</code> æ³¨è§£è¿›è¡Œé…ç½®ã€‚</p>
<p><strong>è¡¥å……ï¼š</strong>å¦‚æœ Web æä¾›äº†æœ‰ä»·å€¼çš„å•†ä¸šä¿¡æ¯æˆ–è€…æ˜¯æ•æ„Ÿæ•°æ®ï¼Œé‚£ä¹ˆç«™ç‚¹çš„å®‰å…¨æ€§å°±æ˜¯å¿…é¡»è€ƒè™‘çš„é—®é¢˜ã€‚å®‰å…¨è®¤è¯æ˜¯å®ç°å®‰å…¨æ€§çš„é‡è¦æ‰‹æ®µï¼Œè®¤è¯å°±æ˜¯è¦è§£å†³â€œAre you who you say you are?â€çš„é—®é¢˜ã€‚è®¤è¯çš„æ–¹å¼éå¸¸å¤šï¼Œç®€å•è¯´æ¥å¯ä»¥åˆ†ä¸ºä¸‰ç±»ï¼š</p>
<ul>
<li>A. What you know? â€” å£ä»¤</li>
<li>B. What you have? â€” æ•°å­—è¯ä¹¦ï¼ˆUç›¾ã€å¯†ä¿å¡ï¼‰</li>
<li>C. Who you are? â€” æŒ‡çº¹è¯†åˆ«ã€è™¹è†œè¯†åˆ«</li>
</ul>
<p>åœ¨ Tomcat ä¸­å¯ä»¥é€šè¿‡å»ºç«‹å®‰å…¨å¥—æ¥å­—å±‚ï¼ˆSecure Socket Layer, SSLï¼‰ä»¥åŠé€šè¿‡åŸºæœ¬éªŒè¯æˆ–è¡¨å•éªŒè¯æ¥å®ç°å¯¹å®‰å…¨æ€§çš„æ”¯æŒã€‚</p>
<blockquote>
<p>109ã€ä½ çš„é¡¹ç›®ä¸­ä½¿ç”¨è¿‡å“ªäº› JSTL æ ‡ç­¾ï¼ˆJSP æ ‡å‡†æ ‡ç­¾åº“ï¼‰ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šé¡¹ç›®ä¸­ä¸»è¦ä½¿ç”¨äº† JSTL çš„æ ¸å¿ƒæ ‡ç­¾åº“ï¼ŒåŒ…æ‹¬ <code>&lt;c:if&gt;</code>ã€<code>&lt;c:choose&gt;</code>ã€<code>&lt;c: when&gt;</code>ã€<code>&lt;c: otherwise&gt;</code>ã€<code>&lt;c:forEach&gt;</code> ç­‰ï¼Œä¸»è¦ç”¨äºæ„é€ å¾ªç¯å’Œåˆ†æ”¯ç»“æ„ä»¥æ§åˆ¶æ˜¾ç¤ºé€»è¾‘ã€‚</p>
<p><strong>è¯´æ˜ï¼š</strong>è™½ç„¶ JSTL æ ‡ç­¾åº“æä¾›äº† <code>core</code>ã€<code>sql</code>ã€<code>fmt</code>ã€<code>xml</code> ç­‰æ ‡ç­¾åº“ï¼Œä½†æ˜¯å®é™…å¼€å‘ä¸­å»ºè®®åªä½¿ç”¨æ ¸å¿ƒæ ‡ç­¾åº“ï¼ˆ<code>core</code>ï¼‰ï¼Œè€Œä¸”æœ€å¥½åªä½¿ç”¨åˆ†æ”¯å’Œå¾ªç¯æ ‡ç­¾å¹¶è¾…ä»¥è¡¨è¾¾å¼è¯­è¨€ï¼ˆELï¼‰ï¼Œè¿™æ ·æ‰èƒ½çœŸæ­£åšåˆ°æ•°æ®æ˜¾ç¤ºå’Œä¸šåŠ¡é€»è¾‘çš„åˆ†ç¦»ï¼Œè¿™æ‰æ˜¯æœ€ä½³å®è·µã€‚</p>
<blockquote>
<p>110ã€ä½¿ç”¨æ ‡ç­¾åº“æœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿå¦‚ä½•è‡ªå®šä¹‰ JSP æ ‡ç­¾ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šä½¿ç”¨æ ‡ç­¾åº“çš„å¥½å¤„åŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š</p>
<ul>
<li>åˆ†ç¦» JSP é¡µé¢çš„å†…å®¹å’Œé€»è¾‘ï¼Œç®€åŒ–äº† Web å¼€å‘ï¼›</li>
<li>å¼€å‘è€…å¯ä»¥åˆ›å»ºè‡ªå®šä¹‰æ ‡ç­¾æ¥å°è£…ä¸šåŠ¡é€»è¾‘å’Œæ˜¾ç¤ºé€»è¾‘ï¼›</li>
<li>æ ‡ç­¾å…·æœ‰å¾ˆå¥½çš„å¯ç§»æ¤æ€§ã€å¯ç»´æŠ¤æ€§å’Œå¯é‡ç”¨æ€§ï¼›</li>
<li>é¿å…äº†å¯¹ Scriptletï¼ˆå°è„šæœ¬ï¼‰çš„ä½¿ç”¨ï¼ˆå¾ˆå¤šå…¬å¸çš„é¡¹ç›®å¼€å‘éƒ½ä¸å…è®¸åœ¨ JSP ä¸­ä¹¦å†™å°è„šæœ¬ï¼‰ã€‚</li>
</ul>
<p>è‡ªå®šä¹‰ JSP æ ‡ç­¾åŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š</p>
<ol>
<li>ç¼–å†™ä¸€ä¸ª Java ç±»å®ç°å®ç° <code>Tag</code>/<code>BodyTag</code>/<code>IterationTag</code> æ¥å£ï¼ˆå¼€å‘ä¸­é€šå¸¸ä¸ç›´æ¥å®ç°è¿™äº›æ¥å£è€Œæ˜¯ç»§æ‰¿ <code>TagSupport</code>/<code>BodyTagSupport</code>/<code>SimpleTagSupport</code> ç±»ï¼Œè¿™æ˜¯å¯¹ç¼ºçœé€‚é…æ¨¡å¼çš„åº”ç”¨ï¼‰ï¼Œé‡å†™ <code>doStartTag()</code>ã€<code>doEndTag()</code> ç­‰æ–¹æ³•ï¼Œå®šä¹‰æ ‡ç­¾è¦å®Œæˆçš„åŠŸèƒ½ï¼›</li>
<li>ç¼–å†™æ‰©å±•åä¸º <code>tld</code> çš„æ ‡ç­¾æè¿°æ–‡ä»¶å¯¹è‡ªå®šä¹‰æ ‡ç­¾è¿›è¡Œéƒ¨ç½²ï¼Œtld æ–‡ä»¶é€šå¸¸æ”¾åœ¨ WEB-INF æ–‡ä»¶å¤¹ä¸‹æˆ–å…¶å­ç›®å½•ä¸­ï¼›</li>
<li>åœ¨ JSP é¡µé¢ä¸­ä½¿ç”¨ <code>taglib</code> æŒ‡ä»¤å¼•ç”¨è¯¥æ ‡ç­¾åº“ã€‚</li>
</ol>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰æ ‡ç­¾åº“çš„ä¾‹å­ã€‚</p>
<ol>
<li><p>æ ‡ç­¾ç±»æºä»£ç  TimeTag.javaï¼š</p>
<p> <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.jackfrued.tags;<br><br><span class="hljs-keyword">import</span> java.io.IOException;<br><span class="hljs-keyword">import</span> java.text.SimpleDateFormat;<br><span class="hljs-keyword">import</span> java.util.Date;<br><br><span class="hljs-keyword">import</span> javax.servlet.jsp.JspException;<br><span class="hljs-keyword">import</span> javax.servlet.jsp.JspWriter;<br><span class="hljs-keyword">import</span> javax.servlet.jsp.tagext.TagSupport;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TimeTag</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">TagSupport</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">long</span> serialVersionUID = <span class="hljs-number">1L</span>;<br><br>    <span class="hljs-keyword">private</span> String format = <span class="hljs-string">&quot;yyyy-MM-dd hh:mm:ss&quot;</span>;<br>    <span class="hljs-keyword">private</span> String foreColor = <span class="hljs-string">&quot;black&quot;</span>;<br>    <span class="hljs-keyword">private</span> String backColor = <span class="hljs-string">&quot;white&quot;</span>;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">doStartTag</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> JspException </span>&#123;<br>        SimpleDateFormat sdf = <span class="hljs-keyword">new</span> SimpleDateFormat(format);<br>        JspWriter writer = pageContext.getOut();<br>        StringBuilder sb = <span class="hljs-keyword">new</span> StringBuilder();<br>        sb.append(String.format(<span class="hljs-string">&quot;&lt;span style=&#x27;color:%s;background-color:%s&#x27;&gt;%s&lt;/span&gt;&quot;</span>,<br>            foreColor, backColor, sdf.format(<span class="hljs-keyword">new</span> Date())));<br>        <span class="hljs-keyword">try</span> &#123;<br>          writer.print(sb.toString());<br>        &#125; <span class="hljs-keyword">catch</span>(IOException e) &#123;<br>          e.printStackTrace();<br>        &#125;<br>        <span class="hljs-keyword">return</span> SKIP_BODY;<br>      &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setFormat</span><span class="hljs-params">(String format)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.format = format;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setForeColor</span><span class="hljs-params">(String foreColor)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.foreColor = foreColor;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setBackColor</span><span class="hljs-params">(String backColor)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.backColor = backColor;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></p>
</li>
<li><p>ç¼–å†™æ ‡ç­¾åº“æè¿°æ–‡ä»¶ my.tldï¼š</p>
<p> <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">taglib</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://java.sun.com/xml/ns/j2ee&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://java.sun.com/xml/ns/j2ee </span></span><br><span class="hljs-tag"><span class="hljs-string">    http://java.sun.com/xml/ns/j2ee/web-jsptaglibrary_2_0.xsd&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">version</span>=<span class="hljs-string">&quot;2.0&quot;</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">description</span>&gt;</span>å®šä¹‰æ ‡ç­¾åº“<span class="hljs-tag">&lt;/<span class="hljs-name">description</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">tlib-version</span>&gt;</span>1.0<span class="hljs-tag">&lt;/<span class="hljs-name">tlib-version</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">short-name</span>&gt;</span>MyTag<span class="hljs-tag">&lt;/<span class="hljs-name">short-name</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">tag</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>time<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">tag-class</span>&gt;</span>com.jackfrued.tags.TimeTag<span class="hljs-tag">&lt;/<span class="hljs-name">tag-class</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">body-content</span>&gt;</span>empty<span class="hljs-tag">&lt;/<span class="hljs-name">body-content</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">attribute</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>format<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">required</span>&gt;</span>false<span class="hljs-tag">&lt;/<span class="hljs-name">required</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">attribute</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">attribute</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>foreColor<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">attribute</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">attribute</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>backColor<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">attribute</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">tag</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">taglib</span>&gt;</span><br></code></pre></td></tr></table></figure></p>
</li>
<li><p>åœ¨ JSP é¡µé¢ä¸­ä½¿ç”¨è‡ªå®šä¹‰æ ‡ç­¾ï¼š</p>
<p> <figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs jsp">&lt;%@ page pageEncoding=<span class="hljs-string">&quot;UTF-8&quot;</span>%&gt;<br>&lt;%@ taglib prefix=<span class="hljs-string">&quot;my&quot;</span> uri=<span class="hljs-string">&quot;/WEB-INF/tld/my.tld&quot;</span> %&gt;<br>&lt;%<br>String path = request.getContextPath();<br>String basePath = request.getScheme() + <span class="hljs-string">&quot;://&quot;</span> + request.getServerName() + <span class="hljs-string">&quot;:&quot;</span> + request.getServerPort() + path + <span class="hljs-string">&quot;/&quot;</span>;<br>%&gt;<br><br>&lt;!DOCTYPE html&gt;<br>&lt;html&gt;<br>  &lt;head&gt;<br>    &lt;base href=<span class="hljs-string">&quot;&lt;%=basePath%&gt;&quot;</span>&gt;<br>    &lt;title&gt;é¦–é¡µ&lt;/title&gt;<br>    &lt;style type=<span class="hljs-string">&quot;text/css&quot;</span>&gt;<br>        * &#123; font-family: <span class="hljs-string">&quot;Arial&quot;</span>; font-size:72px; &#125;<br>    &lt;/style&gt;<br>  &lt;/head&gt;<br><br>  &lt;body&gt;<br>    &lt;my:time format=<span class="hljs-string">&quot;yyyy-MM-dd&quot;</span> backColor=<span class="hljs-string">&quot;blue&quot;</span> foreColor=<span class="hljs-string">&quot;yellow&quot;</span>/&gt;<br>  &lt;/body&gt;<br>&lt;/html&gt;<br></code></pre></td></tr></table></figure>
</p>
</li>
</ol>
<p><strong>æ³¨æ„ï¼š</strong>å¦‚æœè¦å°†è‡ªå®šä¹‰çš„æ ‡ç­¾åº“å‘å¸ƒæˆ JAR æ–‡ä»¶ï¼Œéœ€è¦å°†æ ‡ç­¾åº“æè¿°æ–‡ä»¶ï¼ˆtld æ–‡ä»¶ï¼‰æ”¾åœ¨ JAR æ–‡ä»¶çš„ META-INF ç›®å½•ä¸‹ï¼Œå¯ä»¥ç”¨ JDK ä¸­çš„ jar å·¥å…·å®Œæˆ JAR æ–‡ä»¶çš„ç”Ÿæˆï¼Œå¦‚æœä¸æ¸…æ¥šå¦‚ä½•æ“ä½œï¼Œå¯ä»¥è¯·æ•™<a target="_blank" rel="noopener" href="https://www.google.com/">è°·è€å¸ˆ</a>å’Œ<a target="_blank" rel="noopener" href="https://www.baidu.com/">ç™¾è€å¸ˆ</a>ã€‚</p>
<blockquote>
<p>111ã€è¯´ä¸€ä¸‹è¡¨è¾¾å¼è¯­è¨€ï¼ˆELï¼‰çš„éšå¼å¯¹è±¡åŠå…¶ä½œç”¨ã€‚</p>
</blockquote>
<p>ç­”ï¼šEL çš„éšå¼å¯¹è±¡åŒ…æ‹¬ï¼špageContextã€initParamï¼ˆè®¿é—®ä¸Šä¸‹æ–‡å‚æ•°ï¼‰ã€paramï¼ˆè®¿é—®è¯·æ±‚å‚æ•°ï¼‰ã€paramValuesã€headerï¼ˆè®¿é—®è¯·æ±‚å¤´ï¼‰ã€headerValuesã€cookieï¼ˆè®¿é—® cookieï¼‰ã€applicationScopeï¼ˆè®¿é—® application ä½œç”¨åŸŸï¼‰ã€sessionScopeï¼ˆè®¿é—® session ä½œç”¨åŸŸï¼‰ã€requestScopeï¼ˆè®¿é—® request ä½œç”¨åŸŸï¼‰ã€pageScopeï¼ˆè®¿é—® page ä½œç”¨åŸŸï¼‰ã€‚</p>
<p>ç”¨æ³•å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs jsp">$&#123;pageContext.request.method&#125;<br>$&#123;pageContext[<span class="hljs-string">&quot;request&quot;</span>][<span class="hljs-string">&quot;method&quot;</span>]&#125;<br>$&#123;pageContext.request[<span class="hljs-string">&quot;method&quot;</span>]&#125;<br>$&#123;pageContext[<span class="hljs-string">&quot;request&quot;</span>].method&#125;<br>$&#123;initParam.defaultEncoding&#125;<br>$&#123;header[<span class="hljs-string">&quot;accept-language&quot;</span>]&#125;<br>$&#123;headerValues[<span class="hljs-string">&quot;accept-language&quot;</span>][<span class="hljs-number">0</span>]&#125;<br>$&#123;cookie.jsessionid.value&#125;<br>$&#123;sessionScope.loginUser.username&#125;<br></code></pre></td></tr></table></figure>
</p>
<p><strong>è¡¥å……ï¼š</strong>è¡¨è¾¾å¼è¯­è¨€çš„ <code>.</code> å’Œ <code>[]</code> è¿ç®—ä½œç”¨æ˜¯ä¸€è‡´çš„ï¼Œå”¯ä¸€çš„å·®åˆ«åœ¨äºå¦‚æœè®¿é—®çš„å±æ€§åä¸ç¬¦åˆ Java æ ‡è¯†ç¬¦å‘½åè§„åˆ™ï¼Œä¾‹å¦‚ä¸Šé¢çš„ <code>accept-language</code> å°±ä¸æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„ Java æ ‡è¯†ç¬¦ï¼Œé‚£ä¹ˆè¿™æ—¶å€™å°±åªèƒ½ç”¨ <code>[]</code> è¿ç®—ç¬¦è€Œä¸èƒ½ä½¿ç”¨ <code>.</code> è¿ç®—ç¬¦è·å–å®ƒçš„å€¼ã€‚</p>
<blockquote>
<p>112ã€è¡¨è¾¾å¼è¯­è¨€ï¼ˆELï¼‰æ”¯æŒå“ªäº›è¿ç®—ç¬¦ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šé™¤äº† <code>.</code> å’Œ <code>[]</code> è¿ç®—ç¬¦ï¼ŒEL è¿˜æä¾›äº†ï¼š</p>
<ul>
<li>ç®—æœ¯è¿ç®—ç¬¦ï¼š<code>+</code>ã€<code>-</code>ã€<code>*</code>ã€<code>/</code> æˆ– <code>div</code>ã€<code>%</code> æˆ– <code>mod</code>ï¼›</li>
<li>å…³ç³»è¿ç®—ç¬¦ï¼š<code>==</code> æˆ– <code>eq</code>ã€<code>!=</code> æˆ– <code>ne</code>ã€<code>&gt;</code> æˆ– <code>gt</code>ã€<code>&gt;=</code> æˆ– <code>ge</code>ã€<code>&lt;</code> æˆ– <code>lt</code>ã€<code>&lt;=</code> æˆ– <code>le</code>ï¼›</li>
<li>é€»è¾‘è¿ç®—ç¬¦ï¼š<code>&amp;&amp;</code> æˆ– <code>and</code>ã€<code>||</code> æˆ– <code>or</code>ã€<code>!</code> æˆ– <code>not</code>ï¼›</li>
<li>æ¡ä»¶è¿ç®—ç¬¦ï¼š<code>$&#123;statement? A : B&#125;</code>ï¼ˆè·Ÿ Java çš„æ¡ä»¶è¿ç®—ç¬¦ç±»ä¼¼ï¼‰ï¼›</li>
<li><code>empty</code> è¿ç®—ç¬¦ï¼šæ£€æŸ¥ä¸€ä¸ªå€¼æ˜¯å¦ä¸º <code>null</code> æˆ–è€… <code>ç©º</code>ï¼ˆæ•°ç»„é•¿åº¦ä¸º 0 æˆ–é›†åˆä¸­æ²¡æœ‰å…ƒç´ ä¹Ÿè¿”å› <code>true</code>ï¼‰ã€‚</li>
</ul>
<blockquote>
<p>113ã€Java Web å¼€å‘çš„ Model 1 å’Œ Model 2 åˆ†åˆ«æŒ‡çš„æ˜¯ä»€ä¹ˆï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šModel 1 æ˜¯ä»¥é¡µé¢ä¸ºä¸­å¿ƒçš„ Java Webå¼€å‘ï¼Œä½¿ç”¨ JSP+JavaBean æŠ€æœ¯å°†é¡µé¢æ˜¾ç¤ºé€»è¾‘å’Œä¸šåŠ¡é€»è¾‘å¤„ç†åˆ†å¼€ï¼ŒJSP å®ç°é¡µé¢æ˜¾ç¤ºï¼ŒJavaBean å¯¹è±¡ç”¨æ¥ä¿å­˜æ•°æ®å’Œå®ç°ä¸šåŠ¡é€»è¾‘ã€‚Model 2 æ˜¯åŸºäº MVCï¼ˆæ¨¡å‹-è§†å›¾-æ§åˆ¶å™¨ï¼ŒModel-View-Controllerï¼‰æ¶æ„æ¨¡å¼çš„å¼€å‘æ¨¡å‹ï¼Œå®ç°äº†æ¨¡å‹å’Œè§†å›¾çš„å½»åº•åˆ†ç¦»ï¼Œåˆ©äºå›¢é˜Ÿå¼€å‘å’Œä»£ç å¤ç”¨ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p>
<p><img src= "https://cdn.jsdelivr.net/gh/Eurkon/CDN/hexo/images/user/loading.gif" data-lazy-src="/images/post/java_interview/113.png" alt></p>
<blockquote>
<p>114ã€Servlet 3 ä¸­çš„å¼‚æ­¥å¤„ç†æŒ‡çš„æ˜¯ä»€ä¹ˆï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šåœ¨ Servlet 3 ä¸­å¼•å…¥äº†ä¸€é¡¹æ–°çš„æŠ€æœ¯å¯ä»¥è®© Servlet å¼‚æ­¥å¤„ç†è¯·æ±‚ã€‚æœ‰äººå¯èƒ½ä¼šè´¨ç–‘ï¼Œæ—¢ç„¶éƒ½æœ‰å¤šçº¿ç¨‹äº†ï¼Œè¿˜éœ€è¦å¼‚æ­¥å¤„ç†è¯·æ±‚å—ï¼Ÿç­”æ¡ˆæ˜¯è‚¯å®šéœ€è¦çš„ï¼Œå› ä¸ºå¦‚æœä¸€ä¸ªä»»åŠ¡å¤„ç†æ—¶é—´ç›¸å½“é•¿ï¼Œé‚£ä¹ˆ Servlet æˆ– Filter ä¼šä¸€ç›´å ç”¨ç€è¯·æ±‚å¤„ç†çº¿ç¨‹ç›´åˆ°ä»»åŠ¡ç»“æŸï¼Œéšç€å¹¶å‘ç”¨æˆ·çš„å¢åŠ ï¼Œå®¹å™¨å°†ä¼šé­é‡çº¿ç¨‹è¶…å‡ºçš„é£é™©ï¼Œè¿™è¿™ç§æƒ…å†µä¸‹å¾ˆå¤šçš„è¯·æ±‚å°†ä¼šè¢«å †ç§¯èµ·æ¥è€Œåç»­çš„è¯·æ±‚å¯èƒ½ä¼šé­é‡æ‹’ç»æœåŠ¡ï¼Œç›´åˆ°æœ‰èµ„æºå¯ä»¥å¤„ç†è¯·æ±‚ä¸ºæ­¢ã€‚å¼‚æ­¥ç‰¹æ€§å¯ä»¥å¸®åŠ©åº”ç”¨èŠ‚çœå®¹å™¨ä¸­çš„çº¿ç¨‹ï¼Œç‰¹åˆ«é€‚åˆæ‰§è¡Œæ—¶é—´é•¿è€Œä¸”ç”¨æˆ·éœ€è¦å¾—åˆ°ç»“æœçš„ä»»åŠ¡ï¼Œå¦‚æœç”¨æˆ·ä¸éœ€è¦å¾—åˆ°ç»“æœåˆ™ç›´æ¥å°†ä¸€ä¸ª Runnable å¯¹è±¡äº¤ç»™ Executor å¹¶ç«‹å³è¿”å›å³å¯ã€‚</p>
<p><strong>è¡¥å……ï¼š</strong>å¤šçº¿ç¨‹åœ¨ Java è¯ç”ŸåˆæœŸæ— ç–‘æ˜¯ä¸€ä¸ªäº®ç‚¹ï¼Œè€Œ Servlet å•å®ä¾‹å¤šçº¿ç¨‹çš„å·¥ä½œæ–¹å¼ä¹Ÿæ›¾ä¸ºå…¶èµ¢å¾—ç¾åï¼Œç„¶è€ŒæŠ€æœ¯çš„å‘å±•å¾€å¾€ä¼šé¢ è¦†æˆ‘ä»¬å¾ˆå¤šçš„è®¤çŸ¥ï¼Œå°±å¦‚åŒå½“å¹´çˆ±å› æ–¯å¦çš„ç›¸å¯¹è®ºé¢ è¦†äº†ç‰›é¡¿çš„ç»å…¸åŠ›å­¦ä¸€èˆ¬ã€‚äº‹å®ä¸Šï¼Œå¼‚æ­¥å¤„ç†ç»ä¸æ˜¯ Serlvet 3 é¦–åˆ›ï¼Œå¦‚æœä½ äº†è§£ Node.js çš„è¯ï¼Œå¯¹ Servlet 3 çš„è¿™ä¸ªé‡è¦æ”¹è¿›å°±ä¸ä»¥ä¸ºå¥‡äº†ã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªæ”¯æŒå¼‚æ­¥å¤„ç†è¯·æ±‚çš„ Servlet çš„ä¾‹å­ã€‚</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.io.IOException;<br><span class="hljs-keyword">import</span> javax.servlet.AsyncContext;<br><span class="hljs-keyword">import</span> javax.servlet.ServletException;<br><span class="hljs-keyword">import</span> javax.servlet.annotation.WebServlet;<br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServlet;<br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServletRequest;<br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServletResponse;<br><br><span class="hljs-meta">@WebServlet(urlPatterns = &#123;&quot;/async&quot;&#125;, asyncSupported = true)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AsyncServlet</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">HttpServlet</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">long</span> serialVersionUID = <span class="hljs-number">1L</span>;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doGet</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> </span><br><span class="hljs-function">            <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>        <span class="hljs-comment">// å¼€å¯Tomcatå¼‚æ­¥Servletæ”¯æŒ</span><br>        req.setAttribute(<span class="hljs-string">&quot;org.apache.catalina.ASYNC_SUPPORTED&quot;</span>, <span class="hljs-keyword">true</span>);<br><br>        <span class="hljs-keyword">final</span> AsyncContext ctx = req.startAsync();  <span class="hljs-comment">// å¯åŠ¨å¼‚æ­¥å¤„ç†çš„ä¸Šä¸‹æ–‡</span><br>        <span class="hljs-comment">// ctx.setTimeout(30000);</span><br>        ctx.start(<span class="hljs-keyword">new</span> Runnable() &#123;<br><br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">run</span><span class="hljs-params">()</span> </span>&#123;<br>                <span class="hljs-comment">// åœ¨æ­¤å¤„æ·»åŠ å¼‚æ­¥å¤„ç†çš„ä»£ç </span><br><br>                ctx.complete();<br>            &#125;<br>        &#125;);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<blockquote>
<p>115ã€å¦‚ä½•åœ¨åŸºäº Java çš„ Web é¡¹ç›®ä¸­å®ç°æ–‡ä»¶ä¸Šä¼ å’Œä¸‹è½½ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šåœ¨ Sevlet 3 ä»¥å‰ï¼ŒServlet API ä¸­æ²¡æœ‰æ”¯æŒä¸Šä¼ åŠŸèƒ½çš„ APIï¼Œå› æ­¤è¦å®ç°ä¸Šä¼ åŠŸèƒ½éœ€è¦å¼•å…¥ç¬¬ä¸‰æ–¹å·¥å…·ä» POST è¯·æ±‚ä¸­è·å¾—ä¸Šä¼ çš„é™„ä»¶æˆ–è€…é€šè¿‡è‡ªè¡Œå¤„ç†è¾“å…¥æµæ¥è·å¾—ä¸Šä¼ çš„æ–‡ä»¶ï¼Œæˆ‘ä»¬æ¨èä½¿ç”¨ Apache çš„ commons-fileuploadã€‚</p>
<p>ä» Servlet 3 å¼€å§‹ï¼Œæ–‡ä»¶ä¸Šä¼ å˜å¾—æ— æ¯”ç®€å•ï¼Œç›¸ä¿¡çœ‹çœ‹ä¸‹é¢çš„ä¾‹å­ä¸€åˆ‡éƒ½æ¸…æ¥šäº†ã€‚</p>
<p>ä¸Šä¼ é¡µé¢index.jspï¼š</p>
<p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs jsp">&lt;%@ page pageEncoding=<span class="hljs-string">&quot;utf-8&quot;</span>%&gt;<br>&lt;!DOCTYPE html&gt;<br>&lt;html&gt;<br>&lt;head&gt;<br>&lt;meta http-equiv=<span class="hljs-string">&quot;Content-Type&quot;</span> content=<span class="hljs-string">&quot;text/html; charset=UTF-8&quot;</span>&gt;<br>&lt;title&gt;Photo Upload&lt;/title&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br>&lt;h1&gt;Select your photo and upload&lt;/h1&gt;<br>&lt;hr/&gt;<br>&lt;div style=&quot;color:red;font-size:14px;&quot;&gt;$&#123;hint&#125;&lt;/div&gt;<br>&lt;form action=<span class="hljs-string">&quot;UploadServlet&quot;</span> method=<span class="hljs-string">&quot;post&quot;</span> enctype=<span class="hljs-string">&quot;multipart/form-data&quot;</span>&gt;<br>    Photo file: &lt;input type=<span class="hljs-string">&quot;file&quot;</span> name=<span class="hljs-string">&quot;photo&quot;</span> /&gt;<br>    &lt;input type=<span class="hljs-string">&quot;submit&quot;</span> value=<span class="hljs-string">&quot;Upload&quot;</span> /&gt;<br>&lt;/form&gt;<br>&lt;/body&gt;<br>&lt;/html&gt;<br></code></pre></td></tr></table></figure>
</p>
<p>æ”¯æŒä¸Šä¼ çš„ Servletï¼š</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.jackfrued.servlet;<br><br><span class="hljs-keyword">import</span> java.io.IOException;<br><br><span class="hljs-keyword">import</span> javax.servlet.ServletException;<br><span class="hljs-keyword">import</span> javax.servlet.annotation.MultipartConfig;<br><span class="hljs-keyword">import</span> javax.servlet.annotation.WebServlet;<br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServlet;<br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServletRequest;<br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServletResponse;<br><span class="hljs-keyword">import</span> javax.servlet.http.Part;<br><br><span class="hljs-meta">@WebServlet(&quot;/UploadServlet&quot;)</span><br><span class="hljs-meta">@MultipartConfig</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UploadServlet</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">HttpServlet</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">long</span> serialVersionUID = <span class="hljs-number">1L</span>;<br><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doPost</span><span class="hljs-params">(HttpServletRequest request,</span></span><br><span class="hljs-function"><span class="hljs-params">            HttpServletResponse response)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>        <span class="hljs-comment">// å¯ä»¥ç”¨request.getPart()æ–¹æ³•è·å¾—åä¸ºphotoçš„ä¸Šä¼ é™„ä»¶</span><br>        <span class="hljs-comment">// ä¹Ÿå¯ä»¥ç”¨request.getParts()è·å¾—æ‰€æœ‰ä¸Šä¼ é™„ä»¶ï¼ˆå¤šæ–‡ä»¶ä¸Šä¼ ï¼‰</span><br>        <span class="hljs-comment">// ç„¶åé€šè¿‡å¾ªç¯åˆ†åˆ«å¤„ç†æ¯ä¸€ä¸ªä¸Šä¼ çš„æ–‡ä»¶</span><br>        Part part = request.getPart(<span class="hljs-string">&quot;photo&quot;</span>);<br>        <span class="hljs-keyword">if</span> (part != <span class="hljs-keyword">null</span> &amp;&amp; part.getSubmittedFileName().length() &gt; <span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-comment">// ç”¨ServletContextå¯¹è±¡çš„getRealPath()æ–¹æ³•è·å¾—ä¸Šä¼ æ–‡ä»¶å¤¹çš„ç»å¯¹è·¯å¾„</span><br>            String savePath = request.getServletContext().getRealPath(<span class="hljs-string">&quot;/upload&quot;</span>);<br>            <span class="hljs-comment">// Servlet 3.1è§„èŒƒä¸­å¯ä»¥ç”¨Partå¯¹è±¡çš„getSubmittedFileName()æ–¹æ³•è·å¾—ä¸Šä¼ çš„æ–‡ä»¶å</span><br>            <span class="hljs-comment">// æ›´å¥½çš„åšæ³•æ˜¯ä¸ºä¸Šä¼ çš„æ–‡ä»¶è¿›è¡Œé‡å‘½åï¼ˆé¿å…åŒåæ–‡ä»¶çš„ç›¸äº’è¦†ç›–ï¼‰</span><br>            part.write(savePath + <span class="hljs-string">&quot;/&quot;</span> + part.getSubmittedFileName());<br>            request.setAttribute(<span class="hljs-string">&quot;hint&quot;</span>, <span class="hljs-string">&quot;Upload Successfully!&quot;</span>);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            request.setAttribute(<span class="hljs-string">&quot;hint&quot;</span>, <span class="hljs-string">&quot;Upload failed!&quot;</span>);<br>        &#125;<br>        <span class="hljs-comment">// è·³è½¬å›åˆ°ä¸Šä¼ é¡µé¢</span><br>        request.getRequestDispatcher(<span class="hljs-string">&quot;index.jsp&quot;</span>).forward(request, response);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<blockquote>
<p>116ã€æœåŠ¡å™¨æ”¶åˆ°ç”¨æˆ·æäº¤çš„è¡¨å•æ•°æ®ï¼Œåˆ°åº•æ˜¯è°ƒç”¨ Servlet çš„ <code>doGet()</code> è¿˜æ˜¯ <code>doPost()</code> æ–¹æ³•ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šHTML çš„ <code>&lt;form&gt;</code> å…ƒç´ æœ‰ä¸€ä¸ª <code>method</code> å±æ€§ï¼Œç”¨æ¥æŒ‡å®šæäº¤è¡¨å•çš„æ–¹å¼ï¼Œå…¶å€¼å¯ä»¥æ˜¯ <code>get</code> æˆ– <code>post</code>ã€‚æˆ‘ä»¬è‡ªå®šä¹‰çš„ Servlet ä¸€èˆ¬æƒ…å†µä¸‹ä¼šé‡å†™ <code>doGet()</code> æˆ– <code>doPost()</code> ä¸¤ä¸ªæ–¹æ³•ä¹‹ä¸€æˆ–å…¨éƒ¨ï¼Œå¦‚æœæ˜¯ <code>GET</code> è¯·æ±‚å°±è°ƒç”¨ <code>doGet()</code> æ–¹æ³•ï¼Œå¦‚æœæ˜¯ <code>POST</code> è¯·æ±‚å°±è°ƒç”¨ <code>doPost()</code> æ–¹æ³•ï¼Œé‚£ä¸ºä»€ä¹ˆä¸ºä»€ä¹ˆè¿™æ ·å‘¢ï¼Ÿæˆ‘ä»¬è‡ªå®šä¹‰çš„ Servlet é€šå¸¸ç»§æ‰¿è‡ª <code>HttpServlet</code>ï¼Œ<code>HttpServlet</code> ç»§æ‰¿è‡ª <code>GenericServlet</code> å¹¶é‡å†™äº†å…¶ä¸­çš„ <code>service()</code> æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯ Servlet æ¥å£ä¸­å®šä¹‰çš„ã€‚<code>HttpServlet</code> é‡å†™çš„ <code>service()</code> æ–¹æ³•ä¼šå…ˆè·å–ç”¨æˆ·è¯·æ±‚çš„æ–¹æ³•ï¼Œç„¶åæ ¹æ®è¯·æ±‚æ–¹æ³•è°ƒç”¨ <code>doGet()</code>ã€<code>doPost()</code>ã€<code>doPut()</code>ã€<code>doDelete()</code> ç­‰æ–¹æ³•ï¼Œå¦‚æœåœ¨è‡ªå®šä¹‰ Servlet ä¸­é‡å†™äº†è¿™äº›æ–¹æ³•ï¼Œé‚£ä¹ˆæ˜¾ç„¶ä¼šè°ƒç”¨é‡å†™è¿‡çš„ï¼ˆè‡ªå®šä¹‰çš„ï¼‰æ–¹æ³•ï¼Œè¿™æ˜¾ç„¶æ˜¯å¯¹æ¨¡æ¿æ–¹æ³•æ¨¡å¼çš„åº”ç”¨ï¼ˆå¦‚æœä¸ç†è§£ï¼Œè¯·å‚è€ƒé˜å®åšå£«çš„ã€ŠJavaä¸æ¨¡å¼ã€‹ä¸€ä¹¦çš„ç¬¬ 37 ç« ï¼‰ã€‚å½“ç„¶ï¼Œè‡ªå®šä¹‰ Servlet ä¸­ä¹Ÿå¯ä»¥ç›´æ¥é‡å†™ <code>service()</code> æ–¹æ³•ï¼Œé‚£ä¹ˆä¸ç®¡æ˜¯å“ªç§æ–¹å¼çš„è¯·æ±‚ï¼Œéƒ½å¯ä»¥é€šè¿‡è‡ªå·±çš„ä»£ç è¿›è¡Œå¤„ç†ï¼Œè¿™å¯¹äºä¸åŒºåˆ†è¯·æ±‚æ–¹æ³•çš„åœºæ™¯æ¯”è¾ƒåˆé€‚ã€‚</p>
<blockquote>
<p>117ã€JSP ä¸­çš„é™æ€åŒ…å«å’ŒåŠ¨æ€åŒ…å«æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šé™æ€åŒ…å«æ˜¯é€šè¿‡ JSP çš„ <code>include</code> æŒ‡ä»¤åŒ…å«é¡µé¢ï¼ŒåŠ¨æ€åŒ…å«æ˜¯é€šè¿‡ JSP æ ‡å‡†åŠ¨ä½œ <code>&lt;jsp:forward&gt;</code> åŒ…å«é¡µé¢ã€‚</p>
<ul>
<li><p>é™æ€åŒ…å«æ˜¯ç¼–è¯‘æ—¶åŒ…å«ï¼Œå¦‚æœåŒ…å«çš„é¡µé¢ä¸å­˜åœ¨åˆ™ä¼šäº§ç”Ÿç¼–è¯‘é”™è¯¯ï¼Œè€Œä¸”ä¸¤ä¸ªé¡µé¢çš„ <code>contentType</code> å±æ€§åº”ä¿æŒä¸€è‡´ï¼Œå› ä¸ºä¸¤ä¸ªé¡µé¢ä¼šåˆäºŒä¸ºä¸€ï¼Œåªäº§ç”Ÿä¸€ä¸ª class æ–‡ä»¶ï¼Œå› æ­¤è¢«åŒ…å«é¡µé¢å‘ç”Ÿçš„å˜åŠ¨å†åŒ…å«å®ƒçš„é¡µé¢æ›´æ–°å‰ä¸ä¼šå¾—åˆ°æ›´æ–°ã€‚</p>
</li>
<li><p>åŠ¨æ€åŒ…å«æ˜¯è¿è¡Œæ—¶åŒ…å«ï¼Œå¯ä»¥å‘è¢«åŒ…å«çš„é¡µé¢ä¼ é€’å‚æ•°ï¼ŒåŒ…å«é¡µé¢å’Œè¢«åŒ…å«é¡µé¢æ˜¯ç‹¬ç«‹çš„ï¼Œä¼šç¼–è¯‘å‡ºä¸¤ä¸ª class æ–‡ä»¶ï¼Œå¦‚æœè¢«åŒ…å«çš„é¡µé¢ä¸å­˜åœ¨ï¼Œä¸ä¼šäº§ç”Ÿç¼–è¯‘é”™è¯¯ï¼Œä¹Ÿä¸å½±å“é¡µé¢å…¶ä»–éƒ¨åˆ†çš„æ‰§è¡Œã€‚ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
</li>
</ul>
<p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs jsp">&lt;%-- é™æ€åŒ…å« --%&gt;<br>&lt;%@ include file=<span class="hljs-string">&quot;...&quot;</span> %&gt;<br><br>&lt;%-- åŠ¨æ€åŒ…å« --%&gt;<br>&lt;jsp:include page=<span class="hljs-string">&quot;...&quot;</span>&gt;<br>    &lt;jsp:param name=<span class="hljs-string">&quot;...&quot;</span> value=<span class="hljs-string">&quot;...&quot;</span> /&gt;<br>&lt;/jsp:include&gt;<br></code></pre></td></tr></table></figure>
</p>
<blockquote>
<p>118ã€Servlet ä¸­å¦‚ä½•è·å–ç”¨æˆ·æäº¤çš„æŸ¥è¯¢å‚æ•°æˆ–è¡¨å•æ•°æ®ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šå¯ä»¥é€šè¿‡è¯·æ±‚å¯¹è±¡ <code>HttpServletRequest</code> çš„ <code>getParameter()</code> æ–¹æ³•é€šè¿‡å‚æ•°åè·å¾—å‚æ•°å€¼ã€‚å¦‚æœæœ‰åŒ…å«å¤šä¸ªå€¼çš„å‚æ•°ï¼ˆä¾‹å¦‚å¤é€‰æ¡†ï¼‰ï¼Œå¯ä»¥é€šè¿‡è¯·æ±‚å¯¹è±¡çš„ <code>getParameterValues()</code> æ–¹æ³•è·å¾—ã€‚å½“ç„¶ä¹Ÿå¯ä»¥é€šè¿‡è¯·æ±‚å¯¹è±¡çš„ <code>getParameterMap()</code> è·å¾—ä¸€ä¸ªå‚æ•°åå’Œå‚æ•°å€¼çš„æ˜ å°„ï¼ˆMapï¼‰ã€‚</p>
<blockquote>
<p>119ã€Servlet ä¸­å¦‚ä½•è·å–ç”¨æˆ·é…ç½®çš„åˆå§‹åŒ–å‚æ•°ä»¥åŠæœåŠ¡å™¨ä¸Šä¸‹æ–‡å‚æ•°ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šå¯ä»¥é€šè¿‡é‡å†™ Servlet æ¥å£çš„ <code>init(ServletConfig)</code> æ–¹æ³•å¹¶é€šè¿‡ <code>ServletConfig</code> å¯¹è±¡çš„ <code>getInitParameter()</code> æ–¹æ³•æ¥è·å– Servlet çš„åˆå§‹åŒ–å‚æ•°ã€‚å¯ä»¥é€šè¿‡ <code>ServletConfig</code> å¯¹è±¡çš„ <code>getServletContext()</code> æ–¹æ³•è·å– <code>ServletContext</code> å¯¹è±¡ï¼Œå¹¶é€šè¿‡è¯¥å¯¹è±¡çš„ <code>getInitParameter()</code> æ–¹æ³•æ¥è·å–æœåŠ¡å™¨ä¸Šä¸‹æ–‡å‚æ•°ã€‚å½“ç„¶ï¼Œ<code>ServletContext</code> å¯¹è±¡ä¹Ÿåœ¨å¤„ç†ç”¨æˆ·è¯·æ±‚çš„æ–¹æ³•ï¼ˆå¦‚ <code>doGet()</code> æ–¹æ³•ï¼‰ä¸­é€šè¿‡è¯·æ±‚å¯¹è±¡çš„ <code>getServletContext()</code>æ–¹æ³•æ¥è·å¾—ã€‚</p>
<blockquote>
<p>120ã€å¦‚ä½•è®¾ç½®è¯·æ±‚çš„ç¼–ç ä»¥åŠå“åº”å†…å®¹çš„ç±»å‹ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šé€šè¿‡è¯·æ±‚å¯¹è±¡ <code>ServletRequest</code> çš„ <code>setCharacterEncoding(String)</code> æ–¹æ³•å¯ä»¥è®¾ç½®è¯·æ±‚çš„ç¼–ç ï¼Œå…¶å®è¦å½»åº•è§£å†³ä¹±ç é—®é¢˜å°±åº”è¯¥è®©é¡µé¢ã€æœåŠ¡å™¨ã€è¯·æ±‚å’Œå“åº”ã€Java ç¨‹åºéƒ½ä½¿ç”¨ç»Ÿä¸€çš„ç¼–ç ï¼Œæœ€å¥½çš„é€‰æ‹©å½“ç„¶æ˜¯ <code>UTF-8</code>ï¼›é€šè¿‡å“åº”å¯¹è±¡ <code>ServletResponse</code> çš„ <code>setContentType(String)</code> æ–¹æ³•å¯ä»¥è®¾ç½®å“åº”å†…å®¹çš„ç±»å‹ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥é€šè¿‡ <code>HttpServletResponsed</code> å¯¹è±¡çš„ <code>setHeader(String, String)</code> æ–¹æ³•æ¥è®¾ç½®ã€‚</p>
<p><strong>è¯´æ˜ï¼š</strong>ç°åœ¨å¦‚æœè¿˜æœ‰å…¬å¸åœ¨é¢è¯•çš„æ—¶å€™é—® JSP çš„å£°æ˜æ ‡è®°ã€è¡¨è¾¾å¼æ ‡è®°ã€å°è„šæœ¬æ ‡è®°è¿™äº›å†…å®¹çš„è¯ï¼Œè¿™æ ·çš„å…¬å¸ä¹Ÿä¸ç”¨å»äº†ï¼Œå…¶å® JSP å†…ç½®å¯¹è±¡ã€JSP æŒ‡ä»¤è¿™äº›ä¸œè¥¿åŸºæœ¬ä¸Šéƒ½å¯ä»¥å¿˜å´äº†ï¼Œå…³äº Java Web å¼€å‘çš„ç›¸å…³çŸ¥è¯†ï¼Œå¯ä»¥çœ‹ä¸€ä¸‹æˆ‘çš„ <a target="_blank" rel="noopener" href="/images/post/java_interview/servlet_jsp.png" one-link-mark="yes">Servlet&amp;JSP æ€ç»´å¯¼å›¾</a>ï¼Œä¸Šé¢æœ‰å®Œæ•´çš„çŸ¥è¯†ç‚¹çš„ç½—åˆ—ã€‚</p>
<blockquote>
<p>121ã€è§£é‡Šä¸€ä¸‹ç½‘ç»œåº”ç”¨çš„æ¨¡å¼åŠå…¶ç‰¹ç‚¹ã€‚</p>
</blockquote>
<p>ç­”ï¼šå…¸å‹çš„ç½‘ç»œåº”ç”¨æ¨¡å¼å¤§è‡´æœ‰ä¸‰ç±»ï¼šB/Sã€C/Sã€P2Pã€‚å…¶ä¸­ B ä»£è¡¨æµè§ˆå™¨ï¼ˆBrowserï¼‰ã€C ä»£è¡¨å®¢æˆ·ç«¯ï¼ˆClientï¼‰ã€S ä»£è¡¨æœåŠ¡å™¨ï¼ˆServerï¼‰ï¼ŒP2P æ˜¯å¯¹ç­‰æ¨¡å¼ï¼Œä¸åŒºåˆ†å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ã€‚B/S åº”ç”¨æ¨¡å¼ä¸­å¯ä»¥è§†ä¸ºç‰¹æ®Šçš„ C/S åº”ç”¨æ¨¡å¼ï¼Œåªæ˜¯å°† C/S åº”ç”¨æ¨¡å¼ä¸­çš„ç‰¹æ®Šçš„å®¢æˆ·ç«¯æ¢æˆäº†æµè§ˆå™¨ï¼Œå› ä¸ºå‡ ä¹æ‰€æœ‰çš„ç³»ç»Ÿä¸Šéƒ½æœ‰æµè§ˆå™¨ï¼Œé‚£ä¹ˆåªè¦æ‰“å¼€æµè§ˆå™¨å°±å¯ä»¥ä½¿ç”¨åº”ç”¨ï¼Œæ²¡æœ‰å®‰è£…ã€é…ç½®ã€å‡çº§å®¢æˆ·ç«¯æ‰€å¸¦æ¥çš„å„ç§å¼€é”€ã€‚P2P åº”ç”¨æ¨¡å¼ä¸­ï¼Œæˆåƒä¸Šä¸‡å°å½¼æ­¤è¿æ¥çš„è®¡ç®—æœºéƒ½å¤„äºå¯¹ç­‰çš„åœ°ä½ï¼Œæ•´ä¸ªç½‘ç»œä¸€èˆ¬æ¥è¯´ä¸ä¾èµ–ä¸“ç”¨çš„é›†ä¸­æœåŠ¡å™¨ã€‚ç½‘ç»œä¸­çš„æ¯ä¸€å°è®¡ç®—æœºæ—¢èƒ½å……å½“ç½‘ç»œæœåŠ¡çš„è¯·æ±‚è€…ï¼Œåˆå¯¹å…¶å®ƒè®¡ç®—æœºçš„è¯·æ±‚ä½œå‡ºå“åº”ï¼Œæä¾›èµ„æºå’ŒæœåŠ¡ã€‚é€šå¸¸è¿™äº›èµ„æºå’ŒæœåŠ¡åŒ…æ‹¬ï¼šä¿¡æ¯çš„å…±äº«å’Œäº¤æ¢ã€è®¡ç®—èµ„æºï¼ˆå¦‚ CPU çš„å…±äº«ï¼‰ã€å­˜å‚¨å…±äº«ï¼ˆå¦‚ç¼“å­˜å’Œç£ç›˜ç©ºé—´çš„ä½¿ç”¨ï¼‰ç­‰ï¼Œè¿™ç§åº”ç”¨æ¨¡å¼æœ€å¤§çš„é˜»åŠ›å®‰å…¨æ€§ã€ç‰ˆæœ¬ç­‰é—®é¢˜ï¼Œç›®å‰æœ‰å¾ˆå¤šåº”ç”¨éƒ½æ··åˆä½¿ç”¨äº†å¤šç§åº”ç”¨æ¨¡å‹ï¼Œæœ€å¸¸è§çš„ç½‘ç»œè§†é¢‘åº”ç”¨ï¼Œå®ƒå‡ ä¹æŠŠä¸‰ç§æ¨¡å¼éƒ½ç”¨ä¸Šäº†ã€‚</p>
<p><strong>è¡¥å……ï¼š</strong>æ­¤é¢˜è¦è·Ÿâ€œç”µå­å•†åŠ¡æ¨¡å¼â€åŒºåˆ†å¼€ï¼Œå› ä¸ºæœ‰å¾ˆå¤šäººè¢«é—®åˆ°è¿™ä¸ªé—®é¢˜çš„æ—¶å€™é©¬ä¸Šæƒ³åˆ°çš„æ˜¯ B2Bï¼ˆå¦‚é˜¿é‡Œå·´å·´ï¼‰ã€B2Cï¼ˆå¦‚å½“å½“ã€äºšé©¬é€Šã€äº¬ä¸œï¼‰ã€C2Cï¼ˆå¦‚æ·˜å®ã€æ‹æ‹ï¼‰ã€C2Bï¼ˆå¦‚å¨å®¢ï¼‰ã€O2Oï¼ˆå¦‚ç¾å›¢ã€é¥¿äº†ä¹ˆï¼‰ã€‚å¯¹äºè¿™ç±»é—®é¢˜ï¼Œå¯ä»¥å»ç™¾åº¦ä¸Šé¢ç§‘æ™®ä¸€ä¸‹ã€‚</p>
<blockquote>
<p>122ã€ä»€ä¹ˆæ˜¯ Web Serviceï¼ˆWeb æœåŠ¡ï¼‰ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šä»è¡¨é¢ä¸Šçœ‹ï¼ŒWeb Service å°±æ˜¯ä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œå®ƒå‘å¤–ç•Œæš´éœ²å‡ºä¸€ä¸ªèƒ½å¤Ÿé€šè¿‡ Web è¿›è¡Œè°ƒç”¨çš„ APIã€‚è¿™å°±æ˜¯è¯´ï¼Œä½ èƒ½å¤Ÿç”¨ç¼–ç¨‹çš„æ–¹æ³•é€æ˜çš„è°ƒç”¨è¿™ä¸ªåº”ç”¨ç¨‹åºï¼Œä¸éœ€è¦äº†è§£å®ƒçš„ä»»ä½•ç»†èŠ‚ï¼Œè·Ÿä½ ä½¿ç”¨çš„ç¼–ç¨‹è¯­è¨€ä¹Ÿæ²¡æœ‰å…³ç³»ã€‚ä¾‹å¦‚å¯ä»¥åˆ›å»ºä¸€ä¸ªæä¾›å¤©æ°”é¢„æŠ¥çš„ Web Serviceï¼Œé‚£ä¹ˆæ— è®ºä½ ç”¨å“ªç§ç¼–ç¨‹è¯­è¨€å¼€å‘çš„åº”ç”¨éƒ½å¯ä»¥é€šè¿‡è°ƒç”¨å®ƒçš„ API å¹¶ä¼ å…¥åŸå¸‚ä¿¡æ¯æ¥è·å¾—è¯¥åŸå¸‚çš„å¤©æ°”é¢„æŠ¥ã€‚ä¹‹æ‰€ä»¥ç§°ä¹‹ä¸º Web Serviceï¼Œæ˜¯å› ä¸ºå®ƒåŸºäº HTTP åè®®ä¼ è¾“æ•°æ®ï¼Œè¿™ä½¿å¾—è¿è¡Œåœ¨ä¸åŒæœºå™¨ä¸Šçš„ä¸åŒåº”ç”¨æ— é¡»å€ŸåŠ©é™„åŠ çš„ã€ä¸“é—¨çš„ç¬¬ä¸‰æ–¹è½¯ä»¶æˆ–ç¡¬ä»¶ï¼Œå°±å¯ç›¸äº’äº¤æ¢æ•°æ®æˆ–é›†æˆã€‚</p>
<p><strong>è¡¥å……ï¼š</strong>è¿™é‡Œå¿…é¡»è¦æåŠçš„ä¸€ä¸ªæ¦‚å¿µæ˜¯ SOAï¼ˆService-Oriented Architectureï¼Œé¢å‘æœåŠ¡çš„æ¶æ„ï¼‰ï¼ŒSOA æ˜¯ä¸€ç§æ€æƒ³ï¼Œå®ƒå°†åº”ç”¨ç¨‹åºçš„ä¸åŒåŠŸèƒ½å•å…ƒé€šè¿‡ä¸­ç«‹çš„å¥‘çº¦è”ç³»èµ·æ¥ï¼Œç‹¬ç«‹äºç¡¬ä»¶å¹³å°ã€æ“ä½œç³»ç»Ÿå’Œç¼–ç¨‹è¯­è¨€ï¼Œä½¿å¾—å„ç§å½¢å¼çš„åŠŸèƒ½å•å…ƒèƒ½å¤Ÿæ›´å¥½çš„é›†æˆã€‚æ˜¾ç„¶ï¼ŒWeb Service æ˜¯ SOA çš„ä¸€ç§è¾ƒå¥½çš„è§£å†³æ–¹æ¡ˆï¼Œå®ƒæ›´å¤šçš„æ˜¯ä¸€ç§æ ‡å‡†ï¼Œè€Œä¸æ˜¯ä¸€ç§å…·ä½“çš„æŠ€æœ¯ã€‚</p>
<blockquote>
<p>123ã€æ¦‚å¿µè§£é‡Šï¼šSOAPã€WSDLã€UDDIã€‚</p>
</blockquote>
<p>ç­”ï¼š</p>
<ul>
<li>SOAPï¼šç®€å•å¯¹è±¡è®¿é—®åè®®ï¼ˆSimple Object Access Protocolï¼‰ï¼Œæ˜¯ Web Service ä¸­äº¤æ¢æ•°æ®çš„ä¸€ç§åè®®è§„èŒƒã€‚</li>
<li>WSDLï¼šWeb æœåŠ¡æè¿°è¯­è¨€ï¼ˆWeb Service Description Languageï¼‰ï¼Œå®ƒæè¿°äº† Web æœåŠ¡çš„å…¬å…±æ¥å£ã€‚è¿™æ˜¯ä¸€ä¸ªåŸºäº XML çš„å…³äºå¦‚ä½•ä¸ Web æœåŠ¡é€šè®¯å’Œä½¿ç”¨çš„æœåŠ¡æè¿°ï¼›ä¹Ÿå°±æ˜¯æè¿°ä¸ç›®å½•ä¸­åˆ—å‡ºçš„ Web æœåŠ¡è¿›è¡Œäº¤äº’æ—¶éœ€è¦ç»‘å®šçš„åè®®å’Œä¿¡æ¯æ ¼å¼ã€‚é€šå¸¸é‡‡ç”¨æŠ½è±¡è¯­è¨€æè¿°è¯¥æœåŠ¡æ”¯æŒçš„æ“ä½œå’Œä¿¡æ¯ï¼Œä½¿ç”¨çš„æ—¶å€™å†å°†å®é™…çš„ç½‘ç»œåè®®å’Œä¿¡æ¯æ ¼å¼ç»‘å®šç»™è¯¥æœåŠ¡ã€‚</li>
<li>UDDIï¼šç»Ÿä¸€æè¿°ã€å‘ç°å’Œé›†æˆï¼ˆUniversal Description, Discovery and Integrationï¼‰ï¼Œå®ƒæ˜¯ä¸€ä¸ªåŸºäº XML çš„è·¨å¹³å°çš„æè¿°è§„èŒƒï¼Œå¯ä»¥ä½¿ä¸–ç•ŒèŒƒå›´å†…çš„ä¼ä¸šåœ¨äº’è”ç½‘ä¸Šå‘å¸ƒè‡ªå·±æ‰€æä¾›çš„æœåŠ¡ã€‚ç®€å•çš„è¯´ï¼ŒUDDI æ˜¯è®¿é—®å„ç§ WSDL çš„ä¸€ä¸ªé—¨é¢ï¼ˆå¯ä»¥å‚è€ƒè®¾è®¡æ¨¡å¼ä¸­çš„é—¨é¢æ¨¡å¼ï¼‰ã€‚</li>
</ul>
<blockquote>
<p>124ã€Java è§„èŒƒä¸­å’Œ Web Service ç›¸å…³çš„è§„èŒƒæœ‰å“ªäº›ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šJava è§„èŒƒä¸­å’Œ Web Service ç›¸å…³çš„æœ‰ä¸‰ä¸ªï¼š</p>
<ul>
<li>JAX-WS(JSR 224)ï¼šè¿™ä¸ªè§„èŒƒæ˜¯æ—©æœŸçš„åŸºäº SOAP çš„ Web Service è§„èŒƒ JAX-RPC çš„æ›¿ä»£ç‰ˆæœ¬ï¼Œå®ƒå¹¶ä¸æä¾›å‘ä¸‹å…¼å®¹æ€§ï¼Œå› ä¸º RPC æ ·å¼çš„ WSDL ä»¥åŠç›¸å…³çš„ API å·²ç»åœ¨ Java EE5 ä¸­è¢«ç§»é™¤äº†ã€‚WS-MetaData æ˜¯ JAX-WS çš„ä¾èµ–è§„èŒƒï¼Œæä¾›äº†åŸºäºæ³¨è§£é…ç½® Web Service å’Œ SOAP æ¶ˆæ¯çš„ç›¸å…³ APIã€‚</li>
<li>JAXM(JSR 67)ï¼šå®šä¹‰äº†å‘é€å’Œæ¥æ”¶æ¶ˆæ¯æ‰€éœ€çš„ APIï¼Œç›¸å½“äº Web Service çš„æœåŠ¡å™¨ç«¯ã€‚</li>
<li>JAX-RS(JSR 311 &amp; JSR 339 &amp; JSR 370)ï¼šæ˜¯ Java é’ˆå¯¹ RESTï¼ˆRepresentation State Transferï¼‰æ¶æ„é£æ ¼åˆ¶å®šçš„ä¸€å¥— Web Service è§„èŒƒã€‚REST æ˜¯ä¸€ç§è½¯ä»¶æ¶æ„æ¨¡å¼ï¼Œæ˜¯ä¸€ç§é£æ ¼ï¼Œå®ƒä¸åƒ SOAP é‚£æ ·æœ¬èº«æ‰¿è½½ç€ä¸€ç§æ¶ˆæ¯åè®®ï¼Œ (ä¸¤ç§é£æ ¼çš„ Web Service å‡é‡‡ç”¨äº† HTTP åšä¼ è¾“åè®®ï¼Œå› ä¸º HTTP åè®®èƒ½ç©¿è¶Šé˜²ç«å¢™ï¼ŒJava çš„è¿œç¨‹æ–¹æ³•è°ƒç”¨ï¼ˆRMIï¼‰ç­‰æ˜¯é‡é‡çº§åè®®ï¼Œé€šå¸¸ä¸èƒ½ç©¿è¶Šé˜²ç«å¢™ï¼‰ï¼Œå› æ­¤å¯ä»¥å°† REST è§†ä¸ºåŸºäº HTTP åè®®çš„è½¯ä»¶æ¶æ„ã€‚REST ä¸­æœ€é‡è¦çš„ä¸¤ä¸ªæ¦‚å¿µæ˜¯èµ„æºå®šä½å’Œèµ„æºæ“ä½œï¼Œè€Œ HTTP åè®®æ°å¥½å®Œæ•´çš„æä¾›äº†è¿™ä¸¤ä¸ªç‚¹ã€‚HTTP åè®®ä¸­çš„ URI å¯ä»¥å®Œæˆèµ„æºå®šä½ï¼Œè€Œ GETã€POSTã€OPTIONã€DELETE æ–¹æ³•å¯ä»¥å®Œæˆèµ„æºæ“ä½œã€‚å› æ­¤ REST å®Œå…¨ä¾èµ– HTTP åè®®å°±å¯ä»¥å®Œæˆ Web Serviceï¼Œè€Œä¸åƒ SOAP åè®®é‚£æ ·åªåˆ©ç”¨äº† HTTP çš„ä¼ è¾“ç‰¹æ€§ï¼Œå®šä½å’Œæ“ä½œéƒ½æ˜¯ç”± SOAP åè®®è‡ªèº«å®Œæˆçš„ï¼Œä¹Ÿæ­£æ˜¯ç”±äº SOAP æ¶ˆæ¯çš„å­˜åœ¨ä½¿å¾—åŸºäº SOAP çš„ Web Service æ˜¾å¾—ç¬¨é‡è€Œé€æ¸è¢«æ·˜æ±°ã€‚</li>
</ul>
<blockquote>
<p>125ã€ä»‹ç»ä¸€ä¸‹ä½ äº†è§£çš„ Java é¢†åŸŸçš„ Web Service æ¡†æ¶ã€‚</p>
</blockquote>
<p>ç­”ï¼šJava é¢†åŸŸçš„ Web Service æ¡†æ¶å¾ˆå¤šï¼ŒåŒ…æ‹¬ Axis2ï¼ˆAxis çš„å‡çº§ç‰ˆæœ¬ï¼‰ã€Jerseyï¼ˆRESTful çš„ Web Service æ¡†æ¶ï¼‰ã€CXFï¼ˆXFire çš„å»¶ç»­ç‰ˆæœ¬ï¼‰ã€Hessianã€Turmericã€JBoss SOA ç­‰ï¼Œå…¶ä¸­ç»å¤§å¤šæ•°éƒ½æ˜¯å¼€æºæ¡†æ¶ã€‚</p>
<p><strong>æ³¨æ„ï¼š</strong>é¢è¯•è¢«é—®åˆ°è¿™ç±»é—®é¢˜çš„æ—¶å€™ä¸€å®šé€‰æ‹©è‡ªå·±ç”¨è¿‡çš„æœ€ç†Ÿæ‚‰çš„ä½œç­”ï¼Œå¦‚æœä¹‹å‰æ²¡æœ‰äº†è§£è¿‡å°±åº”è¯¥åœ¨é¢è¯•å‰èŠ±ä¸€äº›æ—¶é—´äº†è§£å…¶ä¸­çš„ä¸¤ä¸ªï¼Œå¹¶æ¯”è¾ƒå…¶ä¼˜ç¼ºç‚¹ï¼Œè¿™æ ·æ‰èƒ½åœ¨é¢è¯•æ—¶ç»™å‡ºä¸€ä¸ªæ¼‚äº®çš„ç­”æ¡ˆã€‚</p>
<h1 id="Java-EE-æ¡†æ¶ï¼ˆ126-170ï¼‰"><a href="#Java-EE-æ¡†æ¶ï¼ˆ126-170ï¼‰" class="headerlink" title="Java EE æ¡†æ¶ï¼ˆ126~170ï¼‰"></a>Java EE æ¡†æ¶ï¼ˆ126~170ï¼‰</h1><blockquote>
<p>126ã€ä»€ä¹ˆæ˜¯ ORMï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šå¯¹è±¡å…³ç³»æ˜ å°„ï¼ˆObject-Relational Mappingï¼Œç®€ç§° ORMï¼‰æ˜¯ä¸€ç§ä¸ºäº†è§£å†³ç¨‹åºçš„é¢å‘å¯¹è±¡æ¨¡å‹ä¸æ•°æ®åº“çš„å…³ç³»æ¨¡å‹äº’ä¸åŒ¹é…é—®é¢˜çš„æŠ€æœ¯ï¼›ç®€å•çš„è¯´ï¼ŒORM æ˜¯é€šè¿‡ä½¿ç”¨æè¿°å¯¹è±¡å’Œæ•°æ®åº“ä¹‹é—´æ˜ å°„çš„å…ƒæ•°æ®ï¼ˆåœ¨ Java ä¸­å¯ä»¥ç”¨ XML æˆ–è€…æ˜¯æ³¨è§£ï¼‰ï¼Œå°†ç¨‹åºä¸­çš„å¯¹è±¡è‡ªåŠ¨æŒä¹…åŒ–åˆ°å…³ç³»æ•°æ®åº“ä¸­æˆ–è€…å°†å…³ç³»æ•°æ®åº“è¡¨ä¸­çš„è¡Œè½¬æ¢æˆ Java å¯¹è±¡ï¼Œå…¶æœ¬è´¨ä¸Šå°±æ˜¯å°†æ•°æ®ä»ä¸€ç§å½¢å¼è½¬æ¢åˆ°å¦å¤–ä¸€ç§å½¢å¼ã€‚</p>
<blockquote>
<p>127ã€æŒä¹…å±‚è®¾è®¡è¦è€ƒè™‘çš„é—®é¢˜æœ‰å“ªäº›ï¼Ÿä½ ç”¨è¿‡çš„æŒä¹…å±‚æ¡†æ¶æœ‰å“ªäº›ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šæ‰€è°“â€œæŒä¹…â€å°±æ˜¯å°†æ•°æ®ä¿å­˜åˆ°å¯æ‰ç”µå¼å­˜å‚¨è®¾å¤‡ä¸­ä»¥ä¾¿ä»Šåä½¿ç”¨ï¼Œç®€å•çš„è¯´ï¼Œå°±æ˜¯å°†å†…å­˜ä¸­çš„æ•°æ®ä¿å­˜åˆ°å…³ç³»å‹æ•°æ®åº“ã€æ–‡ä»¶ç³»ç»Ÿã€æ¶ˆæ¯é˜Ÿåˆ—ç­‰æä¾›æŒä¹…åŒ–æ”¯æŒçš„è®¾å¤‡ä¸­ã€‚æŒä¹…å±‚å°±æ˜¯ç³»ç»Ÿä¸­ä¸“æ³¨äºå®ç°æ•°æ®æŒä¹…åŒ–çš„ç›¸å¯¹ç‹¬ç«‹çš„å±‚é¢ã€‚</p>
<p>æŒä¹…å±‚è®¾è®¡çš„ç›®æ ‡åŒ…æ‹¬ï¼š</p>
<ul>
<li>æ•°æ®å­˜å‚¨é€»è¾‘çš„åˆ†ç¦»ï¼Œæä¾›æŠ½è±¡åŒ–çš„æ•°æ®è®¿é—®æ¥å£ã€‚</li>
<li>æ•°æ®è®¿é—®åº•å±‚å®ç°çš„åˆ†ç¦»ï¼Œå¯ä»¥åœ¨ä¸ä¿®æ”¹ä»£ç çš„æƒ…å†µä¸‹åˆ‡æ¢åº•å±‚å®ç°ã€‚</li>
<li>èµ„æºç®¡ç†å’Œè°ƒåº¦çš„åˆ†ç¦»ï¼Œåœ¨æ•°æ®è®¿é—®å±‚å®ç°ç»Ÿä¸€çš„èµ„æºè°ƒåº¦ï¼ˆå¦‚ç¼“å­˜æœºåˆ¶ï¼‰ã€‚</li>
<li>æ•°æ®æŠ½è±¡ï¼Œæä¾›æ›´é¢å‘å¯¹è±¡çš„æ•°æ®æ“ä½œã€‚</li>
</ul>
<p>æŒä¹…å±‚æ¡†æ¶æœ‰ï¼š</p>
<ul>
<li>Hibernate</li>
<li>MyBatis</li>
<li>TopLink</li>
<li>Guzz</li>
<li>jOOQ</li>
<li>Spring Data</li>
<li>ActiveJDBC</li>
</ul>
<blockquote>
<p>128ã€Hibernate ä¸­ SessionFactory æ˜¯çº¿ç¨‹å®‰å…¨çš„å—ï¼ŸSession æ˜¯çº¿ç¨‹å®‰å…¨çš„å—ï¼ˆä¸¤ä¸ªçº¿ç¨‹èƒ½å¤Ÿå…±äº«åŒä¸€ä¸ª Session å—ï¼‰ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šSessionFactory å¯¹åº” Hibernate çš„ä¸€ä¸ªæ•°æ®å­˜å‚¨çš„æ¦‚å¿µï¼Œå®ƒæ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå¯ä»¥è¢«å¤šä¸ªçº¿ç¨‹å¹¶å‘è®¿é—®ã€‚SessionFactory ä¸€èˆ¬åªä¼šåœ¨å¯åŠ¨çš„æ—¶å€™æ„å»ºã€‚å¯¹äºåº”ç”¨ç¨‹åºï¼Œæœ€å¥½å°† SessionFactory é€šè¿‡å•ä¾‹æ¨¡å¼è¿›è¡Œå°è£…ä»¥ä¾¿äºè®¿é—®ã€‚Session æ˜¯ä¸€ä¸ªè½»é‡çº§éçº¿ç¨‹å®‰å…¨çš„å¯¹è±¡ï¼ˆçº¿ç¨‹é—´ä¸èƒ½å…±äº« Sessionï¼‰ï¼Œå®ƒè¡¨ç¤ºä¸æ•°æ®åº“è¿›è¡Œäº¤äº’çš„ä¸€ä¸ªå·¥ä½œå•å…ƒã€‚Session æ˜¯ç”± SessionFactory åˆ›å»ºçš„ï¼Œåœ¨ä»»åŠ¡å®Œæˆä¹‹åå®ƒä¼šè¢«å…³é—­ã€‚Session æ˜¯æŒä¹…å±‚æœåŠ¡å¯¹å¤–æä¾›çš„ä¸»è¦æ¥å£ã€‚Session ä¼šå»¶è¿Ÿè·å–æ•°æ®åº“è¿æ¥ï¼ˆä¹Ÿå°±æ˜¯åœ¨éœ€è¦çš„æ—¶å€™æ‰ä¼šè·å–ï¼‰ã€‚ä¸ºäº†é¿å…åˆ›å»ºå¤ªå¤šçš„ Sessionï¼Œå¯ä»¥ä½¿ç”¨ <code>ThreadLocal</code> å°† Session å’Œå½“å‰çº¿ç¨‹ç»‘å®šåœ¨ä¸€èµ·ï¼Œè¿™æ ·å¯ä»¥è®©åŒä¸€ä¸ªçº¿ç¨‹è·å¾—çš„æ€»æ˜¯åŒä¸€ä¸ª Sessionã€‚Hibernate 3 ä¸­ SessionFactory çš„ <code>getCurrentSession()</code> æ–¹æ³•å°±å¯ä»¥åšåˆ°ã€‚</p>
<blockquote>
<p>129ã€Hibernate ä¸­ Session çš„ <code>load</code> å’Œ <code>get</code> æ–¹æ³•çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šä¸»è¦æœ‰ä»¥ä¸‹ä¸‰é¡¹åŒºåˆ«ï¼š</p>
<ol>
<li>å¦‚æœæ²¡æœ‰æ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„è®°å½•ï¼Œ<code>get</code> æ–¹æ³•è¿”å› <code>null</code>ï¼Œ<code>load</code> æ–¹æ³•æŠ›å‡ºå¼‚å¸¸ã€‚</li>
<li><code>get</code> æ–¹æ³•ç›´æ¥è¿”å›å®ä½“ç±»å¯¹è±¡ï¼Œ<code>load</code> æ–¹æ³•è¿”å›å®ä½“ç±»å¯¹è±¡çš„ä»£ç†ã€‚</li>
<li>åœ¨ Hibernate 3 ä¹‹å‰ï¼Œ<code>get</code> æ–¹æ³•åªåœ¨ä¸€çº§ç¼“å­˜ä¸­è¿›è¡Œæ•°æ®æŸ¥æ‰¾ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°å¯¹åº”çš„æ•°æ®åˆ™è¶Šè¿‡äºŒçº§ç¼“å­˜ï¼Œç›´æ¥å‘å‡º SQL è¯­å¥å®Œæˆæ•°æ®è¯»å–ï¼›<code>load</code> æ–¹æ³•åˆ™å¯ä»¥ä»äºŒçº§ç¼“å­˜ä¸­è·å–æ•°æ®ï¼›ä» Hibernate 3 å¼€å§‹ï¼Œ<code>get</code> æ–¹æ³•ä¸å†æ˜¯å¯¹äºŒçº§ç¼“å­˜åªå†™ä¸è¯»ï¼Œå®ƒä¹Ÿæ˜¯å¯ä»¥è®¿é—®äºŒçº§ç¼“å­˜çš„ã€‚</li>
</ol>
<p><strong>è¯´æ˜ï¼š</strong>å¯¹äº <code>load()</code> æ–¹æ³• Hibernate è®¤ä¸ºè¯¥æ•°æ®åœ¨æ•°æ®åº“ä¸­ä¸€å®šå­˜åœ¨å¯ä»¥æ”¾å¿ƒçš„ä½¿ç”¨ä»£ç†æ¥å®ç°å»¶è¿ŸåŠ è½½ï¼Œå¦‚æœæ²¡æœ‰æ•°æ®å°±æŠ›å‡ºå¼‚å¸¸ï¼Œè€Œé€šè¿‡ <code>get()</code> æ–¹æ³•è·å–çš„æ•°æ®å¯ä»¥ä¸å­˜åœ¨ã€‚</p>
<blockquote>
<p>130ã€Session çš„ <code>save()</code>ã€<code>update()</code>ã€<code>merge()</code>ã€<code>lock()</code>ã€<code>saveOrUpdate()</code>å’Œ <code>persist()</code> æ–¹æ³•åˆ†åˆ«æ˜¯åšä»€ä¹ˆçš„ï¼Ÿæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šHibernate çš„å¯¹è±¡æœ‰ä¸‰ç§çŠ¶æ€ï¼šç¬æ—¶æ€ï¼ˆtransientï¼‰ã€æŒä¹…æ€ï¼ˆpersistentï¼‰å’Œæ¸¸ç¦»æ€ï¼ˆdetachedï¼‰ï¼Œå¦‚ç¬¬ 135 é¢˜ä¸­çš„å›¾æ‰€ç¤ºã€‚ç¬æ—¶æ€çš„å®ä¾‹å¯ä»¥é€šè¿‡è°ƒç”¨ <code>save()</code>ã€<code>persist()</code> æˆ–è€… <code>saveOrUpdate()</code> æ–¹æ³•å˜æˆæŒä¹…æ€ï¼›æ¸¸ç¦»æ€çš„å®ä¾‹å¯ä»¥é€šè¿‡è°ƒç”¨ <code>update()</code>ã€<code>saveOrUpdate()</code>ã€<code>lock()</code> æˆ–è€… <code>replicate()</code> å˜æˆæŒä¹…æ€ã€‚<code>save()</code> å’Œ <code>persist()</code> å°†ä¼šå¼•å‘ SQL çš„ <code>INSERT</code> è¯­å¥ï¼Œè€Œ <code>update()</code> æˆ– <code>merge()</code> ä¼šå¼•å‘ <code>UPDATE</code> è¯­å¥ã€‚<code>save()</code> å’Œ <code>update()</code> çš„åŒºåˆ«åœ¨äºä¸€ä¸ªæ˜¯å°†ç¬æ—¶æ€å¯¹è±¡å˜æˆæŒä¹…æ€ï¼Œä¸€ä¸ªæ˜¯å°†æ¸¸ç¦»æ€å¯¹è±¡å˜ä¸ºæŒä¹…æ€ã€‚<code>merge()</code> æ–¹æ³•å¯ä»¥å®Œæˆ <code>save()</code> å’Œ <code>update()</code> æ–¹æ³•çš„åŠŸèƒ½ï¼Œå®ƒçš„æ„å›¾æ˜¯å°†æ–°çš„çŠ¶æ€åˆå¹¶åˆ°å·²æœ‰çš„æŒä¹…åŒ–å¯¹è±¡ä¸Šæˆ–åˆ›å»ºæ–°çš„æŒä¹…åŒ–å¯¹è±¡ã€‚å¯¹äº <code>persist()</code> æ–¹æ³•ï¼ŒæŒ‰ç…§å®˜æ–¹æ–‡æ¡£çš„è¯´æ˜ï¼š(1)<code>persist()</code> æ–¹æ³•æŠŠä¸€ä¸ªç¬æ—¶æ€çš„å®ä¾‹æŒä¹…åŒ–ï¼Œä½†æ˜¯å¹¶ä¸ä¿è¯æ ‡è¯†ç¬¦è¢«ç«‹åˆ»å¡«å…¥åˆ°æŒä¹…åŒ–å®ä¾‹ä¸­ï¼Œæ ‡è¯†ç¬¦çš„å¡«å…¥å¯èƒ½è¢«æ¨è¿Ÿåˆ° <code>flush</code> çš„æ—¶é—´ï¼›(2)<code>persist()</code> æ–¹æ³•ä¿è¯å½“å®ƒåœ¨ä¸€ä¸ªäº‹åŠ¡å¤–éƒ¨è¢«è°ƒç”¨çš„æ—¶å€™å¹¶ä¸è§¦å‘ä¸€ä¸ª <code>INSERT</code> è¯­å¥ï¼Œå½“éœ€è¦å°è£…ä¸€ä¸ªé•¿ä¼šè¯æµç¨‹çš„æ—¶å€™ï¼Œ<code>persist()</code> æ–¹æ³•æ˜¯å¾ˆæœ‰å¿…è¦çš„ï¼›(3)<code>save()</code> æ–¹æ³•ä¸ä¿è¯ç¬¬(2)æ¡ï¼Œå®ƒè¦è¿”å›æ ‡è¯†ç¬¦ï¼Œæ‰€ä»¥å®ƒä¼šç«‹å³æ‰§è¡Œ <code>INSERT</code> è¯­å¥ï¼Œä¸ç®¡æ˜¯åœ¨äº‹åŠ¡å†…éƒ¨è¿˜æ˜¯å¤–éƒ¨ã€‚è‡³äº <code>lock()</code> æ–¹æ³•å’Œ <code>update()</code> æ–¹æ³•çš„åŒºåˆ«ï¼Œ<code>update()</code> æ–¹æ³•æ˜¯æŠŠä¸€ä¸ªå·²ç»æ›´æ”¹è¿‡çš„è„±ç®¡çŠ¶æ€çš„å¯¹è±¡å˜æˆæŒä¹…çŠ¶æ€ï¼›<code>lock()</code> æ–¹æ³•æ˜¯æŠŠä¸€ä¸ªæ²¡æœ‰æ›´æ”¹è¿‡çš„è„±ç®¡çŠ¶æ€çš„å¯¹è±¡å˜æˆæŒä¹…çŠ¶æ€ã€‚</p>
<blockquote>
<p>131ã€é˜è¿° Session åŠ è½½å®ä½“å¯¹è±¡çš„è¿‡ç¨‹ã€‚</p>
</blockquote>
<p>ç­”ï¼šSession åŠ è½½å®ä½“å¯¹è±¡çš„æ­¥éª¤æ˜¯ï¼š</p>
<ol>
<li>Session åœ¨è°ƒç”¨æ•°æ®åº“æŸ¥è¯¢åŠŸèƒ½ä¹‹å‰ï¼Œé¦–å…ˆä¼šåœ¨ä¸€çº§ç¼“å­˜ä¸­é€šè¿‡å®ä½“ç±»å‹å’Œä¸»é”®è¿›è¡ŒæŸ¥æ‰¾ï¼Œå¦‚æœä¸€çº§ç¼“å­˜æŸ¥æ‰¾å‘½ä¸­ä¸”æ•°æ®çŠ¶æ€åˆæ³•ï¼Œåˆ™ç›´æ¥è¿”å›ï¼›</li>
<li>å¦‚æœä¸€çº§ç¼“å­˜æ²¡æœ‰å‘½ä¸­ï¼Œæ¥ä¸‹æ¥ Session ä¼šåœ¨å½“å‰ <code>NonExists</code> è®°å½•ï¼ˆç›¸å½“äºä¸€ä¸ªæŸ¥è¯¢é»‘åå•ï¼Œå¦‚æœå‡ºç°é‡å¤çš„æ— æ•ˆæŸ¥è¯¢å¯ä»¥è¿…é€Ÿåšå‡ºåˆ¤æ–­ï¼Œä»è€Œæå‡æ€§èƒ½ï¼‰ä¸­è¿›è¡ŒæŸ¥æ‰¾ï¼Œå¦‚æœ <code>NonExists</code> ä¸­å­˜åœ¨åŒæ ·çš„æŸ¥è¯¢æ¡ä»¶ï¼Œåˆ™è¿”å› <code>null</code>ï¼›</li>
<li>å¦‚æœä¸€çº§ç¼“å­˜æŸ¥è¯¢å¤±è´¥åˆ™æŸ¥è¯¢äºŒçº§ç¼“å­˜ï¼Œå¦‚æœäºŒçº§ç¼“å­˜å‘½ä¸­åˆ™ç›´æ¥è¿”å›ï¼›</li>
<li>å¦‚æœä¹‹å‰çš„æŸ¥è¯¢éƒ½æœªå‘½ä¸­ï¼Œåˆ™å‘å‡º SQL è¯­å¥ï¼Œå¦‚æœæŸ¥è¯¢æœªå‘ç°å¯¹åº”è®°å½•åˆ™å°†æ­¤æ¬¡æŸ¥è¯¢æ·»åŠ åˆ° Session çš„ <code>NonExists</code> ä¸­åŠ ä»¥è®°å½•ï¼Œå¹¶è¿”å› <code>null</code>ï¼›</li>
<li>æ ¹æ®æ˜ å°„é…ç½®å’Œ SQL è¯­å¥å¾—åˆ° <code>ResultSet</code>ï¼Œå¹¶åˆ›å»ºå¯¹åº”çš„å®ä½“å¯¹è±¡ï¼›</li>
<li>å°†å¯¹è±¡çº³å…¥ Sessionï¼ˆä¸€çº§ç¼“å­˜ï¼‰çš„ç®¡ç†ï¼›</li>
<li>å¦‚æœæœ‰å¯¹åº”çš„æ‹¦æˆªå™¨ï¼Œåˆ™æ‰§è¡Œæ‹¦æˆªå™¨çš„ <code>onLoad</code> æ–¹æ³•ï¼›</li>
<li>å¦‚æœå¼€å¯å¹¶è®¾ç½®äº†è¦ä½¿ç”¨äºŒçº§ç¼“å­˜ï¼Œåˆ™å°†æ•°æ®å¯¹è±¡çº³å…¥äºŒçº§ç¼“å­˜ï¼›</li>
<li>è¿”å›æ•°æ®å¯¹è±¡ã€‚</li>
</ol>
<blockquote>
<p>132ã€<code>Query</code> æ¥å£çš„ <code>list</code> æ–¹æ³•å’Œ <code>iterate</code> æ–¹æ³•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼š</p>
<ul>
<li><code>list()</code> æ–¹æ³•æ— æ³•åˆ©ç”¨ä¸€çº§ç¼“å­˜å’ŒäºŒçº§ç¼“å­˜ï¼ˆå¯¹ç¼“å­˜åªå†™ä¸è¯»ï¼‰ï¼Œå®ƒåªèƒ½åœ¨å¼€å¯æŸ¥è¯¢ç¼“å­˜çš„å‰æä¸‹ä½¿ç”¨æŸ¥è¯¢ç¼“å­˜ï¼›<code>iterate()</code> æ–¹æ³•å¯ä»¥å……åˆ†åˆ©ç”¨ç¼“å­˜ï¼Œå¦‚æœç›®æ ‡æ•°æ®åªè¯»æˆ–è€…è¯»å–é¢‘ç¹ï¼Œä½¿ç”¨ <code>iterate()</code> æ–¹æ³•å¯ä»¥å‡å°‘æ€§èƒ½å¼€é”€ã€‚</li>
<li><code>list()</code> æ–¹æ³•ä¸ä¼šå¼•èµ· N+1 æŸ¥è¯¢é—®é¢˜ï¼Œè€Œ <code>iterate()</code> æ–¹æ³•å¯èƒ½å¼•èµ· N+1 æŸ¥è¯¢é—®é¢˜</li>
</ul>
<p><strong>è¯´æ˜ï¼š</strong>å…³äº N+1 æŸ¥è¯¢é—®é¢˜ï¼Œå¯ä»¥å‚è€ƒ CSDN çš„ä¸€ç¯‡æ–‡ç« <a target="_blank" rel="noopener" href="http://blog.csdn.net/xtayhicbladwin/article/details/4739852">ã€Šä»€ä¹ˆæ˜¯N+1æŸ¥è¯¢ã€‹</a></p>
<blockquote>
<p>133ã€Hibernate å¦‚ä½•å®ç°åˆ†é¡µæŸ¥è¯¢ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šé€šè¿‡ Hibernate å®ç°åˆ†é¡µæŸ¥è¯¢ï¼Œå¼€å‘äººå‘˜åªéœ€è¦æä¾› HQL è¯­å¥ï¼ˆè°ƒç”¨ Session çš„ <code>createQuery()</code> æ–¹æ³•ï¼‰æˆ–æŸ¥è¯¢æ¡ä»¶ï¼ˆè°ƒç”¨ Session çš„ <code>createCriteria()</code> æ–¹æ³•ï¼‰ã€è®¾ç½®æŸ¥è¯¢èµ·å§‹è¡Œæ•°ï¼ˆè°ƒç”¨ <code>Query</code> æˆ– <code>Criteria</code> æ¥å£çš„ <code>setFirstResult()</code> æ–¹æ³•ï¼‰å’Œæœ€å¤§æŸ¥è¯¢è¡Œæ•°ï¼ˆè°ƒç”¨ <code>Query</code> æˆ– <code>Criteria</code> æ¥å£çš„ <code>setMaxResults()</code> æ–¹æ³•ï¼‰ï¼Œå¹¶è°ƒç”¨ <code>Query</code> æˆ– <code>Criteria</code> æ¥å£çš„ <code>list()</code> æ–¹æ³•ï¼ŒHibernate ä¼šè‡ªåŠ¨ç”Ÿæˆåˆ†é¡µæŸ¥è¯¢çš„ SQL è¯­å¥ã€‚</p>
<blockquote>
<p>134ã€é”æœºåˆ¶æœ‰ä»€ä¹ˆç”¨ï¼Ÿç®€è¿° Hibernate çš„æ‚²è§‚é”å’Œä¹è§‚é”æœºåˆ¶ã€‚</p>
</blockquote>
<p>ç­”ï¼šæœ‰äº›ä¸šåŠ¡é€»è¾‘åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­è¦æ±‚å¯¹æ•°æ®è¿›è¡Œæ’ä»–æ€§çš„è®¿é—®ï¼Œäºæ˜¯éœ€è¦é€šè¿‡ä¸€äº›æœºåˆ¶ä¿è¯åœ¨æ­¤è¿‡ç¨‹ä¸­æ•°æ®è¢«é”ä½ä¸ä¼šè¢«å¤–ç•Œä¿®æ”¹ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„é”æœºåˆ¶ã€‚</p>
<p>Hibernate æ”¯æŒæ‚²è§‚é”å’Œä¹è§‚é”ä¸¤ç§é”æœºåˆ¶ã€‚</p>
<ul>
<li><p>æ‚²è§‚é”ï¼Œé¡¾åæ€ä¹‰æ‚²è§‚çš„è®¤ä¸ºåœ¨æ•°æ®å¤„ç†è¿‡ç¨‹ä¸­ææœ‰å¯èƒ½å­˜åœ¨ä¿®æ”¹æ•°æ®çš„å¹¶å‘äº‹åŠ¡ï¼ˆåŒ…æ‹¬æœ¬ç³»ç»Ÿçš„å…¶ä»–äº‹åŠ¡æˆ–æ¥è‡ªå¤–éƒ¨ç³»ç»Ÿçš„äº‹åŠ¡ï¼‰ï¼Œäºæ˜¯å°†å¤„ç†çš„æ•°æ®è®¾ç½®ä¸ºé”å®šçŠ¶æ€ã€‚æ‚²è§‚é”å¿…é¡»ä¾èµ–æ•°æ®åº“æœ¬èº«çš„é”æœºåˆ¶æ‰èƒ½çœŸæ­£ä¿è¯æ•°æ®è®¿é—®çš„æ’ä»–æ€§ï¼Œå…³äºæ•°æ®åº“çš„é”æœºåˆ¶å’Œäº‹åŠ¡éš”ç¦»çº§åˆ«åœ¨å‰é¢å·²ç»è®¨è®ºè¿‡äº†ã€‚</p>
</li>
<li><p>ä¹è§‚é”ï¼Œé¡¾åæ€ä¹‰ï¼Œå¯¹å¹¶å‘äº‹åŠ¡æŒä¹è§‚æ€åº¦ï¼ˆè®¤ä¸ºå¯¹æ•°æ®çš„å¹¶å‘æ“ä½œä¸ä¼šç»å¸¸æ€§çš„å‘ç”Ÿï¼‰ï¼Œé€šè¿‡æ›´åŠ å®½æ¾çš„é”æœºåˆ¶æ¥è§£å†³ç”±äºæ‚²è§‚é”æ’ä»–æ€§çš„æ•°æ®è®¿é—®å¯¹ç³»ç»Ÿæ€§èƒ½é€ æˆçš„ä¸¥é‡å½±å“ã€‚æœ€å¸¸è§çš„ä¹è§‚é”æ˜¯é€šè¿‡æ•°æ®ç‰ˆæœ¬æ ‡è¯†æ¥å®ç°çš„ï¼Œè¯»å–æ•°æ®æ—¶è·å¾—æ•°æ®çš„ç‰ˆæœ¬å·ï¼Œæ›´æ–°æ•°æ®æ—¶å°†æ­¤ç‰ˆæœ¬å·åŠ  1ï¼Œç„¶åå’Œæ•°æ®åº“è¡¨å¯¹åº”è®°å½•çš„å½“å‰ç‰ˆæœ¬å·è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœæäº¤çš„æ•°æ®ç‰ˆæœ¬å·å¤§äºæ•°æ®åº“ä¸­æ­¤è®°å½•çš„å½“å‰ç‰ˆæœ¬å·åˆ™æ›´æ–°æ•°æ®ï¼Œå¦åˆ™è®¤ä¸ºæ˜¯è¿‡æœŸæ•°æ®æ— æ³•æ›´æ–°ã€‚Hibernate ä¸­é€šè¿‡ Session çš„ <code>get()</code> å’Œ <code>load()</code> æ–¹æ³•ä»æ•°æ®åº“ä¸­åŠ è½½å¯¹è±¡æ—¶å¯ä»¥é€šè¿‡å‚æ•°æŒ‡å®šä½¿ç”¨æ‚²è§‚é”ï¼›è€Œä¹è§‚é”å¯ä»¥é€šè¿‡ç»™å®ä½“ç±»åŠ æ•´å‹çš„ç‰ˆæœ¬å­—æ®µå†é€šè¿‡ XML æˆ– <code>@Version</code> æ³¨è§£è¿›è¡Œé…ç½®ã€‚</p>
</li>
</ul>
<p><strong>æ³¨æ„ï¼š</strong>ä½¿ç”¨ä¹è§‚é”ä¼šå¢åŠ äº†ä¸€ä¸ªç‰ˆæœ¬å­—æ®µï¼Œå¾ˆæ˜æ˜¾è¿™éœ€è¦é¢å¤–çš„ç©ºé—´æ¥å­˜å‚¨è¿™ä¸ªç‰ˆæœ¬å­—æ®µï¼Œæµªè´¹äº†ç©ºé—´ï¼Œä½†æ˜¯ä¹è§‚é”ä¼šè®©ç³»ç»Ÿå…·æœ‰æ›´å¥½çš„å¹¶å‘æ€§ï¼Œè¿™æ˜¯å¯¹æ—¶é—´çš„èŠ‚çœã€‚å› æ­¤ä¹è§‚é”ä¹Ÿæ˜¯å…¸å‹çš„ç©ºé—´æ¢æ—¶é—´çš„ç­–ç•¥ã€‚</p>
<blockquote>
<p>135ã€é˜è¿°å®ä½“å¯¹è±¡çš„ä¸‰ç§çŠ¶æ€ä»¥åŠè½¬æ¢å…³ç³»ã€‚</p>
</blockquote>
<p>ç­”ï¼šæœ€æ–°çš„ Hibernate æ–‡æ¡£ä¸­ä¸º Hibernate å¯¹è±¡å®šä¹‰äº†å››ç§çŠ¶æ€ï¼ˆåŸæ¥æ˜¯ä¸‰ç§çŠ¶æ€ï¼Œé¢è¯•çš„æ—¶å€™åŸºæœ¬ä¸Šé—®çš„ä¹Ÿæ˜¯ä¸‰ç§çŠ¶æ€ï¼‰ï¼Œåˆ†åˆ«æ˜¯ï¼š<strong>ç¬æ—¶æ€</strong>ï¼ˆnew, or transientï¼‰ã€<strong>æŒä¹…æ€</strong>ï¼ˆmanaged, or persistentï¼‰ã€<strong>æ¸¸çŠ¶æ€</strong>ï¼ˆdetachedï¼‰å’Œ<strong>ç§»é™¤æ€</strong>ï¼ˆremovedï¼Œä»¥å‰ Hibernate æ–‡æ¡£ä¸­å®šä¹‰çš„ä¸‰ç§çŠ¶æ€ä¸­æ²¡æœ‰ç§»é™¤æ€ï¼‰ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå°±ä»¥å‰çš„Hibernateæ–‡æ¡£ä¸­ç§»é™¤æ€è¢«è§†ä¸ºæ˜¯ç¬æ—¶æ€ã€‚</p>
<p><img src= "https://cdn.jsdelivr.net/gh/Eurkon/CDN/hexo/images/user/loading.gif" data-lazy-src="/images/post/java_interview/135.png" alt></p>
<ul>
<li><p>ç¬æ—¶æ€ï¼šå½“ new ä¸€ä¸ªå®ä½“å¯¹è±¡åï¼Œè¿™ä¸ªå¯¹è±¡å¤„äºç¬æ—¶æ€ï¼Œå³è¿™ä¸ªå¯¹è±¡åªæ˜¯ä¸€ä¸ªä¿å­˜ä¸´æ—¶æ•°æ®çš„å†…å­˜åŒºåŸŸï¼Œå¦‚æœæ²¡æœ‰å˜é‡å¼•ç”¨è¿™ä¸ªå¯¹è±¡ï¼Œåˆ™ä¼šè¢« JVM çš„åƒåœ¾å›æ”¶æœºåˆ¶å›æ”¶ã€‚è¿™ä¸ªå¯¹è±¡æ‰€ä¿å­˜çš„æ•°æ®ä¸æ•°æ®åº“æ²¡æœ‰ä»»ä½•å…³ç³»ï¼Œé™¤éé€šè¿‡ Session çš„ <code>save()</code>ã€<code>saveOrUpdate()</code>ã€<code>persist()</code>ã€<code>merge()</code> æ–¹æ³•æŠŠç¬æ—¶æ€å¯¹è±¡ä¸æ•°æ®åº“å…³è”ï¼Œå¹¶æŠŠæ•°æ®æ’å…¥æˆ–è€…æ›´æ–°åˆ°æ•°æ®åº“ï¼Œè¿™ä¸ªå¯¹è±¡æ‰è½¬æ¢ä¸ºæŒä¹…æ€å¯¹è±¡ã€‚</p>
</li>
<li><p>æŒä¹…æ€ï¼šæŒä¹…æ€å¯¹è±¡çš„å®ä¾‹åœ¨æ•°æ®åº“ä¸­æœ‰å¯¹åº”çš„è®°å½•ï¼Œå¹¶æ‹¥æœ‰ä¸€ä¸ªæŒä¹…åŒ–æ ‡è¯†ï¼ˆIDï¼‰ã€‚å¯¹æŒä¹…æ€å¯¹è±¡è¿›è¡Œ <code>delete</code> æ“ä½œåï¼Œæ•°æ®åº“ä¸­å¯¹åº”çš„è®°å½•å°†è¢«åˆ é™¤ï¼Œé‚£ä¹ˆæŒä¹…æ€å¯¹è±¡ä¸æ•°æ®åº“è®°å½•ä¸å†å­˜åœ¨å¯¹åº”å…³ç³»ï¼ŒæŒä¹…æ€å¯¹è±¡å˜æˆç§»é™¤æ€ï¼ˆå¯ä»¥è§†ä¸ºç¬æ—¶æ€ï¼‰ã€‚æŒä¹…æ€å¯¹è±¡è¢«ä¿®æ”¹å˜æ›´åï¼Œä¸ä¼šé©¬ä¸ŠåŒæ­¥åˆ°æ•°æ®åº“ï¼Œç›´åˆ°æ•°æ®åº“äº‹åŠ¡æäº¤ã€‚</p>
</li>
<li><p>æ¸¸ç¦»æ€ï¼šå½“ Session è¿›è¡Œäº† <code>close()</code>ã€<code>clear()</code>ã€<code>evict()</code> æˆ– <code>flush()</code> åï¼Œå®ä½“å¯¹è±¡ä»æŒä¹…æ€å˜æˆæ¸¸ç¦»æ€ï¼Œå¯¹è±¡è™½ç„¶æ‹¥æœ‰æŒä¹…å’Œä¸æ•°æ®åº“å¯¹åº”è®°å½•ä¸€è‡´çš„æ ‡è¯†å€¼ï¼Œä½†æ˜¯å› ä¸ºå¯¹è±¡å·²ç»ä»ä¼šè¯ä¸­æ¸…é™¤æ‰ï¼Œå¯¹è±¡ä¸åœ¨æŒä¹…åŒ–ç®¡ç†ä¹‹å†…ï¼Œæ‰€ä»¥å¤„äºæ¸¸ç¦»æ€ï¼ˆä¹Ÿå«è„±ç®¡æ€ï¼‰ã€‚æ¸¸ç¦»æ€çš„å¯¹è±¡ä¸ä¸´æ—¶çŠ¶æ€å¯¹è±¡æ˜¯ååˆ†ç›¸ä¼¼çš„ï¼Œåªæ˜¯å®ƒè¿˜å«æœ‰æŒä¹…åŒ–æ ‡è¯†ã€‚</p>
</li>
</ul>
<p><strong>æ³¨æ„ï¼š</strong>å…³äºè¿™ä¸ªé—®é¢˜ï¼Œåœ¨ <a target="_blank" rel="noopener" href="https://docs.jboss.org/hibernate/orm/4.3/devguide/en-US/html_single/">Hibernate çš„å®˜æ–¹æ–‡æ¡£</a>ä¸­æœ‰æ›´ä¸ºè¯¦ç»†çš„è§£è¯»ã€‚</p>
<blockquote>
<p>136ã€å¦‚ä½•ç†è§£ Hibernate çš„å»¶è¿ŸåŠ è½½æœºåˆ¶ï¼Ÿåœ¨å®é™…åº”ç”¨ä¸­ï¼Œå»¶è¿ŸåŠ è½½ä¸ Session å…³é—­çš„çŸ›ç›¾æ˜¯å¦‚ä½•å¤„ç†çš„ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šå»¶è¿ŸåŠ è½½å°±æ˜¯å¹¶ä¸æ˜¯åœ¨è¯»å–çš„æ—¶å€™å°±æŠŠæ•°æ®åŠ è½½è¿›æ¥ï¼Œè€Œæ˜¯ç­‰åˆ°ä½¿ç”¨æ—¶å†åŠ è½½ã€‚Hibernate ä½¿ç”¨äº†è™šæ‹Ÿä»£ç†æœºåˆ¶å®ç°å»¶è¿ŸåŠ è½½ï¼Œæˆ‘ä»¬ä½¿ç”¨ Session çš„ <code>load()</code> æ–¹æ³•åŠ è½½æ•°æ®æˆ–è€…ä¸€å¯¹å¤šå…³è”æ˜ å°„åœ¨ä½¿ç”¨å»¶è¿ŸåŠ è½½çš„æƒ…å†µä¸‹ä»ä¸€çš„ä¸€æ–¹åŠ è½½å¤šçš„ä¸€æ–¹ï¼Œå¾—åˆ°çš„éƒ½æ˜¯è™šæ‹Ÿä»£ç†ï¼Œç®€å•çš„è¯´è¿”å›ç»™ç”¨æˆ·çš„å¹¶ä¸æ˜¯å®ä½“æœ¬èº«ï¼Œè€Œæ˜¯å®ä½“å¯¹è±¡çš„ä»£ç†ã€‚ä»£ç†å¯¹è±¡åœ¨ç”¨æˆ·è°ƒç”¨ <code>getter</code> æ–¹æ³•æ—¶æ‰ä¼šå»æ•°æ®åº“åŠ è½½æ•°æ®ã€‚ä½†åŠ è½½æ•°æ®å°±éœ€è¦æ•°æ®åº“è¿æ¥ã€‚è€Œå½“æˆ‘ä»¬æŠŠä¼šè¯å…³é—­æ—¶ï¼Œæ•°æ®åº“è¿æ¥å°±åŒæ—¶å…³é—­äº†ã€‚</p>
<p>å»¶è¿ŸåŠ è½½ä¸ session å…³é—­çš„çŸ›ç›¾ä¸€èˆ¬å¯ä»¥è¿™æ ·å¤„ç†ï¼š</p>
<ol>
<li>å…³é—­å»¶è¿ŸåŠ è½½ç‰¹æ€§ã€‚è¿™ç§æ–¹å¼æ“ä½œèµ·æ¥æ¯”è¾ƒç®€å•ï¼Œå› ä¸º Hibernate çš„å»¶è¿ŸåŠ è½½ç‰¹æ€§æ˜¯å¯ä»¥é€šè¿‡æ˜ å°„æ–‡ä»¶æˆ–è€…æ³¨è§£è¿›è¡Œé…ç½®çš„ï¼Œä½†è¿™ç§è§£å†³æ–¹æ¡ˆå­˜åœ¨æ˜æ˜¾çš„ç¼ºé™·ã€‚é¦–å…ˆï¼Œå‡ºç° &quot;no session or session was closed&quot; é€šå¸¸è¯´æ˜ç³»ç»Ÿä¸­å·²ç»å­˜åœ¨ä¸»å¤–é”®å…³è”ï¼Œå¦‚æœå»æ‰å»¶è¿ŸåŠ è½½çš„è¯ï¼Œæ¯æ¬¡æŸ¥è¯¢çš„å¼€é”€éƒ½ä¼šå˜å¾—å¾ˆå¤§ã€‚</li>
<li>åœ¨ session å…³é—­ä¹‹å‰å…ˆè·å–éœ€è¦æŸ¥è¯¢çš„æ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨å·¥å…·æ–¹æ³• <code>Hibernate.isInitialized()</code> åˆ¤æ–­å¯¹è±¡æ˜¯å¦è¢«åŠ è½½ï¼Œå¦‚æœæ²¡æœ‰è¢«åŠ è½½åˆ™å¯ä»¥ä½¿ç”¨ <code>Hibernate.initialize()</code> æ–¹æ³•åŠ è½½å¯¹è±¡ã€‚</li>
<li>ä½¿ç”¨æ‹¦æˆªå™¨æˆ–è¿‡æ»¤å™¨å»¶é•¿ Session çš„ç”Ÿå‘½å‘¨æœŸç›´åˆ°è§†å›¾è·å¾—æ•°æ®ã€‚Spring æ•´åˆ Hibernate æä¾›çš„ <code>OpenSessionInViewFilter</code> å’Œ <code>OpenSessionInViewInterceptor</code> å°±æ˜¯è¿™ç§åšæ³•ã€‚</li>
</ol>
<blockquote>
<p>137ã€ä¸¾ä¸€ä¸ªå¤šå¯¹å¤šå…³è”çš„ä¾‹å­ï¼Œå¹¶è¯´æ˜å¦‚ä½•å®ç°å¤šå¯¹å¤šå…³è”æ˜ å°„ã€‚</p>
</blockquote>
<p>ç­”ï¼šä¾‹å¦‚ï¼šå•†å“å’Œè®¢å•ã€å­¦ç”Ÿå’Œè¯¾ç¨‹éƒ½æ˜¯å…¸å‹çš„å¤šå¯¹å¤šå…³ç³»ã€‚å¯ä»¥åœ¨å®ä½“ç±»ä¸Šé€šè¿‡ <code>@ManyToMany</code> æ³¨è§£é…ç½®å¤šå¯¹å¤šå…³è”æˆ–è€…é€šè¿‡æ˜ å°„æ–‡ä»¶ä¸­çš„å’Œæ ‡ç­¾é…ç½®å¤šå¯¹å¤šå…³è”ï¼Œä½†æ˜¯å®é™…é¡¹ç›®å¼€å‘ä¸­ï¼Œå¾ˆå¤šæ—¶å€™éƒ½æ˜¯å°†å¤šå¯¹å¤šå…³è”æ˜ å°„è½¬æ¢æˆä¸¤ä¸ªå¤šå¯¹ä¸€å…³è”æ˜ å°„æ¥å®ç°çš„ã€‚</p>
<blockquote>
<p>138ã€è°ˆä¸€ä¸‹ä½ å¯¹ç»§æ‰¿æ˜ å°„çš„ç†è§£ã€‚</p>
</blockquote>
<p>ç­”ï¼šç»§æ‰¿å…³ç³»çš„æ˜ å°„ç­–ç•¥æœ‰ä¸‰ç§ï¼š</p>
<ul>
<li>æ¯ä¸ªç»§æ‰¿ç»“æ„ä¸€å¼ è¡¨ï¼ˆtable per class hierarchyï¼‰ï¼Œä¸ç®¡å¤šå°‘ä¸ªå­ç±»éƒ½ç”¨ä¸€å¼ è¡¨ã€‚</li>
<li>æ¯ä¸ªå­ç±»ä¸€å¼ è¡¨ï¼ˆtable per subclassï¼‰ï¼Œå…¬å…±ä¿¡æ¯æ”¾ä¸€å¼ è¡¨ï¼Œç‰¹æœ‰ä¿¡æ¯æ”¾å•ç‹¬çš„è¡¨ã€‚</li>
<li>æ¯ä¸ªå…·ä½“ç±»ä¸€å¼ è¡¨ï¼ˆtable per concrete classï¼‰ï¼Œæœ‰å¤šå°‘ä¸ªå­ç±»å°±æœ‰å¤šå°‘å¼ è¡¨ã€‚</li>
</ul>
<p>ç¬¬ä¸€ç§æ–¹å¼å±äºå•è¡¨ç­–ç•¥ï¼Œå…¶ä¼˜ç‚¹åœ¨äºæŸ¥è¯¢å­ç±»å¯¹è±¡çš„æ—¶å€™æ— éœ€è¡¨è¿æ¥ï¼ŒæŸ¥è¯¢é€Ÿåº¦å¿«ï¼Œé€‚åˆå¤šæ€æŸ¥è¯¢ï¼›ç¼ºç‚¹æ˜¯å¯èƒ½å¯¼è‡´è¡¨å¾ˆå¤§ã€‚åä¸¤ç§æ–¹å¼å±äºå¤šè¡¨ç­–ç•¥ï¼Œå…¶ä¼˜ç‚¹åœ¨äºæ•°æ®å­˜å‚¨ç´§å‡‘ï¼Œå…¶ç¼ºç‚¹æ˜¯éœ€è¦è¿›è¡Œè¿æ¥æŸ¥è¯¢ï¼Œä¸é€‚åˆå¤šæ€æŸ¥è¯¢ã€‚</p>
<blockquote>
<p>139ã€ç®€è¿° Hibernate å¸¸è§ä¼˜åŒ–ç­–ç•¥ã€‚</p>
</blockquote>
<p>ç­”ï¼šè¿™ä¸ªé—®é¢˜åº”å½“æŒ‘è‡ªå·±ä½¿ç”¨è¿‡çš„ä¼˜åŒ–ç­–ç•¥å›ç­”ï¼Œå¸¸ç”¨çš„æœ‰ï¼š</p>
<ul>
<li>åˆ¶å®šåˆç†çš„ç¼“å­˜ç­–ç•¥ï¼ˆäºŒçº§ç¼“å­˜ã€æŸ¥è¯¢ç¼“å­˜ï¼‰ã€‚</li>
<li>é‡‡ç”¨åˆç†çš„ Session ç®¡ç†æœºåˆ¶ã€‚</li>
<li>å°½é‡ä½¿ç”¨å»¶è¿ŸåŠ è½½ç‰¹æ€§ã€‚</li>
<li>è®¾å®šåˆç†çš„æ‰¹å¤„ç†å‚æ•°ã€‚</li>
<li>å¦‚æœå¯ä»¥ï¼Œé€‰ç”¨ UUID ä½œä¸ºä¸»é”®ç”Ÿæˆå™¨ã€‚</li>
<li>å¦‚æœå¯ä»¥ï¼Œé€‰ç”¨åŸºäºç‰ˆæœ¬å·çš„ä¹è§‚é”æ›¿ä»£æ‚²è§‚é”ã€‚</li>
<li>åœ¨å¼€å‘è¿‡ç¨‹ä¸­, å¼€å¯ <code>hibernate.show_sql</code> é€‰é¡¹æŸ¥çœ‹ç”Ÿæˆçš„ SQLï¼Œä»è€Œäº†è§£åº•å±‚çš„çŠ¶å†µï¼›å¼€å‘å®Œæˆåå…³é—­æ­¤é€‰é¡¹ã€‚</li>
<li>è€ƒè™‘æ•°æ®åº“æœ¬èº«çš„ä¼˜åŒ–ï¼Œåˆç†çš„ç´¢å¼•ã€æ°å½“çš„æ•°æ®åˆ†åŒºç­–ç•¥ç­‰éƒ½ä¼šå¯¹æŒä¹…å±‚çš„æ€§èƒ½å¸¦æ¥å¯è§‚çš„æå‡ï¼Œä½†è¿™äº›éœ€è¦ä¸“ä¸šçš„ DBAï¼ˆæ•°æ®åº“ç®¡ç†å‘˜ï¼‰æä¾›æ”¯æŒã€‚</li>
</ul>
<blockquote>
<p>140ã€è°ˆä¸€è°ˆ Hibernate çš„ä¸€çº§ç¼“å­˜ã€äºŒçº§ç¼“å­˜å’ŒæŸ¥è¯¢ç¼“å­˜ã€‚</p>
</blockquote>
<p>ç­”ï¼šHibernate çš„ Session æä¾›äº†ä¸€çº§ç¼“å­˜çš„åŠŸèƒ½ï¼Œé»˜è®¤æ€»æ˜¯æœ‰æ•ˆçš„ï¼Œå½“åº”ç”¨ç¨‹åºä¿å­˜æŒä¹…åŒ–å®ä½“ã€ä¿®æ”¹æŒä¹…åŒ–å®ä½“æ—¶ï¼ŒSession å¹¶ä¸ä¼šç«‹å³æŠŠè¿™ç§æ”¹å˜æäº¤åˆ°æ•°æ®åº“ï¼Œè€Œæ˜¯ç¼“å­˜åœ¨å½“å‰çš„ Session ä¸­ï¼Œé™¤éæ˜¾ç¤ºè°ƒç”¨äº† Session çš„ <code>flush()</code> æ–¹æ³•æˆ–é€šè¿‡ <code>close()</code> æ–¹æ³•å…³é—­ Sessionã€‚é€šè¿‡ä¸€çº§ç¼“å­˜ï¼Œå¯ä»¥å‡å°‘ç¨‹åºä¸æ•°æ®åº“çš„äº¤äº’ï¼Œä»è€Œæé«˜æ•°æ®åº“è®¿é—®æ€§èƒ½ã€‚</p>
<p>SessionFactory çº§åˆ«çš„äºŒçº§ç¼“å­˜æ˜¯å…¨å±€æ€§çš„ï¼Œæ‰€æœ‰çš„ Session å¯ä»¥å…±äº«è¿™ä¸ªäºŒçº§ç¼“å­˜ã€‚ä¸è¿‡äºŒçº§ç¼“å­˜é»˜è®¤æ˜¯å…³é—­çš„ï¼Œéœ€è¦æ˜¾ç¤ºå¼€å¯å¹¶æŒ‡å®šéœ€è¦ä½¿ç”¨å“ªç§äºŒçº§ç¼“å­˜å®ç°ç±»ï¼ˆå¯ä»¥ä½¿ç”¨ç¬¬ä¸‰æ–¹æä¾›çš„å®ç°ï¼‰ã€‚ä¸€æ—¦å¼€å¯äº†äºŒçº§ç¼“å­˜å¹¶è®¾ç½®äº†éœ€è¦ä½¿ç”¨äºŒçº§ç¼“å­˜çš„å®ä½“ç±»ï¼ŒSessionFactory å°±ä¼šç¼“å­˜è®¿é—®è¿‡çš„è¯¥å®ä½“ç±»çš„æ¯ä¸ªå¯¹è±¡ï¼Œé™¤éç¼“å­˜çš„æ•°æ®è¶…å‡ºäº†æŒ‡å®šçš„ç¼“å­˜ç©ºé—´ã€‚</p>
<p>ä¸€çº§ç¼“å­˜å’ŒäºŒçº§ç¼“å­˜éƒ½æ˜¯å¯¹æ•´ä¸ªå®ä½“è¿›è¡Œç¼“å­˜ï¼Œä¸ä¼šç¼“å­˜æ™®é€šå±æ€§ï¼Œå¦‚æœå¸Œæœ›å¯¹æ™®é€šå±æ€§è¿›è¡Œç¼“å­˜ï¼Œå¯ä»¥ä½¿ç”¨æŸ¥è¯¢ç¼“å­˜ã€‚æŸ¥è¯¢ç¼“å­˜æ˜¯å°†HQLæˆ–SQLè¯­å¥ä»¥åŠå®ƒä»¬çš„æŸ¥è¯¢ç»“æœä½œä¸ºé”®å€¼å¯¹è¿›è¡Œç¼“å­˜ï¼Œå¯¹äºåŒæ ·çš„æŸ¥è¯¢å¯ä»¥ç›´æ¥ä»ç¼“å­˜ä¸­è·å–æ•°æ®ã€‚æŸ¥è¯¢ç¼“å­˜é»˜è®¤ä¹Ÿæ˜¯å…³é—­çš„ï¼Œéœ€è¦æ˜¾ç¤ºå¼€å¯ã€‚</p>
<blockquote>
<p>141ã€Hibernate ä¸­ DetachedCriteria ç±»æ˜¯åšä»€ä¹ˆçš„ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šDetachedCriteria å’Œ Criteria çš„ç”¨æ³•åŸºæœ¬ä¸Šæ˜¯ä¸€è‡´çš„ï¼Œä½† Criteria æ˜¯ç”± Session çš„ <code>createCriteria()</code> æ–¹æ³•åˆ›å»ºçš„ï¼Œä¹Ÿå°±æ„å‘³ç€ç¦»å¼€åˆ›å»ºå®ƒçš„ Sessionï¼ŒCriteria å°±æ— æ³•ä½¿ç”¨äº†ã€‚DetachedCriteria ä¸éœ€è¦ Session å°±å¯ä»¥åˆ›å»ºï¼ˆä½¿ç”¨ <code>DetachedCriteria.forClass()</code> æ–¹æ³•åˆ›å»ºï¼‰ï¼Œæ‰€ä»¥é€šå¸¸ä¹Ÿç§°å…¶ä¸ºç¦»çº¿çš„ Criteriaï¼Œåœ¨éœ€è¦è¿›è¡ŒæŸ¥è¯¢æ“ä½œçš„æ—¶å€™å†å’Œ Session ç»‘å®šï¼ˆè°ƒç”¨å…¶ <code>getExecutableCriteria(Session)</code> æ–¹æ³•ï¼‰ï¼Œè¿™ä¹Ÿå°±æ„å‘³ç€ä¸€ä¸ª DetachedCriteria å¯ä»¥åœ¨éœ€è¦çš„æ—¶å€™å’Œä¸åŒçš„ Session è¿›è¡Œç»‘å®šã€‚</p>
<blockquote>
<p>142ã€<code>@OneToMany</code> æ³¨è§£çš„ <code>mappedBy</code> å±æ€§æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼š<code>@OneToMany</code> ç”¨æ¥é…ç½®ä¸€å¯¹å¤šå…³è”æ˜ å°„ï¼Œä½†é€šå¸¸æƒ…å†µä¸‹ï¼Œä¸€å¯¹å¤šå…³è”æ˜ å°„éƒ½ç”±å¤šçš„ä¸€æ–¹æ¥ç»´æŠ¤å…³è”å…³ç³»ï¼Œä¾‹å¦‚å­¦ç”Ÿå’Œç­çº§ï¼Œåº”è¯¥åœ¨å­¦ç”Ÿç±»ä¸­æ·»åŠ ç­çº§å±æ€§æ¥ç»´æŒå­¦ç”Ÿå’Œç­çº§çš„å…³è”å…³ç³»ï¼ˆåœ¨æ•°æ®åº“ä¸­æ˜¯ç”±å­¦ç”Ÿè¡¨ä¸­çš„å¤–é”®ç­çº§ç¼–å·æ¥ç»´æŠ¤å­¦ç”Ÿè¡¨å’Œç­çº§è¡¨çš„å¤šå¯¹ä¸€å…³ç³»ï¼‰ï¼Œå¦‚æœè¦ä½¿ç”¨åŒå‘å…³è”ï¼Œåœ¨ç­çº§ç±»ä¸­æ·»åŠ ä¸€ä¸ªå®¹å™¨å±æ€§æ¥å­˜æ”¾å­¦ç”Ÿï¼Œå¹¶ä½¿ç”¨ <code>@OneToMany</code> æ³¨è§£è¿›è¡Œæ˜ å°„ï¼Œæ­¤æ—¶ <code>mappedBy</code> å±æ€§å°±éå¸¸é‡è¦ã€‚å¦‚æœä½¿ç”¨ XML è¿›è¡Œé…ç½®ï¼Œå¯ä»¥ç”¨ <code>&lt;set&gt;</code> æ ‡ç­¾çš„ <code>inverse=&quot;true&quot;</code> è®¾ç½®æ¥è¾¾åˆ°åŒæ ·çš„æ•ˆæœã€‚</p>
<blockquote>
<p>143ã€<code>MyBatis</code> ä¸­ä½¿ç”¨ <code>#</code> å’Œ <code>$</code> ä¹¦å†™å ä½ç¬¦æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼š<code>#</code> å°†ä¼ å…¥çš„æ•°æ®éƒ½å½“æˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä¼šå¯¹ä¼ å…¥çš„æ•°æ®è‡ªåŠ¨åŠ ä¸Šå¼•å·ï¼›<code>$</code> å°†ä¼ å…¥çš„æ•°æ®ç›´æ¥æ˜¾ç¤ºç”Ÿæˆåœ¨SQLä¸­ã€‚</p>
<p><strong>æ³¨æ„ï¼š</strong>ä½¿ç”¨ <script type="math/tex">` å ä½ç¬¦å¯èƒ½ä¼šå¯¼è‡´ SQL æ³¨å°„æ”»å‡»ï¼Œèƒ½ç”¨ `#` çš„åœ°æ–¹å°±ä¸è¦ä½¿ç”¨ `</script>ï¼Œå†™ <code>order by</code> å­å¥çš„æ—¶å€™åº”è¯¥ç”¨ <code>$</code> è€Œä¸æ˜¯ <code>#</code>ã€‚</p>
<blockquote>
<p>144ã€è§£é‡Šä¸€ä¸‹ MyBatis ä¸­å‘½åç©ºé—´ï¼ˆnamespaceï¼‰çš„ä½œç”¨ã€‚</p>
</blockquote>
<p>ç­”ï¼šåœ¨å¤§å‹é¡¹ç›®ä¸­ï¼Œå¯èƒ½å­˜åœ¨å¤§é‡çš„ SQL è¯­å¥ï¼Œè¿™æ—¶å€™ä¸ºæ¯ä¸ª SQL è¯­å¥èµ·ä¸€ä¸ªå”¯ä¸€çš„æ ‡è¯†ï¼ˆIDï¼‰å°±å˜å¾—å¹¶ä¸å®¹æ˜“äº†ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œåœ¨ MyBatis ä¸­ï¼Œå¯ä»¥ä¸ºæ¯ä¸ªæ˜ å°„æ–‡ä»¶èµ·ä¸€ä¸ªå”¯ä¸€çš„å‘½åç©ºé—´ï¼Œè¿™æ ·å®šä¹‰åœ¨è¿™ä¸ªæ˜ å°„æ–‡ä»¶ä¸­çš„æ¯ä¸ª SQL è¯­å¥å°±æˆäº†å®šä¹‰åœ¨è¿™ä¸ªå‘½åç©ºé—´ä¸­çš„ä¸€ä¸ª IDã€‚åªè¦æˆ‘ä»¬èƒ½å¤Ÿä¿è¯æ¯ä¸ªå‘½åç©ºé—´ä¸­è¿™ä¸ª ID æ˜¯å”¯ä¸€çš„ï¼Œå³ä½¿åœ¨ä¸åŒæ˜ å°„æ–‡ä»¶ä¸­çš„è¯­å¥ ID ç›¸åŒï¼Œä¹Ÿä¸ä¼šå†äº§ç”Ÿå†²çªäº†ã€‚</p>
<blockquote>
<p>145ã€MyBatis ä¸­çš„åŠ¨æ€ SQL æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šå¯¹äºä¸€äº›å¤æ‚çš„æŸ¥è¯¢ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šæŒ‡å®šå¤šä¸ªæŸ¥è¯¢æ¡ä»¶ï¼Œä½†æ˜¯è¿™äº›æ¡ä»¶å¯èƒ½å­˜åœ¨ä¹Ÿå¯èƒ½ä¸å­˜åœ¨ï¼Œä¾‹å¦‚åœ¨ 58 åŒåŸä¸Šé¢æ‰¾æˆ¿å­ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šæŒ‡å®šé¢ç§¯ã€æ¥¼å±‚å’Œæ‰€åœ¨ä½ç½®æ¥æŸ¥æ‰¾æˆ¿æºï¼Œä¹Ÿå¯èƒ½ä¼šæŒ‡å®šé¢ç§¯ã€ä»·æ ¼ã€æˆ·å‹å’Œæ‰€åœ¨ä½ç½®æ¥æŸ¥æ‰¾æˆ¿æºï¼Œæ­¤æ—¶å°±éœ€è¦æ ¹æ®ç”¨æˆ·æŒ‡å®šçš„æ¡ä»¶åŠ¨æ€ç”Ÿæˆ SQL è¯­å¥ã€‚å¦‚æœä¸ä½¿ç”¨æŒä¹…å±‚æ¡†æ¶æˆ‘ä»¬å¯èƒ½éœ€è¦è‡ªå·±æ‹¼è£… SQL è¯­å¥ï¼Œè¿˜å¥½ MyBatis æä¾›äº†åŠ¨æ€ SQL çš„åŠŸèƒ½æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚MyBatis ä¸­ç”¨äºå®ç°åŠ¨æ€ SQL çš„å…ƒç´ ä¸»è¦æœ‰ï¼š</p>
<ul>
<li>if</li>
<li>choose / when / otherwise</li>
<li>trim</li>
<li>where</li>
<li>set</li>
<li>foreach</li>
</ul>
<p>ä¸‹é¢æ˜¯æ˜ å°„æ–‡ä»¶çš„ç‰‡æ®µã€‚</p>
<p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs xml"> <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;foo&quot;</span> <span class="hljs-attr">parameterType</span>=<span class="hljs-string">&quot;Blog&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;Blog&quot;</span>&gt;</span><br>     select * from t_blog where 1 = 1<br>     <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;title != null&quot;</span>&gt;</span><br>         and title = #&#123;title&#125;<br>     <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br>     <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;content != null&quot;</span>&gt;</span><br>         and content = #&#123;content&#125;<br>     <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br>     <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;owner != null&quot;</span>&gt;</span><br>         and owner = #&#123;owner&#125;<br>     <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br></code></pre></td></tr></table></figure>
</p>
<p>å½“ç„¶ä¹Ÿå¯ä»¥åƒä¸‹é¢è¿™äº›ä¹¦å†™ã€‚</p>
<p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;foo&quot;</span> <span class="hljs-attr">parameterType</span>=<span class="hljs-string">&quot;Blog&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;Blog&quot;</span>&gt;</span><br>    select * from t_blog where 1 = 1 <br>    <span class="hljs-tag">&lt;<span class="hljs-name">choose</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">when</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;title != null&quot;</span>&gt;</span><br>            and title = #&#123;title&#125;<br>        <span class="hljs-tag">&lt;/<span class="hljs-name">when</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">when</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;content != null&quot;</span>&gt;</span><br>            and content = #&#123;content&#125;<br>        <span class="hljs-tag">&lt;/<span class="hljs-name">when</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">otherwise</span>&gt;</span><br>            and owner = &quot;owner1&quot;<br>        <span class="hljs-tag">&lt;/<span class="hljs-name">otherwise</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">choose</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br></code></pre></td></tr></table></figure>
</p>
<p>å†çœ‹çœ‹ä¸‹é¢è¿™ä¸ªä¾‹å­ã€‚</p>
<p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;bar&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;Blog&quot;</span>&gt;</span><br>    select * from t_blog where id in<br>    <span class="hljs-tag">&lt;<span class="hljs-name">foreach</span> <span class="hljs-attr">collection</span>=<span class="hljs-string">&quot;array&quot;</span> <span class="hljs-attr">index</span>=<span class="hljs-string">&quot;index&quot;</span> <span class="hljs-attr">item</span>=<span class="hljs-string">&quot;item&quot;</span> <span class="hljs-attr">open</span>=<span class="hljs-string">&quot;(&quot;</span> <span class="hljs-attr">separator</span>=<span class="hljs-string">&quot;,&quot;</span> <span class="hljs-attr">close</span>=<span class="hljs-string">&quot;)&quot;</span>&gt;</span><br>        #&#123;item&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">foreach</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br></code></pre></td></tr></table></figure>
</p>
<blockquote>
<p>146ã€ä»€ä¹ˆæ˜¯ IoC å’Œ DIï¼ŸDI æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šIoC å«æ§åˆ¶åè½¬ï¼Œæ˜¯ Inversion of Control çš„ç¼©å†™ï¼ŒDIï¼ˆDependency Injectionï¼‰å«ä¾èµ–æ³¨å…¥ï¼Œæ˜¯å¯¹ IoC æ›´ç®€å•çš„è¯ é‡Šã€‚æ§åˆ¶åè½¬æ˜¯æŠŠä¼ ç»Ÿä¸Šç”±ç¨‹åºä»£ç ç›´æ¥æ“æ§çš„å¯¹è±¡çš„è°ƒç”¨æƒäº¤ç»™å®¹å™¨ï¼Œé€šè¿‡å®¹å™¨æ¥å®ç°å¯¹è±¡ç»„ä»¶çš„è£…é…å’Œç®¡ç†ã€‚æ‰€è°“çš„â€œæ§åˆ¶åè½¬â€å°±æ˜¯å¯¹ç»„ä»¶å¯¹è±¡æ§åˆ¶æƒçš„è½¬ç§»ï¼Œä»ç¨‹åºä»£ç æœ¬èº«è½¬ç§»åˆ°äº†å¤–éƒ¨å®¹å™¨ï¼Œç”±å®¹å™¨æ¥åˆ›å»ºå¯¹è±¡å¹¶ç®¡ç†å¯¹è±¡ä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚ IoC ä½“ç°äº†å¥½è±ååŸåˆ™ - &quot;Donâ€™t call me, we will call you&quot;ã€‚ä¾èµ–æ³¨å…¥çš„åŸºæœ¬åŸåˆ™æ˜¯åº”ç”¨ç»„ä»¶ä¸åº”è¯¥è´Ÿè´£æŸ¥æ‰¾èµ„æºæˆ–è€…å…¶ä»–ä¾èµ–çš„åä½œå¯¹è±¡ã€‚é…ç½®å¯¹è±¡çš„å·¥ä½œåº”è¯¥ç”±å®¹å™¨è´Ÿè´£ï¼ŒæŸ¥æ‰¾èµ„æºçš„é€»è¾‘åº”è¯¥ä»åº”ç”¨ç»„ä»¶çš„ä»£ç ä¸­æŠ½å–å‡ºæ¥ï¼Œäº¤ç»™å®¹å™¨æ¥å®Œæˆã€‚DI æ˜¯å¯¹ IoC æ›´å‡†ç¡®çš„æè¿°ï¼Œå³ç»„ä»¶ä¹‹é—´çš„ä¾èµ–å…³ç³»ç”±å®¹å™¨åœ¨è¿è¡ŒæœŸå†³å®šï¼Œå½¢è±¡çš„æ¥è¯´ï¼Œå³ç”±å®¹å™¨åŠ¨æ€çš„å°†æŸç§ä¾èµ–å…³ç³»æ³¨å…¥åˆ°ç»„ä»¶ä¹‹ä¸­ã€‚</p>
<p>ä¸¾ä¸ªä¾‹å­ï¼šä¸€ä¸ªç±» A éœ€è¦ç”¨åˆ°æ¥å£ B ä¸­çš„æ–¹æ³•ï¼Œé‚£ä¹ˆå°±éœ€è¦ä¸ºç±» A å’Œæ¥å£ B å»ºç«‹å…³è”æˆ–ä¾èµ–å…³ç³»ï¼Œæœ€åŸå§‹çš„æ–¹æ³•æ˜¯åœ¨ç±» A ä¸­åˆ›å»ºä¸€ä¸ªæ¥å£ B çš„å®ç°ç±» C çš„å®ä¾‹ï¼Œä½†è¿™ç§æ–¹æ³•éœ€è¦å¼€å‘äººå‘˜è‡ªè¡Œç»´æŠ¤äºŒè€…çš„ä¾èµ–å…³ç³»ï¼Œä¹Ÿå°±æ˜¯è¯´å½“ä¾èµ–å…³ç³»å‘ç”Ÿå˜åŠ¨çš„æ—¶å€™éœ€è¦ä¿®æ”¹ä»£ç å¹¶é‡æ–°æ„å»ºæ•´ä¸ªç³»ç»Ÿã€‚å¦‚æœé€šè¿‡ä¸€ä¸ªå®¹å™¨æ¥ç®¡ç†è¿™äº›å¯¹è±¡ä»¥åŠå¯¹è±¡çš„ä¾èµ–å…³ç³»ï¼Œåˆ™åªéœ€è¦åœ¨ç±» A ä¸­å®šä¹‰å¥½ç”¨äºå…³è”æ¥å£ B çš„æ–¹æ³•ï¼ˆæ„é€ å™¨æˆ– setter æ–¹æ³•ï¼‰ï¼Œå°†ç±» A å’Œæ¥å£ B çš„å®ç°ç±» C æ”¾å…¥å®¹å™¨ä¸­ï¼Œé€šè¿‡å¯¹å®¹å™¨çš„é…ç½®æ¥å®ç°äºŒè€…çš„å…³è”ã€‚</p>
<p>ä¾èµ–æ³¨å…¥å¯ä»¥é€šè¿‡ setter æ–¹æ³•æ³¨å…¥ï¼ˆè®¾å€¼æ³¨å…¥ï¼‰ã€æ„é€ å™¨æ³¨å…¥å’Œæ¥å£æ³¨å…¥ä¸‰ç§æ–¹å¼æ¥å®ç°ï¼ŒSpring æ”¯æŒ setter æ³¨å…¥å’Œæ„é€ å™¨æ³¨å…¥ï¼Œé€šå¸¸ä½¿ç”¨æ„é€ å™¨æ³¨å…¥æ¥æ³¨å…¥å¿…é¡»çš„ä¾èµ–å…³ç³»ï¼Œå¯¹äºå¯é€‰çš„ä¾èµ–å…³ç³»ï¼Œåˆ™ setter æ³¨å…¥æ˜¯æ›´å¥½çš„é€‰æ‹©ï¼Œsetter æ³¨å…¥éœ€è¦ç±»æä¾›æ— å‚æ„é€ å™¨æˆ–è€…æ— å‚çš„é™æ€å·¥å‚æ–¹æ³•æ¥åˆ›å»ºå¯¹è±¡ã€‚</p>
<blockquote>
<p>147ã€Spring ä¸­ Bean çš„ä½œç”¨åŸŸæœ‰å“ªäº›ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šåœ¨ Spring çš„æ—©æœŸç‰ˆæœ¬ä¸­ï¼Œä»…æœ‰ä¸¤ä¸ªä½œç”¨åŸŸï¼š<code>singleton</code> å’Œ <code>prototype</code>ï¼Œå‰è€…è¡¨ç¤º Bean ä»¥å•ä¾‹çš„æ–¹å¼å­˜åœ¨ï¼›åè€…è¡¨ç¤ºæ¯æ¬¡ä»å®¹å™¨ä¸­è°ƒç”¨ Bean æ—¶ï¼Œéƒ½ä¼šè¿”å›ä¸€ä¸ªæ–°çš„å®ä¾‹ï¼Œ<code>prototype</code> é€šå¸¸ç¿»è¯‘ä¸ºåŸå‹ã€‚</p>
<p><strong>è¡¥å……ï¼š</strong>è®¾è®¡æ¨¡å¼ä¸­çš„åˆ›å»ºå‹æ¨¡å¼ä¸­ä¹Ÿæœ‰ä¸€ä¸ªåŸå‹æ¨¡å¼ï¼ŒåŸå‹æ¨¡å¼ä¹Ÿæ˜¯ä¸€ä¸ªå¸¸ç”¨çš„æ¨¡å¼ï¼Œä¾‹å¦‚åšä¸€ä¸ªå®¤å†…è®¾è®¡è½¯ä»¶ï¼Œæ‰€æœ‰çš„ç´ æéƒ½åœ¨å·¥å…·ç®±ä¸­ï¼Œè€Œæ¯æ¬¡ä»å·¥å…·ç®±ä¸­å–å‡ºçš„éƒ½æ˜¯ç´ æå¯¹è±¡çš„ä¸€ä¸ªåŸå‹ï¼Œå¯ä»¥é€šè¿‡å¯¹è±¡å…‹éš†æ¥å®ç°åŸå‹æ¨¡å¼ã€‚</p>
<p>Spring 2.x ä¸­é’ˆå¯¹ <code>WebApplicationContext</code> æ–°å¢äº†3ä¸ªä½œç”¨åŸŸï¼Œåˆ†åˆ«æ˜¯ï¼š<code>request</code>ï¼ˆæ¯æ¬¡HTTPè¯·æ±‚éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„Beanï¼‰ã€<code>session</code>ï¼ˆåŒä¸€ä¸ª HttpSession å…±äº«åŒä¸€ä¸ª Beanï¼Œä¸åŒçš„ HttpSession ä½¿ç”¨ä¸åŒçš„ Beanï¼‰å’Œ <code>globalSession</code>ï¼ˆåŒä¸€ä¸ªå…¨å±€ Session å…±äº«ä¸€ä¸ª Beanï¼‰ã€‚</p>
<p><strong>è¯´æ˜ï¼š</strong>å•ä¾‹æ¨¡å¼å’ŒåŸå‹æ¨¡å¼éƒ½æ˜¯é‡è¦çš„è®¾è®¡æ¨¡å¼ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæ— çŠ¶æ€æˆ–çŠ¶æ€ä¸å¯å˜çš„ç±»é€‚åˆä½¿ç”¨å•ä¾‹æ¨¡å¼ã€‚åœ¨ä¼ ç»Ÿå¼€å‘ä¸­ï¼Œç”±äº DAO æŒæœ‰ Connection è¿™ä¸ªéçº¿ç¨‹å®‰å…¨å¯¹è±¡å› è€Œæ²¡æœ‰ä½¿ç”¨å•ä¾‹æ¨¡å¼ï¼›ä½†åœ¨ Spring ç¯å¢ƒä¸‹ï¼Œæ‰€æœ‰ DAO ç±»å¯¹å¯ä»¥é‡‡ç”¨å•ä¾‹æ¨¡å¼ï¼Œå› ä¸º Spring åˆ©ç”¨ AOP å’Œ Java API ä¸­çš„ ThreadLocal å¯¹éçº¿ç¨‹å®‰å…¨çš„å¯¹è±¡è¿›è¡Œäº†ç‰¹æ®Šå¤„ç†ã€‚</p>
<p>ThreadLocal ä¸ºè§£å†³å¤šçº¿ç¨‹ç¨‹åºçš„å¹¶å‘é—®é¢˜æä¾›äº†ä¸€ç§æ–°çš„æ€è·¯ã€‚ThreadLocalï¼Œé¡¾åæ€ä¹‰æ˜¯çº¿ç¨‹çš„ä¸€ä¸ªæœ¬åœ°åŒ–å¯¹è±¡ï¼Œå½“å·¥ä½œäºå¤šçº¿ç¨‹ä¸­çš„å¯¹è±¡ä½¿ç”¨ ThreadLocal ç»´æŠ¤å˜é‡æ—¶ï¼ŒThreadLocal ä¸ºæ¯ä¸ªä½¿ç”¨è¯¥å˜é‡çš„çº¿ç¨‹åˆ†é…ä¸€ä¸ªç‹¬ç«‹çš„å˜é‡å‰¯æœ¬ï¼Œæ‰€ä»¥æ¯ä¸€ä¸ªçº¿ç¨‹éƒ½å¯ä»¥ç‹¬ç«‹çš„æ”¹å˜è‡ªå·±çš„å‰¯æœ¬ï¼Œè€Œä¸å½±å“å…¶ä»–çº¿ç¨‹æ‰€å¯¹åº”çš„å‰¯æœ¬ã€‚ä»çº¿ç¨‹çš„è§’åº¦çœ‹ï¼Œè¿™ä¸ªå˜é‡å°±åƒæ˜¯çº¿ç¨‹çš„æœ¬åœ°å˜é‡ã€‚</p>
<p>ThreadLocal ç±»éå¸¸ç®€å•å¥½ç”¨ï¼Œåªæœ‰å››ä¸ªæ–¹æ³•ï¼Œèƒ½ç”¨ä¸Šçš„ä¹Ÿå°±æ˜¯ä¸‹é¢ä¸‰ä¸ªæ–¹æ³•ï¼š</p>
<ul>
<li><code>void set(T value)</code>ï¼šè®¾ç½®å½“å‰çº¿ç¨‹çš„çº¿ç¨‹å±€éƒ¨å˜é‡çš„å€¼ã€‚</li>
<li><code>T get()</code>ï¼šè·å¾—å½“å‰çº¿ç¨‹æ‰€å¯¹åº”çš„çº¿ç¨‹å±€éƒ¨å˜é‡çš„å€¼ã€‚</li>
<li><code>void remove()</code>ï¼šåˆ é™¤å½“å‰çº¿ç¨‹ä¸­çº¿ç¨‹å±€éƒ¨å˜é‡çš„å€¼ã€‚</li>
</ul>
<p>ThreadLocal æ˜¯å¦‚ä½•åšåˆ°ä¸ºæ¯ä¸€ä¸ªçº¿ç¨‹ç»´æŠ¤ä¸€ä»½ç‹¬ç«‹çš„å˜é‡å‰¯æœ¬çš„å‘¢ï¼Ÿåœ¨ ThreadLocal ç±»ä¸­æœ‰ä¸€ä¸ª <code>Map</code>ï¼Œé”®ä¸ºçº¿ç¨‹å¯¹è±¡ï¼Œå€¼æ˜¯å…¶çº¿ç¨‹å¯¹åº”çš„å˜é‡çš„å‰¯æœ¬ï¼Œè‡ªå·±è¦æ¨¡æ‹Ÿå®ç°ä¸€ä¸ªThreadLocal ç±»å…¶å®å¹¶ä¸å›°éš¾ï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.Collections;<br><span class="hljs-keyword">import</span> java.util.HashMap;<br><span class="hljs-keyword">import</span> java.util.Map;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyThreadLocal</span>&lt;<span class="hljs-title">T</span>&gt; </span>&#123;<br>    <span class="hljs-keyword">private</span> Map&lt;Thread, T&gt; map = Collections.synchronizedMap(<span class="hljs-keyword">new</span> HashMap&lt;Thread, T&gt;());<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">set</span><span class="hljs-params">(T newValue)</span> </span>&#123;<br>        map.put(Thread.currentThread(), newValue);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> T <span class="hljs-title">get</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> map.get(Thread.currentThread());<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">remove</span><span class="hljs-params">()</span> </span>&#123;<br>        map.remove(Thread.currentThread());<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<blockquote>
<p>148ã€è§£é‡Šä¸€ä¸‹ä»€ä¹ˆå« AOPï¼ˆé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼‰ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šAOPï¼ˆAspect-Oriented Programmingï¼‰æŒ‡ä¸€ç§ç¨‹åºè®¾è®¡èŒƒå‹ï¼Œè¯¥èŒƒå‹ä»¥ä¸€ç§ç§°ä¸ºåˆ‡é¢ï¼ˆaspectï¼‰çš„è¯­è¨€æ„é€ ä¸ºåŸºç¡€ï¼Œåˆ‡é¢æ˜¯ä¸€ç§æ–°çš„æ¨¡å—åŒ–æœºåˆ¶ï¼Œç”¨æ¥æè¿°åˆ†æ•£åœ¨å¯¹è±¡ã€ç±»æˆ–æ–¹æ³•ä¸­çš„æ¨ªåˆ‡å…³æ³¨ç‚¹ï¼ˆcrosscutting concernï¼‰ã€‚</p>
<blockquote>
<p>149ã€ä½ æ˜¯å¦‚ä½•ç†è§£â€œæ¨ªåˆ‡å…³æ³¨â€è¿™ä¸ªæ¦‚å¿µçš„ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šâ€œæ¨ªåˆ‡å…³æ³¨â€æ˜¯ä¼šå½±å“åˆ°æ•´ä¸ªåº”ç”¨ç¨‹åºçš„å…³æ³¨åŠŸèƒ½ï¼Œå®ƒè·Ÿæ­£å¸¸çš„ä¸šåŠ¡é€»è¾‘æ˜¯æ­£äº¤çš„ï¼Œæ²¡æœ‰å¿…ç„¶çš„è”ç³»ï¼Œä½†æ˜¯å‡ ä¹æ‰€æœ‰çš„ä¸šåŠ¡é€»è¾‘éƒ½ä¼šæ¶‰åŠåˆ°è¿™äº›å…³æ³¨åŠŸèƒ½ã€‚é€šå¸¸ï¼Œäº‹åŠ¡ã€æ—¥å¿—ã€å®‰å…¨æ€§ç­‰å…³æ³¨å°±æ˜¯åº”ç”¨ä¸­çš„æ¨ªåˆ‡å…³æ³¨åŠŸèƒ½ã€‚</p>
<blockquote>
<p>150ã€ä½ å¦‚ä½•ç†è§£ AOP ä¸­çš„è¿æ¥ç‚¹ï¼ˆJoinpointï¼‰ã€åˆ‡ç‚¹ï¼ˆPointcutï¼‰ã€å¢å¼ºï¼ˆAdviceï¼‰ã€å¼•ä»‹ï¼ˆIntroductionï¼‰ã€ç»‡å…¥ï¼ˆWeavingï¼‰ã€åˆ‡é¢ï¼ˆAspectï¼‰è¿™äº›æ¦‚å¿µï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼š</p>
<ul>
<li>è¿æ¥ç‚¹ï¼ˆJoinpointï¼‰ï¼šç¨‹åºæ‰§è¡Œçš„æŸä¸ªç‰¹å®šä½ç½®ï¼ˆå¦‚ï¼šæŸä¸ªæ–¹æ³•è°ƒç”¨å‰ã€è°ƒç”¨åï¼Œæ–¹æ³•æŠ›å‡ºå¼‚å¸¸åï¼‰ã€‚ä¸€ä¸ªç±»æˆ–ä¸€æ®µç¨‹åºä»£ç æ‹¥æœ‰ä¸€äº›å…·æœ‰è¾¹ç•Œæ€§è´¨çš„ç‰¹å®šç‚¹ï¼Œè¿™äº›ä»£ç ä¸­çš„ç‰¹å®šç‚¹å°±æ˜¯è¿æ¥ç‚¹ã€‚Spring ä»…æ”¯æŒæ–¹æ³•çš„è¿æ¥ç‚¹ã€‚</li>
<li>åˆ‡ç‚¹ï¼ˆPointcutï¼‰ï¼šå¦‚æœè¿æ¥ç‚¹ç›¸å½“äºæ•°æ®ä¸­çš„è®°å½•ï¼Œé‚£ä¹ˆåˆ‡ç‚¹ç›¸å½“äºæŸ¥è¯¢æ¡ä»¶ï¼Œä¸€ä¸ªåˆ‡ç‚¹å¯ä»¥åŒ¹é…å¤šä¸ªè¿æ¥ç‚¹ã€‚Spring AOP çš„è§„åˆ™è§£æå¼•æ“è´Ÿè´£è§£æåˆ‡ç‚¹æ‰€è®¾å®šçš„æŸ¥è¯¢æ¡ä»¶ï¼Œæ‰¾åˆ°å¯¹åº”çš„è¿æ¥ç‚¹ã€‚</li>
<li>å¢å¼ºï¼ˆAdviceï¼‰ï¼šå¢å¼ºæ˜¯ç»‡å…¥åˆ°ç›®æ ‡ç±»è¿æ¥ç‚¹ä¸Šçš„ä¸€æ®µç¨‹åºä»£ç ã€‚Spring æä¾›çš„å¢å¼ºæ¥å£éƒ½æ˜¯å¸¦æ–¹ä½åçš„ï¼Œå¦‚ï¼šBeforeAdviceã€AfterReturningAdviceã€ThrowsAdvice ç­‰ã€‚å¾ˆå¤šèµ„æ–™ä¸Šå°†å¢å¼ºè¯‘ä¸ºâ€œé€šçŸ¥â€ï¼Œè¿™æ˜æ˜¾æ˜¯ä¸ªè¯ä¸è¾¾æ„çš„ç¿»è¯‘ï¼Œè®©å¾ˆå¤šç¨‹åºå‘˜å›°æƒ‘äº†è®¸ä¹…ã€‚</li>
</ul>
<p><strong>è¯´æ˜ï¼š</strong> Advice åœ¨å›½å†…çš„å¾ˆå¤šä¹¦é¢èµ„æ–™ä¸­éƒ½è¢«ç¿»è¯‘æˆ&quot;é€šçŸ¥&quot;ï¼Œä½†æ˜¯å¾ˆæ˜¾ç„¶è¿™ä¸ªç¿»è¯‘æ— æ³•è¡¨è¾¾å…¶æœ¬è´¨ï¼Œæœ‰å°‘é‡çš„è¯»ç‰©ä¸Šå°†è¿™ä¸ªè¯ç¿»è¯‘ä¸º&quot;å¢å¼º&quot;ï¼Œè¿™ä¸ªç¿»è¯‘æ˜¯å¯¹ Advice è¾ƒä¸ºå‡†ç¡®çš„è¯ é‡Šï¼Œæˆ‘ä»¬é€šè¿‡ AOP å°†æ¨ªåˆ‡å…³æ³¨åŠŸèƒ½åŠ åˆ°åŸæœ‰çš„ä¸šåŠ¡é€»è¾‘ä¸Šï¼Œè¿™å°±æ˜¯å¯¹åŸæœ‰ä¸šåŠ¡é€»è¾‘çš„ä¸€ç§å¢å¼ºï¼Œè¿™ç§å¢å¼ºå¯ä»¥æ˜¯å‰ç½®å¢å¼ºã€åç½®å¢å¼ºã€è¿”å›åå¢å¼ºã€æŠ›å¼‚å¸¸æ—¶å¢å¼ºå’ŒåŒ…å›´å‹å¢å¼ºã€‚</p>
<ul>
<li>å¼•ä»‹ï¼ˆIntroductionï¼‰ï¼šå¼•ä»‹æ˜¯ä¸€ç§ç‰¹æ®Šçš„å¢å¼ºï¼Œå®ƒä¸ºç±»æ·»åŠ ä¸€äº›å±æ€§å’Œæ–¹æ³•ã€‚è¿™æ ·ï¼Œå³ä½¿ä¸€ä¸ªä¸šåŠ¡ç±»åŸæœ¬æ²¡æœ‰å®ç°æŸä¸ªæ¥å£ï¼Œé€šè¿‡å¼•ä»‹åŠŸèƒ½ï¼Œå¯ä»¥åŠ¨æ€çš„æœªè¯¥ä¸šåŠ¡ç±»æ·»åŠ æ¥å£çš„å®ç°é€»è¾‘ï¼Œè®©ä¸šåŠ¡ç±»æˆä¸ºè¿™ä¸ªæ¥å£çš„å®ç°ç±»ã€‚</li>
<li>ç»‡å…¥ï¼ˆWeavingï¼‰ï¼šç»‡å…¥æ˜¯å°†å¢å¼ºæ·»åŠ åˆ°ç›®æ ‡ç±»å…·ä½“è¿æ¥ç‚¹ä¸Šçš„è¿‡ç¨‹ï¼ŒAOP æœ‰ä¸‰ç§ç»‡å…¥æ–¹å¼ï¼š<ul>
<li>ç¼–è¯‘æœŸç»‡å…¥ï¼šéœ€è¦ç‰¹æ®Šçš„ Java ç¼–è¯‘æœŸï¼ˆä¾‹å¦‚ AspectJ çš„ ajcï¼‰ï¼›</li>
<li>è£…è½½æœŸç»‡å…¥ï¼šè¦æ±‚ä½¿ç”¨ç‰¹æ®Šçš„ç±»åŠ è½½å™¨ï¼Œåœ¨è£…è½½ç±»çš„æ—¶å€™å¯¹ç±»è¿›è¡Œå¢å¼ºï¼›</li>
<li>è¿è¡Œæ—¶ç»‡å…¥ï¼šåœ¨è¿è¡Œæ—¶ä¸ºç›®æ ‡ç±»ç”Ÿæˆä»£ç†å®ç°å¢å¼ºã€‚Spring é‡‡ç”¨äº†åŠ¨æ€ä»£ç†çš„æ–¹å¼å®ç°äº†è¿è¡Œæ—¶ç»‡å…¥ï¼Œè€Œ AspectJ é‡‡ç”¨äº†ç¼–è¯‘æœŸç»‡å…¥å’Œè£…è½½æœŸç»‡å…¥çš„æ–¹å¼ã€‚</li>
</ul>
</li>
<li>åˆ‡é¢ï¼ˆAspectï¼‰ï¼šåˆ‡é¢æ˜¯ç”±åˆ‡ç‚¹å’Œå¢å¼ºï¼ˆå¼•ä»‹ï¼‰ç»„æˆçš„ï¼Œå®ƒåŒ…æ‹¬äº†å¯¹æ¨ªåˆ‡å…³æ³¨åŠŸèƒ½çš„å®šä¹‰ï¼Œä¹ŸåŒ…æ‹¬äº†å¯¹è¿æ¥ç‚¹çš„å®šä¹‰ã€‚</li>
</ul>
<p><strong>è¡¥å……ï¼š</strong>ä»£ç†æ¨¡å¼æ˜¯ GoF æå‡ºçš„ 23 ç§è®¾è®¡æ¨¡å¼ä¸­æœ€ä¸ºç»å…¸çš„æ¨¡å¼ä¹‹ä¸€ï¼Œä»£ç†æ¨¡å¼æ˜¯å¯¹è±¡çš„ç»“æ„æ¨¡å¼ï¼Œå®ƒç»™æŸä¸€ä¸ªå¯¹è±¡æä¾›ä¸€ä¸ªä»£ç†å¯¹è±¡ï¼Œå¹¶ç”±ä»£ç†å¯¹è±¡æ§åˆ¶å¯¹åŸå¯¹è±¡çš„å¼•ç”¨ã€‚ç®€å•çš„è¯´ï¼Œä»£ç†å¯¹è±¡å¯ä»¥å®Œæˆæ¯”åŸå¯¹è±¡æ›´å¤šçš„èŒè´£ï¼Œå½“éœ€è¦ä¸ºåŸå¯¹è±¡æ·»åŠ æ¨ªåˆ‡å…³æ³¨åŠŸèƒ½æ—¶ï¼Œå°±å¯ä»¥ä½¿ç”¨åŸå¯¹è±¡çš„ä»£ç†å¯¹è±¡ã€‚æˆ‘ä»¬åœ¨æ‰“å¼€ Office ç³»åˆ—çš„ Word æ–‡æ¡£æ—¶ï¼Œå¦‚æœæ–‡æ¡£ä¸­æœ‰æ’å›¾ï¼Œå½“æ–‡æ¡£åˆšåŠ è½½æ—¶ï¼Œæ–‡æ¡£ä¸­çš„æ’å›¾éƒ½åªæ˜¯ä¸€ä¸ªè™šæ¡†å ä½ç¬¦ï¼Œç­‰ç”¨æˆ·çœŸæ­£ç¿»åˆ°æŸé¡µè¦æŸ¥çœ‹è¯¥å›¾ç‰‡æ—¶ï¼Œæ‰ä¼šçœŸæ­£åŠ è½½è¿™å¼ å›¾ï¼Œè¿™å…¶å®å°±æ˜¯å¯¹ä»£ç†æ¨¡å¼çš„ä½¿ç”¨ï¼Œä»£æ›¿çœŸæ­£å›¾ç‰‡çš„è™šæ¡†å°±æ˜¯ä¸€ä¸ªè™šæ‹Ÿä»£ç†ï¼› Hibernate çš„ <code>load</code> æ–¹æ³•ä¹Ÿæ˜¯è¿”å›ä¸€ä¸ªè™šæ‹Ÿä»£ç†å¯¹è±¡ï¼Œç­‰ç”¨æˆ·çœŸæ­£éœ€è¦è®¿é—®å¯¹è±¡çš„å±æ€§æ—¶ï¼Œæ‰å‘æ•°æ®åº“å‘å‡º SQL è¯­å¥è·å¾—çœŸå®å¯¹è±¡ã€‚</p>
<p>ä¸‹é¢ç”¨ä¸€ä¸ªæ‰¾æªæ‰‹ä»£è€ƒçš„ä¾‹å­æ¼”ç¤ºä»£ç†æ¨¡å¼çš„ä½¿ç”¨ï¼š</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * å‚è€ƒäººå‘˜æ¥å£</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">Candidate</span> </span>&#123;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * ç­”é¢˜</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">answerTheQuestions</span><span class="hljs-params">()</span></span>;<br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * æ‡’å­¦ç”Ÿ</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LazyStudent</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Candidate</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> String name;        <span class="hljs-comment">// å§“å</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">LazyStudent</span><span class="hljs-params">(String name)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.name = name;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">answerTheQuestions</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-comment">// æ‡’å­¦ç”Ÿåªèƒ½å†™å‡ºè‡ªå·±çš„åå­—ä¸ä¼šç­”é¢˜</span><br>        System.out.println(<span class="hljs-string">&quot;å§“å: &quot;</span> + name);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * æªæ‰‹</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Gunman</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Candidate</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> Candidate target;     <span class="hljs-comment">// è¢«ä»£ç†å¯¹è±¡</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Gunman</span><span class="hljs-params">(Candidate target)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.target = target;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">answerTheQuestions</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-comment">// æªæ‰‹è¦å†™ä¸Šä»£è€ƒçš„å­¦ç”Ÿçš„å§“å</span><br>        target.answerTheQuestions();<br>        <span class="hljs-comment">// æªæ‰‹è¦å¸®åŠ©æ‡’å­¦ç”Ÿç­”é¢˜å¹¶äº¤å·</span><br>        System.out.println(<span class="hljs-string">&quot;å¥‹ç¬”ç–¾ä¹¦æ­£ç¡®ç­”æ¡ˆ&quot;</span>);<br>        System.out.println(<span class="hljs-string">&quot;äº¤å·&quot;</span>);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ProxyTest1</span> </span>&#123;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        Candidate c = <span class="hljs-keyword">new</span> Gunman(<span class="hljs-keyword">new</span> LazyStudent(<span class="hljs-string">&quot;ç‹å°äºŒ&quot;</span>));<br>        c.answerTheQuestions();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<p><strong>è¯´æ˜ï¼š</strong>ä» JDK 1.3 å¼€å§‹ï¼ŒJava æä¾›äº†åŠ¨æ€ä»£ç†æŠ€æœ¯ï¼Œå…è®¸å¼€å‘è€…åœ¨è¿è¡Œæ—¶åˆ›å»ºæ¥å£çš„ä»£ç†å®ä¾‹ï¼Œä¸»è¦åŒ…æ‹¬ <code>Proxy</code> ç±»å’Œ <code>InvocationHandler</code> æ¥å£ã€‚ä¸‹é¢çš„ä¾‹å­ä½¿ç”¨åŠ¨æ€ä»£ç†ä¸º <code>ArrayList</code> ç¼–å†™ä¸€ä¸ªä»£ç†ï¼Œåœ¨æ·»åŠ å’Œåˆ é™¤å…ƒç´ æ—¶ï¼Œåœ¨æ§åˆ¶å°æ‰“å°æ·»åŠ æˆ–åˆ é™¤çš„å…ƒç´ ä»¥åŠ <code>ArrayList</code> çš„å¤§å°ï¼š</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.lang.reflect.InvocationHandler;<br><span class="hljs-keyword">import</span> java.lang.reflect.Method;<br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ListProxy</span>&lt;<span class="hljs-title">T</span>&gt; <span class="hljs-keyword">implements</span> <span class="hljs-title">InvocationHandler</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> List&lt;T&gt; target;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">ListProxy</span><span class="hljs-params">(List&lt;T&gt; target)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.target = target;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Object <span class="hljs-title">invoke</span><span class="hljs-params">(Object proxy, Method method, Object[] args)</span></span><br><span class="hljs-function">            <span class="hljs-keyword">throws</span> Throwable </span>&#123;<br>        Object retVal = <span class="hljs-keyword">null</span>;<br>        System.out.println(<span class="hljs-string">&quot;[&quot;</span> + method.getName() + <span class="hljs-string">&quot;: &quot;</span> + args[<span class="hljs-number">0</span>] + <span class="hljs-string">&quot;]&quot;</span>);<br>        retVal = method.invoke(target, args);<br>        System.out.println(<span class="hljs-string">&quot;[size=&quot;</span> + target.size() + <span class="hljs-string">&quot;]&quot;</span>);<br>        <span class="hljs-keyword">return</span> retVal;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.lang.reflect.Proxy;<br><span class="hljs-keyword">import</span> java.util.ArrayList;<br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ProxyTest2</span> </span>&#123;<br><br>    <span class="hljs-meta">@SuppressWarnings(&quot;unchecked&quot;)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        List&lt;String&gt; list = <span class="hljs-keyword">new</span> ArrayList&lt;String&gt;();<br>        Class&lt;?&gt; clazz = list.getClass();<br>        ListProxy&lt;String&gt; myProxy = <span class="hljs-keyword">new</span> ListProxy&lt;String&gt;(list);<br>        List&lt;String&gt; newList = (List&lt;String&gt;) <br>                Proxy.newProxyInstance(clazz.getClassLoader(), <br>                clazz.getInterfaces(), myProxy);<br>        newList.add(<span class="hljs-string">&quot;apple&quot;</span>);<br>        newList.add(<span class="hljs-string">&quot;banana&quot;</span>);<br>        newList.add(<span class="hljs-string">&quot;orange&quot;</span>);<br>        newList.remove(<span class="hljs-string">&quot;banana&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<p><strong>è¯´æ˜ï¼š</strong>ä½¿ç”¨ Java çš„åŠ¨æ€ä»£ç†æœ‰ä¸€ä¸ªå±€é™æ€§å°±æ˜¯ä»£ç†çš„ç±»å¿…é¡»è¦å®ç°æ¥å£ï¼Œè™½ç„¶é¢å‘æ¥å£ç¼–ç¨‹æ˜¯æ¯ä¸ªä¼˜ç§€çš„ Java ç¨‹åºéƒ½çŸ¥é“çš„è§„åˆ™ï¼Œä½†ç°å®å¾€å¾€ä¸å°½å¦‚äººæ„ï¼Œå¯¹äºæ²¡æœ‰å®ç°æ¥å£çš„ç±»å¦‚ä½•ä¸ºå…¶ç”Ÿæˆä»£ç†å‘¢ï¼Ÿç»§æ‰¿ï¼ç»§æ‰¿æ˜¯æœ€ç»å…¸çš„æ‰©å±•å·²æœ‰ä»£ç èƒ½åŠ›çš„æ‰‹æ®µï¼Œè™½ç„¶ç»§æ‰¿å¸¸å¸¸è¢«åˆå­¦è€…æ»¥ç”¨ï¼Œä½†ç»§æ‰¿ä¹Ÿå¸¸å¸¸è¢«è¿›é˜¶çš„ç¨‹åºå‘˜å¿½è§†ã€‚CGLib é‡‡ç”¨éå¸¸åº•å±‚çš„å­—èŠ‚ç ç”ŸæˆæŠ€æœ¯ï¼Œé€šè¿‡ä¸ºä¸€ä¸ªç±»åˆ›å»ºå­ç±»æ¥ç”Ÿæˆä»£ç†ï¼Œå®ƒå¼¥è¡¥äº† Java åŠ¨æ€ä»£ç†çš„ä¸è¶³ï¼Œå› æ­¤ Spring ä¸­åŠ¨æ€ä»£ç†å’Œ CGLib éƒ½æ˜¯åˆ›å»ºä»£ç†çš„é‡è¦æ‰‹æ®µï¼Œå¯¹äºå®ç°äº†æ¥å£çš„ç±»å°±ç”¨åŠ¨æ€ä»£ç†ä¸ºå…¶ç”Ÿæˆä»£ç†ç±»ï¼Œè€Œæ²¡æœ‰å®ç°æ¥å£çš„ç±»å°±ç”¨ CGLib é€šè¿‡ç»§æ‰¿çš„æ–¹å¼ä¸ºå…¶åˆ›å»ºä»£ç†ã€‚</p>
<blockquote>
<p>151ã€Spring ä¸­è‡ªåŠ¨è£…é…çš„æ–¹å¼æœ‰å“ªäº›ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼š</p>
<ul>
<li><code>no</code>ï¼šä¸è¿›è¡Œè‡ªåŠ¨è£…é…ï¼Œæ‰‹åŠ¨è®¾ç½® Bean çš„ä¾èµ–å…³ç³»ã€‚</li>
<li><code>byName</code>ï¼šæ ¹æ® Bean çš„åå­—è¿›è¡Œè‡ªåŠ¨è£…é…ã€‚</li>
<li><code>byType</code>ï¼šæ ¹æ® Bean çš„ç±»å‹è¿›è¡Œè‡ªåŠ¨è£…é…ã€‚</li>
<li><code>constructor</code>ï¼šç±»ä¼¼äº <code>byType</code>ï¼Œä¸è¿‡æ˜¯åº”ç”¨äºæ„é€ å™¨çš„å‚æ•°ï¼Œå¦‚æœæ­£å¥½æœ‰ä¸€ä¸ª Bean ä¸æ„é€ å™¨çš„å‚æ•°ç±»å‹ç›¸åŒåˆ™å¯ä»¥è‡ªåŠ¨è£…é…ï¼Œå¦åˆ™ä¼šå¯¼è‡´é”™è¯¯ã€‚</li>
<li><code>autodetect</code>ï¼šå¦‚æœæœ‰é»˜è®¤çš„æ„é€ å™¨ï¼Œåˆ™é€šè¿‡ <code>constructor</code> çš„æ–¹å¼è¿›è¡Œè‡ªåŠ¨è£…é…ï¼Œå¦åˆ™ä½¿ç”¨ <code>byType</code> çš„æ–¹å¼è¿›è¡Œè‡ªåŠ¨è£…é…ã€‚</li>
</ul>
<p><strong>è¯´æ˜ï¼š</strong>è‡ªåŠ¨è£…é…æ²¡æœ‰è‡ªå®šä¹‰è£…é…æ–¹å¼é‚£ä¹ˆç²¾ç¡®ï¼Œè€Œä¸”ä¸èƒ½è‡ªåŠ¨è£…é…ç®€å•å±æ€§ï¼ˆåŸºæœ¬ç±»å‹ã€å­—ç¬¦ä¸²ç­‰ï¼‰ï¼Œåœ¨ä½¿ç”¨æ—¶åº”æ³¨æ„ã€‚</p>
<blockquote>
<p>152ã€Spring ä¸­å¦‚ä½•ä½¿ç”¨æ³¨è§£æ¥é…ç½® Beanï¼Ÿæœ‰å“ªäº›ç›¸å…³çš„æ³¨è§£ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šé¦–å…ˆéœ€è¦åœ¨ Spring é…ç½®æ–‡ä»¶ä¸­å¢åŠ å¦‚ä¸‹é…ç½®ï¼š</p>
<p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">context:component-scan</span> <span class="hljs-attr">base-package</span>=<span class="hljs-string">&quot;org.example&quot;</span>/&gt;</span><br></code></pre></td></tr></table></figure>
</p>
<p>ç„¶åå¯ä»¥ç”¨ <code>@Component</code>ã€<code>@Controller</code>ã€<code>@Service</code>ã€<code>@Repository</code> æ³¨è§£æ¥æ ‡æ³¨éœ€è¦ç”± Spring IoC å®¹å™¨è¿›è¡Œå¯¹è±¡æ‰˜ç®¡çš„ç±»ã€‚è¿™å‡ ä¸ªæ³¨è§£æ²¡æœ‰æœ¬è´¨åŒºåˆ«ï¼Œåªä¸è¿‡ <code>@Controller</code> é€šå¸¸ç”¨äºæ§åˆ¶å™¨ï¼Œ<code>@Service</code> é€šå¸¸ç”¨äºä¸šåŠ¡é€»è¾‘ç±»ï¼Œ<code>@Repository</code> é€šå¸¸ç”¨äºä»“å‚¨ç±»ï¼ˆä¾‹å¦‚æˆ‘ä»¬çš„ DAO å®ç°ç±»ï¼‰ï¼Œæ™®é€šçš„ç±»ç”¨ <code>@Component</code> æ¥æ ‡æ³¨ã€‚</p>
<blockquote>
<p>153ã€Spring æ”¯æŒçš„äº‹åŠ¡ç®¡ç†ç±»å‹æœ‰å“ªäº›ï¼Ÿä½ åœ¨é¡¹ç›®ä¸­ä½¿ç”¨å“ªç§æ–¹å¼ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šSpring æ”¯æŒ<strong>ç¼–ç¨‹å¼</strong>äº‹åŠ¡ç®¡ç†å’Œ<strong>å£°æ˜å¼</strong>äº‹åŠ¡ç®¡ç†ã€‚è®¸å¤š Spring æ¡†æ¶çš„ç”¨æˆ·é€‰æ‹©å£°æ˜å¼äº‹åŠ¡ç®¡ç†ï¼Œå› ä¸ºè¿™ç§æ–¹å¼å’Œåº”ç”¨ç¨‹åºçš„å…³è”è¾ƒå°‘ï¼Œå› æ­¤æ›´åŠ ç¬¦åˆè½»é‡çº§å®¹å™¨çš„æ¦‚å¿µã€‚å£°æ˜å¼äº‹åŠ¡ç®¡ç†è¦ä¼˜äºç¼–ç¨‹å¼äº‹åŠ¡ç®¡ç†ï¼Œå°½ç®¡åœ¨çµæ´»æ€§æ–¹é¢å®ƒå¼±äºç¼–ç¨‹å¼äº‹åŠ¡ç®¡ç†ï¼Œå› ä¸ºç¼–ç¨‹å¼äº‹åŠ¡å…è®¸ä½ é€šè¿‡ä»£ç æ§åˆ¶ä¸šåŠ¡ã€‚</p>
<p>äº‹åŠ¡åˆ†ä¸º<strong>å…¨å±€äº‹åŠ¡</strong>å’Œ<strong>å±€éƒ¨äº‹åŠ¡</strong>ã€‚å…¨å±€äº‹åŠ¡ç”±åº”ç”¨æœåŠ¡å™¨ç®¡ç†ï¼Œéœ€è¦åº•å±‚æœåŠ¡å™¨ JTA æ”¯æŒï¼ˆå¦‚ WebLogicã€WildFly ç­‰ï¼‰ã€‚å±€éƒ¨äº‹åŠ¡å’Œåº•å±‚é‡‡ç”¨çš„æŒä¹…åŒ–æ–¹æ¡ˆæœ‰å…³ï¼Œä¾‹å¦‚ä½¿ç”¨ JDBC è¿›è¡ŒæŒä¹…åŒ–æ—¶ï¼Œéœ€è¦ä½¿ç”¨ Connetion å¯¹è±¡æ¥æ“ä½œäº‹åŠ¡ï¼›è€Œé‡‡ç”¨ Hibernate è¿›è¡ŒæŒä¹…åŒ–æ—¶ï¼Œéœ€è¦ä½¿ç”¨ Session å¯¹è±¡æ¥æ“ä½œäº‹åŠ¡ã€‚</p>
<p>Spring æä¾›äº†å¦‚ä¸‹æ‰€ç¤ºçš„äº‹åŠ¡ç®¡ç†å™¨ã€‚</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>äº‹åŠ¡ç®¡ç†å™¨å®ç°ç±»</th>
<th>ç›®æ ‡å¯¹è±¡</th>
</tr>
</thead>
<tbody>
<tr>
<td>DataSourceTransactionManager</td>
<td>æ³¨å…¥ DataSource</td>
</tr>
<tr>
<td>HibernateTransactionManager</td>
<td>æ³¨å…¥ SessionFactory</td>
</tr>
<tr>
<td>JdoTransactionManager</td>
<td>ç®¡ç† JDO äº‹åŠ¡</td>
</tr>
<tr>
<td>JtaTransactionManager</td>
<td>ä½¿ç”¨ JTA ç®¡ç†äº‹åŠ¡</td>
</tr>
<tr>
<td>PersistenceBrokerTransactionManager</td>
<td>ç®¡ç† Apache çš„ OJB äº‹åŠ¡</td>
</tr>
</tbody>
</table>
</div>
<p>è¿™äº›äº‹åŠ¡çš„çˆ¶æ¥å£éƒ½æ˜¯ <code>PlatformTransactionManager</code>ã€‚Spring çš„äº‹åŠ¡ç®¡ç†æœºåˆ¶æ˜¯ä¸€ç§å…¸å‹çš„ç­–ç•¥æ¨¡å¼ï¼Œ<code>PlatformTransactionManager</code> ä»£è¡¨äº‹åŠ¡ç®¡ç†æ¥å£ï¼Œè¯¥æ¥å£å®šä¹‰äº†ä¸‰ä¸ªæ–¹æ³•ï¼Œè¯¥æ¥å£å¹¶ä¸çŸ¥é“åº•å±‚å¦‚ä½•ç®¡ç†äº‹åŠ¡ï¼Œä½†æ˜¯å®ƒçš„å®ç°ç±»å¿…é¡»æä¾› <code>getTransaction()</code> æ–¹æ³•ï¼ˆå¼€å¯äº‹åŠ¡ï¼‰ã€<code>commit()</code> æ–¹æ³•ï¼ˆæäº¤äº‹åŠ¡ï¼‰ã€<code>rollback()</code> æ–¹æ³•ï¼ˆå›æ»šäº‹åŠ¡ï¼‰çš„å¤šæ€å®ç°ï¼Œè¿™æ ·å°±å¯ä»¥ç”¨ä¸åŒçš„å®ç°ç±»ä»£è¡¨ä¸åŒçš„äº‹åŠ¡ç®¡ç†ç­–ç•¥ã€‚ä½¿ç”¨ JTA å…¨å±€äº‹åŠ¡ç­–ç•¥æ—¶ï¼Œéœ€è¦åº•å±‚åº”ç”¨æœåŠ¡å™¨æ”¯æŒï¼Œè€Œä¸åŒçš„åº”ç”¨æœåŠ¡å™¨æ‰€æä¾›çš„ JTA å…¨å±€äº‹åŠ¡å¯èƒ½å­˜åœ¨ç»†èŠ‚ä¸Šçš„å·®å¼‚ï¼Œå› æ­¤å®é™…é…ç½®å…¨å±€äº‹åŠ¡ç®¡ç†å™¨æ˜¯å¯èƒ½éœ€è¦ä½¿ç”¨ <code>JtaTransactionManager</code> çš„å­ç±»ï¼Œå¦‚ï¼š<code>WebLogicJtaTransactionManager</code>ï¼ˆOracle çš„ WebLogic æœåŠ¡å™¨æä¾›ï¼‰ã€<code>UowJtaTransactionManager</code>ï¼ˆIBM çš„ WebSphere æœåŠ¡å™¨æä¾›ï¼‰ç­‰ã€‚</p>
<p>ç¼–ç¨‹å¼äº‹åŠ¡ç®¡ç†å¦‚ä¸‹æ‰€ç¤ºã€‚</p>
<p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br> <span class="hljs-tag">&lt;<span class="hljs-name">beans</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans&quot;</span></span><br><span class="hljs-tag">     <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>  <span class="hljs-attr">xmlns:p</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/p&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">xmlns:p</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/context&quot;</span></span><br><span class="hljs-tag">     <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd</span></span><br><span class="hljs-tag"><span class="hljs-string">     http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd&quot;</span>&gt;</span><br><br>     <span class="hljs-tag">&lt;<span class="hljs-name">context:component-scan</span> <span class="hljs-attr">base-package</span>=<span class="hljs-string">&quot;com.jackfrued&quot;</span>/&gt;</span><br><br>     <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;propertyConfig&quot;</span></span><br><span class="hljs-tag">         <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.springframework.beans.factory.config.PropertyPlaceholderConfigurer&quot;</span>&gt;</span><br>         <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;location&quot;</span>&gt;</span><br>             <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>jdbc.properties<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br>         <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br>     <span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br><br>     <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;dataSource&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.apache.commons.dbcp.BasicDataSource&quot;</span>&gt;</span><br>         <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;driverClassName&quot;</span>&gt;</span><br>             <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>$&#123;db.driver&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br>         <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br>         <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;url&quot;</span>&gt;</span><br>             <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>$&#123;db.url&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br>         <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br>         <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;username&quot;</span>&gt;</span><br>             <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>$&#123;db.username&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br>         <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br>         <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;password&quot;</span>&gt;</span><br>             <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>$&#123;db.password&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br>         <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br>     <span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br><br>     <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;jdbcTemplate&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.springframework.jdbc.core.JdbcTemplate&quot;</span>&gt;</span><br>         <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;dataSource&quot;</span>&gt;</span><br>             <span class="hljs-tag">&lt;<span class="hljs-name">ref</span> <span class="hljs-attr">bean</span>=<span class="hljs-string">&quot;dataSource&quot;</span> /&gt;</span><br>         <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br>     <span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br><br>     <span class="hljs-comment">&lt;!-- JDBCäº‹åŠ¡ç®¡ç†å™¨ --&gt;</span><br>     <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;transactionManager&quot;</span></span><br><span class="hljs-tag">         <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;</span>ã€€<span class="hljs-attr">scope</span>=<span class="hljs-string">&quot;singleton&quot;</span>&gt;</span><br>         <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;dataSource&quot;</span>&gt;</span><br>             <span class="hljs-tag">&lt;<span class="hljs-name">ref</span> <span class="hljs-attr">bean</span>=<span class="hljs-string">&quot;dataSource&quot;</span> /&gt;</span><br>         <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br>     <span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br><br>     <span class="hljs-comment">&lt;!-- å£°æ˜äº‹åŠ¡æ¨¡æ¿ --&gt;</span><br>     <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;transactionTemplate&quot;</span></span><br><span class="hljs-tag">         <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.springframework.transaction.support.TransactionTemplate&quot;</span>&gt;</span><br>         <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;transactionManager&quot;</span>&gt;</span><br>             <span class="hljs-tag">&lt;<span class="hljs-name">ref</span> <span class="hljs-attr">bean</span>=<span class="hljs-string">&quot;transactionManager&quot;</span> /&gt;</span><br>         <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br>     <span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">beans</span>&gt;</span><br></code></pre></td></tr></table></figure>
</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.jackfrued.dao.impl;<br><br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.jdbc.core.JdbcTemplate;<br><br><span class="hljs-keyword">import</span> com.jackfrued.dao.EmpDao;<br><span class="hljs-keyword">import</span> com.jackfrued.entity.Emp;<br><br><span class="hljs-meta">@Repository</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">EmpDaoImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">EmpDao</span> </span>&#123;<br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> JdbcTemplate jdbcTemplate;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">save</span><span class="hljs-params">(Emp emp)</span> </span>&#123;<br>        String sql = <span class="hljs-string">&quot;insert into emp values (?,?,?)&quot;</span>;<br>        <span class="hljs-keyword">return</span> jdbcTemplate.update(sql, emp.getId(), emp.getName(), emp.getBirthday()) == <span class="hljs-number">1</span>;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.jackfrued.biz.impl;<br><br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.stereotype.Service;<br><span class="hljs-keyword">import</span> org.springframework.transaction.TransactionStatus;<br><span class="hljs-keyword">import</span> org.springframework.transaction.support.TransactionCallbackWithoutResult;<br><span class="hljs-keyword">import</span> org.springframework.transaction.support.TransactionTemplate;<br><br><span class="hljs-keyword">import</span> com.jackfrued.biz.EmpService;<br><span class="hljs-keyword">import</span> com.jackfrued.dao.EmpDao;<br><span class="hljs-keyword">import</span> com.jackfrued.entity.Emp;<br><br><span class="hljs-meta">@Service</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">EmpServiceImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">EmpService</span> </span>&#123;<br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> TransactionTemplate txTemplate;<br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> EmpDao empDao;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">addEmp</span><span class="hljs-params">(<span class="hljs-keyword">final</span> Emp emp)</span> </span>&#123;<br>        txTemplate.execute(<span class="hljs-keyword">new</span> TransactionCallbackWithoutResult() &#123;<br><br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doInTransactionWithoutResult</span><span class="hljs-params">(TransactionStatus txStatus)</span> </span>&#123;<br>                empDao.save(emp);<br>            &#125;<br>        &#125;);<br>    &#125;<br><br><br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<p>å£°æ˜å¼äº‹åŠ¡å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œä»¥ Spring æ•´åˆ Hibernate 3 ä¸ºä¾‹ï¼ŒåŒ…æ‹¬å®Œæ•´çš„ DAO å’Œä¸šåŠ¡é€»è¾‘ä»£ç ã€‚</p>
<p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">beans</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span> </span><br><span class="hljs-tag">    <span class="hljs-attr">xmlns:p</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/p&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">xmlns:context</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/context&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">xmlns:aop</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/aop&quot;</span> </span><br><span class="hljs-tag">    <span class="hljs-attr">xmlns:tx</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/tx&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans</span></span><br><span class="hljs-tag"><span class="hljs-string">           http://www.springframework.org/schema/beans/spring-beans-3.2.xsd</span></span><br><span class="hljs-tag"><span class="hljs-string">           http://www.springframework.org/schema/context</span></span><br><span class="hljs-tag"><span class="hljs-string">           http://www.springframework.org/schema/context/spring-context-3.2.xsd</span></span><br><span class="hljs-tag"><span class="hljs-string">           http://www.springframework.org/schema/aop</span></span><br><span class="hljs-tag"><span class="hljs-string">           http://www.springframework.org/schema/aop/spring-aop-3.2.xsd</span></span><br><span class="hljs-tag"><span class="hljs-string">           http://www.springframework.org/schema/tx</span></span><br><span class="hljs-tag"><span class="hljs-string">           http://www.springframework.org/schema/tx/spring-tx-3.2.xsd&quot;</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- é…ç½®ç”±Spring IoCå®¹å™¨æ‰˜ç®¡çš„å¯¹è±¡å¯¹åº”çš„è¢«æ³¨è§£çš„ç±»æ‰€åœ¨çš„åŒ… --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">context:component-scan</span> <span class="hljs-attr">base-package</span>=<span class="hljs-string">&quot;com.jackfrued&quot;</span> /&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- é…ç½®é€šè¿‡è‡ªåŠ¨ç”Ÿæˆä»£ç†å®ç°AOPåŠŸèƒ½ --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">aop:aspectj-autoproxy</span> /&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- é…ç½®æ•°æ®åº“è¿æ¥æ±  (DBCP) --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;dataSource&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.apache.commons.dbcp.BasicDataSource&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">destroy-method</span>=<span class="hljs-string">&quot;close&quot;</span>&gt;</span><br>        <span class="hljs-comment">&lt;!-- é…ç½®é©±åŠ¨ç¨‹åºç±» --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;driverClassName&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;com.mysql.jdbc.Driver&quot;</span> /&gt;</span><br>        <span class="hljs-comment">&lt;!-- é…ç½®è¿æ¥æ•°æ®åº“çš„URL --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;url&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;jdbc:mysql://localhost:3306/myweb&quot;</span> /&gt;</span><br>        <span class="hljs-comment">&lt;!-- é…ç½®è®¿é—®æ•°æ®åº“çš„ç”¨æˆ·å --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;username&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;root&quot;</span> /&gt;</span><br>        <span class="hljs-comment">&lt;!-- é…ç½®è®¿é—®æ•°æ®åº“çš„å£ä»¤ --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;123456&quot;</span> /&gt;</span><br>        <span class="hljs-comment">&lt;!-- é…ç½®æœ€å¤§è¿æ¥æ•° --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;maxActive&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;150&quot;</span> /&gt;</span><br>        <span class="hljs-comment">&lt;!-- é…ç½®æœ€å°ç©ºé—²è¿æ¥æ•° --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;minIdle&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;5&quot;</span> /&gt;</span><br>        <span class="hljs-comment">&lt;!-- é…ç½®æœ€å¤§ç©ºé—²è¿æ¥æ•° --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;maxIdle&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;20&quot;</span> /&gt;</span><br>        <span class="hljs-comment">&lt;!-- é…ç½®åˆå§‹è¿æ¥æ•° --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;initialSize&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;10&quot;</span> /&gt;</span><br>        <span class="hljs-comment">&lt;!-- é…ç½®è¿æ¥è¢«æ³„éœ²æ—¶æ˜¯å¦ç”Ÿæˆæ—¥å¿— --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;logAbandoned&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;true&quot;</span> /&gt;</span><br>        <span class="hljs-comment">&lt;!-- é…ç½®æ˜¯å¦åˆ é™¤è¶…æ—¶è¿æ¥ --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;removeAbandoned&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;true&quot;</span> /&gt;</span><br>        <span class="hljs-comment">&lt;!-- é…ç½®åˆ é™¤è¶…æ—¶è¿æ¥çš„è¶…æ—¶é—¨é™å€¼(ä»¥ç§’ä¸ºå•ä½) --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;removeAbandonedTimeout&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;120&quot;</span> /&gt;</span><br>        <span class="hljs-comment">&lt;!-- é…ç½®è¶…æ—¶ç­‰å¾…æ—¶é—´(ä»¥æ¯«ç§’ä¸ºå•ä½) --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;maxWait&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;5000&quot;</span> /&gt;</span><br>        <span class="hljs-comment">&lt;!-- é…ç½®ç©ºé—²è¿æ¥å›æ”¶å™¨çº¿ç¨‹è¿è¡Œçš„æ—¶é—´é—´éš”(ä»¥æ¯«ç§’ä¸ºå•ä½) --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;timeBetweenEvictionRunsMillis&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;300000&quot;</span> /&gt;</span><br>        <span class="hljs-comment">&lt;!-- é…ç½®è¿æ¥ç©ºé—²å¤šé•¿æ—¶é—´å(ä»¥æ¯«ç§’ä¸ºå•ä½)è¢«æ–­å¼€è¿æ¥ --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;minEvictableIdleTimeMillis&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;60000&quot;</span> /&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- é…ç½®Springæä¾›çš„æ”¯æŒæ³¨è§£ORMæ˜ å°„çš„Hibernateä¼šè¯å·¥å‚ --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;sessionFactory&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean&quot;</span>&gt;</span><br>        <span class="hljs-comment">&lt;!-- é€šè¿‡setteræ³¨å…¥æ•°æ®æºå±æ€§ --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;dataSource&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;dataSource&quot;</span> /&gt;</span><br>        <span class="hljs-comment">&lt;!-- é…ç½®å®ä½“ç±»æ‰€åœ¨çš„åŒ… --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;packagesToScan&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;com.jackfrued.entity&quot;</span> /&gt;</span><br>        <span class="hljs-comment">&lt;!-- é…ç½®Hibernateçš„ç›¸å…³å±æ€§ --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;hibernateProperties&quot;</span>&gt;</span><br>            <span class="hljs-comment">&lt;!-- åœ¨é¡¹ç›®è°ƒè¯•å®Œæˆåè¦åˆ é™¤show_sqlå’Œformat_sqlå±æ€§å¦åˆ™å¯¹æ€§èƒ½æœ‰æ˜¾è‘—å½±å“ --&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span><br>                hibernate.dialect=org.hibernate.dialect.MySQL5Dialect<br>            <span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- é…ç½®Springæä¾›çš„Hibernateäº‹åŠ¡ç®¡ç†å™¨ --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;transactionManager&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.springframework.orm.hibernate3.HibernateTransactionManager&quot;</span>&gt;</span><br>        <span class="hljs-comment">&lt;!-- é€šè¿‡setteræ³¨å…¥Hibernateä¼šè¯å·¥å‚ --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;sessionFactory&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;sessionFactory&quot;</span> /&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- é…ç½®åŸºäºæ³¨è§£é…ç½®å£°æ˜å¼äº‹åŠ¡ --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">tx:annotation-driven</span> /&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">beans</span>&gt;</span><br></code></pre></td></tr></table></figure>
</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.jackfrued.dao;<br><br><span class="hljs-keyword">import</span> java.io.Serializable;<br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-keyword">import</span> com.jackfrued.comm.QueryBean;<br><span class="hljs-keyword">import</span> com.jackfrued.comm.QueryResult;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * æ•°æ®è®¿é—®å¯¹è±¡æ¥å£(ä»¥å¯¹è±¡ä¸ºå•ä½å°è£…CRUDæ“ä½œ)</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> &lt;E&gt; å®ä½“ç±»å‹</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> &lt;K&gt; å®ä½“æ ‡è¯†å­—æ®µçš„ç±»å‹</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">BaseDao</span> &lt;<span class="hljs-title">E</span>, <span class="hljs-title">K</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Serializable</span>&gt; </span>&#123;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ–°å¢</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> entity ä¸šåŠ¡å®ä½“å¯¹è±¡</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> å¢åŠ æˆåŠŸè¿”å›å®ä½“å¯¹è±¡çš„æ ‡è¯†</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> K <span class="hljs-title">save</span><span class="hljs-params">(E entity)</span></span>;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * åˆ é™¤</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> entity ä¸šåŠ¡å®ä½“å¯¹è±¡</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">delete</span><span class="hljs-params">(E entity)</span></span>;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ ¹æ®IDåˆ é™¤</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> id ä¸šåŠ¡å®ä½“å¯¹è±¡çš„æ ‡è¯†</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> åˆ é™¤æˆåŠŸè¿”å›trueå¦åˆ™è¿”å›false</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">deleteById</span><span class="hljs-params">(K id)</span></span>;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * ä¿®æ”¹</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> entity ä¸šåŠ¡å®ä½“å¯¹è±¡</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> ä¿®æ”¹æˆåŠŸè¿”å›trueå¦åˆ™è¿”å›false</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">update</span><span class="hljs-params">(E entity)</span></span>;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ ¹æ®IDæŸ¥æ‰¾ä¸šåŠ¡å®ä½“å¯¹è±¡</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> id ä¸šåŠ¡å®ä½“å¯¹è±¡çš„æ ‡è¯†</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> ä¸šåŠ¡å®ä½“å¯¹è±¡å¯¹è±¡æˆ–null</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> E <span class="hljs-title">findById</span><span class="hljs-params">(K id)</span></span>;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ ¹æ®IDæŸ¥æ‰¾ä¸šåŠ¡å®ä½“å¯¹è±¡</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> id ä¸šåŠ¡å®ä½“å¯¹è±¡çš„æ ‡è¯†</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> lazy æ˜¯å¦ä½¿ç”¨å»¶è¿ŸåŠ è½½</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> ä¸šåŠ¡å®ä½“å¯¹è±¡å¯¹è±¡</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> E <span class="hljs-title">findById</span><span class="hljs-params">(K id, <span class="hljs-keyword">boolean</span> lazy)</span></span>;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æŸ¥æ‰¾æ‰€æœ‰ä¸šåŠ¡å®ä½“å¯¹è±¡</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> è£…æ‰€æœ‰ä¸šåŠ¡å®ä½“å¯¹è±¡çš„åˆ—è¡¨å®¹å™¨</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;E&gt; <span class="hljs-title">findAll</span><span class="hljs-params">()</span></span>;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * åˆ†é¡µæŸ¥æ‰¾ä¸šåŠ¡å®ä½“å¯¹è±¡</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> page é¡µç </span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> size é¡µé¢å¤§å°</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> æŸ¥è¯¢ç»“æœå¯¹è±¡</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> QueryResult&lt;E&gt; <span class="hljs-title">findByPage</span><span class="hljs-params">(<span class="hljs-keyword">int</span> page, <span class="hljs-keyword">int</span> size)</span></span>;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * åˆ†é¡µæŸ¥æ‰¾ä¸šåŠ¡å®ä½“å¯¹è±¡</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> queryBean æŸ¥è¯¢æ¡ä»¶å¯¹è±¡</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> page é¡µç </span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> size é¡µé¢å¤§å°</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> æŸ¥è¯¢ç»“æœå¯¹è±¡</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> QueryResult&lt;E&gt; <span class="hljs-title">findByPage</span><span class="hljs-params">(QueryBean queryBean, <span class="hljs-keyword">int</span> page, <span class="hljs-keyword">int</span> size)</span></span>;<br><br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.jackfrued.dao;<br><br><span class="hljs-keyword">import</span> java.io.Serializable;<br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-keyword">import</span> com.jackfrued.comm.QueryBean;<br><span class="hljs-keyword">import</span> com.jackfrued.comm.QueryResult;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * BaseDaoçš„ç¼ºçœé€‚é…å™¨</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> &lt;E&gt; å®ä½“ç±»å‹</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> &lt;K&gt; å®ä½“æ ‡è¯†å­—æ®µçš„ç±»å‹</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BaseDaoAdapter</span>&lt;<span class="hljs-title">E</span>, <span class="hljs-title">K</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Serializable</span>&gt; <span class="hljs-keyword">implements</span> <span class="hljs-title">BaseDao</span>&lt;<span class="hljs-title">E</span>, <span class="hljs-title">K</span>&gt; </span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> K <span class="hljs-title">save</span><span class="hljs-params">(E entity)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">delete</span><span class="hljs-params">(E entity)</span> </span>&#123;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">deleteById</span><span class="hljs-params">(K id)</span> </span>&#123;<br>        E entity = findById(id);<br>        <span class="hljs-keyword">if</span>(entity != <span class="hljs-keyword">null</span>) &#123;<br>            delete(entity);<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">update</span><span class="hljs-params">(E entity)</span> </span>&#123;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> E <span class="hljs-title">findById</span><span class="hljs-params">(K id)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> E <span class="hljs-title">findById</span><span class="hljs-params">(K id, <span class="hljs-keyword">boolean</span> lazy)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;E&gt; <span class="hljs-title">findAll</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> QueryResult&lt;E&gt; <span class="hljs-title">findByPage</span><span class="hljs-params">(<span class="hljs-keyword">int</span> page, <span class="hljs-keyword">int</span> size)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> QueryResult&lt;E&gt; <span class="hljs-title">findByPage</span><span class="hljs-params">(QueryBean queryBean, <span class="hljs-keyword">int</span> page, <span class="hljs-keyword">int</span> size)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.jackfrued.dao;<br><br><span class="hljs-keyword">import</span> java.io.Serializable;<br><span class="hljs-keyword">import</span> java.lang.reflect.ParameterizedType;<br><span class="hljs-keyword">import</span> java.util.ArrayList;<br><span class="hljs-keyword">import</span> java.util.Collections;<br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-keyword">import</span> org.hibernate.Query;<br><span class="hljs-keyword">import</span> org.hibernate.Session;<br><span class="hljs-keyword">import</span> org.hibernate.SessionFactory;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><br><span class="hljs-keyword">import</span> com.jackfrued.comm.HQLQueryBean;<br><span class="hljs-keyword">import</span> com.jackfrued.comm.QueryBean;<br><span class="hljs-keyword">import</span> com.jackfrued.comm.QueryResult;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * åŸºäºHibernateçš„BaseDaoå®ç°ç±»</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> &lt;E&gt; å®ä½“ç±»å‹</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> &lt;K&gt; ä¸»é”®ç±»å‹</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@SuppressWarnings(value = &#123;&quot;unchecked&quot;&#125;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BaseDaoHibernateImpl</span>&lt;<span class="hljs-title">E</span>, <span class="hljs-title">K</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Serializable</span>&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title">BaseDaoAdapter</span>&lt;<span class="hljs-title">E</span>, <span class="hljs-title">K</span>&gt; </span>&#123;<br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">protected</span> SessionFactory sessionFactory;<br><br>    <span class="hljs-keyword">private</span> Class&lt;?&gt; entityClass;       <span class="hljs-comment">// ä¸šåŠ¡å®ä½“çš„ç±»å¯¹è±¡</span><br>    <span class="hljs-keyword">private</span> String entityName;          <span class="hljs-comment">// ä¸šåŠ¡å®ä½“çš„åå­—</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">BaseDaoHibernateImpl</span><span class="hljs-params">()</span> </span>&#123;<br>        ParameterizedType pt = (ParameterizedType) <span class="hljs-keyword">this</span>.getClass().getGenericSuperclass();<br>        entityClass = (Class&lt;?&gt;) pt.getActualTypeArguments()[<span class="hljs-number">0</span>];<br>        entityName = entityClass.getSimpleName();<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> K <span class="hljs-title">save</span><span class="hljs-params">(E entity)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> (K) sessionFactory.getCurrentSession().save(entity);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">delete</span><span class="hljs-params">(E entity)</span> </span>&#123;<br>        sessionFactory.getCurrentSession().delete(entity);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">update</span><span class="hljs-params">(E entity)</span> </span>&#123;<br>        sessionFactory.getCurrentSession().update(entity);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> E <span class="hljs-title">findById</span><span class="hljs-params">(K id)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> findById(id, <span class="hljs-keyword">false</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> E <span class="hljs-title">findById</span><span class="hljs-params">(K id, <span class="hljs-keyword">boolean</span> lazy)</span> </span>&#123;<br>        Session session = sessionFactory.getCurrentSession();<br>        <span class="hljs-keyword">return</span> (E) (lazy? session.load(entityClass, id) : session.get(entityClass, id));<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;E&gt; <span class="hljs-title">findAll</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> sessionFactory.getCurrentSession().createCriteria(entityClass).list();<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> QueryResult&lt;E&gt; <span class="hljs-title">findByPage</span><span class="hljs-params">(<span class="hljs-keyword">int</span> page, <span class="hljs-keyword">int</span> size)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> QueryResult&lt;E&gt;(<br>            findByHQLAndPage(<span class="hljs-string">&quot;from &quot;</span> + entityName , page, size),<br>            getCountByHQL(<span class="hljs-string">&quot;select count(*) from &quot;</span> + entityName)<br>        );<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> QueryResult&lt;E&gt; <span class="hljs-title">findByPage</span><span class="hljs-params">(QueryBean queryBean, <span class="hljs-keyword">int</span> page, <span class="hljs-keyword">int</span> size)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span>(queryBean <span class="hljs-keyword">instanceof</span> HQLQueryBean) &#123;<br>            HQLQueryBean hqlQueryBean = (HQLQueryBean) queryBean;<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> QueryResult&lt;E&gt;(<br>                findByHQLAndPage(hqlQueryBean.getQueryString(), page, size, hqlQueryBean.getParameters()),<br>                getCountByHQL(hqlQueryBean.getCountString(), hqlQueryBean.getParameters())<br>            );<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ ¹æ®HQLå’Œå¯å˜å‚æ•°åˆ—è¡¨è¿›è¡ŒæŸ¥è¯¢</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> hql åŸºäºHQLçš„æŸ¥è¯¢è¯­å¥</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> params å¯å˜å‚æ•°åˆ—è¡¨</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> æŒæœ‰æŸ¥è¯¢ç»“æœçš„åˆ—è¡¨å®¹å™¨æˆ–ç©ºåˆ—è¡¨å®¹å™¨</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> List&lt;E&gt; <span class="hljs-title">findByHQL</span><span class="hljs-params">(String hql, Object... params)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.findByHQL(hql, getParamList(params));<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ ¹æ®HQLå’Œå‚æ•°åˆ—è¡¨è¿›è¡ŒæŸ¥è¯¢</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> hql åŸºäºHQLçš„æŸ¥è¯¢è¯­å¥</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> params æŸ¥è¯¢å‚æ•°åˆ—è¡¨</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> æŒæœ‰æŸ¥è¯¢ç»“æœçš„åˆ—è¡¨å®¹å™¨æˆ–ç©ºåˆ—è¡¨å®¹å™¨</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> List&lt;E&gt; <span class="hljs-title">findByHQL</span><span class="hljs-params">(String hql, List&lt;Object&gt; params)</span> </span>&#123;<br>        List&lt;E&gt; list = createQuery(hql, params).list();<br>        <span class="hljs-keyword">return</span> list != <span class="hljs-keyword">null</span> &amp;&amp; list.size() &gt; <span class="hljs-number">0</span> ? list : Collections.EMPTY_LIST;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ ¹æ®HQLå’Œå‚æ•°åˆ—è¡¨è¿›è¡Œåˆ†é¡µæŸ¥è¯¢</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> hql åŸºäºHQLçš„æŸ¥è¯¢è¯­å¥</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@page</span> é¡µç </span><br><span class="hljs-comment">     * <span class="hljs-doctag">@size</span> é¡µé¢å¤§å°</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> params å¯å˜å‚æ•°åˆ—è¡¨</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> æŒæœ‰æŸ¥è¯¢ç»“æœçš„åˆ—è¡¨å®¹å™¨æˆ–ç©ºåˆ—è¡¨å®¹å™¨</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> List&lt;E&gt; <span class="hljs-title">findByHQLAndPage</span><span class="hljs-params">(String hql, <span class="hljs-keyword">int</span> page, <span class="hljs-keyword">int</span> size, Object... params)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.findByHQLAndPage(hql, page, size, getParamList(params));<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ ¹æ®HQLå’Œå‚æ•°åˆ—è¡¨è¿›è¡Œåˆ†é¡µæŸ¥è¯¢</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> hql åŸºäºHQLçš„æŸ¥è¯¢è¯­å¥</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@page</span> é¡µç </span><br><span class="hljs-comment">     * <span class="hljs-doctag">@size</span> é¡µé¢å¤§å°</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> params æŸ¥è¯¢å‚æ•°åˆ—è¡¨</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> æŒæœ‰æŸ¥è¯¢ç»“æœçš„åˆ—è¡¨å®¹å™¨æˆ–ç©ºåˆ—è¡¨å®¹å™¨</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> List&lt;E&gt; <span class="hljs-title">findByHQLAndPage</span><span class="hljs-params">(String hql, <span class="hljs-keyword">int</span> page, <span class="hljs-keyword">int</span> size, List&lt;Object&gt; params)</span> </span>&#123;<br>        List&lt;E&gt; list = createQuery(hql, params)<br>                .setFirstResult((page - <span class="hljs-number">1</span>) * size)<br>                .setMaxResults(size)<br>                .list();<br>        <span class="hljs-keyword">return</span> list != <span class="hljs-keyword">null</span> &amp;&amp; list.size() &gt; <span class="hljs-number">0</span> ? list : Collections.EMPTY_LIST;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æŸ¥è¯¢æ»¡è¶³æ¡ä»¶çš„è®°å½•æ•°</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> hql åŸºäºHQLçš„æŸ¥è¯¢è¯­å¥</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> params å¯å˜å‚æ•°åˆ—è¡¨</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> æ»¡è¶³æŸ¥è¯¢æ¡ä»¶çš„æ€»è®°å½•æ•°</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">long</span> <span class="hljs-title">getCountByHQL</span><span class="hljs-params">(String hql, Object... params)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.getCountByHQL(hql, getParamList(params));<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æŸ¥è¯¢æ»¡è¶³æ¡ä»¶çš„è®°å½•æ•°</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> hql åŸºäºHQLçš„æŸ¥è¯¢è¯­å¥</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> params å‚æ•°åˆ—è¡¨å®¹å™¨</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> æ»¡è¶³æŸ¥è¯¢æ¡ä»¶çš„æ€»è®°å½•æ•°</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">long</span> <span class="hljs-title">getCountByHQL</span><span class="hljs-params">(String hql, List&lt;Object&gt; params)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> (Long) createQuery(hql, params).uniqueResult();<br>    &#125;<br><br>    <span class="hljs-comment">// åˆ›å»ºHibernateæŸ¥è¯¢å¯¹è±¡(Query)</span><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> Query <span class="hljs-title">createQuery</span><span class="hljs-params">(String hql, List&lt;Object&gt; params)</span> </span>&#123;<br>        Query query = sessionFactory.getCurrentSession().createQuery(hql);<br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; params.size(); i++) &#123;<br>            query.setParameter(i, params.get(i));<br>        &#125;<br>        <span class="hljs-keyword">return</span> query;<br>    &#125;<br><br>    <span class="hljs-comment">// å°†å¯å˜å‚æ•°åˆ—è¡¨ç»„è£…æˆåˆ—è¡¨å®¹å™¨</span><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> List&lt;Object&gt; <span class="hljs-title">getParamList</span><span class="hljs-params">(Object... params)</span> </span>&#123;<br>        List&lt;Object&gt; paramList = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();<br>        <span class="hljs-keyword">if</span>(params != <span class="hljs-keyword">null</span>) &#123;<br>            <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; params.length; i++) &#123;<br>                paramList.add(params[i]);<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> paramList.size() == <span class="hljs-number">0</span>? Collections.EMPTY_LIST : paramList;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.jackfrued.comm;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * æŸ¥è¯¢æ¡ä»¶çš„æ¥å£</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">QueryBean</span> </span>&#123;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ·»åŠ æ’åºå­—æ®µ</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> fieldName ç”¨äºæ’åºçš„å­—æ®µ</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> asc å‡åºè¿˜æ˜¯é™åº</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> æŸ¥è¯¢æ¡ä»¶å¯¹è±¡è‡ªèº«(æ–¹ä¾¿çº§è”ç¼–ç¨‹)</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> QueryBean <span class="hljs-title">addOrder</span><span class="hljs-params">(String fieldName, <span class="hljs-keyword">boolean</span> asc)</span></span>;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ·»åŠ æ’åºå­—æ®µ</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> available æ˜¯å¦æ·»åŠ æ­¤æ’åºå­—æ®µ</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> fieldName ç”¨äºæ’åºçš„å­—æ®µ</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> asc å‡åºè¿˜æ˜¯é™åº</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> æŸ¥è¯¢æ¡ä»¶å¯¹è±¡è‡ªèº«(æ–¹ä¾¿çº§è”ç¼–ç¨‹)</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> QueryBean <span class="hljs-title">addOrder</span><span class="hljs-params">(<span class="hljs-keyword">boolean</span> available, String fieldName, <span class="hljs-keyword">boolean</span> asc)</span></span>;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ·»åŠ æŸ¥è¯¢æ¡ä»¶</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> condition æ¡ä»¶</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> params æ›¿æ¢æ‰æ¡ä»¶ä¸­å‚æ•°å ä½ç¬¦çš„å‚æ•°</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> æŸ¥è¯¢æ¡ä»¶å¯¹è±¡è‡ªèº«(æ–¹ä¾¿çº§è”ç¼–ç¨‹)</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> QueryBean <span class="hljs-title">addCondition</span><span class="hljs-params">(String condition, Object... params)</span></span>;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ·»åŠ æŸ¥è¯¢æ¡ä»¶</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> available æ˜¯å¦éœ€è¦æ·»åŠ æ­¤æ¡ä»¶</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> condition æ¡ä»¶</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> params æ›¿æ¢æ‰æ¡ä»¶ä¸­å‚æ•°å ä½ç¬¦çš„å‚æ•°</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> æŸ¥è¯¢æ¡ä»¶å¯¹è±¡è‡ªèº«(æ–¹ä¾¿çº§è”ç¼–ç¨‹)</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> QueryBean <span class="hljs-title">addCondition</span><span class="hljs-params">(<span class="hljs-keyword">boolean</span> available, String condition, Object... params)</span></span>;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * è·å¾—æŸ¥è¯¢è¯­å¥</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> æŸ¥è¯¢è¯­å¥</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getQueryString</span><span class="hljs-params">()</span></span>;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * è·å–æŸ¥è¯¢è®°å½•æ•°çš„æŸ¥è¯¢è¯­å¥</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> æŸ¥è¯¢è®°å½•æ•°çš„æŸ¥è¯¢è¯­å¥</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getCountString</span><span class="hljs-params">()</span></span>;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * è·å¾—æŸ¥è¯¢å‚æ•°</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> æŸ¥è¯¢å‚æ•°çš„åˆ—è¡¨å®¹å™¨</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;Object&gt; <span class="hljs-title">getParameters</span><span class="hljs-params">()</span></span>;<br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.jackfrued.comm;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * æŸ¥è¯¢ç»“æœ</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> &lt;T&gt; æ³›å‹å‚æ•°</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">QueryResult</span>&lt;<span class="hljs-title">T</span>&gt; </span>&#123;<br>    <span class="hljs-keyword">private</span> List&lt;T&gt; result;     <span class="hljs-comment">// æŒæœ‰æŸ¥è¯¢ç»“æœçš„åˆ—è¡¨å®¹å™¨</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">long</span> totalRecords;  <span class="hljs-comment">// æŸ¥è¯¢åˆ°çš„æ€»è®°å½•æ•°</span><br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ„é€ å™¨</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">QueryResult</span><span class="hljs-params">()</span> </span>&#123;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ„é€ å™¨</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> result æŒæœ‰æŸ¥è¯¢ç»“æœçš„åˆ—è¡¨å®¹å™¨</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> totalRecords æŸ¥è¯¢åˆ°çš„æ€»è®°å½•æ•°</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">QueryResult</span><span class="hljs-params">(List&lt;T&gt; result, <span class="hljs-keyword">long</span> totalRecords)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.result = result;<br>        <span class="hljs-keyword">this</span>.totalRecords = totalRecords;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;T&gt; <span class="hljs-title">getResult</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> result;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setResult</span><span class="hljs-params">(List&lt;T&gt; result)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.result = result;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">long</span> <span class="hljs-title">getTotalRecords</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> totalRecords;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setTotalRecords</span><span class="hljs-params">(<span class="hljs-keyword">long</span> totalRecords)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.totalRecords = totalRecords;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.jackfrued.dao;<br><br><span class="hljs-keyword">import</span> com.jackfrued.comm.QueryResult;<br><span class="hljs-keyword">import</span> com.jackfrued.entity.Dept;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * éƒ¨é—¨æ•°æ®è®¿é—®å¯¹è±¡æ¥å£</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">DeptDao</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">BaseDao</span>&lt;<span class="hljs-title">Dept</span>, <span class="hljs-title">Integer</span>&gt; </span>&#123;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * åˆ†é¡µæŸ¥è¯¢é¡¶çº§éƒ¨é—¨</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> page é¡µç </span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> size é¡µç å¤§å°</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> æŸ¥è¯¢ç»“æœå¯¹è±¡</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> QueryResult&lt;Dept&gt; <span class="hljs-title">findTopDeptByPage</span><span class="hljs-params">(<span class="hljs-keyword">int</span> page, <span class="hljs-keyword">int</span> size)</span></span>;<br><br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.jackfrued.dao.impl;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-keyword">import</span> org.springframework.stereotype.Repository;<br><br><span class="hljs-keyword">import</span> com.jackfrued.comm.QueryResult;<br><span class="hljs-keyword">import</span> com.jackfrued.dao.BaseDaoHibernateImpl;<br><span class="hljs-keyword">import</span> com.jackfrued.dao.DeptDao;<br><span class="hljs-keyword">import</span> com.jackfrued.entity.Dept;<br><br><span class="hljs-meta">@Repository</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DeptDaoImpl</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">BaseDaoHibernateImpl</span>&lt;<span class="hljs-title">Dept</span>, <span class="hljs-title">Integer</span>&gt; <span class="hljs-keyword">implements</span> <span class="hljs-title">DeptDao</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String HQL_FIND_TOP_DEPT = <span class="hljs-string">&quot; from Dept as d where d.superiorDept is null &quot;</span>;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> QueryResult&lt;Dept&gt; <span class="hljs-title">findTopDeptByPage</span><span class="hljs-params">(<span class="hljs-keyword">int</span> page, <span class="hljs-keyword">int</span> size)</span> </span>&#123;<br>        List&lt;Dept&gt; list = findByHQLAndPage(HQL_FIND_TOP_DEPT, page, size);<br>        <span class="hljs-keyword">long</span> totalRecords = getCountByHQL(<span class="hljs-string">&quot; select count(*) &quot;</span> + HQL_FIND_TOP_DEPT);<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> QueryResult&lt;&gt;(list, totalRecords);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.jackfrued.comm;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * åˆ†é¡µå™¨</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> &lt;T&gt; åˆ†é¡µæ•°æ®å¯¹è±¡çš„ç±»å‹</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PageBean</span>&lt;<span class="hljs-title">T</span>&gt; </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> DEFAUL_INIT_PAGE = <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> DEFAULT_PAGE_SIZE = <span class="hljs-number">10</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> DEFAULT_PAGE_COUNT = <span class="hljs-number">5</span>;<br><br>    <span class="hljs-keyword">private</span> List&lt;T&gt; data;           <span class="hljs-comment">// åˆ†é¡µæ•°æ®</span><br>    <span class="hljs-keyword">private</span> PageRange pageRange;    <span class="hljs-comment">// é¡µç èŒƒå›´</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> totalPage;          <span class="hljs-comment">// æ€»é¡µæ•°</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> size;               <span class="hljs-comment">// é¡µé¢å¤§å°</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> currentPage;        <span class="hljs-comment">// å½“å‰é¡µç </span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> pageCount;          <span class="hljs-comment">// é¡µç æ•°é‡</span><br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ„é€ å™¨</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> currentPage å½“å‰é¡µç </span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> size é¡µç å¤§å°</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> pageCount é¡µç æ•°é‡</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">PageBean</span><span class="hljs-params">(<span class="hljs-keyword">int</span> currentPage, <span class="hljs-keyword">int</span> size, <span class="hljs-keyword">int</span> pageCount)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.currentPage = currentPage &gt; <span class="hljs-number">0</span> ? currentPage : <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">this</span>.size = size &gt; <span class="hljs-number">0</span> ? size : DEFAULT_PAGE_SIZE;<br>        <span class="hljs-keyword">this</span>.pageCount = pageCount &gt; <span class="hljs-number">0</span> ? size : DEFAULT_PAGE_COUNT;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ„é€ å™¨</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> currentPage å½“å‰é¡µç </span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> size é¡µç å¤§å°</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">PageBean</span><span class="hljs-params">(<span class="hljs-keyword">int</span> currentPage, <span class="hljs-keyword">int</span> size)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>(currentPage, size, DEFAULT_PAGE_COUNT);<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ„é€ å™¨</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> currentPage å½“å‰é¡µç </span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">PageBean</span><span class="hljs-params">(<span class="hljs-keyword">int</span> currentPage)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>(currentPage, DEFAULT_PAGE_SIZE, DEFAULT_PAGE_COUNT);<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ„é€ å™¨</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">PageBean</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>(DEFAUL_INIT_PAGE, DEFAULT_PAGE_SIZE, DEFAULT_PAGE_COUNT);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;T&gt; <span class="hljs-title">getData</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> data;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getStartPage</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> pageRange != <span class="hljs-keyword">null</span> ? pageRange.getStartPage() : <span class="hljs-number">1</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getEndPage</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> pageRange != <span class="hljs-keyword">null</span> ? pageRange.getEndPage() : <span class="hljs-number">1</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">long</span> <span class="hljs-title">getTotalPage</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> totalPage;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getSize</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> size;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getCurrentPage</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> currentPage;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * å°†æŸ¥è¯¢ç»“æœè½¬æ¢ä¸ºåˆ†é¡µæ•°æ®</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> queryResult æŸ¥è¯¢ç»“æœå¯¹è±¡</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">transferQueryResult</span><span class="hljs-params">(QueryResult&lt;T&gt; queryResult)</span> </span>&#123;<br>        <span class="hljs-keyword">long</span> totalRecords = queryResult.getTotalRecords();<br><br>        data = queryResult.getResult();<br>        totalPage = (<span class="hljs-keyword">int</span>) ((totalRecords + size - <span class="hljs-number">1</span>) / size); <br>        totalPage = totalPage &gt;= <span class="hljs-number">0</span> ? totalPage : Integer.MAX_VALUE;<br>        <span class="hljs-keyword">this</span>.pageRange = <span class="hljs-keyword">new</span> PageRange(pageCount, currentPage, totalPage);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.jackfrued.comm;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * é¡µç èŒƒå›´</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PageRange</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> startPage;  <span class="hljs-comment">// èµ·å§‹é¡µç </span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> endPage;    <span class="hljs-comment">// ç»ˆæ­¢é¡µç </span><br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ„é€ å™¨</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> pageCount æ€»å…±æ˜¾ç¤ºå‡ ä¸ªé¡µç </span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> currentPage å½“å‰é¡µç </span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> totalPage æ€»é¡µæ•°</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">PageRange</span><span class="hljs-params">(<span class="hljs-keyword">int</span> pageCount, <span class="hljs-keyword">int</span> currentPage, <span class="hljs-keyword">int</span> totalPage)</span> </span>&#123;<br>        startPage = currentPage - (pageCount - <span class="hljs-number">1</span>) / <span class="hljs-number">2</span>;<br>        endPage = currentPage + pageCount / <span class="hljs-number">2</span>;<br>        <span class="hljs-keyword">if</span>(startPage &lt; <span class="hljs-number">1</span>) &#123;<br>            startPage = <span class="hljs-number">1</span>;<br>            endPage = totalPage &gt; pageCount ? pageCount : totalPage;<br>        &#125;<br>        <span class="hljs-keyword">if</span> (endPage &gt; totalPage) &#123;<br>            endPage = totalPage;<br>            startPage = (endPage - pageCount &gt; <span class="hljs-number">0</span>) ? endPage - pageCount + <span class="hljs-number">1</span> : <span class="hljs-number">1</span>;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * è·å¾—èµ·å§‹é¡µé¡µç </span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> èµ·å§‹é¡µé¡µç </span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getStartPage</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> startPage;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * è·å¾—ç»ˆæ­¢é¡µé¡µç </span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> ç»ˆæ­¢é¡µé¡µç </span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getEndPage</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> endPage;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.jackfrued.biz;<br><br><span class="hljs-keyword">import</span> com.jackfrued.comm.PageBean;<br><span class="hljs-keyword">import</span> com.jackfrued.entity.Dept;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * éƒ¨é—¨ä¸šåŠ¡é€»è¾‘æ¥å£</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">DeptService</span> </span>&#123;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * åˆ›å»ºæ–°çš„éƒ¨é—¨</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> department éƒ¨é—¨å¯¹è±¡</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> åˆ›å»ºæˆåŠŸè¿”å›trueå¦åˆ™è¿”å›false</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">createNewDepartment</span><span class="hljs-params">(Dept department)</span></span>;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * åˆ é™¤æŒ‡å®šéƒ¨é—¨</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> id è¦åˆ é™¤çš„éƒ¨é—¨çš„ç¼–å·</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> åˆ é™¤æˆåŠŸè¿”å›trueå¦åˆ™è¿”å›false</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">deleteDepartment</span><span class="hljs-params">(Integer id)</span></span>;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * åˆ†é¡µè·å–é¡¶çº§éƒ¨é—¨</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> page é¡µç </span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> size é¡µç å¤§å°</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> éƒ¨é—¨å¯¹è±¡çš„åˆ†é¡µå™¨å¯¹è±¡</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> PageBean&lt;Dept&gt; <span class="hljs-title">getTopDeptByPage</span><span class="hljs-params">(<span class="hljs-keyword">int</span> page, <span class="hljs-keyword">int</span> size)</span></span>;<br><br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.jackfrued.biz.impl;<br><br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.stereotype.Service;<br><span class="hljs-keyword">import</span> org.springframework.transaction.annotation.Transactional;<br><br><span class="hljs-keyword">import</span> com.jackfrued.biz.DeptService;<br><span class="hljs-keyword">import</span> com.jackfrued.comm.PageBean;<br><span class="hljs-keyword">import</span> com.jackfrued.comm.QueryResult;<br><span class="hljs-keyword">import</span> com.jackfrued.dao.DeptDao;<br><span class="hljs-keyword">import</span> com.jackfrued.entity.Dept;<br><br><span class="hljs-meta">@Service</span><br><span class="hljs-meta">@Transactional</span>  <span class="hljs-comment">// å£°æ˜å¼äº‹åŠ¡çš„æ³¨è§£</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DeptServiceImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">DeptService</span> </span>&#123;<br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> DeptDao deptDao;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">createNewDepartment</span><span class="hljs-params">(Dept department)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> deptDao.save(department) != <span class="hljs-keyword">null</span>;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">deleteDepartment</span><span class="hljs-params">(Integer id)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> deptDao.deleteById(id);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> PageBean&lt;Dept&gt; <span class="hljs-title">getTopDeptByPage</span><span class="hljs-params">(<span class="hljs-keyword">int</span> page, <span class="hljs-keyword">int</span> size)</span> </span>&#123;<br>        QueryResult&lt;Dept&gt; queryResult = deptDao.findTopDeptByPage(page, size);<br>        PageBean&lt;Dept&gt; pageBean = <span class="hljs-keyword">new</span> PageBean&lt;&gt;(page, size);<br>        pageBean.transferQueryResult(queryResult);<br>        <span class="hljs-keyword">return</span> pageBean;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<blockquote>
<p>154ã€å¦‚ä½•åœ¨ Web é¡¹ç›®ä¸­é…ç½® Spring çš„ IoC å®¹å™¨ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šå¦‚æœéœ€è¦åœ¨ Web é¡¹ç›®ä¸­ä½¿ç”¨ Spring çš„ IoC å®¹å™¨ï¼Œå¯ä»¥åœ¨ Web é¡¹ç›®é…ç½®æ–‡ä»¶ web.xml ä¸­åšå‡ºå¦‚ä¸‹é…ç½®ï¼š</p>
<p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">context-param</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">param-name</span>&gt;</span>contextConfigLocation<span class="hljs-tag">&lt;/<span class="hljs-name">param-name</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">param-value</span>&gt;</span>classpath:applicationContext.xml<span class="hljs-tag">&lt;/<span class="hljs-name">param-value</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">context-param</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">listener</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">listener-class</span>&gt;</span><br>        org.springframework.web.context.ContextLoaderListener<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">listener-class</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">listener</span>&gt;</span><br></code></pre></td></tr></table></figure>
</p>
<blockquote>
<p>155ã€å¦‚ä½•åœ¨ Web é¡¹ç›®ä¸­é…ç½® Spring MVCï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šè¦ä½¿ç”¨ Spring MVC éœ€è¦åœ¨ Web é¡¹ç›®é…ç½®æ–‡ä»¶ä¸­é…ç½®å…¶å‰ç«¯æ§åˆ¶å™¨ <code>DispatcherServlet</code>ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">web-app</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">servlet</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">servlet-name</span>&gt;</span>example<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">servlet-class</span>&gt;</span><br>            org.springframework.web.servlet.DispatcherServlet<br>        <span class="hljs-tag">&lt;/<span class="hljs-name">servlet-class</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">load-on-startup</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">load-on-startup</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">servlet</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">servlet-mapping</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">servlet-name</span>&gt;</span>example<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">url-pattern</span>&gt;</span>*.html<span class="hljs-tag">&lt;/<span class="hljs-name">url-pattern</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">servlet-mapping</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">web-app</span>&gt;</span><br></code></pre></td></tr></table></figure>
</p>
<p><strong>è¯´æ˜ï¼š</strong>ä¸Šé¢çš„é…ç½®ä¸­ä½¿ç”¨äº† <code>*.html</code> çš„åç¼€æ˜ å°„ï¼Œè¿™æ ·åšä¸€æ–¹é¢ä¸èƒ½å¤Ÿé€šè¿‡ URL æ¨æ–­é‡‡ç”¨äº†ä½•ç§æœåŠ¡å™¨ç«¯çš„æŠ€æœ¯ï¼Œå¦ä¸€æ–¹é¢å¯ä»¥æ¬ºéª—æœç´¢å¼•æ“ï¼Œå› ä¸ºæœç´¢å¼•æ“ä¸ä¼šæœç´¢åŠ¨æ€é¡µé¢ï¼Œè¿™ç§åšæ³•ç§°ä¸º<strong>ä¼ªé™æ€åŒ–</strong>ã€‚</p>
<blockquote>
<p>156ã€Spring MVC çš„å·¥ä½œåŸç†æ˜¯æ€æ ·çš„ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šSpring MVC çš„å·¥ä½œåŸç†å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src= "https://cdn.jsdelivr.net/gh/Eurkon/CDN/hexo/images/user/loading.gif" data-lazy-src="/images/post/java_interview/156.png" alt></p>
<ol>
<li>å®¢æˆ·ç«¯çš„æ‰€æœ‰è¯·æ±‚éƒ½äº¤ç»™å‰ç«¯æ§åˆ¶å™¨ <code>DispatcherServlet</code> æ¥å¤„ç†ï¼Œå®ƒä¼šè´Ÿè´£è°ƒç”¨ç³»ç»Ÿçš„å…¶ä»–æ¨¡å—æ¥çœŸæ­£å¤„ç†ç”¨æˆ·çš„è¯·æ±‚ã€‚</li>
<li><code>DispatcherServlet</code> æ”¶åˆ°è¯·æ±‚åï¼Œå°†æ ¹æ®è¯·æ±‚çš„ä¿¡æ¯ï¼ˆåŒ…æ‹¬ URLã€HTTP åè®®æ–¹æ³•ã€è¯·æ±‚å¤´ã€è¯·æ±‚å‚æ•°ã€Cookie ç­‰ï¼‰ä»¥åŠ <code>HandlerMapping</code> çš„é…ç½®æ‰¾åˆ°å¤„ç†è¯¥è¯·æ±‚çš„ <code>Handler</code>ï¼ˆä»»ä½•ä¸€ä¸ªå¯¹è±¡éƒ½å¯ä»¥ä½œä¸ºè¯·æ±‚çš„ <code>Handler</code>ï¼‰ã€‚</li>
<li>åœ¨è¿™ä¸ªåœ°æ–¹ Spring ä¼šé€šè¿‡ <code>Controller</code> å¯¹è¯¥å¤„ç†å™¨è¿›è¡Œå°è£…ã€‚</li>
<li><code>Controller</code> æ˜¯ä¸€ä¸ªé€‚é…å™¨ï¼Œå®ƒç”¨ç»Ÿä¸€çš„æ¥å£å¯¹å„ç§ <code>Handler</code> ä¸­çš„æ–¹æ³•è¿›è¡Œè°ƒç”¨ã€‚</li>
<li><code>Handler</code> å®Œæˆå¯¹ç”¨æˆ·è¯·æ±‚çš„å¤„ç†åï¼Œä¼šè¿”å›ä¸€ä¸ª <code>ModelAndView</code> å¯¹è±¡ç»™ <code>DispatcherServlet</code>ï¼Œ<code>ModelAndView</code> é¡¾åæ€ä¹‰ï¼ŒåŒ…å«äº†æ•°æ®æ¨¡å‹ä»¥åŠç›¸åº”çš„è§†å›¾çš„ä¿¡æ¯ã€‚</li>
<li><code>ModelAndView</code> çš„è§†å›¾æ˜¯é€»è¾‘è§†å›¾ï¼Œ<code>DispatcherServlet</code> è¿˜è¦å€ŸåŠ© <code>ViewResolver</code> å®Œæˆä»é€»è¾‘è§†å›¾åˆ°çœŸå®è§†å›¾å¯¹è±¡çš„è§£æå·¥ä½œã€‚</li>
<li>å½“å¾—åˆ°çœŸæ­£çš„è§†å›¾å¯¹è±¡åï¼Œ<code>DispatcherServlet</code> ä¼šåˆ©ç”¨è§†å›¾å¯¹è±¡å¯¹æ¨¡å‹æ•°æ®è¿›è¡Œæ¸²æŸ“ã€‚</li>
<li>å®¢æˆ·ç«¯å¾—åˆ°å“åº”ï¼Œå¯èƒ½æ˜¯ä¸€ä¸ªæ™®é€šçš„HTMLé¡µé¢ï¼Œä¹Ÿå¯ä»¥æ˜¯ XML æˆ– JSON å­—ç¬¦ä¸²ï¼Œè¿˜å¯ä»¥æ˜¯ä¸€å¼ å›¾ç‰‡æˆ–è€…ä¸€ä¸ª PDF æ–‡ä»¶ã€‚</li>
</ol>
<blockquote>
<p>157ã€å¦‚ä½•åœ¨ Spring IoC å®¹å™¨ä¸­é…ç½®æ•°æ®æºï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼š</p>
<p>DBCP é…ç½®ï¼š</p>
<p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;dataSource&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.apache.commons.dbcp.BasicDataSource&quot;</span> <span class="hljs-attr">destroy-method</span>=<span class="hljs-string">&quot;close&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;driverClassName&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$&#123;jdbc.driverClassName&#125;&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;url&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$&#123;jdbc.url&#125;&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;username&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$&#123;jdbc.username&#125;&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$&#123;jdbc.password&#125;&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">context:property-placeholder</span> <span class="hljs-attr">location</span>=<span class="hljs-string">&quot;jdbc.properties&quot;</span>/&gt;</span><br></code></pre></td></tr></table></figure>
</p>
<p>C3P0 é…ç½®ï¼š</p>
<p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;dataSource&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.mchange.v2.c3p0.ComboPooledDataSource&quot;</span> <span class="hljs-attr">destroy-method</span>=<span class="hljs-string">&quot;close&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;driverClass&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$&#123;jdbc.driverClassName&#125;&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;jdbcUrl&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$&#123;jdbc.url&#125;&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;user&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$&#123;jdbc.username&#125;&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$&#123;jdbc.password&#125;&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">context:property-placeholder</span> <span class="hljs-attr">location</span>=<span class="hljs-string">&quot;jdbc.properties&quot;</span>/&gt;</span><br></code></pre></td></tr></table></figure>
</p>
<p><strong>æ³¨æ„ï¼š</strong> DBCP çš„è¯¦ç»†é…ç½®åœ¨ç¬¬ 153 é¢˜ä¸­å·²ç»å®Œæ•´çš„å±•ç¤ºè¿‡äº†ã€‚</p>
<blockquote>
<p>158ã€å¦‚ä½•é…ç½®é…ç½®äº‹åŠ¡å¢å¼ºï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼š</p>
<p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">beans</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">xmlns:aop</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/aop&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">xmlns:tx</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/tx&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;</span></span><br><span class="hljs-tag"><span class="hljs-string">     http://www.springframework.org/schema/beans</span></span><br><span class="hljs-tag"><span class="hljs-string">     http://www.springframework.org/schema/beans/spring-beans.xsd</span></span><br><span class="hljs-tag"><span class="hljs-string">     http://www.springframework.org/schema/tx</span></span><br><span class="hljs-tag"><span class="hljs-string">     http://www.springframework.org/schema/tx/spring-tx.xsd</span></span><br><span class="hljs-tag"><span class="hljs-string">     http://www.springframework.org/schema/aop</span></span><br><span class="hljs-tag"><span class="hljs-string">     http://www.springframework.org/schema/aop/spring-aop.xsd&quot;</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- this is the service object that we want to make transactional --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;fooService&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;x.y.service.DefaultFooService&quot;</span> /&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- the transactional advice --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">tx:advice</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;txAdvice&quot;</span> <span class="hljs-attr">transaction-manager</span>=<span class="hljs-string">&quot;txManager&quot;</span>&gt;</span><br>        <span class="hljs-comment">&lt;!-- the transactional semantics... --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">tx:attributes</span>&gt;</span><br>            <span class="hljs-comment">&lt;!-- all methods starting with &#x27;get&#x27; are read-only --&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">tx:method</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;get*&quot;</span> <span class="hljs-attr">read-only</span>=<span class="hljs-string">&quot;true&quot;</span> /&gt;</span><br>            <span class="hljs-comment">&lt;!-- other methods use the default transaction settings (see below) --&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">tx:method</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;*&quot;</span> /&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">tx:attributes</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">tx:advice</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- ensure that the above transactional advice runs for any execution of </span><br><span class="hljs-comment">        an operation defined by the FooService interface --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">aop:config</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">aop:pointcut</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;fooServiceOperation&quot;</span> <span class="hljs-attr">expression</span>=<span class="hljs-string">&quot;execution(* x.y.service.FooService.*(..))&quot;</span> /&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">aop:advisor</span> <span class="hljs-attr">advice-ref</span>=<span class="hljs-string">&quot;txAdvice&quot;</span> <span class="hljs-attr">pointcut-ref</span>=<span class="hljs-string">&quot;fooServiceOperation&quot;</span> /&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">aop:config</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- don&#x27;t forget the DataSource --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;dataSource&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.apache.commons.dbcp.BasicDataSource&quot;</span> <span class="hljs-attr">destroy-method</span>=<span class="hljs-string">&quot;close&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;driverClassName&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;oracle.jdbc.driver.OracleDriver&quot;</span> /&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;url&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;jdbc:oracle:thin:@localhost:1521:orcl&quot;</span> /&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;username&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;scott&quot;</span> /&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;tiger&quot;</span> /&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- similarly, don&#x27;t forget the PlatformTransactionManager --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;txManager&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;dataSource&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;dataSource&quot;</span> /&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- other &lt;bean/&gt; definitions here --&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">beans</span>&gt;</span><br></code></pre></td></tr></table></figure>
</p>
<blockquote>
<p>159ã€é€‰æ‹©ä½¿ç”¨ Spring æ¡†æ¶çš„åŸå› ï¼ˆSpring æ¡†æ¶ä¸ºä¼ä¸šçº§å¼€å‘å¸¦æ¥çš„å¥½å¤„æœ‰å“ªäº›ï¼‰ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šå¯ä»¥ä»ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ä½œç­”ï¼š</p>
<ul>
<li>éä¾µå…¥å¼ï¼šæ”¯æŒåŸºäº POJO çš„ç¼–ç¨‹æ¨¡å¼ï¼Œä¸å¼ºåˆ¶æ€§çš„è¦æ±‚å®ç° Spring æ¡†æ¶ä¸­çš„æ¥å£æˆ–ç»§æ‰¿ Spring æ¡†æ¶ä¸­çš„ç±»ã€‚</li>
<li>IoC å®¹å™¨ï¼šIoC å®¹å™¨å¸®åŠ©åº”ç”¨ç¨‹åºç®¡ç†å¯¹è±¡ä»¥åŠå¯¹è±¡ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œå¯¹è±¡ä¹‹é—´çš„ä¾èµ–å…³ç³»å¦‚æœå‘ç”Ÿäº†æ”¹å˜åªéœ€è¦ä¿®æ”¹é…ç½®æ–‡ä»¶è€Œä¸æ˜¯ä¿®æ”¹ä»£ç ï¼Œå› ä¸ºä»£ç çš„ä¿®æ”¹å¯èƒ½æ„å‘³ç€é¡¹ç›®çš„é‡æ–°æ„å»ºå’Œå®Œæ•´çš„å›å½’æµ‹è¯•ã€‚æœ‰äº† IoC å®¹å™¨ï¼Œç¨‹åºå‘˜å†ä¹Ÿä¸éœ€è¦è‡ªå·±ç¼–å†™å·¥å‚ã€å•ä¾‹ï¼Œè¿™ä¸€ç‚¹ç‰¹åˆ«ç¬¦åˆ Spring çš„ç²¾ç¥â€œä¸è¦é‡å¤çš„å‘æ˜è½®å­â€ã€‚</li>
<li>AOPï¼ˆé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼‰ï¼šå°†æ‰€æœ‰çš„æ¨ªåˆ‡å…³æ³¨åŠŸèƒ½å°è£…åˆ°åˆ‡é¢ï¼ˆaspectï¼‰ä¸­ï¼Œé€šè¿‡é…ç½®çš„æ–¹å¼å°†æ¨ªåˆ‡å…³æ³¨åŠŸèƒ½åŠ¨æ€æ·»åŠ åˆ°ç›®æ ‡ä»£ç ä¸Šï¼Œè¿›ä¸€æ­¥å®ç°äº†ä¸šåŠ¡é€»è¾‘å’Œç³»ç»ŸæœåŠ¡ä¹‹é—´çš„åˆ†ç¦»ã€‚å¦ä¸€æ–¹é¢ï¼Œæœ‰äº† AOP ç¨‹åºå‘˜å¯ä»¥çœå»å¾ˆå¤šè‡ªå·±å†™ä»£ç†ç±»çš„å·¥ä½œã€‚</li>
<li>MVCï¼šSpring çš„ MVC æ¡†æ¶æ˜¯éå¸¸ä¼˜ç§€çš„ï¼Œä»å„ä¸ªæ–¹é¢éƒ½å¯ä»¥ç”© Struts 2 å‡ æ¡è¡—ï¼Œä¸º Web è¡¨ç¤ºå±‚æä¾›äº†æ›´å¥½çš„è§£å†³æ–¹æ¡ˆã€‚</li>
<li>äº‹åŠ¡ç®¡ç†ï¼šSpring ä»¥å®½å¹¿çš„èƒ¸æ€€æ¥çº³å¤šç§æŒä¹…å±‚æŠ€æœ¯ï¼Œå¹¶ä¸”ä¸ºå…¶æä¾›äº†å£°æ˜å¼çš„äº‹åŠ¡ç®¡ç†ï¼Œåœ¨ä¸éœ€è¦ä»»ä½•ä¸€è¡Œä»£ç çš„æƒ…å†µä¸‹å°±èƒ½å¤Ÿå®Œæˆäº‹åŠ¡ç®¡ç†ã€‚</li>
<li>å…¶ä»–ï¼šé€‰æ‹© Spring æ¡†æ¶çš„åŸå› è¿˜è¿œä¸æ­¢äºæ­¤ï¼ŒSpring ä¸º Java ä¼ä¸šçº§å¼€å‘æä¾›äº†ä¸€ç«™å¼é€‰æ‹©ï¼Œä½ å¯ä»¥åœ¨éœ€è¦çš„æ—¶å€™ä½¿ç”¨å®ƒçš„éƒ¨åˆ†å’Œå…¨éƒ¨ï¼Œæ›´é‡è¦çš„æ˜¯ï¼Œä½ ç”šè‡³å¯ä»¥åœ¨æ„Ÿè§‰ä¸åˆ° Spring å­˜åœ¨çš„æƒ…å†µä¸‹ï¼Œåœ¨ä½ çš„é¡¹ç›®ä¸­ä½¿ç”¨ Spring æä¾›çš„å„ç§ä¼˜ç§€çš„åŠŸèƒ½ã€‚</li>
</ul>
<blockquote>
<p>160ã€Spring IoC å®¹å™¨é…ç½® Bean çš„æ–¹å¼ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼š</p>
<ul>
<li>åŸºäº XML æ–‡ä»¶è¿›è¡Œé…ç½®ã€‚</li>
<li>åŸºäºæ³¨è§£è¿›è¡Œé…ç½®ã€‚</li>
<li>åŸºäº Java ç¨‹åºè¿›è¡Œé…ç½®ï¼ˆSpring 3+ï¼‰</li>
</ul>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.jackfrued.bean;<br><br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.stereotype.Component;<br><br><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Person</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> String name;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> age;<br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> Car car;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Person</span><span class="hljs-params">(String name, <span class="hljs-keyword">int</span> age)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.name = name;<br>        <span class="hljs-keyword">this</span>.age = age;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setCar</span><span class="hljs-params">(Car car)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.car = car;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">toString</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Person [name=&quot;</span> + name + <span class="hljs-string">&quot;, age=&quot;</span> + age + <span class="hljs-string">&quot;, car=&quot;</span> + car + <span class="hljs-string">&quot;]&quot;</span>;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.jackfrued.bean;<br><br><span class="hljs-keyword">import</span> org.springframework.stereotype.Component;<br><br><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Car</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> String brand;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> maxSpeed;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Car</span><span class="hljs-params">(String brand, <span class="hljs-keyword">int</span> maxSpeed)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.brand = brand;<br>        <span class="hljs-keyword">this</span>.maxSpeed = maxSpeed;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">toString</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Car [brand=&quot;</span> + brand + <span class="hljs-string">&quot;, maxSpeed=&quot;</span> + maxSpeed + <span class="hljs-string">&quot;]&quot;</span>;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.jackfrued.config;<br><br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Bean;<br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Configuration;<br><br><span class="hljs-keyword">import</span> com.jackfrued.bean.Car;<br><span class="hljs-keyword">import</span> com.jackfrued.bean.Person;<br><br><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AppConfig</span> </span>&#123;<br><br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Car <span class="hljs-title">car</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Car(<span class="hljs-string">&quot;Benz&quot;</span>, <span class="hljs-number">320</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Person <span class="hljs-title">person</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Person(<span class="hljs-string">&quot;Jack&quot;</span>, <span class="hljs-number">34</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.jackfrued.test;<br><br><span class="hljs-keyword">import</span> org.springframework.context.ConfigurableApplicationContext;<br><span class="hljs-keyword">import</span> org.springframework.context.annotation.AnnotationConfigApplicationContext;<br><br><span class="hljs-keyword">import</span> com.jackfrued.bean.Person;<br><span class="hljs-keyword">import</span> com.jackfrued.config.AppConfig;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        <span class="hljs-comment">// TWR (Java 7+)</span><br>        <span class="hljs-keyword">try</span>(ConfigurableApplicationContext factory = <span class="hljs-keyword">new</span> AnnotationConfigApplicationContext(AppConfig.class)) &#123;<br>            Person person = factory.getBean(Person.class);<br>            System.out.println(person);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
</p>
<blockquote>
<p>161ã€é˜è¿° Spring æ¡†æ¶ä¸­ Bean çš„ç”Ÿå‘½å‘¨æœŸï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼š</p>
<ol>
<li>Spring IoC å®¹å™¨æ‰¾åˆ°å…³äº Bean çš„å®šä¹‰å¹¶å®ä¾‹åŒ–è¯¥ Beanã€‚</li>
<li>Spring IoC å®¹å™¨å¯¹ Bean è¿›è¡Œä¾èµ–æ³¨å…¥ã€‚</li>
<li>å¦‚æœ Bean å®ç°äº† <code>BeanNameAware</code> æ¥å£ï¼Œåˆ™å°†è¯¥ Bean çš„ <code>id</code> ä¼ ç»™ <code>setBeanName</code> æ–¹æ³•ã€‚</li>
<li>å¦‚æœ Bean å®ç°äº† <code>BeanFactoryAware</code> æ¥å£ï¼Œåˆ™å°† <code>BeanFactory</code> å¯¹è±¡ä¼ ç»™ <code>setBeanFactory</code> æ–¹æ³•ã€‚</li>
<li>å¦‚æœ Bean å®ç°äº† <code>BeanPostProcessor</code> æ¥å£ï¼Œåˆ™è°ƒç”¨å…¶ <code>postProcessBeforeInitialization</code> æ–¹æ³•ã€‚</li>
<li>å¦‚æœ Bean å®ç°äº† <code>InitializingBean</code> æ¥å£ï¼Œåˆ™è°ƒç”¨å…¶ <code>afterPropertySet</code> æ–¹æ³•ã€‚</li>
<li>å¦‚æœæœ‰å’Œ Bean å…³è”çš„ <code>BeanPostProcessors</code> å¯¹è±¡ï¼Œåˆ™è¿™äº›å¯¹è±¡çš„ <code>postProcessAfterInitialization</code> æ–¹æ³•è¢«è°ƒç”¨ã€‚</li>
<li>å½“é”€æ¯ Bean å®ä¾‹æ—¶ï¼Œå¦‚æœBeanå®ç°äº† <code>DisposableBean</code> æ¥å£ï¼Œåˆ™è°ƒç”¨å…¶ <code>destroy</code> æ–¹æ³•ã€‚</li>
</ol>
<blockquote>
<p>162ã€ä¾èµ–æ³¨å…¥æ—¶å¦‚ä½•æ³¨å…¥é›†åˆå±æ€§ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šå¯ä»¥åœ¨å®šä¹‰ Bean å±æ€§æ—¶ï¼Œé€šè¿‡ <code>&lt;list&gt;</code>/<code>&lt;set&gt;</code>/<code>&lt;map&gt;</code>/<code>&lt;props&gt;</code> åˆ†åˆ«ä¸ºå…¶æ³¨å…¥åˆ—è¡¨ã€é›†åˆã€æ˜ å°„å’Œé”®å€¼éƒ½æ˜¯å­—ç¬¦ä¸²çš„æ˜ å°„å±æ€§ã€‚</p>
<blockquote>
<p>163ã€Spring ä¸­çš„è‡ªåŠ¨è£…é…æœ‰å“ªäº›é™åˆ¶ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼š</p>
<ul>
<li>å¦‚æœä½¿ç”¨äº†æ„é€ å™¨æ³¨å…¥æˆ–è€… setter æ³¨å…¥ï¼Œé‚£ä¹ˆå°†è¦†ç›–è‡ªåŠ¨è£…é…çš„ä¾èµ–å…³ç³»ã€‚</li>
<li>åŸºæœ¬æ•°æ®ç±»å‹çš„å€¼ã€å­—ç¬¦ä¸²å­—é¢é‡ã€ç±»å­—é¢é‡æ— æ³•ä½¿ç”¨è‡ªåŠ¨è£…é…æ¥æ³¨å…¥ã€‚</li>
<li>ä¼˜å…ˆè€ƒè™‘ä½¿ç”¨æ˜¾å¼çš„è£…é…æ¥è¿›è¡Œæ›´ç²¾ç¡®çš„ä¾èµ–æ³¨å…¥è€Œä¸æ˜¯ä½¿ç”¨è‡ªåŠ¨è£…é…ã€‚</li>
</ul>
<blockquote>
<p>164ã€åœ¨ Web é¡¹ç›®ä¸­å¦‚ä½•è·å¾— Spring çš„ IoC å®¹å™¨ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼š</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">WebApplicationContext ctx = WebApplicationContextUtils.getWebApplicationContext(servletContext);<br></code></pre></td></tr></table></figure>
</p>
<blockquote>
<p>165ã€å¤§å‹ç½‘ç«™åœ¨æ¶æ„ä¸Šåº”å½“è€ƒè™‘å“ªäº›é—®é¢˜ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼š</p>
<ul>
<li><p>åˆ†å±‚ï¼šåˆ†å±‚æ˜¯å¤„ç†ä»»ä½•å¤æ‚ç³»ç»Ÿæœ€å¸¸è§çš„æ‰‹æ®µä¹‹ä¸€ï¼Œå°†ç³»ç»Ÿæ¨ªå‘åˆ‡åˆ†æˆè‹¥å¹²ä¸ªå±‚é¢ï¼Œæ¯ä¸ªå±‚é¢åªæ‰¿æ‹…å•ä¸€çš„èŒè´£ï¼Œç„¶åé€šè¿‡ä¸‹å±‚ä¸ºä¸Šå±‚æä¾›çš„åŸºç¡€è®¾æ–½å’ŒæœåŠ¡ä»¥åŠä¸Šå±‚å¯¹ä¸‹å±‚çš„è°ƒç”¨æ¥å½¢æˆä¸€ä¸ªå®Œæ•´çš„å¤æ‚çš„ç³»ç»Ÿã€‚è®¡ç®—æœºç½‘ç»œçš„å¼€æ”¾ç³»ç»Ÿäº’è”å‚è€ƒæ¨¡å‹ï¼ˆOSI/RMï¼‰å’Œ Internet çš„ TCP/IP æ¨¡å‹éƒ½æ˜¯åˆ†å±‚ç»“æ„ã€‚</p>
<p>  å¤§å‹ç½‘ç«™çš„è½¯ä»¶ç³»ç»Ÿä¹Ÿå¯ä»¥ä½¿ç”¨åˆ†å±‚çš„ç†å¿µå°†å…¶åˆ†ä¸º<strong>æŒä¹…å±‚</strong>ï¼ˆæä¾›æ•°æ®å­˜å‚¨å’Œè®¿é—®æœåŠ¡ï¼‰ã€<strong>ä¸šåŠ¡å±‚</strong>ï¼ˆå¤„ç†ä¸šåŠ¡é€»è¾‘ï¼Œç³»ç»Ÿä¸­æœ€æ ¸å¿ƒçš„éƒ¨åˆ†ï¼‰å’Œ<strong>è¡¨ç¤ºå±‚</strong>ï¼ˆç³»ç»Ÿäº¤äº’ã€è§†å›¾å±•ç¤ºï¼‰ã€‚éœ€è¦æŒ‡å‡ºçš„æ˜¯ï¼š(1)åˆ†å±‚æ˜¯é€»è¾‘ä¸Šçš„åˆ’åˆ†ï¼Œåœ¨ç‰©ç†ä¸Šå¯ä»¥ä½äºåŒä¸€è®¾å¤‡ä¸Šä¹Ÿå¯ä»¥åœ¨ä¸åŒçš„è®¾å¤‡ä¸Šéƒ¨ç½²ä¸åŒçš„åŠŸèƒ½æ¨¡å—ï¼Œè¿™æ ·å¯ä»¥ä½¿ç”¨æ›´å¤šçš„è®¡ç®—èµ„æºæ¥åº”å¯¹ç”¨æˆ·çš„å¹¶å‘è®¿é—®ï¼›(2)å±‚ä¸å±‚ä¹‹é—´åº”å½“æœ‰æ¸…æ™°çš„è¾¹ç•Œï¼Œè¿™æ ·åˆ†å±‚æ‰æœ‰æ„ä¹‰ï¼Œæ‰æ›´åˆ©äºè½¯ä»¶çš„å¼€å‘å’Œç»´æŠ¤ã€‚</p>
</li>
<li><p>åˆ†å‰²ï¼šåˆ†å‰²æ˜¯å¯¹è½¯ä»¶çš„çºµå‘åˆ‡åˆ†ã€‚æˆ‘ä»¬å¯ä»¥å°†å¤§å‹ç½‘ç«™çš„ä¸åŒåŠŸèƒ½å’ŒæœåŠ¡åˆ†å‰²å¼€ï¼Œå½¢æˆé«˜å†…èšä½è€¦åˆçš„åŠŸèƒ½æ¨¡å—ï¼ˆå•å…ƒï¼‰ã€‚åœ¨è®¾è®¡åˆæœŸå¯ä»¥åšä¸€ä¸ªç²—ç²’åº¦çš„åˆ†å‰²ï¼Œå°†ç½‘ç«™åˆ†å‰²ä¸ºè‹¥å¹²ä¸ªåŠŸèƒ½æ¨¡å—ï¼ŒåæœŸè¿˜å¯ä»¥è¿›ä¸€æ­¥å¯¹æ¯ä¸ªæ¨¡å—è¿›è¡Œç»†ç²’åº¦çš„åˆ†å‰²ï¼Œè¿™æ ·ä¸€æ–¹é¢æœ‰åŠ©äºè½¯ä»¶çš„å¼€å‘å’Œç»´æŠ¤ï¼Œå¦ä¸€æ–¹é¢æœ‰åŠ©äºåˆ†å¸ƒå¼çš„éƒ¨ç½²ï¼Œæä¾›ç½‘ç«™çš„å¹¶å‘å¤„ç†èƒ½åŠ›å’ŒåŠŸèƒ½çš„æ‰©å±•ã€‚</p>
</li>
<li><p>åˆ†å¸ƒå¼ï¼šé™¤äº†ä¸Šé¢æåˆ°çš„å†…å®¹ï¼Œç½‘ç«™çš„é™æ€èµ„æºï¼ˆJavaScriptã€CSSã€å›¾ç‰‡ç­‰ï¼‰ä¹Ÿå¯ä»¥é‡‡ç”¨ç‹¬ç«‹åˆ†å¸ƒå¼éƒ¨ç½²å¹¶é‡‡ç”¨ç‹¬ç«‹çš„åŸŸåï¼Œè¿™æ ·å¯ä»¥å‡è½»åº”ç”¨æœåŠ¡å™¨çš„è´Ÿè½½å‹åŠ›ï¼Œä¹Ÿä½¿å¾—æµè§ˆå™¨å¯¹èµ„æºçš„åŠ è½½æ›´å¿«ã€‚æ•°æ®çš„å­˜å–ä¹Ÿåº”è¯¥æ˜¯åˆ†å¸ƒå¼çš„ï¼Œä¼ ç»Ÿçš„å•†ä¸šçº§å…³ç³»å‹æ•°æ®åº“äº§å“åŸºæœ¬ä¸Šéƒ½æ”¯æŒåˆ†å¸ƒå¼éƒ¨ç½²ï¼Œè€Œæ–°ç”Ÿçš„ NoSQL äº§å“å‡ ä¹éƒ½æ˜¯åˆ†å¸ƒå¼çš„ã€‚å½“ç„¶ï¼Œç½‘ç«™åå°çš„ä¸šåŠ¡å¤„ç†ä¹Ÿè¦ä½¿ç”¨åˆ†å¸ƒå¼æŠ€æœ¯ï¼Œä¾‹å¦‚æŸ¥è¯¢ç´¢å¼•çš„æ„å»ºã€æ•°æ®åˆ†æç­‰ï¼Œè¿™äº›ä¸šåŠ¡è®¡ç®—è§„æ¨¡åºå¤§ï¼Œå¯ä»¥ä½¿ç”¨ Hadoop ä»¥åŠ MapReduce åˆ†å¸ƒå¼è®¡ç®—æ¡†æ¶æ¥å¤„ç†ã€‚</p>
</li>
<li><p>é›†ç¾¤ï¼šé›†ç¾¤ä½¿å¾—æœ‰æ›´å¤šçš„æœåŠ¡å™¨æä¾›ç›¸åŒçš„æœåŠ¡ï¼Œå¯ä»¥æ›´å¥½çš„æä¾›å¯¹å¹¶å‘çš„æ”¯æŒã€‚</p>
</li>
<li><p>ç¼“å­˜ï¼šæ‰€è°“ç¼“å­˜å°±æ˜¯ç”¨ç©ºé—´æ¢å–æ—¶é—´çš„æŠ€æœ¯ï¼Œå°†æ•°æ®å°½å¯èƒ½æ”¾åœ¨è·ç¦»è®¡ç®—æœ€è¿‘çš„ä½ç½®ã€‚ä½¿ç”¨ç¼“å­˜æ˜¯ç½‘ç«™ä¼˜åŒ–çš„ç¬¬ä¸€å®šå¾‹ã€‚æˆ‘ä»¬é€šå¸¸è¯´çš„ CDNã€åå‘ä»£ç†ã€çƒ­ç‚¹æ•°æ®éƒ½æ˜¯å¯¹ç¼“å­˜æŠ€æœ¯çš„ä½¿ç”¨ã€‚</p>
</li>
<li><p>å¼‚æ­¥ï¼šå¼‚æ­¥æ˜¯å®ç°è½¯ä»¶å®ä½“ä¹‹é—´è§£è€¦åˆçš„åˆä¸€é‡è¦æ‰‹æ®µã€‚å¼‚æ­¥æ¶æ„æ˜¯å…¸å‹çš„ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å¼ï¼ŒäºŒè€…ä¹‹é—´æ²¡æœ‰ç›´æ¥çš„è°ƒç”¨å…³ç³»ï¼Œåªè¦ä¿æŒæ•°æ®ç»“æ„ä¸å˜ï¼Œå½¼æ­¤åŠŸèƒ½å®ç°å¯ä»¥éšæ„å˜åŒ–è€Œä¸äº’ç›¸å½±å“ï¼Œè¿™å¯¹ç½‘ç«™çš„æ‰©å±•éå¸¸æœ‰åˆ©ã€‚ä½¿ç”¨å¼‚æ­¥å¤„ç†è¿˜å¯ä»¥æé«˜ç³»ç»Ÿå¯ç”¨æ€§ï¼ŒåŠ å¿«ç½‘ç«™çš„å“åº”é€Ÿåº¦ï¼ˆç”¨ Ajax åŠ è½½æ•°æ®å°±æ˜¯ä¸€ç§å¼‚æ­¥æŠ€æœ¯ï¼‰ï¼ŒåŒæ—¶è¿˜å¯ä»¥èµ·åˆ°å‰Šå³°ä½œç”¨ï¼ˆåº”å¯¹ç¬æ—¶é«˜å¹¶å‘ï¼‰ã€‚â€œèƒ½æ¨è¿Ÿå¤„ç†çš„éƒ½è¦æ¨è¿Ÿå¤„ç†â€æ˜¯ç½‘ç«™ä¼˜åŒ–çš„ç¬¬äºŒå®šå¾‹ï¼Œè€Œå¼‚æ­¥æ˜¯è·µè¡Œç½‘ç«™ä¼˜åŒ–ç¬¬äºŒå®šå¾‹çš„é‡è¦æ‰‹æ®µã€‚</p>
</li>
<li><p>å†—ä½™ï¼šå„ç§æœåŠ¡å™¨éƒ½è¦æä¾›ç›¸åº”çš„å†—ä½™æœåŠ¡å™¨ä»¥ä¾¿åœ¨æŸå°æˆ–æŸäº›æœåŠ¡å™¨å®•æœºæ—¶è¿˜èƒ½ä¿è¯ç½‘ç«™å¯ä»¥æ­£å¸¸å·¥ä½œï¼ŒåŒæ—¶ä¹Ÿæä¾›äº†ç¾éš¾æ¢å¤çš„å¯èƒ½æ€§ã€‚å†—ä½™æ˜¯ç½‘ç«™é«˜å¯ç”¨æ€§çš„é‡è¦ä¿è¯ã€‚</p>
</li>
</ul>
<blockquote>
<p>166ã€ä½ ç”¨è¿‡çš„ç½‘ç«™å‰ç«¯ä¼˜åŒ–çš„æŠ€æœ¯æœ‰å“ªäº›ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼š</p>
<ul>
<li><p>æµè§ˆå™¨è®¿é—®ä¼˜åŒ–ï¼š</p>
<ul>
<li>å‡å°‘ HTTP è¯·æ±‚æ•°é‡ï¼šåˆå¹¶ CSSã€åˆå¹¶ JavaScriptã€åˆå¹¶å›¾ç‰‡ï¼ˆCSS Spriteï¼‰</li>
<li>ä½¿ç”¨æµè§ˆå™¨ç¼“å­˜ï¼šé€šè¿‡è®¾ç½® HTTP å“åº”å¤´ä¸­çš„ Cache-Control å’Œ Expires å±æ€§ï¼Œå°† CSSã€JavaScriptã€å›¾ç‰‡ç­‰åœ¨æµè§ˆå™¨ä¸­ç¼“å­˜ï¼Œå½“è¿™äº›é™æ€èµ„æºéœ€è¦æ›´æ–°æ—¶ï¼Œå¯ä»¥æ›´æ–° HTML æ–‡ä»¶ä¸­çš„å¼•ç”¨æ¥è®©æµè§ˆå™¨é‡æ–°è¯·æ±‚æ–°çš„èµ„æº</li>
<li>å¯ç”¨å‹ç¼©</li>
<li>CSS å‰ç½®ï¼ŒJavaScript åç½®</li>
<li>å‡å°‘ Cookie ä¼ è¾“</li>
</ul>
</li>
<li><p>CDN åŠ é€Ÿï¼šCDNï¼ˆContent Distribute Networkï¼‰çš„æœ¬è´¨ä»ç„¶æ˜¯ç¼“å­˜ï¼Œå°†æ•°æ®ç¼“å­˜åœ¨ç¦»ç”¨æˆ·æœ€è¿‘çš„åœ°æ–¹ï¼ŒCDN é€šå¸¸éƒ¨ç½²åœ¨ç½‘ç»œè¿è¥å•†çš„æœºæˆ¿ï¼Œä¸ä»…å¯ä»¥æå‡å“åº”é€Ÿåº¦ï¼Œè¿˜å¯ä»¥å‡å°‘åº”ç”¨æœåŠ¡å™¨çš„å‹åŠ›ã€‚å½“ç„¶ï¼ŒCDN ç¼“å­˜çš„é€šå¸¸éƒ½æ˜¯é™æ€èµ„æºã€‚</p>
</li>
<li><p>åå‘ä»£ç†ï¼šåå‘ä»£ç†ç›¸å½“äºåº”ç”¨æœåŠ¡å™¨çš„ä¸€ä¸ªé—¨é¢ï¼Œå¯ä»¥ä¿æŠ¤ç½‘ç«™çš„å®‰å…¨æ€§ï¼Œä¹Ÿå¯ä»¥å®ç°è´Ÿè½½å‡è¡¡çš„åŠŸèƒ½ï¼Œå½“ç„¶æœ€é‡è¦çš„æ˜¯å®ƒç¼“å­˜äº†ç”¨æˆ·è®¿é—®çš„çƒ­ç‚¹èµ„æºï¼Œå¯ä»¥ç›´æ¥ä»åå‘ä»£ç†å°†æŸäº›å†…å®¹è¿”å›ç»™ç”¨æˆ·æµè§ˆå™¨ã€‚</p>
</li>
</ul>
<blockquote>
<p>167ã€ä½ ä½¿ç”¨è¿‡çš„åº”ç”¨æœåŠ¡å™¨ä¼˜åŒ–æŠ€æœ¯æœ‰å“ªäº›ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼š</p>
<ul>
<li><p>åˆ†å¸ƒå¼ç¼“å­˜ï¼šç¼“å­˜çš„æœ¬è´¨å°±æ˜¯å†…å­˜ä¸­çš„å“ˆå¸Œè¡¨ï¼Œå¦‚æœè®¾è®¡ä¸€ä¸ªä¼˜è´¨çš„å“ˆå¸Œå‡½æ•°ï¼Œé‚£ä¹ˆç†è®ºä¸Šå“ˆå¸Œè¡¨è¯»å†™çš„æ¸è¿‘æ—¶é—´å¤æ‚åº¦ä¸º O(1)ã€‚ç¼“å­˜ä¸»è¦ç”¨æ¥å­˜æ”¾é‚£äº›è¯»å†™æ¯”å¾ˆé«˜ã€å˜åŒ–å¾ˆå°‘çš„æ•°æ®ï¼Œè¿™æ ·åº”ç”¨ç¨‹åºè¯»å–æ•°æ®æ—¶å…ˆåˆ°ç¼“å­˜ä¸­è¯»å–ï¼Œå¦‚æœæ²¡æœ‰æˆ–è€…æ•°æ®å·²ç»å¤±æ•ˆå†å»è®¿é—®æ•°æ®åº“æˆ–æ–‡ä»¶ç³»ç»Ÿï¼Œå¹¶æ ¹æ®æ‹Ÿå®šçš„è§„åˆ™å°†æ•°æ®å†™å…¥ç¼“å­˜ã€‚å¯¹ç½‘ç«™æ•°æ®çš„è®¿é—®ä¹Ÿç¬¦åˆäºŒå…«å®šå¾‹ï¼ˆPareto åˆ†å¸ƒï¼Œå¹‚å¾‹åˆ†å¸ƒï¼‰ï¼Œå³ 80% çš„è®¿é—®éƒ½é›†ä¸­åœ¨ 20% çš„æ•°æ®ä¸Šï¼Œå¦‚æœèƒ½å¤Ÿå°†è¿™ 20% çš„æ•°æ®ç¼“å­˜èµ·æ¥ï¼Œé‚£ä¹ˆç³»ç»Ÿçš„æ€§èƒ½å°†å¾—åˆ°æ˜¾è‘—çš„æ”¹å–„ã€‚å½“ç„¶ï¼Œä½¿ç”¨ç¼“å­˜éœ€è¦è§£å†³ä»¥ä¸‹å‡ ä¸ªé—®é¢˜ï¼š</p>
<ul>
<li>é¢‘ç¹ä¿®æ”¹çš„æ•°æ®ï¼›</li>
<li>æ•°æ®ä¸ä¸€è‡´ä¸è„è¯»ï¼›</li>
<li>ç¼“å­˜é›ªå´©ï¼ˆå¯ä»¥é‡‡ç”¨åˆ†å¸ƒå¼ç¼“å­˜æœåŠ¡å™¨é›†ç¾¤åŠ ä»¥è§£å†³ï¼Œ<a target="_blank" rel="noopener" href="http://memcached.org/">memcached</a> æ˜¯å¹¿æ³›é‡‡ç”¨çš„è§£å†³æ–¹æ¡ˆï¼‰ï¼›</li>
<li>ç¼“å­˜é¢„çƒ­ï¼›</li>
<li>ç¼“å­˜ç©¿é€ï¼ˆæ¶æ„æŒç»­è¯·æ±‚ä¸å­˜åœ¨çš„æ•°æ®ï¼‰ã€‚</li>
</ul>
</li>
<li><p>å¼‚æ­¥æ“ä½œï¼šå¯ä»¥ä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—å°†è°ƒç”¨å¼‚æ­¥åŒ–ï¼Œé€šè¿‡å¼‚æ­¥å¤„ç†å°†çŸ­æ—¶é—´é«˜å¹¶å‘äº§ç”Ÿçš„äº‹ä»¶æ¶ˆæ¯å­˜å‚¨åœ¨æ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼Œä»è€Œèµ·åˆ°å‰Šå³°ä½œç”¨ã€‚ç”µå•†ç½‘ç«™åœ¨è¿›è¡Œä¿ƒé”€æ´»åŠ¨æ—¶ï¼Œå¯ä»¥å°†ç”¨æˆ·çš„è®¢å•è¯·æ±‚å­˜å…¥æ¶ˆæ¯é˜Ÿåˆ—ï¼Œè¿™æ ·å¯ä»¥æŠµå¾¡å¤§é‡çš„å¹¶å‘è®¢å•è¯·æ±‚å¯¹ç³»ç»Ÿå’Œæ•°æ®åº“çš„å†²å‡»ã€‚ç›®å‰ï¼Œç»å¤§å¤šæ•°çš„ç”µå•†ç½‘ç«™å³ä¾¿ä¸è¿›è¡Œä¿ƒé”€æ´»åŠ¨ï¼Œè®¢å•ç³»ç»Ÿéƒ½é‡‡ç”¨äº†æ¶ˆæ¯é˜Ÿåˆ—æ¥å¤„ç†ã€‚</p>
</li>
<li><p>ä½¿ç”¨é›†ç¾¤ã€‚</p>
</li>
<li><p>ä»£ç ä¼˜åŒ–ï¼š</p>
<ul>
<li>å¤šçº¿ç¨‹ï¼šåŸºäº Java çš„ Web å¼€å‘åŸºæœ¬ä¸Šéƒ½é€šè¿‡å¤šçº¿ç¨‹çš„æ–¹å¼å“åº”ç”¨æˆ·çš„å¹¶å‘è¯·æ±‚ï¼Œä½¿ç”¨å¤šçº¿ç¨‹æŠ€æœ¯åœ¨ç¼–ç¨‹ä¸Šè¦è§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Œä¸»è¦å¯ä»¥è€ƒè™‘ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š<ul>
<li>å°†å¯¹è±¡è®¾è®¡ä¸ºæ— çŠ¶æ€å¯¹è±¡ï¼ˆè¿™å’Œé¢å‘å¯¹è±¡çš„ç¼–ç¨‹è§‚ç‚¹æ˜¯çŸ›ç›¾çš„ï¼Œåœ¨é¢å‘å¯¹è±¡çš„ä¸–ç•Œä¸­è¢«è§†ä¸ºä¸è‰¯è®¾è®¡ï¼‰ï¼Œè¿™æ ·å°±ä¸ä¼šå­˜åœ¨å¹¶å‘è®¿é—®æ—¶å¯¹è±¡çŠ¶æ€ä¸ä¸€è‡´çš„é—®é¢˜ã€‚</li>
<li>åœ¨æ–¹æ³•å†…éƒ¨åˆ›å»ºå¯¹è±¡ï¼Œè¿™æ ·å¯¹è±¡ç”±è¿›å…¥æ–¹æ³•çš„çº¿ç¨‹åˆ›å»ºï¼Œä¸ä¼šå‡ºç°å¤šä¸ªçº¿ç¨‹è®¿é—®åŒä¸€å¯¹è±¡çš„é—®é¢˜ã€‚ä½¿ç”¨ ThreadLocal å°†å¯¹è±¡ä¸çº¿ç¨‹ç»‘å®šä¹Ÿæ˜¯å¾ˆå¥½çš„åšæ³•ï¼Œè¿™ä¸€ç‚¹åœ¨å‰é¢å·²ç»æ¢è®¨è¿‡äº†ã€‚</li>
<li>å¯¹èµ„æºè¿›è¡Œå¹¶å‘è®¿é—®æ—¶åº”å½“ä½¿ç”¨åˆç†çš„é”æœºåˆ¶ã€‚</li>
</ul>
</li>
<li>éé˜»å¡ I/Oï¼š ä½¿ç”¨å•çº¿ç¨‹å’Œéé˜»å¡ I/O æ˜¯ç›®å‰å…¬è®¤çš„æ¯”å¤šçº¿ç¨‹çš„æ–¹å¼æ›´èƒ½å……åˆ†å‘æŒ¥æœåŠ¡å™¨æ€§èƒ½çš„åº”ç”¨æ¨¡å¼ï¼ŒåŸºäº Node.js æ„å»ºçš„æœåŠ¡å™¨å°±é‡‡ç”¨äº†è¿™æ ·çš„æ–¹å¼ã€‚Java åœ¨ JDK 1.4 ä¸­å°±å¼•å…¥äº† NIOï¼ˆNon-blocking I/Oï¼‰,åœ¨ Servlet 3 è§„èŒƒä¸­åˆå¼•å…¥äº†å¼‚æ­¥ Servlet çš„æ¦‚å¿µï¼Œè¿™äº›éƒ½ä¸ºåœ¨æœåŠ¡å™¨ç«¯é‡‡ç”¨éé˜»å¡ I/O æä¾›äº†å¿…è¦çš„åŸºç¡€ã€‚</li>
<li>èµ„æºå¤ç”¨ï¼šèµ„æºå¤ç”¨ä¸»è¦æœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸€æ˜¯å•ä¾‹ï¼ŒäºŒæ˜¯å¯¹è±¡æ± ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„æ•°æ®åº“è¿æ¥æ± ã€çº¿ç¨‹æ± éƒ½æ˜¯å¯¹è±¡æ± åŒ–æŠ€æœ¯ï¼Œè¿™æ˜¯å…¸å‹çš„ç”¨ç©ºé—´æ¢å–æ—¶é—´çš„ç­–ç•¥ï¼Œå¦ä¸€æ–¹é¢ä¹Ÿå®ç°å¯¹èµ„æºçš„å¤ç”¨ï¼Œä»è€Œé¿å…äº†ä¸å¿…è¦çš„åˆ›å»ºå’Œé‡Šæ”¾èµ„æºæ‰€å¸¦æ¥çš„å¼€é”€ã€‚</li>
</ul>
</li>
</ul>
<blockquote>
<p>168ã€ä»€ä¹ˆæ˜¯ XSS æ”»å‡»ï¼Ÿä»€ä¹ˆæ˜¯ SQL æ³¨å…¥æ”»å‡»ï¼Ÿä»€ä¹ˆæ˜¯ CSRF æ”»å‡»ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼š</p>
<ul>
<li><p>XSSï¼ˆCross Site Scriptï¼Œè·¨ç«™è„šæœ¬æ”»å‡»ï¼‰æ˜¯å‘ç½‘é¡µä¸­æ³¨å…¥æ¶æ„è„šæœ¬åœ¨ç”¨æˆ·æµè§ˆç½‘é¡µæ—¶åœ¨ç”¨æˆ·æµè§ˆå™¨ä¸­æ‰§è¡Œæ¶æ„è„šæœ¬çš„æ”»å‡»æ–¹å¼ã€‚è·¨ç«™è„šæœ¬æ”»å‡»åˆ†æœ‰ä¸¤ç§å½¢å¼ï¼šåå°„å‹æ”»å‡»ï¼ˆè¯±ä½¿ç”¨æˆ·ç‚¹å‡»ä¸€ä¸ªåµŒå…¥æ¶æ„è„šæœ¬çš„é“¾æ¥ä»¥è¾¾åˆ°æ”»å‡»çš„ç›®æ ‡ï¼Œç›®å‰æœ‰å¾ˆå¤šæ”»å‡»è€…åˆ©ç”¨è®ºå›ã€å¾®åšå‘å¸ƒå«æœ‰æ¶æ„è„šæœ¬çš„ URL å°±å±äºè¿™ç§æ–¹å¼ï¼‰å’ŒæŒä¹…å‹æ”»å‡»ï¼ˆå°†æ¶æ„è„šæœ¬æäº¤åˆ°è¢«æ”»å‡»ç½‘ç«™çš„æ•°æ®åº“ä¸­ï¼Œç”¨æˆ·æµè§ˆç½‘é¡µæ—¶ï¼Œæ¶æ„è„šæœ¬ä»æ•°æ®åº“ä¸­è¢«åŠ è½½åˆ°é¡µé¢æ‰§è¡Œï¼ŒQQ é‚®ç®±çš„æ—©æœŸç‰ˆæœ¬å°±æ›¾ç»è¢«åˆ©ç”¨ä½œä¸ºæŒä¹…å‹è·¨ç«™è„šæœ¬æ”»å‡»çš„å¹³å°ï¼‰ã€‚XSS è™½ç„¶ä¸æ˜¯ä»€ä¹ˆæ–°é²œç©æ„ï¼Œä½†æ˜¯æ”»å‡»çš„æ‰‹æ³•å´ä¸æ–­ç¿»æ–°ï¼Œé˜²èŒƒ XSS ä¸»è¦æœ‰ä¸¤æ–¹é¢ï¼šæ¶ˆæ¯’ï¼ˆå¯¹å±é™©å­—ç¬¦è¿›è¡Œè½¬ä¹‰ï¼‰å’Œ HttpOnlyï¼ˆé˜²èŒƒ XSS æ”»å‡»è€…çªƒå– Cookie æ•°æ®ï¼‰ã€‚</p>
</li>
<li><p>SQL æ³¨å…¥æ”»å‡»æ˜¯æ³¨å…¥æ”»å‡»æœ€å¸¸è§çš„å½¢å¼ï¼ˆæ­¤å¤–è¿˜æœ‰ OS æ³¨å…¥æ”»å‡»ï¼ˆStruts 2 çš„é«˜å±æ¼æ´å°±æ˜¯é€šè¿‡ OGNL å®æ–½ OS æ³¨å…¥æ”»å‡»å¯¼è‡´çš„ï¼‰ï¼‰ï¼Œå½“æœåŠ¡å™¨ä½¿ç”¨è¯·æ±‚å‚æ•°æ„é€  SQL è¯­å¥æ—¶ï¼Œæ¶æ„çš„ SQL è¢«åµŒå…¥åˆ° SQL ä¸­äº¤ç»™æ•°æ®åº“æ‰§è¡Œã€‚SQL æ³¨å…¥æ”»å‡»éœ€è¦æ”»å‡»è€…å¯¹æ•°æ®åº“ç»“æ„æœ‰æ‰€äº†è§£æ‰èƒ½è¿›è¡Œï¼Œæ”»å‡»è€…æƒ³è¦è·å¾—è¡¨ç»“æ„æœ‰å¤šç§æ–¹å¼ï¼š(1)å¦‚æœä½¿ç”¨å¼€æºç³»ç»Ÿæ­å»ºç½‘ç«™ï¼Œæ•°æ®åº“ç»“æ„ä¹Ÿæ˜¯å…¬å¼€çš„ï¼ˆç›®å‰æœ‰å¾ˆå¤šç°æˆçš„ç³»ç»Ÿå¯ä»¥ç›´æ¥æ­å»ºè®ºå›ï¼Œç”µå•†ç½‘ç«™ï¼Œè™½ç„¶æ–¹ä¾¿å¿«æ·ä½†æ˜¯é£é™©æ˜¯å¿…é¡»è¦è®¤çœŸè¯„ä¼°çš„ï¼‰ï¼›(2)é”™è¯¯å›æ˜¾ï¼ˆå¦‚æœå°†æœåŠ¡å™¨çš„é”™è¯¯ä¿¡æ¯ç›´æ¥æ˜¾ç¤ºåœ¨é¡µé¢ä¸Šï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡éæ³•å‚æ•°å¼•å‘é¡µé¢é”™è¯¯ä»è€Œé€šè¿‡é”™è¯¯ä¿¡æ¯äº†è§£æ•°æ®åº“ç»“æ„ï¼ŒWeb åº”ç”¨åº”å½“è®¾ç½®å‹å¥½çš„é”™è¯¯é¡µï¼Œä¸€æ–¹é¢ç¬¦åˆæœ€å°æƒŠè®¶åŸåˆ™ï¼Œä¸€æ–¹é¢å±è”½æ‰å¯èƒ½ç»™ç³»ç»Ÿå¸¦æ¥å±é™©çš„é”™è¯¯å›æ˜¾ä¿¡æ¯ï¼‰ï¼›(3)ç›²æ³¨ã€‚é˜²èŒƒ SQL æ³¨å…¥æ”»å‡»ä¹Ÿå¯ä»¥é‡‡ç”¨æ¶ˆæ¯’çš„æ–¹å¼ï¼Œé€šè¿‡æ­£åˆ™è¡¨è¾¾å¼å¯¹è¯·æ±‚å‚æ•°è¿›è¡ŒéªŒè¯ï¼Œæ­¤å¤–ï¼Œå‚æ•°ç»‘å®šä¹Ÿæ˜¯å¾ˆå¥½çš„æ‰‹æ®µï¼Œè¿™æ ·æ¶æ„çš„ SQL ä¼šè¢«å½“åš SQL çš„å‚æ•°è€Œä¸æ˜¯å‘½ä»¤è¢«æ‰§è¡Œï¼ŒJDBC ä¸­çš„ <code>PreparedStatement</code> å°±æ˜¯æ”¯æŒå‚æ•°ç»‘å®šçš„è¯­å¥å¯¹è±¡ï¼Œä»æ€§èƒ½å’Œå®‰å…¨æ€§ä¸Šéƒ½æ˜æ˜¾ä¼˜äº <code>Statement</code>ã€‚</p>
</li>
<li><p>CSRF æ”»å‡»ï¼ˆCross Site Request Forgeryï¼Œè·¨ç«™è¯·æ±‚ä¼ªé€ ï¼‰æ˜¯æ”»å‡»è€…é€šè¿‡è·¨ç«™è¯·æ±‚ï¼Œä»¥åˆæ³•çš„ç”¨æˆ·èº«ä»½è¿›è¡Œéæ³•æ“ä½œï¼ˆå¦‚è½¬è´¦æˆ–å‘å¸–ç­‰ï¼‰ã€‚CSRF çš„åŸç†æ˜¯åˆ©ç”¨æµè§ˆå™¨çš„ Cookie æˆ–æœåŠ¡å™¨çš„ Sessionï¼Œç›—å–ç”¨æˆ·èº«ä»½ï¼Œå…¶åŸç†å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚é˜²èŒƒ CSRF çš„ä¸»è¦æ‰‹æ®µæ˜¯è¯†åˆ«è¯·æ±‚è€…çš„èº«ä»½ï¼Œä¸»è¦æœ‰ä»¥ä¸‹å‡ ç§æ–¹å¼ï¼š(1)åœ¨è¡¨å•ä¸­æ·»åŠ ä»¤ç‰Œï¼ˆtokenï¼‰ï¼›(2)éªŒè¯ç ï¼›(3)æ£€æŸ¥è¯·æ±‚å¤´ä¸­çš„ Refererï¼ˆå‰é¢æåˆ°é˜²å›¾ç‰‡ç›—é“¾æ¥ä¹Ÿæ˜¯ç”¨çš„è¿™ç§æ–¹å¼ï¼‰ã€‚ä»¤ç‰Œå’ŒéªŒè¯éƒ½å…·æœ‰ä¸€æ¬¡æ¶ˆè´¹æ€§çš„ç‰¹å¾ï¼Œå› æ­¤åœ¨åŸç†ä¸Šä¸€è‡´çš„ï¼Œä½†æ˜¯éªŒè¯ç æ˜¯ä¸€ç§ç³Ÿç³•çš„ç”¨æˆ·ä½“éªŒï¼Œä¸æ˜¯å¿…è¦çš„æƒ…å†µä¸‹ä¸è¦è½»æ˜“ä½¿ç”¨éªŒè¯ç ï¼Œç›®å‰å¾ˆå¤šç½‘ç«™çš„åšæ³•æ˜¯å¦‚æœåœ¨çŸ­æ—¶é—´å†…å¤šæ¬¡æäº¤ä¸€ä¸ªè¡¨å•æœªè·å¾—æˆåŠŸåæ‰è¦æ±‚æä¾›éªŒè¯ç ï¼Œè¿™æ ·ä¼šè·å¾—è¾ƒå¥½çš„ç”¨æˆ·ä½“éªŒã€‚</p>
</li>
</ul>
<p><img src= "https://cdn.jsdelivr.net/gh/Eurkon/CDN/hexo/images/user/loading.gif" data-lazy-src="/images/post/java_interview/168.png" alt></p>
<p><strong>è¡¥å……ï¼š</strong>é˜²ç«å¢™çš„æ¶è®¾æ˜¯ Web å®‰å…¨çš„é‡è¦ä¿éšœï¼Œ<a target="_blank" rel="noopener" href="https://www.modsecurity.org/">ModSecurity</a> æ˜¯å¼€æºçš„ Web é˜²ç«å¢™ä¸­çš„ä½¼ä½¼è€…ã€‚ä¼ä¸šçº§é˜²ç«å¢™çš„æ¶è®¾åº”å½“æœ‰ä¸¤çº§é˜²ç«å¢™ï¼ŒWeb æœåŠ¡å™¨å’Œéƒ¨åˆ†åº”ç”¨æœåŠ¡å™¨å¯ä»¥æ¶è®¾åœ¨ä¸¤çº§é˜²ç«å¢™ä¹‹é—´çš„ DMZï¼Œè€Œæ•°æ®å’Œèµ„æºæœåŠ¡å™¨åº”å½“æ¶è®¾åœ¨ç¬¬äºŒçº§é˜²ç«å¢™ä¹‹åã€‚</p>
<blockquote>
<p>169ã€ä»€ä¹ˆæ˜¯é¢†åŸŸæ¨¡å‹ï¼ˆdomain modelï¼‰ï¼Ÿè´«è¡€æ¨¡å‹ï¼ˆanaemic domain modelï¼‰å’Œå……è¡€æ¨¡å‹ï¼ˆrich domain modelï¼‰æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p>
</blockquote>
<p>ç­”ï¼šé¢†åŸŸæ¨¡å‹æ˜¯é¢†åŸŸå†…çš„æ¦‚å¿µç±»æˆ–ç°å®ä¸–ç•Œä¸­å¯¹è±¡çš„å¯è§†åŒ–è¡¨ç¤ºï¼Œåˆç§°ä¸ºæ¦‚å¿µæ¨¡å‹æˆ–åˆ†æå¯¹è±¡æ¨¡å‹ï¼Œå®ƒä¸“æ³¨äºåˆ†æé—®é¢˜é¢†åŸŸæœ¬èº«ï¼Œå‘æ˜é‡è¦çš„ä¸šåŠ¡é¢†åŸŸæ¦‚å¿µï¼Œå¹¶å»ºç«‹ä¸šåŠ¡é¢†åŸŸæ¦‚å¿µä¹‹é—´çš„å…³ç³»ã€‚è´«è¡€æ¨¡å‹æ˜¯æŒ‡ä½¿ç”¨çš„é¢†åŸŸå¯¹è±¡ä¸­åªæœ‰ <code>setter</code> å’Œ <code>getter</code> æ–¹æ³•ï¼ˆPOJOï¼‰ï¼Œæ‰€æœ‰çš„ä¸šåŠ¡é€»è¾‘éƒ½ä¸åŒ…å«åœ¨é¢†åŸŸå¯¹è±¡ä¸­è€Œæ˜¯æ”¾åœ¨ä¸šåŠ¡é€»è¾‘å±‚ã€‚æœ‰äººå°†æˆ‘ä»¬è¿™é‡Œè¯´çš„è´«è¡€æ¨¡å‹è¿›ä¸€æ­¥åˆ’åˆ†æˆå¤±è¡€æ¨¡å‹ï¼ˆé¢†åŸŸå¯¹è±¡å®Œå…¨æ²¡æœ‰ä¸šåŠ¡é€»è¾‘ï¼‰å’Œè´«è¡€æ¨¡å‹ï¼ˆé¢†åŸŸå¯¹è±¡æœ‰å°‘é‡çš„ä¸šåŠ¡é€»è¾‘ï¼‰ï¼Œæˆ‘ä»¬è¿™é‡Œå°±ä¸å¯¹æ­¤åŠ ä»¥åŒºåˆ†äº†ã€‚å……è¡€æ¨¡å‹å°†å¤§å¤šæ•°ä¸šåŠ¡é€»è¾‘å’ŒæŒä¹…åŒ–æ”¾åœ¨é¢†åŸŸå¯¹è±¡ä¸­ï¼Œä¸šåŠ¡é€»è¾‘ï¼ˆä¸šåŠ¡é—¨é¢ï¼‰åªæ˜¯å®Œæˆå¯¹ä¸šåŠ¡é€»è¾‘çš„å°è£…ã€äº‹åŠ¡å’Œæƒé™ç­‰çš„å¤„ç†ã€‚ä¸‹é¢ä¸¤å¼ å›¾åˆ†åˆ«å±•ç¤ºäº†è´«è¡€æ¨¡å‹å’Œå……è¡€æ¨¡å‹çš„åˆ†å±‚æ¶æ„ã€‚</p>
<p>è´«è¡€æ¨¡å‹</p>
<p><img src= "https://cdn.jsdelivr.net/gh/Eurkon/CDN/hexo/images/user/loading.gif" data-lazy-src="/images/post/java_interview/169_1.png" alt></p>
<p>å……è¡€æ¨¡å‹</p>
<p><img src= "https://cdn.jsdelivr.net/gh/Eurkon/CDN/hexo/images/user/loading.gif" data-lazy-src="/images/post/java_interview/169_2.png" alt></p>
<p>è´«è¡€æ¨¡å‹ä¸‹ç»„ç»‡é¢†åŸŸé€»è¾‘é€šå¸¸ä½¿ç”¨äº‹åŠ¡è„šæœ¬æ¨¡å¼ï¼Œè®©æ¯ä¸ªè¿‡ç¨‹å¯¹åº”ç”¨æˆ·å¯èƒ½è¦åšçš„ä¸€ä¸ªåŠ¨ä½œï¼Œæ¯ä¸ªåŠ¨ä½œç”±ä¸€ä¸ªè¿‡ç¨‹æ¥é©±åŠ¨ã€‚ä¹Ÿå°±æ˜¯è¯´åœ¨è®¾è®¡ä¸šåŠ¡é€»è¾‘æ¥å£çš„æ—¶å€™ï¼Œæ¯ä¸ªæ–¹æ³•å¯¹åº”ç€ç”¨æˆ·çš„ä¸€ä¸ªæ“ä½œï¼Œè¿™ç§æ¨¡å¼æœ‰ä»¥ä¸‹å‡ ä¸ªæœ‰ç‚¹ï¼š</p>
<ul>
<li>å®ƒæ˜¯ä¸€ä¸ªå¤§å¤šæ•°å¼€å‘è€…éƒ½èƒ½å¤Ÿç†è§£çš„ç®€å•è¿‡ç¨‹æ¨¡å‹ï¼ˆé€‚åˆå›½å†…çš„ç»å¤§å¤šæ•°å¼€å‘è€…ï¼‰ã€‚</li>
<li>å®ƒèƒ½å¤Ÿä¸ä¸€ä¸ªä½¿ç”¨è¡Œæ•°æ®å…¥å£æˆ–è¡¨æ•°æ®å…¥å£çš„ç®€å•æ•°æ®è®¿é—®å±‚å¾ˆå¥½çš„åä½œã€‚</li>
<li>äº‹åŠ¡è¾¹ç•Œçš„æ˜¾è€Œæ˜“è§ï¼Œä¸€ä¸ªäº‹åŠ¡å¼€å§‹äºè„šæœ¬çš„å¼€å§‹ï¼Œç»ˆæ­¢äºè„šæœ¬çš„ç»“æŸï¼Œå¾ˆå®¹æ˜“é€šè¿‡ä»£ç†ï¼ˆæˆ–åˆ‡é¢ï¼‰å®ç°å£°æ˜å¼äº‹åŠ¡ã€‚</li>
</ul>
<p>ç„¶è€Œï¼Œäº‹åŠ¡è„šæœ¬æ¨¡å¼çš„ç¼ºç‚¹ä¹Ÿæ˜¯å¾ˆå¤šçš„ï¼Œéšç€é¢†åŸŸé€»è¾‘å¤æ‚æ€§çš„å¢åŠ ï¼Œç³»ç»Ÿçš„å¤æ‚æ€§å°†è¿…é€Ÿå¢åŠ ï¼Œç¨‹åºç»“æ„å°†å˜å¾—æåº¦æ··ä¹±ã€‚å¼€æºä¸­å›½ç¤¾åŒºä¸Šæœ‰ä¸€ç¯‡å¾ˆå¥½çš„è¯‘æ–‡<a target="_blank" rel="noopener" href="https://www.oschina.net/translate/how-anaemic-domain-models-cause-bad-software">ã€Šè´«è¡€é¢†åŸŸæ¨¡å‹æ˜¯å¦‚ä½•å¯¼è‡´ç³Ÿç³•çš„è½¯ä»¶äº§ç”Ÿã€‹</a>å¯¹è¿™ä¸ªé—®é¢˜åšäº†æ¯”è¾ƒç»†è‡´çš„é˜è¿°ã€‚</p>
<blockquote>
<p>170ã€è°ˆä¸€è°ˆæµ‹è¯•é©±åŠ¨å¼€å‘ï¼ˆTDDï¼‰çš„å¥½å¤„ä»¥åŠä½ çš„ç†è§£ã€‚</p>
</blockquote>
<p>ç­”ï¼šTDD æ˜¯æŒ‡åœ¨ç¼–å†™çœŸæ­£çš„åŠŸèƒ½å®ç°ä»£ç ä¹‹å‰å…ˆå†™æµ‹è¯•ä»£ç ï¼Œç„¶åæ ¹æ®éœ€è¦é‡æ„å®ç°ä»£ç ã€‚åœ¨ JUnit çš„ä½œè€… Kent Beck çš„å¤§ä½œã€Šæµ‹è¯•é©±åŠ¨å¼€å‘ï¼šå®æˆ˜ä¸æ¨¡å¼è§£æã€‹ï¼ˆTest-Driven Development: by Exampleï¼‰ä¸€ä¹¦ä¸­æœ‰è¿™ä¹ˆä¸€æ®µå†…å®¹ï¼šâ€œæ¶ˆé™¤ææƒ§å’Œä¸ç¡®å®šæ€§æ˜¯ç¼–å†™æµ‹è¯•é©±åŠ¨ä»£ç çš„é‡è¦åŸå› â€ã€‚å› ä¸ºç¼–å†™ä»£ç æ—¶çš„ææƒ§ä¼šè®©ä½ å°å¿ƒè¯•æ¢ï¼Œè®©ä½ å›é¿æ²Ÿé€šï¼Œè®©ä½ ç¾äºå¾—åˆ°åé¦ˆï¼Œè®©ä½ å˜å¾—ç„¦èºä¸å®‰ï¼Œè€Œ TDD æ˜¯æ¶ˆé™¤ææƒ§ã€è®© Java å¼€å‘è€…æ›´åŠ è‡ªä¿¡æ›´åŠ ä¹äºæ²Ÿé€šçš„é‡è¦æ‰‹æ®µã€‚TDD ä¼šå¸¦æ¥çš„å¥½å¤„å¯èƒ½ä¸ä¼šé©¬ä¸Šå‘ˆç°ï¼Œä½†æ˜¯ä½ åœ¨æŸä¸ªæ—¶å€™ä¸€å®šä¼šå‘ç°ï¼Œè¿™äº›å¥½å¤„åŒ…æ‹¬ï¼š</p>
<ul>
<li>æ›´æ¸…æ™°çš„ä»£ç  â€” åªå†™éœ€è¦çš„ä»£ç </li>
<li>æ›´å¥½çš„è®¾è®¡</li>
<li>æ›´å‡ºè‰²çš„çµæ´»æ€§ â€” é¼“åŠ±ç¨‹åºå‘˜é¢å‘æ¥å£ç¼–ç¨‹</li>
<li>æ›´å¿«é€Ÿçš„åé¦ˆ â€” ä¸ä¼šåˆ°ç³»ç»Ÿä¸Šçº¿æ—¶æ‰çŸ¥é“bugçš„å­˜åœ¨</li>
</ul>
<p><strong>è¡¥å……ï¼š</strong>æ•æ·è½¯ä»¶å¼€å‘çš„æ¦‚å¿µå·²ç»æœ‰å¾ˆå¤šå¹´äº†ï¼Œè€Œä¸”ä¹Ÿéƒ¨åˆ†çš„æ”¹å˜äº†è½¯ä»¶å¼€å‘è¿™ä¸ªè¡Œä¸šï¼ŒTDD ä¹Ÿæ˜¯æ•æ·å¼€å‘æ‰€å€¡å¯¼çš„ã€‚</p>
<p>TDD å¯ä»¥åœ¨å¤šä¸ªå±‚çº§ä¸Šåº”ç”¨ï¼ŒåŒ…æ‹¬å•å…ƒæµ‹è¯•ï¼ˆæµ‹è¯•ä¸€ä¸ªç±»ä¸­çš„ä»£ç ï¼‰ã€é›†æˆæµ‹è¯•ï¼ˆæµ‹è¯•ç±»ä¹‹é—´çš„äº¤äº’ï¼‰ã€ç³»ç»Ÿæµ‹è¯•ï¼ˆæµ‹è¯•è¿è¡Œçš„ç³»ç»Ÿï¼‰å’Œç³»ç»Ÿé›†æˆæµ‹è¯•ï¼ˆæµ‹è¯•è¿è¡Œçš„ç³»ç»ŸåŒ…æ‹¬ä½¿ç”¨çš„ç¬¬ä¸‰æ–¹ç»„ä»¶ï¼‰ã€‚TDD çš„å®æ–½æ­¥éª¤æ˜¯ï¼šçº¢ï¼ˆå¤±è´¥æµ‹è¯•ï¼‰- ç»¿ï¼ˆé€šè¿‡æµ‹è¯•ï¼‰ - é‡æ„ã€‚å…³äºå®æ–½ TDD çš„è¯¦ç»†æ­¥éª¤è¯·å‚è€ƒå¦ä¸€ç¯‡æ–‡ç« <a target="_blank" rel="noopener" href="https://blog.csdn.net/jackfrued/article/details/44433249">ã€Šæµ‹è¯•é©±åŠ¨å¼€å‘ä¹‹åˆçª¥é—¨å¾„ã€‹</a>ã€‚</p>
<p>åœ¨ä½¿ç”¨ TDD å¼€å‘æ—¶ï¼Œç»å¸¸ä¼šé‡åˆ°éœ€è¦è¢«æµ‹å¯¹è±¡éœ€è¦ä¾èµ–å…¶ä»–å­ç³»ç»Ÿçš„æƒ…å†µï¼Œä½†æ˜¯ä½ å¸Œæœ›å°†æµ‹è¯•ä»£ç è·Ÿä¾èµ–é¡¹éš”ç¦»ï¼Œä»¥ä¿è¯æµ‹è¯•ä»£ç ä»…ä»…é’ˆå¯¹å½“å‰è¢«æµ‹å¯¹è±¡æˆ–æ–¹æ³•å±•å¼€ï¼Œè¿™æ—¶å€™ä½ éœ€è¦çš„æ˜¯æµ‹è¯•æ›¿èº«ã€‚æµ‹è¯•æ›¿èº«å¯ä»¥åˆ†ä¸ºå››ç±»ï¼š</p>
<ul>
<li>è™šè®¾æ›¿èº«ï¼šåªä¼ é€’ä½†æ˜¯ä¸ä¼šä½¿ç”¨åˆ°çš„å¯¹è±¡ï¼Œä¸€èˆ¬ç”¨äºå¡«å……æ–¹æ³•çš„å‚æ•°åˆ—è¡¨</li>
<li>å­˜æ ¹æ›¿èº«ï¼šæ€»æ˜¯è¿”å›ç›¸åŒçš„é¢„è®¾å“åº”ï¼Œå…¶ä¸­å¯èƒ½åŒ…æ‹¬ä¸€äº›è™šè®¾çŠ¶æ€</li>
<li>ä¼ªè£…æ›¿èº«ï¼šå¯ä»¥å–ä»£çœŸå®ç‰ˆæœ¬çš„å¯ç”¨ç‰ˆæœ¬ï¼ˆæ¯”çœŸå®ç‰ˆæœ¬è¿˜æ˜¯ä¼šå·®å¾ˆå¤šï¼‰</li>
<li>æ¨¡æ‹Ÿæ›¿èº«ï¼šå¯ä»¥è¡¨ç¤ºä¸€ç³»åˆ—æœŸæœ›å€¼çš„å¯¹è±¡ï¼Œå¹¶ä¸”å¯ä»¥æä¾›é¢„è®¾å“åº”</li>
</ul>
<p>Java ä¸–ç•Œä¸­å®ç°æ¨¡æ‹Ÿæ›¿èº«çš„ç¬¬ä¸‰æ–¹å·¥å…·éå¸¸å¤šï¼ŒåŒ…æ‹¬ EasyMockã€Mockitoã€jMock ç­‰ã€‚</p>
</article><div class="post-copyright"><div class="post-copyright__title"><span class="post-copyright-info"><h>Java é¢è¯•é¢˜è§£æ</h></span></div><div class="post-copyright__type"><span class="post-copyright-info"><a href="https://blog.eurkon.com/post/d2aef718.html">https://blog.eurkon.com/post/d2aef718.html</a></span></div><div class="post-copyright-m"><div class="post-copyright-m-info"><div class="post-copyright-a"><h>ä½œè€…</h><div class="post-copyright-cc-info"><h>Eurkon</h></div></div><div class="post-copyright-p"><h>å‘å¸ƒäº</h><div class="post-copyright-cc-info"><h>2021-03-20</h></div></div><div class="post-copyright-u"><h>æ›´æ–°äº</h><div class="post-copyright-cc-info"><h>2021-03-23</h></div></div><div class="post-copyright-c"><h>è®¸å¯åè®®</h><div class="post-copyright-cc-info"><a class="icon" title="Creative Commons" target="_blank" rel="noopener" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a title="CC BY-NC-SA 4.0" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a></div></div></div></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E2%98%95Java/">â˜•Java</a></div><div class="post_share"><div class="social-share" data-image="/images/cover/java_interview.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button button--animated"><i class="fas fa-qrcode"></i> æ‰“èµ</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://cdn.jsdelivr.net/gh/Eurkon/CDN/hexo/images/user/wechat.jpg" target="_blank"><img class="post-qr-code-img" data-lazy-src="https://cdn.jsdelivr.net/gh/Eurkon/CDN/hexo/images/user/wechat.jpg" alt="å¾®ä¿¡"/></a><div class="post-qr-code-desc">å¾®ä¿¡</div></li><li class="reward-item"><a href="https://cdn.jsdelivr.net/gh/Eurkon/CDN/hexo/images/user/alipay.jpg" target="_blank"><img class="post-qr-code-img" data-lazy-src="https://cdn.jsdelivr.net/gh/Eurkon/CDN/hexo/images/user/alipay.jpg" alt="æ”¯ä»˜å®"/></a><div class="post-qr-code-desc">æ”¯ä»˜å®</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/post/735e5788.html"><img class="next-cover" data-lazy-src="/images/cover/sort_algorithm.jpg" onerror="onerror=null;src='https://cdn.jsdelivr.net/gh/Eurkon/CDN/hexo/images/user/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">æ’åºç®—æ³•</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> è¯„è®º</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-info-avatar is-center"><img class="avatar-img" data-lazy-src="https://cdn.jsdelivr.net/gh/Eurkon/CDN/hexo/images/user/avatar.jpg" onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/gh/Eurkon/CDN/hexo/images/user/friend_404.gif'" alt="avatar"/><div class="author-info__name">Eurkon</div><div class="author-info__description">ä¸åªæ˜¯ä»£ç çš„æ¬è¿å·¥</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">21</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">13</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">3</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Eurkon"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/Eurkon" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:eurkon@foxmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>å…¬å‘Š</span></div><div class="announcement_content">Hello Eurkon</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Java-%E5%9F%BA%E7%A1%80%EF%BC%881-51%EF%BC%89"><span class="toc-number">1.</span> <span class="toc-text">Java åŸºç¡€ï¼ˆ1~51ï¼‰</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Java-%E5%AE%B9%E5%99%A8%EF%BC%8852-56%EF%BC%89"><span class="toc-number">2.</span> <span class="toc-text">Java å®¹å™¨ï¼ˆ52~56ï¼‰</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Java-%E5%B9%B6%E5%8F%91%EF%BC%8857-67%EF%BC%89"><span class="toc-number">3.</span> <span class="toc-text">Java å¹¶å‘ï¼ˆ57~67ï¼‰</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Java-I-O%EF%BC%8868-72%EF%BC%89"><span class="toc-number">4.</span> <span class="toc-text">Java I&#x2F;Oï¼ˆ68~72ï¼‰</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Java-%E6%95%B0%E6%8D%AE%E5%BA%93%EF%BC%8873-84%EF%BC%89"><span class="toc-number">5.</span> <span class="toc-text">Java æ•°æ®åº“ï¼ˆ73~84ï¼‰</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Java-%E5%8F%8D%E5%B0%84%EF%BC%8885-88%EF%BC%89"><span class="toc-number">6.</span> <span class="toc-text">Java åå°„ï¼ˆ85~88ï¼‰</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Java-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%EF%BC%8889-95%EF%BC%89"><span class="toc-number">7.</span> <span class="toc-text">Java è®¾è®¡æ¨¡å¼ï¼ˆ89~95ï¼‰</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Java-Web%EF%BC%8896-125%EF%BC%89"><span class="toc-number">8.</span> <span class="toc-text">Java Webï¼ˆ96~125ï¼‰</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Java-EE-%E6%A1%86%E6%9E%B6%EF%BC%88126-170%EF%BC%89"><span class="toc-number">9.</span> <span class="toc-text">Java EE æ¡†æ¶ï¼ˆ126~170ï¼‰</span></a></li></ol></div></div><div class="card-widget card-clock"><div id="clock"><img v-if="clockshow == &quot;false&quot;" alt="" src="/assets/weather/loading.gif" height="120px" width="100%"/><table class="clock" v-if="clockshow"><tbody><tr><td class="clockdate">{{date}}</td><td class="weatherimg"><img id="weatherimg" :src="weatherimg" alt=""/></td><td class="temperature">{{temperature}}</td><td class="humidityimg"><img id="humidityimg" :src="humidityimg" alt=""/></td><td class="humidity">{{humidity}}</td></tr><tr class="time"><td colspan="5">{{time}}</td></tr><tr><td class="usaqi" colspan="1"><span>{{ip}}</span></td><td class="city" colspan="2">{{city}}</td><td class="daylight" colspan="2">{{daylight}}</td></tr></tbody></table></div></div><script defer="defer" data-pjax="data-pjax" src="/js/card_clock.js"></script><div class="card-widget card-history"><div class="card-content"><div class="item-headline"><i class="fas fa-clock fa-spin"></i><span>é‚£å¹´ä»Šæ—¥</span></div><div id="history-baidu" style="height: 100px; overflow: hidden;"><div class="history_swiper-container" id="history-container" style="width: 100%; height: 100%;"><div class="swiper-wrapper" id="history_container_wrapper" style="height:20px"></div></div></div></div></div><script defer="defer" data-pjax="data-pjax" src="https://cdn.jsdelivr.net/npm/swiper/swiper-bundle.min.js"></script><script defer="defer" data-pjax="data-pjax" src="/js/card_history.js"></script><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/post/d2aef718.html" title="Java é¢è¯•é¢˜è§£æ"><img data-lazy-src="/images/cover/java_interview.jpg" onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/gh/Eurkon/CDN/hexo/images/user/404.jpg'" alt="Java é¢è¯•é¢˜è§£æ"/></a><div class="content"><a class="title" href="/post/d2aef718.html" title="Java é¢è¯•é¢˜è§£æ">Java é¢è¯•é¢˜è§£æ</a><time datetime="2021-03-20T01:38:32.000Z" title="å‘è¡¨äº 2021-03-20 09:38:32">2021-03-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/735e5788.html" title="æ’åºç®—æ³•"><img data-lazy-src="/images/cover/sort_algorithm.jpg" onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/gh/Eurkon/CDN/hexo/images/user/404.jpg'" alt="æ’åºç®—æ³•"/></a><div class="content"><a class="title" href="/post/735e5788.html" title="æ’åºç®—æ³•">æ’åºç®—æ³•</a><time datetime="2021-03-15T05:16:02.000Z" title="å‘è¡¨äº 2021-03-15 13:16:02">2021-03-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/65795b97.html" title="HTML ç‰¹æ®Šç¬¦å·ç¼–ç å¯¹ç…§è¡¨"><img data-lazy-src="/images/cover/html_symbols.jpg" onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/gh/Eurkon/CDN/hexo/images/user/404.jpg'" alt="HTML ç‰¹æ®Šç¬¦å·ç¼–ç å¯¹ç…§è¡¨"/></a><div class="content"><a class="title" href="/post/65795b97.html" title="HTML ç‰¹æ®Šç¬¦å·ç¼–ç å¯¹ç…§è¡¨">HTML ç‰¹æ®Šç¬¦å·ç¼–ç å¯¹ç…§è¡¨</a><time datetime="2021-03-12T07:54:12.000Z" title="å‘è¡¨äº 2021-03-12 15:54:12">2021-03-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/73bb9016.html" title="ç‰¹æ®Šç¬¦å·"><img data-lazy-src="/images/cover/special_symbols.jpg" onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/gh/Eurkon/CDN/hexo/images/user/404.jpg'" alt="ç‰¹æ®Šç¬¦å·"/></a><div class="content"><a class="title" href="/post/73bb9016.html" title="ç‰¹æ®Šç¬¦å·">ç‰¹æ®Šç¬¦å·</a><time datetime="2021-03-10T02:23:12.000Z" title="å‘è¡¨äº 2021-03-10 10:23:12">2021-03-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/d1e7dfd3.html" title="HDFS Shell å‘½ä»¤"><img data-lazy-src="/images/cover/hdfs_shell.jpg" onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/gh/Eurkon/CDN/hexo/images/user/404.jpg'" alt="HDFS Shell å‘½ä»¤"/></a><div class="content"><a class="title" href="/post/d1e7dfd3.html" title="HDFS Shell å‘½ä»¤">HDFS Shell å‘½ä»¤</a><time datetime="2021-03-05T02:31:14.000Z" title="å‘è¡¨äº 2021-03-05 10:31:14">2021-03-05</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2021 By Eurkon</div><div class="footer_custom_text"><p id="badges"><a target="_blank" href="https://hexo.io/" rel="external nofollow noopener noreferrer" style="margin-inline: 5px;" one-link-mark="yes"><img title="åšå®¢æ¡†æ¶Hexo" class="entered loaded" src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&amp;logo=hexo" data-ll-status="loaded"></a><a target="_blank" href="https://butterfly.js.org/" rel="external nofollow noopener noreferrer" style="margin-inline: 5px;" one-link-mark="yes"><img title="åšå®¢ä¸»é¢˜Butterfly" class="entered loaded" src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&amp;logo=bitdefender" data-ll-status="loaded"></a><a target="_blank" href="https://www.jsdelivr.com/" rel="external nofollow noopener noreferrer" style="margin-inline: 5px;" one-link-mark="yes"><img title="æœ¬ç«™ä½¿ç”¨JsDelivrä¸ºé™æ€èµ„æºæä¾›CDNåŠ é€Ÿ" class="entered loaded" src="https://img.shields.io/badge/CDN-jsDelivr-orange?style=flat&amp;logo=jsDelivr" data-ll-status="loaded"></a><a target="_blank" href="https://vercel.com/" rel="external nofollow noopener noreferrer" style="margin-inline: 5px;" one-link-mark="yes"><img title="æœ¬ç«™éƒ¨ç½²æ‰˜ç®¡äºVercel" class="entered loading" src="https://img.shields.io/badge/Hosted-Vercel-brightgreen?style=flat&amp;logo=Vercel" data-ll-status="loaded" ></a><a target="_blank" href="https://github.com/" rel="external nofollow noopener noreferrer" style="margin-inline: 5px;" one-link-mark="yes"><img title="æœ¬ç«™é¡¹ç›®ç”±GitHubæ‰˜ç®¡" class="entered loaded" src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&amp;logo=GitHub" data-ll-status="loaded"></a><a target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noopener noreferrer" style="margin-inline: 5px;" one-link-mark="yes"><img title="æœ¬ç«™é‡‡ç”¨åˆ›ä½œå…±ç”¨-ç½²å-éå•†ä¸šæ€§-ç›¸åŒæ–¹å¼å…±äº«4.0ç‰ˆå›½é™…è®¸å¯åè®®" class="entered loaded" src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&amp;logo=Claris" data-ll-status="loaded"></a></p></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="font-plus" type="button" title="æ”¾å¤§å­—ä½“"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="ç¼©å°å­—ä½“"><i class="fas fa-minus"></i></button><button id="translateLink" type="button" title="ç®€ç¹è½¬æ¢">ç®€</button><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="ç›´è¾¾è¯„è®º"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">æœ¬åœ°æœç´¢</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« " type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/vue@2.6.11"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>if (document.getElementsByClassName('mermaid').length) {
  if (window.mermaidJsLoad) mermaid.init()
  else {
    getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(() => {
      window.mermaidJsLoad = true
      mermaid.initialize({
        theme: 'dark',
      })
      true && mermaid.init()
    })
  }
}</script><script>(()=>{
  const $countDom = document.getElementById('twikoo-count')
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'twikoo-7gsa2rc0c087a562',
      region: ''
    }, null))
  }

  const getCount = () => {
    twikoo.getCommentsCount({
      envId: 'twikoo-7gsa2rc0c087a562',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(function (res) {
      $countDom.innerText = res[0].count
    }).catch(function (err) {
      console.error(err);
    });
  }

  const loadTwikoo = (bool = false) => {
    if (typeof twikoo === 'object') {
      init()
      bool && $countDom && setTimeout(getCount,0)
    } else {
      getScript('https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js').then(()=> {
        init()
        bool && $countDom && setTimeout(getCount,0)
      })
    }
  }

  if ('Twikoo' === 'Twikoo' || !false) {
    if (false) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo(true)
  } else {
    window.loadOtherComment = () => {
      loadTwikoo()
    }
  }
})()</script></div><script>window.addEventListener('load', () => {
  const changeContent = (content) => {
    if (content === '') return content

    content = content.replace(/<img.*?src="(.*?)"?[^\>]+>/ig, '[å›¾ç‰‡]') // replace image link
    content = content.replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi, '[é“¾æ¥]') // replace url
    content = content.replace(/<pre><code>.*?<\/pre>/gi, '[ä»£ç ]') // replace code
    content = content.replace(/<[^>]+>/g,"") // remove html tag

    if (content.length > 150) {
      content = content.substring(0,150) + '...'
    }
    return content
  }

  const getComment = () => {
    const runTwikoo = () => {
      twikoo.getRecentComments({
        envId: 'twikoo-7gsa2rc0c087a562',
        region: '',
        pageSize: 6,
        includeReply: true
      }).then(function (res) {
        const twikooArray = res.map(e => {
          return {
            'content': changeContent(e.comment),
            'avatar': e.avatar,
            'nick': e.nick,
            'url': e.url + '#' + e.id,
            'date': new Date(e.created).toISOString()
          }
        })

        saveToLocal.set('twikoo-newest-comments', JSON.stringify(twikooArray), 10/(60*24))
        generateHtml(twikooArray)
      }).catch(function (err) {
        const $dom = document.querySelector('#card-newest-comments .aside-list')
        $dom.innerHTML= "æ— æ³•è·å–è¯„è®ºï¼Œè¯·ç¡®è®¤ç›¸å…³é…ç½®æ˜¯å¦æ­£ç¡®"
      })
    }

    if (typeof twikoo === 'object') {
      runTwikoo()
    } else {
      getScript('https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js').then(runTwikoo)
    }
  }

  const generateHtml = array => {
    let result = ''

    if (array.length) {
      for (let i = 0; i < array.length; i++) {
        result += '<div class=\'aside-list-item\'>'

        if (true) {
          const name = 'data-lazy-src'
          result += `<a href='${array[i].url}' class='thumbnail'><img ${name}='${array[i].avatar}' alt='${array[i].nick}'></a>`
        }
        
        result += `<div class='content'>
        <a class='comment' href='${array[i].url}'>${array[i].content}</a>
        <div class='name'><span>${array[i].nick} / </span><time datetime="${array[i].date}">${btf.diffDate(array[i].date, true)}</time></div>
        </div></div>`
      }
    } else {
      result += 'æ²¡æœ‰è¯„è®º'
    }

    let $dom = document.querySelector('#card-newest-comments .aside-list')
    $dom.innerHTML= result
    window.lazyLoadInstance && window.lazyLoadInstance.update()
    window.pjax && window.pjax.refresh($dom)
  }

  const newestCommentInit = () => {
    if (document.querySelector('#card-newest-comments .aside-list')) {
      const data = saveToLocal.get('twikoo-newest-comments')
      if (data) {
        generateHtml(JSON.parse(data))
      } else {
        getComment()
      }
    }
  }

  newestCommentInit()
  document.addEventListener('pjax:complete', newestCommentInit)
})</script><script data-pjax src="/js/custom.js"></script><script data-pjax src="https://cdn.jsdelivr.net/gh/Eurkon/CDN/hexo/js/gitcalendar.js"></script><script data-pjax async src="//at.alicdn.com/t/font_2358265_expoyqe85d4.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = [
  'title',
  '#config-diff',
  '#body-wrap',
  '#rightside-config-hide',
  '#rightside-config-show',
  '.js-pjax'
]

if (false) {
  pjaxSelectors.unshift('meta[property="og:image"]', 'meta[property="og:title"]', 'meta[property="og:url"]')
}

var pjax = new Pjax({
  elements: 'a:not([target="_blank"]):not([href="/census/"]):not([href="/charts/"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // Analytics
  if (false) {
    MtaH5.pgv()
  }

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()

  typeof preloader === 'object' && preloader.endLoading()
})


document.addEventListener('pjax:send', function () {
  typeof preloader === 'object' && preloader.initLoading()
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script async>window.onload=function(){var a=document.createElement('script'),b=document.getElementsByTagName('script')[0];a.type='text/javascript',a.async=!0,a.src='/sw-register.js?v='+Date.now(),b.parentNode.insertBefore(a,b)};</script></body></html>